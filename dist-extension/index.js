(function(){const Y=document.createElement("link").relList;if(Y&&Y.supports&&Y.supports("modulepreload"))return;for(const $ of document.querySelectorAll('link[rel="modulepreload"]'))b($);new MutationObserver($=>{for(const ne of $)if(ne.type==="childList")for(const de of ne.addedNodes)de.tagName==="LINK"&&de.rel==="modulepreload"&&b(de)}).observe(document,{childList:!0,subtree:!0});function P($){const ne={};return $.integrity&&(ne.integrity=$.integrity),$.referrerPolicy&&(ne.referrerPolicy=$.referrerPolicy),$.crossOrigin==="use-credentials"?ne.credentials="include":$.crossOrigin==="anonymous"?ne.credentials="omit":ne.credentials="same-origin",ne}function b($){if($.ep)return;$.ep=!0;const ne=P($);fetch($.href,ne)}})();var Ju={exports:{}},Sr={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xd;function sm(){if(xd)return Sr;xd=1;var E=Symbol.for("react.transitional.element"),Y=Symbol.for("react.fragment");function P(b,$,ne){var de=null;if(ne!==void 0&&(de=""+ne),$.key!==void 0&&(de=""+$.key),"key"in $){ne={};for(var ee in $)ee!=="key"&&(ne[ee]=$[ee])}else ne=$;return $=ne.ref,{$$typeof:E,type:b,key:de,ref:$!==void 0?$:null,props:ne}}return Sr.Fragment=Y,Sr.jsx=P,Sr.jsxs=P,Sr}var Ud;function lm(){return Ud||(Ud=1,Ju.exports=sm()),Ju.exports}var v=lm(),Wu={exports:{}},Ne={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dd;function rm(){if(Dd)return Ne;Dd=1;var E=Symbol.for("react.transitional.element"),Y=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),$=Symbol.for("react.profiler"),ne=Symbol.for("react.consumer"),de=Symbol.for("react.context"),ee=Symbol.for("react.forward_ref"),V=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),Q=Symbol.for("react.lazy"),he=Symbol.iterator;function le(S){return S===null||typeof S!="object"?null:(S=he&&S[he]||S["@@iterator"],typeof S=="function"?S:null)}var H={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ye=Object.assign,Oe={};function ge(S,I,W){this.props=S,this.context=I,this.refs=Oe,this.updater=W||H}ge.prototype.isReactComponent={},ge.prototype.setState=function(S,I){if(typeof S!="object"&&typeof S!="function"&&S!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,S,I,"setState")},ge.prototype.forceUpdate=function(S){this.updater.enqueueForceUpdate(this,S,"forceUpdate")};function re(){}re.prototype=ge.prototype;function be(S,I,W){this.props=S,this.context=I,this.refs=Oe,this.updater=W||H}var se=be.prototype=new re;se.constructor=be,ye(se,ge.prototype),se.isPureReactComponent=!0;var R=Array.isArray,J={H:null,A:null,T:null,S:null,V:null},nt=Object.prototype.hasOwnProperty;function mt(S,I,W,F,ve,ke){return W=ke.ref,{$$typeof:E,type:S,key:I,ref:W!==void 0?W:null,props:ke}}function Ot(S,I){return mt(S.type,I,void 0,void 0,void 0,S.props)}function lt(S){return typeof S=="object"&&S!==null&&S.$$typeof===E}function Hn(S){var I={"=":"=0",":":"=2"};return"$"+S.replace(/[=:]/g,function(W){return I[W]})}var h=/\/+/g;function qe(S,I){return typeof S=="object"&&S!==null&&S.key!=null?Hn(""+S.key):I.toString(36)}function Xt(){}function U(S){switch(S.status){case"fulfilled":return S.value;case"rejected":throw S.reason;default:switch(typeof S.status=="string"?S.then(Xt,Xt):(S.status="pending",S.then(function(I){S.status==="pending"&&(S.status="fulfilled",S.value=I)},function(I){S.status==="pending"&&(S.status="rejected",S.reason=I)})),S.status){case"fulfilled":return S.value;case"rejected":throw S.reason}}throw S}function Le(S,I,W,F,ve){var ke=typeof S;(ke==="undefined"||ke==="boolean")&&(S=null);var Te=!1;if(S===null)Te=!0;else switch(ke){case"bigint":case"string":case"number":Te=!0;break;case"object":switch(S.$$typeof){case E:case Y:Te=!0;break;case Q:return Te=S._init,Le(Te(S._payload),I,W,F,ve)}}if(Te)return ve=ve(S),Te=F===""?"."+qe(S,0):F,R(ve)?(W="",Te!=null&&(W=Te.replace(h,"$&/")+"/"),Le(ve,I,W,"",function(ln){return ln})):ve!=null&&(lt(ve)&&(ve=Ot(ve,W+(ve.key==null||S&&S.key===ve.key?"":(""+ve.key).replace(h,"$&/")+"/")+Te)),I.push(ve)),1;Te=0;var Et=F===""?".":F+":";if(R(S))for(var Ye=0;Ye<S.length;Ye++)F=S[Ye],ke=Et+qe(F,Ye),Te+=Le(F,I,W,ke,ve);else if(Ye=le(S),typeof Ye=="function")for(S=Ye.call(S),Ye=0;!(F=S.next()).done;)F=F.value,ke=Et+qe(F,Ye++),Te+=Le(F,I,W,ke,ve);else if(ke==="object"){if(typeof S.then=="function")return Le(U(S),I,W,F,ve);throw I=String(S),Error("Objects are not valid as a React child (found: "+(I==="[object Object]"?"object with keys {"+Object.keys(S).join(", ")+"}":I)+"). If you meant to render a collection of children, use an array instead.")}return Te}function D(S,I,W){if(S==null)return S;var F=[],ve=0;return Le(S,F,"","",function(ke){return I.call(W,ke,ve++)}),F}function G(S){if(S._status===-1){var I=S._result;I=I(),I.then(function(W){(S._status===0||S._status===-1)&&(S._status=1,S._result=W)},function(W){(S._status===0||S._status===-1)&&(S._status=2,S._result=W)}),S._status===-1&&(S._status=0,S._result=I)}if(S._status===1)return S._result.default;throw S._result}var me=typeof reportError=="function"?reportError:function(S){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var I=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof S=="object"&&S!==null&&typeof S.message=="string"?String(S.message):String(S),error:S});if(!window.dispatchEvent(I))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",S);return}console.error(S)};function Ge(){}return Ne.Children={map:D,forEach:function(S,I,W){D(S,function(){I.apply(this,arguments)},W)},count:function(S){var I=0;return D(S,function(){I++}),I},toArray:function(S){return D(S,function(I){return I})||[]},only:function(S){if(!lt(S))throw Error("React.Children.only expected to receive a single React element child.");return S}},Ne.Component=ge,Ne.Fragment=P,Ne.Profiler=$,Ne.PureComponent=be,Ne.StrictMode=b,Ne.Suspense=V,Ne.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=J,Ne.__COMPILER_RUNTIME={__proto__:null,c:function(S){return J.H.useMemoCache(S)}},Ne.cache=function(S){return function(){return S.apply(null,arguments)}},Ne.cloneElement=function(S,I,W){if(S==null)throw Error("The argument must be a React element, but you passed "+S+".");var F=ye({},S.props),ve=S.key,ke=void 0;if(I!=null)for(Te in I.ref!==void 0&&(ke=void 0),I.key!==void 0&&(ve=""+I.key),I)!nt.call(I,Te)||Te==="key"||Te==="__self"||Te==="__source"||Te==="ref"&&I.ref===void 0||(F[Te]=I[Te]);var Te=arguments.length-2;if(Te===1)F.children=W;else if(1<Te){for(var Et=Array(Te),Ye=0;Ye<Te;Ye++)Et[Ye]=arguments[Ye+2];F.children=Et}return mt(S.type,ve,void 0,void 0,ke,F)},Ne.createContext=function(S){return S={$$typeof:de,_currentValue:S,_currentValue2:S,_threadCount:0,Provider:null,Consumer:null},S.Provider=S,S.Consumer={$$typeof:ne,_context:S},S},Ne.createElement=function(S,I,W){var F,ve={},ke=null;if(I!=null)for(F in I.key!==void 0&&(ke=""+I.key),I)nt.call(I,F)&&F!=="key"&&F!=="__self"&&F!=="__source"&&(ve[F]=I[F]);var Te=arguments.length-2;if(Te===1)ve.children=W;else if(1<Te){for(var Et=Array(Te),Ye=0;Ye<Te;Ye++)Et[Ye]=arguments[Ye+2];ve.children=Et}if(S&&S.defaultProps)for(F in Te=S.defaultProps,Te)ve[F]===void 0&&(ve[F]=Te[F]);return mt(S,ke,void 0,void 0,null,ve)},Ne.createRef=function(){return{current:null}},Ne.forwardRef=function(S){return{$$typeof:ee,render:S}},Ne.isValidElement=lt,Ne.lazy=function(S){return{$$typeof:Q,_payload:{_status:-1,_result:S},_init:G}},Ne.memo=function(S,I){return{$$typeof:x,type:S,compare:I===void 0?null:I}},Ne.startTransition=function(S){var I=J.T,W={};J.T=W;try{var F=S(),ve=J.S;ve!==null&&ve(W,F),typeof F=="object"&&F!==null&&typeof F.then=="function"&&F.then(Ge,me)}catch(ke){me(ke)}finally{J.T=I}},Ne.unstable_useCacheRefresh=function(){return J.H.useCacheRefresh()},Ne.use=function(S){return J.H.use(S)},Ne.useActionState=function(S,I,W){return J.H.useActionState(S,I,W)},Ne.useCallback=function(S,I){return J.H.useCallback(S,I)},Ne.useContext=function(S){return J.H.useContext(S)},Ne.useDebugValue=function(){},Ne.useDeferredValue=function(S,I){return J.H.useDeferredValue(S,I)},Ne.useEffect=function(S,I,W){var F=J.H;if(typeof W=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return F.useEffect(S,I)},Ne.useId=function(){return J.H.useId()},Ne.useImperativeHandle=function(S,I,W){return J.H.useImperativeHandle(S,I,W)},Ne.useInsertionEffect=function(S,I){return J.H.useInsertionEffect(S,I)},Ne.useLayoutEffect=function(S,I){return J.H.useLayoutEffect(S,I)},Ne.useMemo=function(S,I){return J.H.useMemo(S,I)},Ne.useOptimistic=function(S,I){return J.H.useOptimistic(S,I)},Ne.useReducer=function(S,I,W){return J.H.useReducer(S,I,W)},Ne.useRef=function(S){return J.H.useRef(S)},Ne.useState=function(S){return J.H.useState(S)},Ne.useSyncExternalStore=function(S,I,W){return J.H.useSyncExternalStore(S,I,W)},Ne.useTransition=function(){return J.H.useTransition()},Ne.version="19.1.0",Ne}var kd;function df(){return kd||(kd=1,Wu.exports=rm()),Wu.exports}var At=df(),$u={exports:{}},Ar={},Fu={exports:{}},ef={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ld;function om(){return Ld||(Ld=1,function(E){function Y(D,G){var me=D.length;D.push(G);e:for(;0<me;){var Ge=me-1>>>1,S=D[Ge];if(0<$(S,G))D[Ge]=G,D[me]=S,me=Ge;else break e}}function P(D){return D.length===0?null:D[0]}function b(D){if(D.length===0)return null;var G=D[0],me=D.pop();if(me!==G){D[0]=me;e:for(var Ge=0,S=D.length,I=S>>>1;Ge<I;){var W=2*(Ge+1)-1,F=D[W],ve=W+1,ke=D[ve];if(0>$(F,me))ve<S&&0>$(ke,F)?(D[Ge]=ke,D[ve]=me,Ge=ve):(D[Ge]=F,D[W]=me,Ge=W);else if(ve<S&&0>$(ke,me))D[Ge]=ke,D[ve]=me,Ge=ve;else break e}}return G}function $(D,G){var me=D.sortIndex-G.sortIndex;return me!==0?me:D.id-G.id}if(E.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var ne=performance;E.unstable_now=function(){return ne.now()}}else{var de=Date,ee=de.now();E.unstable_now=function(){return de.now()-ee}}var V=[],x=[],Q=1,he=null,le=3,H=!1,ye=!1,Oe=!1,ge=!1,re=typeof setTimeout=="function"?setTimeout:null,be=typeof clearTimeout=="function"?clearTimeout:null,se=typeof setImmediate<"u"?setImmediate:null;function R(D){for(var G=P(x);G!==null;){if(G.callback===null)b(x);else if(G.startTime<=D)b(x),G.sortIndex=G.expirationTime,Y(V,G);else break;G=P(x)}}function J(D){if(Oe=!1,R(D),!ye)if(P(V)!==null)ye=!0,nt||(nt=!0,qe());else{var G=P(x);G!==null&&Le(J,G.startTime-D)}}var nt=!1,mt=-1,Ot=5,lt=-1;function Hn(){return ge?!0:!(E.unstable_now()-lt<Ot)}function h(){if(ge=!1,nt){var D=E.unstable_now();lt=D;var G=!0;try{e:{ye=!1,Oe&&(Oe=!1,be(mt),mt=-1),H=!0;var me=le;try{t:{for(R(D),he=P(V);he!==null&&!(he.expirationTime>D&&Hn());){var Ge=he.callback;if(typeof Ge=="function"){he.callback=null,le=he.priorityLevel;var S=Ge(he.expirationTime<=D);if(D=E.unstable_now(),typeof S=="function"){he.callback=S,R(D),G=!0;break t}he===P(V)&&b(V),R(D)}else b(V);he=P(V)}if(he!==null)G=!0;else{var I=P(x);I!==null&&Le(J,I.startTime-D),G=!1}}break e}finally{he=null,le=me,H=!1}G=void 0}}finally{G?qe():nt=!1}}}var qe;if(typeof se=="function")qe=function(){se(h)};else if(typeof MessageChannel<"u"){var Xt=new MessageChannel,U=Xt.port2;Xt.port1.onmessage=h,qe=function(){U.postMessage(null)}}else qe=function(){re(h,0)};function Le(D,G){mt=re(function(){D(E.unstable_now())},G)}E.unstable_IdlePriority=5,E.unstable_ImmediatePriority=1,E.unstable_LowPriority=4,E.unstable_NormalPriority=3,E.unstable_Profiling=null,E.unstable_UserBlockingPriority=2,E.unstable_cancelCallback=function(D){D.callback=null},E.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ot=0<D?Math.floor(1e3/D):5},E.unstable_getCurrentPriorityLevel=function(){return le},E.unstable_next=function(D){switch(le){case 1:case 2:case 3:var G=3;break;default:G=le}var me=le;le=G;try{return D()}finally{le=me}},E.unstable_requestPaint=function(){ge=!0},E.unstable_runWithPriority=function(D,G){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var me=le;le=D;try{return G()}finally{le=me}},E.unstable_scheduleCallback=function(D,G,me){var Ge=E.unstable_now();switch(typeof me=="object"&&me!==null?(me=me.delay,me=typeof me=="number"&&0<me?Ge+me:Ge):me=Ge,D){case 1:var S=-1;break;case 2:S=250;break;case 5:S=1073741823;break;case 4:S=1e4;break;default:S=5e3}return S=me+S,D={id:Q++,callback:G,priorityLevel:D,startTime:me,expirationTime:S,sortIndex:-1},me>Ge?(D.sortIndex=me,Y(x,D),P(V)===null&&D===P(x)&&(Oe?(be(mt),mt=-1):Oe=!0,Le(J,me-Ge))):(D.sortIndex=S,Y(V,D),ye||H||(ye=!0,nt||(nt=!0,qe()))),D},E.unstable_shouldYield=Hn,E.unstable_wrapCallback=function(D){var G=le;return function(){var me=le;le=G;try{return D.apply(this,arguments)}finally{le=me}}}}(ef)),ef}var jd;function cm(){return jd||(jd=1,Fu.exports=om()),Fu.exports}var tf={exports:{}},Vt={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bd;function um(){if(Bd)return Vt;Bd=1;var E=df();function Y(V){var x="https://react.dev/errors/"+V;if(1<arguments.length){x+="?args[]="+encodeURIComponent(arguments[1]);for(var Q=2;Q<arguments.length;Q++)x+="&args[]="+encodeURIComponent(arguments[Q])}return"Minified React error #"+V+"; visit "+x+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function P(){}var b={d:{f:P,r:function(){throw Error(Y(522))},D:P,C:P,L:P,m:P,X:P,S:P,M:P},p:0,findDOMNode:null},$=Symbol.for("react.portal");function ne(V,x,Q){var he=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$,key:he==null?null:""+he,children:V,containerInfo:x,implementation:Q}}var de=E.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function ee(V,x){if(V==="font")return"";if(typeof x=="string")return x==="use-credentials"?x:""}return Vt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=b,Vt.createPortal=function(V,x){var Q=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!x||x.nodeType!==1&&x.nodeType!==9&&x.nodeType!==11)throw Error(Y(299));return ne(V,x,null,Q)},Vt.flushSync=function(V){var x=de.T,Q=b.p;try{if(de.T=null,b.p=2,V)return V()}finally{de.T=x,b.p=Q,b.d.f()}},Vt.preconnect=function(V,x){typeof V=="string"&&(x?(x=x.crossOrigin,x=typeof x=="string"?x==="use-credentials"?x:"":void 0):x=null,b.d.C(V,x))},Vt.prefetchDNS=function(V){typeof V=="string"&&b.d.D(V)},Vt.preinit=function(V,x){if(typeof V=="string"&&x&&typeof x.as=="string"){var Q=x.as,he=ee(Q,x.crossOrigin),le=typeof x.integrity=="string"?x.integrity:void 0,H=typeof x.fetchPriority=="string"?x.fetchPriority:void 0;Q==="style"?b.d.S(V,typeof x.precedence=="string"?x.precedence:void 0,{crossOrigin:he,integrity:le,fetchPriority:H}):Q==="script"&&b.d.X(V,{crossOrigin:he,integrity:le,fetchPriority:H,nonce:typeof x.nonce=="string"?x.nonce:void 0})}},Vt.preinitModule=function(V,x){if(typeof V=="string")if(typeof x=="object"&&x!==null){if(x.as==null||x.as==="script"){var Q=ee(x.as,x.crossOrigin);b.d.M(V,{crossOrigin:Q,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0})}}else x==null&&b.d.M(V)},Vt.preload=function(V,x){if(typeof V=="string"&&typeof x=="object"&&x!==null&&typeof x.as=="string"){var Q=x.as,he=ee(Q,x.crossOrigin);b.d.L(V,Q,{crossOrigin:he,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0,type:typeof x.type=="string"?x.type:void 0,fetchPriority:typeof x.fetchPriority=="string"?x.fetchPriority:void 0,referrerPolicy:typeof x.referrerPolicy=="string"?x.referrerPolicy:void 0,imageSrcSet:typeof x.imageSrcSet=="string"?x.imageSrcSet:void 0,imageSizes:typeof x.imageSizes=="string"?x.imageSizes:void 0,media:typeof x.media=="string"?x.media:void 0})}},Vt.preloadModule=function(V,x){if(typeof V=="string")if(x){var Q=ee(x.as,x.crossOrigin);b.d.m(V,{as:typeof x.as=="string"&&x.as!=="script"?x.as:void 0,crossOrigin:Q,integrity:typeof x.integrity=="string"?x.integrity:void 0})}else b.d.m(V)},Vt.requestFormReset=function(V){b.d.r(V)},Vt.unstable_batchedUpdates=function(V,x){return V(x)},Vt.useFormState=function(V,x,Q){return de.H.useFormState(V,x,Q)},Vt.useFormStatus=function(){return de.H.useHostTransitionStatus()},Vt.version="19.1.0",Vt}var qd;function fm(){if(qd)return tf.exports;qd=1;function E(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(E)}catch(Y){console.error(Y)}}return E(),tf.exports=um(),tf.exports}var Gd;function hm(){if(Gd)return Ar;Gd=1;/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E=cm(),Y=df(),P=fm();function b(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function $(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ne(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function de(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ee(e){if(ne(e)!==e)throw Error(b(188))}function V(e){var t=e.alternate;if(!t){if(t=ne(e),t===null)throw Error(b(188));return t!==e?null:e}for(var n=e,s=t;;){var r=n.return;if(r===null)break;var c=r.alternate;if(c===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===c.child){for(c=r.child;c;){if(c===n)return ee(r),e;if(c===s)return ee(r),t;c=c.sibling}throw Error(b(188))}if(n.return!==s.return)n=r,s=c;else{for(var d=!1,g=r.child;g;){if(g===n){d=!0,n=r,s=c;break}if(g===s){d=!0,s=r,n=c;break}g=g.sibling}if(!d){for(g=c.child;g;){if(g===n){d=!0,n=c,s=r;break}if(g===s){d=!0,s=c,n=r;break}g=g.sibling}if(!d)throw Error(b(189))}}if(n.alternate!==s)throw Error(b(190))}if(n.tag!==3)throw Error(b(188));return n.stateNode.current===n?e:t}function x(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=x(e),t!==null)return t;e=e.sibling}return null}var Q=Object.assign,he=Symbol.for("react.element"),le=Symbol.for("react.transitional.element"),H=Symbol.for("react.portal"),ye=Symbol.for("react.fragment"),Oe=Symbol.for("react.strict_mode"),ge=Symbol.for("react.profiler"),re=Symbol.for("react.provider"),be=Symbol.for("react.consumer"),se=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),J=Symbol.for("react.suspense"),nt=Symbol.for("react.suspense_list"),mt=Symbol.for("react.memo"),Ot=Symbol.for("react.lazy"),lt=Symbol.for("react.activity"),Hn=Symbol.for("react.memo_cache_sentinel"),h=Symbol.iterator;function qe(e){return e===null||typeof e!="object"?null:(e=h&&e[h]||e["@@iterator"],typeof e=="function"?e:null)}var Xt=Symbol.for("react.client.reference");function U(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===Xt?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ye:return"Fragment";case ge:return"Profiler";case Oe:return"StrictMode";case J:return"Suspense";case nt:return"SuspenseList";case lt:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case H:return"Portal";case se:return(e.displayName||"Context")+".Provider";case be:return(e._context.displayName||"Context")+".Consumer";case R:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case mt:return t=e.displayName||null,t!==null?t:U(e.type)||"Memo";case Ot:t=e._payload,e=e._init;try{return U(e(t))}catch{}}return null}var Le=Array.isArray,D=Y.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,G=P.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,me={pending:!1,data:null,method:null,action:null},Ge=[],S=-1;function I(e){return{current:e}}function W(e){0>S||(e.current=Ge[S],Ge[S]=null,S--)}function F(e,t){S++,Ge[S]=e.current,e.current=t}var ve=I(null),ke=I(null),Te=I(null),Et=I(null);function Ye(e,t){switch(F(Te,t),F(ke,e),F(ve,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?sd(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=sd(t),e=ld(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}W(ve),F(ve,e)}function ln(){W(ve),W(ke),W(Te)}function Bi(e){e.memoizedState!==null&&F(Et,e);var t=ve.current,n=ld(t,e.type);t!==n&&(F(ke,e),F(ve,n))}function qi(e){ke.current===e&&(W(ve),W(ke)),Et.current===e&&(W(Et),mr._currentValue=me)}var On=Object.prototype.hasOwnProperty,Gi=E.unstable_scheduleCallback,zi=E.unstable_cancelCallback,os=E.unstable_shouldYield,cs=E.unstable_requestPaint,X=E.unstable_now,Z=E.unstable_getCurrentPriorityLevel,ce=E.unstable_ImmediatePriority,ue=E.unstable_UserBlockingPriority,te=E.unstable_NormalPriority,ct=E.unstable_LowPriority,Dt=E.unstable_IdlePriority,dn=E.log,Hi=E.unstable_setDisableYieldValue,Vn=null,Xe=null;function ut(e){if(typeof dn=="function"&&Hi(e),Xe&&typeof Xe.setStrictMode=="function")try{Xe.setStrictMode(Vn,e)}catch{}}var et=Math.clz32?Math.clz32:Er,sl=Math.log,_r=Math.LN2;function Er(e){return e>>>=0,e===0?32:31-(sl(e)/_r|0)|0}var Ua=256,Vi=4194304;function Tn(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Da(e,t,n){var s=e.pendingLanes;if(s===0)return 0;var r=0,c=e.suspendedLanes,d=e.pingedLanes;e=e.warmLanes;var g=s&134217727;return g!==0?(s=g&~c,s!==0?r=Tn(s):(d&=g,d!==0?r=Tn(d):n||(n=g&~e,n!==0&&(r=Tn(n))))):(g=s&~c,g!==0?r=Tn(g):d!==0?r=Tn(d):n||(n=s&~e,n!==0&&(r=Tn(n)))),r===0?0:t!==0&&t!==r&&(t&c)===0&&(c=r&-r,n=t&-t,c>=n||c===32&&(n&4194048)!==0)?t:r}function Ii(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function us(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ll(){var e=Ua;return Ua<<=1,(Ua&4194048)===0&&(Ua=256),e}function ka(){var e=Vi;return Vi<<=1,(Vi&62914560)===0&&(Vi=4194304),e}function pt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Yi(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Mr(e,t,n,s,r,c){var d=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var g=e.entanglements,y=e.expirationTimes,M=e.hiddenUpdates;for(n=d&~n;0<n;){var k=31-et(n),z=1<<k;g[k]=0,y[k]=-1;var w=M[k];if(w!==null)for(M[k]=null,k=0;k<w.length;k++){var N=w[k];N!==null&&(N.lane&=-536870913)}n&=~z}s!==0&&wr(e,s,0),c!==0&&r===0&&e.tag!==0&&(e.suspendedLanes|=c&~(d&~t))}function wr(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var s=31-et(t);e.entangledLanes|=t,e.entanglements[s]=e.entanglements[s]|1073741824|n&4194090}function Zt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-et(n),r=1<<s;r&t|e[s]&t&&(e[s]|=t),n&=~r}}function rl(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function ol(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function cl(){var e=G.p;return e!==0?e:(e=window.event,e===void 0?32:Cd(e.type))}function Nr(e,t){var n=G.p;try{return G.p=e,t()}finally{G.p=n}}var Rn=Math.random().toString(36).slice(2),Tt="__reactFiber$"+Rn,kt="__reactProps$"+Rn,Pi="__reactContainer$"+Rn,fs="__reactEvents$"+Rn,yc="__reactListeners$"+Rn,ul="__reactHandles$"+Rn,xr="__reactResources$"+Rn,La="__reactMarker$"+Rn;function fl(e){delete e[Tt],delete e[kt],delete e[fs],delete e[yc],delete e[ul]}function Cn(e){var t=e[Tt];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Pi]||n[Tt]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=ud(e);e!==null;){if(n=e[Tt])return n;e=ud(e)}return t}e=n,n=e.parentNode}return null}function ui(e){if(e=e[Tt]||e[Pi]){var t=e.tag;if(t===5||t===6||t===13||t===26||t===27||t===3)return e}return null}function In(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(b(33))}function Qi(e){var t=e[xr];return t||(t=e[xr]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function yt(e){e[La]=!0}var Ce=new Set,Ur={};function fi(e,t){Yn(e,t),Yn(e+"Capture",t)}function Yn(e,t){for(Ur[e]=t,e=0;e<t.length;e++)Ce.add(t[e])}var Dr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),it={},hl={};function vc(e){return On.call(hl,e)?!0:On.call(it,e)?!1:Dr.test(e)?hl[e]=!0:(it[e]=!0,!1)}function hi(e,t,n){if(vc(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var s=t.toLowerCase().slice(0,5);if(s!=="data-"&&s!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function Xi(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function _n(e,t,n,s){if(s===null)e.removeAttribute(n);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+s)}}var dl,gl;function Zi(e){if(dl===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);dl=t&&t[1]||"",gl=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+dl+e+gl}var hs=!1;function ds(e,t){if(!e||hs)return"";hs=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var s={DetermineComponentFrameRoot:function(){try{if(t){var z=function(){throw Error()};if(Object.defineProperty(z.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(z,[])}catch(N){var w=N}Reflect.construct(e,[],z)}else{try{z.call()}catch(N){w=N}e.call(z.prototype)}}else{try{throw Error()}catch(N){w=N}(z=e())&&typeof z.catch=="function"&&z.catch(function(){})}}catch(N){if(N&&w&&typeof N.stack=="string")return[N.stack,w.stack]}return[null,null]}};s.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var r=Object.getOwnPropertyDescriptor(s.DetermineComponentFrameRoot,"name");r&&r.configurable&&Object.defineProperty(s.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var c=s.DetermineComponentFrameRoot(),d=c[0],g=c[1];if(d&&g){var y=d.split(`
`),M=g.split(`
`);for(r=s=0;s<y.length&&!y[s].includes("DetermineComponentFrameRoot");)s++;for(;r<M.length&&!M[r].includes("DetermineComponentFrameRoot");)r++;if(s===y.length||r===M.length)for(s=y.length-1,r=M.length-1;1<=s&&0<=r&&y[s]!==M[r];)r--;for(;1<=s&&0<=r;s--,r--)if(y[s]!==M[r]){if(s!==1||r!==1)do if(s--,r--,0>r||y[s]!==M[r]){var k=`
`+y[s].replace(" at new "," at ");return e.displayName&&k.includes("<anonymous>")&&(k=k.replace("<anonymous>",e.displayName)),k}while(1<=s&&0<=r);break}}}finally{hs=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?Zi(n):""}function bc(e){switch(e.tag){case 26:case 27:case 5:return Zi(e.type);case 16:return Zi("Lazy");case 13:return Zi("Suspense");case 19:return Zi("SuspenseList");case 0:case 15:return ds(e.type,!1);case 11:return ds(e.type.render,!1);case 1:return ds(e.type,!0);case 31:return Zi("Activity");default:return""}}function ml(e){try{var t="";do t+=bc(e),e=e.return;while(e);return t}catch(n){return`
Error generating stack: `+n.message+`
`+n.stack}}function Kt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function kr(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Sc(e){var t=kr(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,c=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(d){s=""+d,c.call(this,d)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(d){s=""+d},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function gs(e){e._valueTracker||(e._valueTracker=Sc(e))}function gn(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=kr(e)?e.checked?"true":"false":e.value),e=s,e!==n?(t.setValue(e),!0):!1}function Ki(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Ji=/[\n"\\]/g;function Jt(e){return e.replace(Ji,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function pl(e,t,n,s,r,c,d,g){e.name="",d!=null&&typeof d!="function"&&typeof d!="symbol"&&typeof d!="boolean"?e.type=d:e.removeAttribute("type"),t!=null?d==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Kt(t)):e.value!==""+Kt(t)&&(e.value=""+Kt(t)):d!=="submit"&&d!=="reset"||e.removeAttribute("value"),t!=null?yl(e,d,Kt(t)):n!=null?yl(e,d,Kt(n)):s!=null&&e.removeAttribute("value"),r==null&&c!=null&&(e.defaultChecked=!!c),r!=null&&(e.checked=r&&typeof r!="function"&&typeof r!="symbol"),g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"?e.name=""+Kt(g):e.removeAttribute("name")}function ms(e,t,n,s,r,c,d,g){if(c!=null&&typeof c!="function"&&typeof c!="symbol"&&typeof c!="boolean"&&(e.type=c),t!=null||n!=null){if(!(c!=="submit"&&c!=="reset"||t!=null))return;n=n!=null?""+Kt(n):"",t=t!=null?""+Kt(t):n,g||t===e.value||(e.value=t),e.defaultValue=t}s=s??r,s=typeof s!="function"&&typeof s!="symbol"&&!!s,e.checked=g?e.checked:!!s,e.defaultChecked=!!s,d!=null&&typeof d!="function"&&typeof d!="symbol"&&typeof d!="boolean"&&(e.name=d)}function yl(e,t,n){t==="number"&&Ki(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function Pn(e,t,n,s){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&s&&(e[n].defaultSelected=!0)}else{for(n=""+Kt(n),t=null,r=0;r<e.length;r++){if(e[r].value===n){e[r].selected=!0,s&&(e[r].defaultSelected=!0);return}t!==null||e[r].disabled||(t=e[r])}t!==null&&(t.selected=!0)}}function Lr(e,t,n){if(t!=null&&(t=""+Kt(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+Kt(n):""}function dt(e,t,n,s){if(t==null){if(s!=null){if(n!=null)throw Error(b(92));if(Le(s)){if(1<s.length)throw Error(b(93));s=s[0]}n=s}n==null&&(n=""),t=n}n=Kt(t),e.defaultValue=n,s=e.textContent,s===n&&s!==""&&s!==null&&(e.value=s)}function fe(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var jr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Lt(e,t,n){var s=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?s?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":s?e.setProperty(t,n):typeof n!="number"||n===0||jr.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Br(e,t,n){if(t!=null&&typeof t!="object")throw Error(b(62));if(e=e.style,n!=null){for(var s in n)!n.hasOwnProperty(s)||t!=null&&t.hasOwnProperty(s)||(s.indexOf("--")===0?e.setProperty(s,""):s==="float"?e.cssFloat="":e[s]="");for(var r in t)s=t[r],t.hasOwnProperty(r)&&n[r]!==s&&Lt(e,r,s)}else for(var c in t)t.hasOwnProperty(c)&&Lt(e,c,t[c])}function ps(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ac=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),qr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ys(e){return qr.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var vs=null;function ja(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var di=null,Qn=null;function vl(e){var t=ui(e);if(t&&(e=t.stateNode)){var n=e[kt]||null;e:switch(e=t.stateNode,t.type){case"input":if(pl(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+Jt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var r=s[kt]||null;if(!r)throw Error(b(90));pl(s,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name)}}for(t=0;t<n.length;t++)s=n[t],s.form===e.form&&gn(s)}break e;case"textarea":Lr(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&Pn(e,!!n.multiple,t,!1)}}}var Ba=!1;function bl(e,t,n){if(Ba)return e(t,n);Ba=!0;try{var s=e(t);return s}finally{if(Ba=!1,(di!==null||Qn!==null)&&(Zo(),di&&(t=di,e=Qn,Qn=di=null,vl(t),e)))for(t=0;t<e.length;t++)vl(e[t])}}function Xn(e,t){var n=e.stateNode;if(n===null)return null;var s=n[kt]||null;if(s===null)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(b(231,t,typeof n));return n}var Wt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Zn=!1;if(Wt)try{var mn={};Object.defineProperty(mn,"passive",{get:function(){Zn=!0}}),window.addEventListener("test",mn,mn),window.removeEventListener("test",mn,mn)}catch{Zn=!1}var En=null,bs=null,Ss=null;function gi(){if(Ss)return Ss;var e,t=bs,n=t.length,s,r="value"in En?En.value:En.textContent,c=r.length;for(e=0;e<n&&t[e]===r[e];e++);var d=n-e;for(s=1;s<=d&&t[n-s]===r[c-s];s++);return Ss=r.slice(e,1<s?1-s:void 0)}function qa(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function As(){return!0}function Gr(){return!1}function Gt(e){function t(n,s,r,c,d){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=c,this.target=d,this.currentTarget=null;for(var g in e)e.hasOwnProperty(g)&&(n=e[g],this[g]=n?n(c):c[g]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?As:Gr,this.isPropagationStopped=Gr,this}return Q(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=As)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=As)},persist:function(){},isPersistent:As}),t}var Ze={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Os=Gt(Ze),Ga=Q({},Ze,{view:0,detail:0}),Oc=Gt(Ga),Sl,Ts,za,It=Q({},Ga,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pn,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==za&&(za&&e.type==="mousemove"?(Sl=e.screenX-za.screenX,Ts=e.screenY-za.screenY):Ts=Sl=0,za=e),Sl)},movementY:function(e){return"movementY"in e?e.movementY:Ts}}),Al=Gt(It),Tc=Q({},It,{dataTransfer:0}),Rs=Gt(Tc),Rc=Q({},Ga,{relatedTarget:0}),Ol=Gt(Rc),Cc=Q({},Ze,{animationName:0,elapsedTime:0,pseudoElement:0}),_c=Gt(Cc),Ec=Q({},Ze,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),zr=Gt(Ec),Hr=Q({},Ze,{data:0}),Vr=Gt(Hr),Mc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ir={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Yr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ha(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Yr[e])?!!t[e]:!1}function pn(){return Ha}var wc=Q({},Ga,{key:function(e){if(e.key){var t=Mc[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=qa(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Ir[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pn,charCode:function(e){return e.type==="keypress"?qa(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?qa(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Nc=Gt(wc),Pr=Q({},It,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qr=Gt(Pr),xc=Q({},Ga,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pn}),Xr=Gt(xc),Uc=Q({},Ze,{propertyName:0,elapsedTime:0,pseudoElement:0}),Dc=Gt(Uc),kc=Q({},It,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Zr=Gt(kc),Lc=Q({},Ze,{newState:0,oldState:0}),Tl=Gt(Lc),Kr=[9,13,27,32],mi=Wt&&"CompositionEvent"in window,$t=null;Wt&&"documentMode"in document&&($t=document.documentMode);var jc=Wt&&"TextEvent"in window&&!$t,Jr=Wt&&(!mi||$t&&8<$t&&11>=$t),Wr=" ",$r=!1;function Fr(e,t){switch(e){case"keyup":return Kr.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function eo(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var pi=!1;function Bc(e,t){switch(e){case"compositionend":return eo(t);case"keypress":return t.which!==32?null:($r=!0,Wr);case"textInput":return e=t.data,e===Wr&&$r?null:e;default:return null}}function to(e,t){if(pi)return e==="compositionend"||!mi&&Fr(e,t)?(e=gi(),Ss=bs=En=null,pi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Jr&&t.locale!=="ko"?null:t.data;default:return null}}var qc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function no(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!qc[e.type]:t==="textarea"}function Rl(e,t,n,s){di?Qn?Qn.push(s):Qn=[s]:di=s,t=ec(t,"onChange"),0<t.length&&(n=new Os("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var Wi=null,$i=null;function io(e){ed(e,0)}function Va(e){var t=In(e);if(gn(t))return e}function ao(e,t){if(e==="change")return t}var so=!1;if(Wt){var Cl;if(Wt){var Cs="oninput"in document;if(!Cs){var yi=document.createElement("div");yi.setAttribute("oninput","return;"),Cs=typeof yi.oninput=="function"}Cl=Cs}else Cl=!1;so=Cl&&(!document.documentMode||9<document.documentMode)}function Fi(){Wi&&(Wi.detachEvent("onpropertychange",_l),$i=Wi=null)}function _l(e){if(e.propertyName==="value"&&Va($i)){var t=[];Rl(t,$i,e,ja(e)),bl(io,t)}}function lo(e,t,n){e==="focusin"?(Fi(),Wi=t,$i=n,Wi.attachEvent("onpropertychange",_l)):e==="focusout"&&Fi()}function ro(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Va($i)}function oo(e,t){if(e==="click")return Va(t)}function Gc(e,t){if(e==="input"||e==="change")return Va(t)}function El(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Yt=typeof Object.is=="function"?Object.is:El;function Kn(e,t){if(Yt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!On.call(t,r)||!Yt(e[r],t[r]))return!1}return!0}function co(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function _s(e,t){var n=co(e);e=0;for(var s;n;){if(n.nodeType===3){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=co(n)}}function Ml(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ml(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function zt(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Ki(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Ki(e.document)}return t}function Ia(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var wl=Wt&&"documentMode"in document&&11>=document.documentMode,ea=null,Nl=null,vi=null,Es=!1;function uo(e,t,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Es||ea==null||ea!==Ki(s)||(s=ea,"selectionStart"in s&&Ia(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),vi&&Kn(vi,s)||(vi=s,s=ec(Nl,"onSelect"),0<s.length&&(t=new Os("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=ea)))}function bi(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Si={animationend:bi("Animation","AnimationEnd"),animationiteration:bi("Animation","AnimationIteration"),animationstart:bi("Animation","AnimationStart"),transitionrun:bi("Transition","TransitionRun"),transitionstart:bi("Transition","TransitionStart"),transitioncancel:bi("Transition","TransitionCancel"),transitionend:bi("Transition","TransitionEnd")},Ai={},fo={};Wt&&(fo=document.createElement("div").style,"AnimationEvent"in window||(delete Si.animationend.animation,delete Si.animationiteration.animation,delete Si.animationstart.animation),"TransitionEvent"in window||delete Si.transitionend.transition);function Jn(e){if(Ai[e])return Ai[e];if(!Si[e])return e;var t=Si[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in fo)return Ai[e]=t[n];return e}var Wn=Jn("animationend"),Ms=Jn("animationiteration"),ho=Jn("animationstart"),go=Jn("transitionrun"),mo=Jn("transitionstart"),zc=Jn("transitioncancel"),po=Jn("transitionend"),yo=new Map,ta="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ta.push("scrollEnd");function vt(e,t){yo.set(e,t),fi(t,[e])}var vo=new WeakMap;function Ft(e,t){if(typeof e=="object"&&e!==null){var n=vo.get(e);return n!==void 0?n:(t={value:e,source:t,stack:ml(t)},vo.set(e,t),t)}return{value:e,source:t,stack:ml(t)}}var bt=[],na=0,xl=0;function ws(){for(var e=na,t=xl=na=0;t<e;){var n=bt[t];bt[t++]=null;var s=bt[t];bt[t++]=null;var r=bt[t];bt[t++]=null;var c=bt[t];if(bt[t++]=null,s!==null&&r!==null){var d=s.pending;d===null?r.next=r:(r.next=d.next,d.next=r),s.pending=r}c!==0&&Ns(n,r,c)}}function Mn(e,t,n,s){bt[na++]=e,bt[na++]=t,bt[na++]=n,bt[na++]=s,xl|=s,e.lanes|=s,e=e.alternate,e!==null&&(e.lanes|=s)}function Mt(e,t,n,s){return Mn(e,t,n,s),$n(e)}function ia(e,t){return Mn(e,null,null,t),$n(e)}function Ns(e,t,n){e.lanes|=n;var s=e.alternate;s!==null&&(s.lanes|=n);for(var r=!1,c=e.return;c!==null;)c.childLanes|=n,s=c.alternate,s!==null&&(s.childLanes|=n),c.tag===22&&(e=c.stateNode,e===null||e._visibility&1||(r=!0)),e=c,c=c.return;return e.tag===3?(c=e.stateNode,r&&t!==null&&(r=31-et(n),e=c.hiddenUpdates,s=e[r],s===null?e[r]=[t]:s.push(t),t.lane=n|536870912),c):null}function $n(e){if(50<rr)throw rr=0,Su=null,Error(b(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Oi={};function Ul(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pt(e,t,n,s){return new Ul(e,t,n,s)}function Ya(e){return e=e.prototype,!(!e||!e.isReactComponent)}function wn(e,t){var n=e.alternate;return n===null?(n=Pt(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function bo(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Pa(e,t,n,s,r,c){var d=0;if(s=e,typeof e=="function")Ya(e)&&(d=1);else if(typeof e=="string")d=Qg(e,n,ve.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case lt:return e=Pt(31,n,t,r),e.elementType=lt,e.lanes=c,e;case ye:return Ti(n.children,r,c,t);case Oe:d=8,r|=24;break;case ge:return e=Pt(12,n,t,r|2),e.elementType=ge,e.lanes=c,e;case J:return e=Pt(13,n,t,r),e.elementType=J,e.lanes=c,e;case nt:return e=Pt(19,n,t,r),e.elementType=nt,e.lanes=c,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case re:case se:d=10;break e;case be:d=9;break e;case R:d=11;break e;case mt:d=14;break e;case Ot:d=16,s=null;break e}d=29,n=Error(b(130,e===null?"null":typeof e,"")),s=null}return t=Pt(d,n,t,r),t.elementType=e,t.type=s,t.lanes=c,t}function Ti(e,t,n,s){return e=Pt(7,e,s,t),e.lanes=n,e}function Dl(e,t,n){return e=Pt(6,e,null,t),e.lanes=n,e}function xs(e,t,n){return t=Pt(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var aa=[],sa=0,Us=null,Ds=0,Ht=[],en=0,Nn=null,xn=1,Un="";function Ri(e,t){aa[sa++]=Ds,aa[sa++]=Us,Us=e,Ds=t}function So(e,t,n){Ht[en++]=xn,Ht[en++]=Un,Ht[en++]=Nn,Nn=e;var s=xn;e=Un;var r=32-et(s)-1;s&=~(1<<r),n+=1;var c=32-et(t)+r;if(30<c){var d=r-r%5;c=(s&(1<<d)-1).toString(32),s>>=d,r-=d,xn=1<<32-et(t)+r|n<<r|s,Un=c+e}else xn=1<<c|n<<r|s,Un=e}function kl(e){e.return!==null&&(Ri(e,1),So(e,1,0))}function Ll(e){for(;e===Us;)Us=aa[--sa],aa[sa]=null,Ds=aa[--sa],aa[sa]=null;for(;e===Nn;)Nn=Ht[--en],Ht[en]=null,Un=Ht[--en],Ht[en]=null,xn=Ht[--en],Ht[en]=null}var wt=null,at=null,Me=!1,Dn=null,tn=!1,Ci=Error(b(519));function kn(e){var t=Error(b(418,""));throw jn(Ft(t,e)),Ci}function jl(e){var t=e.stateNode,n=e.type,s=e.memoizedProps;switch(t[Tt]=e,t[kt]=s,n){case"dialog":De("cancel",t),De("close",t);break;case"iframe":case"object":case"embed":De("load",t);break;case"video":case"audio":for(n=0;n<cr.length;n++)De(cr[n],t);break;case"source":De("error",t);break;case"img":case"image":case"link":De("error",t),De("load",t);break;case"details":De("toggle",t);break;case"input":De("invalid",t),ms(t,s.value,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name,!0),gs(t);break;case"select":De("invalid",t);break;case"textarea":De("invalid",t),dt(t,s.value,s.defaultValue,s.children),gs(t)}n=s.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||s.suppressHydrationWarning===!0||ad(t.textContent,n)?(s.popover!=null&&(De("beforetoggle",t),De("toggle",t)),s.onScroll!=null&&De("scroll",t),s.onScrollEnd!=null&&De("scrollend",t),s.onClick!=null&&(t.onclick=tc),t=!0):t=!1,t||kn(e)}function Bl(e){for(wt=e.return;wt;)switch(wt.tag){case 5:case 13:tn=!1;return;case 27:case 3:tn=!0;return;default:wt=wt.return}}function Ln(e){if(e!==wt)return!1;if(!Me)return Bl(e),Me=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||ju(e.type,e.memoizedProps)),n=!n),n&&at&&kn(e),Bl(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(b(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8)if(n=e.data,n==="/$"){if(t===0){at=zn(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++;e=e.nextSibling}at=null}}else t===27?(t=at,_a(e.type)?(e=zu,zu=null,at=e):at=t):at=wt?zn(e.stateNode.nextSibling):null;return!0}function la(){at=wt=null,Me=!1}function ra(){var e=Dn;return e!==null&&(sn===null?sn=e:sn.push.apply(sn,e),Dn=null),e}function jn(e){Dn===null?Dn=[e]:Dn.push(e)}var Qa=I(null),yn=null,Bn=null;function vn(e,t,n){F(Qa,t._currentValue),t._currentValue=n}function St(e){e._currentValue=Qa.current,W(Qa)}function oa(e,t,n){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function ql(e,t,n,s){var r=e.child;for(r!==null&&(r.return=e);r!==null;){var c=r.dependencies;if(c!==null){var d=r.child;c=c.firstContext;e:for(;c!==null;){var g=c;c=r;for(var y=0;y<t.length;y++)if(g.context===t[y]){c.lanes|=n,g=c.alternate,g!==null&&(g.lanes|=n),oa(c.return,n,e),s||(d=null);break e}c=g.next}}else if(r.tag===18){if(d=r.return,d===null)throw Error(b(341));d.lanes|=n,c=d.alternate,c!==null&&(c.lanes|=n),oa(d,n,e),d=null}else d=r.child;if(d!==null)d.return=r;else for(d=r;d!==null;){if(d===e){d=null;break}if(r=d.sibling,r!==null){r.return=d.return,d=r;break}d=d.return}r=d}}function Xa(e,t,n,s){e=null;for(var r=t,c=!1;r!==null;){if(!c){if((r.flags&524288)!==0)c=!0;else if((r.flags&262144)!==0)break}if(r.tag===10){var d=r.alternate;if(d===null)throw Error(b(387));if(d=d.memoizedProps,d!==null){var g=r.type;Yt(r.pendingProps.value,d.value)||(e!==null?e.push(g):e=[g])}}else if(r===Et.current){if(d=r.alternate,d===null)throw Error(b(387));d.memoizedState.memoizedState!==r.memoizedState.memoizedState&&(e!==null?e.push(mr):e=[mr])}r=r.return}e!==null&&ql(t,e,n,s),t.flags|=262144}function Za(e){for(e=e.firstContext;e!==null;){if(!Yt(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function _i(e){yn=e,Bn=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Rt(e){return Gl(yn,e)}function nn(e,t){return yn===null&&_i(e),Gl(e,t)}function Gl(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},Bn===null){if(e===null)throw Error(b(308));Bn=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Bn=Bn.next=t;return n}var Ka=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,s){e.push(s)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},Ao=E.unstable_scheduleCallback,Oo=E.unstable_NormalPriority,$e={$$typeof:se,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Fn(){return{controller:new Ka,data:new Map,refCount:0}}function Ja(e){e.refCount--,e.refCount===0&&Ao(Oo,function(){e.controller.abort()})}var ca=null,tt=0,ua=0,fa=null;function Hc(e,t){if(ca===null){var n=ca=[];tt=0,ua=Eu(),fa={status:"pending",value:void 0,then:function(s){n.push(s)}}}return tt++,t.then(To,To),t}function To(){if(--tt===0&&ca!==null){fa!==null&&(fa.status="fulfilled");var e=ca;ca=null,ua=0,fa=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function Vc(e,t){var n=[],s={status:"pending",value:null,reason:null,then:function(r){n.push(r)}};return e.then(function(){s.status="fulfilled",s.value=t;for(var r=0;r<n.length;r++)(0,n[r])(t)},function(r){for(s.status="rejected",s.reason=r,r=0;r<n.length;r++)(0,n[r])(void 0)}),s}var Ro=D.S;D.S=function(e,t){typeof t=="object"&&t!==null&&typeof t.then=="function"&&Hc(e,t),Ro!==null&&Ro(e,t)};var ei=I(null);function zl(){var e=ei.current;return e!==null?e:Fe.pooledCache}function ha(e,t){t===null?F(ei,ei.current):F(ei,t.pool)}function Co(){var e=zl();return e===null?null:{parent:$e._currentValue,pool:e}}var Wa=Error(b(460)),_o=Error(b(474)),ks=Error(b(542)),Hl={then:function(){}};function Eo(e){return e=e.status,e==="fulfilled"||e==="rejected"}function $a(){}function Mo(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then($a,$a),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,No(e),e;default:if(typeof t.status=="string")t.then($a,$a);else{if(e=Fe,e!==null&&100<e.shellSuspendCounter)throw Error(b(482));e=t,e.status="pending",e.then(function(s){if(t.status==="pending"){var r=t;r.status="fulfilled",r.value=s}},function(s){if(t.status==="pending"){var r=t;r.status="rejected",r.reason=s}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,No(e),e}throw Fa=t,Wa}}var Fa=null;function wo(){if(Fa===null)throw Error(b(459));var e=Fa;return Fa=null,e}function No(e){if(e===Wa||e===ks)throw Error(b(483))}var qn=!1;function Ls(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Vl(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ti(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ni(e,t,n){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,(Pe&2)!==0){var r=s.pending;return r===null?t.next=t:(t.next=r.next,r.next=t),s.pending=t,t=$n(e),Ns(e,null,n),t}return Mn(e,s,t,n),$n(e)}function es(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,Zt(e,n)}}function Il(e,t){var n=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,c=null;if(n=n.firstBaseUpdate,n!==null){do{var d={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};c===null?r=c=d:c=c.next=d,n=n.next}while(n!==null);c===null?r=c=t:c=c.next=t}else r=c=t;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:c,shared:s.shared,callbacks:s.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Yl=!1;function ts(){if(Yl){var e=fa;if(e!==null)throw e}}function ns(e,t,n,s){Yl=!1;var r=e.updateQueue;qn=!1;var c=r.firstBaseUpdate,d=r.lastBaseUpdate,g=r.shared.pending;if(g!==null){r.shared.pending=null;var y=g,M=y.next;y.next=null,d===null?c=M:d.next=M,d=y;var k=e.alternate;k!==null&&(k=k.updateQueue,g=k.lastBaseUpdate,g!==d&&(g===null?k.firstBaseUpdate=M:g.next=M,k.lastBaseUpdate=y))}if(c!==null){var z=r.baseState;d=0,k=M=y=null,g=c;do{var w=g.lane&-536870913,N=w!==g.lane;if(N?(Be&w)===w:(s&w)===w){w!==0&&w===ua&&(Yl=!0),k!==null&&(k=k.next={lane:0,tag:g.tag,payload:g.payload,callback:null,next:null});e:{var Ee=e,Ae=g;w=t;var Je=n;switch(Ae.tag){case 1:if(Ee=Ae.payload,typeof Ee=="function"){z=Ee.call(Je,z,w);break e}z=Ee;break e;case 3:Ee.flags=Ee.flags&-65537|128;case 0:if(Ee=Ae.payload,w=typeof Ee=="function"?Ee.call(Je,z,w):Ee,w==null)break e;z=Q({},z,w);break e;case 2:qn=!0}}w=g.callback,w!==null&&(e.flags|=64,N&&(e.flags|=8192),N=r.callbacks,N===null?r.callbacks=[w]:N.push(w))}else N={lane:w,tag:g.tag,payload:g.payload,callback:g.callback,next:null},k===null?(M=k=N,y=z):k=k.next=N,d|=w;if(g=g.next,g===null){if(g=r.shared.pending,g===null)break;N=g,g=N.next,N.next=null,r.lastBaseUpdate=N,r.shared.pending=null}}while(!0);k===null&&(y=z),r.baseState=y,r.firstBaseUpdate=M,r.lastBaseUpdate=k,c===null&&(r.shared.lanes=0),Oa|=d,e.lanes=d,e.memoizedState=z}}function da(e,t){if(typeof e!="function")throw Error(b(191,e));e.call(t)}function Pl(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)da(n[e],t)}var ii=I(null),js=I(0);function Bs(e,t){e=Li,F(js,e),F(ii,t),Li=e|t.baseLanes}function qs(){F(js,Li),F(ii,ii.current)}function Ql(){Li=js.current,W(ii),W(js)}var ai=0,we=null,Ve=null,ft=null,Gs=!1,Ei=!1,rn=!1,si=0,Mi=0,ga=null,Ic=0;function rt(){throw Error(b(321))}function Xl(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Yt(e[n],t[n]))return!1;return!0}function Zl(e,t,n,s,r,c){return ai=c,we=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,D.H=e===null||e.memoizedState===null?qf:Gf,rn=!1,c=n(s,r),rn=!1,Ei&&(c=xo(t,n,s,r)),Kl(e),c}function Kl(e){D.H=Lo;var t=Ve!==null&&Ve.next!==null;if(ai=0,ft=Ve=we=null,Gs=!1,Mi=0,ga=null,t)throw Error(b(300));e===null||Nt||(e=e.dependencies,e!==null&&Za(e)&&(Nt=!0))}function xo(e,t,n,s){we=e;var r=0;do{if(Ei&&(ga=null),Mi=0,Ei=!1,25<=r)throw Error(b(301));if(r+=1,ft=Ve=null,e.updateQueue!=null){var c=e.updateQueue;c.lastEffect=null,c.events=null,c.stores=null,c.memoCache!=null&&(c.memoCache.index=0)}D.H=ig,c=t(n,s)}while(Ei);return c}function Yc(){var e=D.H,t=e.useState()[0];return t=typeof t.then=="function"?m(t):t,e=e.useState()[0],(Ve!==null?Ve.memoizedState:null)!==e&&(we.flags|=1024),t}function i(){var e=si!==0;return si=0,e}function a(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function l(e){if(Gs){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Gs=!1}ai=0,ft=Ve=we=null,Ei=!1,Mi=si=0,ga=null}function o(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ft===null?we.memoizedState=ft=e:ft=ft.next=e,ft}function u(){if(Ve===null){var e=we.alternate;e=e!==null?e.memoizedState:null}else e=Ve.next;var t=ft===null?we.memoizedState:ft.next;if(t!==null)ft=t,Ve=e;else{if(e===null)throw we.alternate===null?Error(b(467)):Error(b(310));Ve=e,e={memoizedState:Ve.memoizedState,baseState:Ve.baseState,baseQueue:Ve.baseQueue,queue:Ve.queue,next:null},ft===null?we.memoizedState=ft=e:ft=ft.next=e}return ft}function f(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function m(e){var t=Mi;return Mi+=1,ga===null&&(ga=[]),e=Mo(ga,e,t),t=we,(ft===null?t.memoizedState:ft.next)===null&&(t=t.alternate,D.H=t===null||t.memoizedState===null?qf:Gf),e}function p(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return m(e);if(e.$$typeof===se)return Rt(e)}throw Error(b(438,String(e)))}function _(e){var t=null,n=we.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var s=we.alternate;s!==null&&(s=s.updateQueue,s!==null&&(s=s.memoCache,s!=null&&(t={data:s.data.map(function(r){return r.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=f(),we.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),s=0;s<e;s++)n[s]=Hn;return t.index++,n}function O(e,t){return typeof t=="function"?t(e):t}function L(e){var t=u();return j(t,Ve,e)}function j(e,t,n){var s=e.queue;if(s===null)throw Error(b(311));s.lastRenderedReducer=n;var r=e.baseQueue,c=s.pending;if(c!==null){if(r!==null){var d=r.next;r.next=c.next,c.next=d}t.baseQueue=r=c,s.pending=null}if(c=e.baseState,r===null)e.memoizedState=c;else{t=r.next;var g=d=null,y=null,M=t,k=!1;do{var z=M.lane&-536870913;if(z!==M.lane?(Be&z)===z:(ai&z)===z){var w=M.revertLane;if(w===0)y!==null&&(y=y.next={lane:0,revertLane:0,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null}),z===ua&&(k=!0);else if((ai&w)===w){M=M.next,w===ua&&(k=!0);continue}else z={lane:0,revertLane:M.revertLane,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null},y===null?(g=y=z,d=c):y=y.next=z,we.lanes|=w,Oa|=w;z=M.action,rn&&n(c,z),c=M.hasEagerState?M.eagerState:n(c,z)}else w={lane:z,revertLane:M.revertLane,action:M.action,hasEagerState:M.hasEagerState,eagerState:M.eagerState,next:null},y===null?(g=y=w,d=c):y=y.next=w,we.lanes|=z,Oa|=z;M=M.next}while(M!==null&&M!==t);if(y===null?d=c:y.next=g,!Yt(c,e.memoizedState)&&(Nt=!0,k&&(n=fa,n!==null)))throw n;e.memoizedState=c,e.baseState=d,e.baseQueue=y,s.lastRenderedState=c}return r===null&&(s.lanes=0),[e.memoizedState,s.dispatch]}function K(e){var t=u(),n=t.queue;if(n===null)throw Error(b(311));n.lastRenderedReducer=e;var s=n.dispatch,r=n.pending,c=t.memoizedState;if(r!==null){n.pending=null;var d=r=r.next;do c=e(c,d.action),d=d.next;while(d!==r);Yt(c,t.memoizedState)||(Nt=!0),t.memoizedState=c,t.baseQueue===null&&(t.baseState=c),n.lastRenderedState=c}return[c,s]}function B(e,t,n){var s=we,r=u(),c=Me;if(c){if(n===void 0)throw Error(b(407));n=n()}else n=t();var d=!Yt((Ve||r).memoizedState,n);d&&(r.memoizedState=n,Nt=!0),r=r.queue;var g=Se.bind(null,s,r,e);if(Jl(2048,8,g,[e]),r.getSnapshot!==t||d||ft!==null&&ft.memoizedState.tag&1){if(s.flags|=2048,zs(9,Uo(),ae.bind(null,s,r,n,t),null),Fe===null)throw Error(b(349));c||(ai&124)!==0||ie(s,t,n)}return n}function ie(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=we.updateQueue,t===null?(t=f(),we.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function ae(e,t,n,s){t.value=n,t.getSnapshot=s,je(t)&&He(e)}function Se(e,t,n){return n(function(){je(t)&&He(e)})}function je(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Yt(e,n)}catch{return!0}}function He(e){var t=ia(e,2);t!==null&&hn(t,e,2)}function Ie(e){var t=o();if(typeof e=="function"){var n=e;if(e=n(),rn){ut(!0);try{n()}finally{ut(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:O,lastRenderedState:e},t}function _e(e,t,n,s){return e.baseState=n,j(e,Ve,typeof s=="function"?s:O)}function Qt(e,t,n,s,r){if(ko(e))throw Error(b(485));if(e=t.action,e!==null){var c={payload:r,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(d){c.listeners.push(d)}};D.T!==null?n(!0):c.isTransition=!1,s(c),n=t.pending,n===null?(c.next=t.pending=c,Ct(t,c)):(c.next=n.next,t.pending=n.next=c)}}function Ct(e,t){var n=t.action,s=t.payload,r=e.state;if(t.isTransition){var c=D.T,d={};D.T=d;try{var g=n(r,s),y=D.S;y!==null&&y(d,g),ma(e,t,g)}catch(M){is(e,t,M)}finally{D.T=c}}else try{c=n(r,s),ma(e,t,c)}catch(M){is(e,t,M)}}function ma(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(s){wi(e,t,s)},function(s){return is(e,t,s)}):wi(e,t,n)}function wi(e,t,n){t.status="fulfilled",t.value=n,gf(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,Ct(e,n)))}function is(e,t,n){var s=e.pending;if(e.pending=null,s!==null){s=s.next;do t.status="rejected",t.reason=n,gf(t),t=t.next;while(t!==s)}e.action=null}function gf(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function mf(e,t){return t}function pf(e,t){if(Me){var n=Fe.formState;if(n!==null){e:{var s=we;if(Me){if(at){t:{for(var r=at,c=tn;r.nodeType!==8;){if(!c){r=null;break t}if(r=zn(r.nextSibling),r===null){r=null;break t}}c=r.data,r=c==="F!"||c==="F"?r:null}if(r){at=zn(r.nextSibling),s=r.data==="F!";break e}}kn(s)}s=!1}s&&(t=n[0])}}return n=o(),n.memoizedState=n.baseState=t,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mf,lastRenderedState:t},n.queue=s,n=Lf.bind(null,we,s),s.dispatch=n,s=Ie(!1),c=Kc.bind(null,we,!1,s.queue),s=o(),r={state:t,dispatch:null,action:e,pending:null},s.queue=r,n=Qt.bind(null,we,r,c,n),r.dispatch=n,s.memoizedState=e,[t,n,!1]}function yf(e){var t=u();return vf(t,Ve,e)}function vf(e,t,n){if(t=j(e,t,mf)[0],e=L(O)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var s=m(t)}catch(d){throw d===Wa?ks:d}else s=t;t=u();var r=t.queue,c=r.dispatch;return n!==t.memoizedState&&(we.flags|=2048,zs(9,Uo(),Fd.bind(null,r,n),null)),[s,c,e]}function Fd(e,t){e.action=t}function bf(e){var t=u(),n=Ve;if(n!==null)return vf(t,n,e);u(),t=t.memoizedState,n=u();var s=n.queue.dispatch;return n.memoizedState=e,[t,s,!1]}function zs(e,t,n,s){return e={tag:e,create:n,deps:s,inst:t,next:null},t=we.updateQueue,t===null&&(t=f(),we.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e),e}function Uo(){return{destroy:void 0,resource:void 0}}function Sf(){return u().memoizedState}function Do(e,t,n,s){var r=o();s=s===void 0?null:s,we.flags|=e,r.memoizedState=zs(1|t,Uo(),n,s)}function Jl(e,t,n,s){var r=u();s=s===void 0?null:s;var c=r.memoizedState.inst;Ve!==null&&s!==null&&Xl(s,Ve.memoizedState.deps)?r.memoizedState=zs(t,c,n,s):(we.flags|=e,r.memoizedState=zs(1|t,c,n,s))}function Af(e,t){Do(8390656,8,e,t)}function Of(e,t){Jl(2048,8,e,t)}function Tf(e,t){return Jl(4,2,e,t)}function Rf(e,t){return Jl(4,4,e,t)}function Cf(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function _f(e,t,n){n=n!=null?n.concat([e]):null,Jl(4,4,Cf.bind(null,t,e),n)}function Pc(){}function Ef(e,t){var n=u();t=t===void 0?null:t;var s=n.memoizedState;return t!==null&&Xl(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function Mf(e,t){var n=u();t=t===void 0?null:t;var s=n.memoizedState;if(t!==null&&Xl(t,s[1]))return s[0];if(s=e(),rn){ut(!0);try{e()}finally{ut(!1)}}return n.memoizedState=[s,t],s}function Qc(e,t,n){return n===void 0||(ai&1073741824)!==0?e.memoizedState=t:(e.memoizedState=n,e=xh(),we.lanes|=e,Oa|=e,n)}function wf(e,t,n,s){return Yt(n,t)?n:ii.current!==null?(e=Qc(e,n,s),Yt(e,t)||(Nt=!0),e):(ai&42)===0?(Nt=!0,e.memoizedState=n):(e=xh(),we.lanes|=e,Oa|=e,t)}function Nf(e,t,n,s,r){var c=G.p;G.p=c!==0&&8>c?c:8;var d=D.T,g={};D.T=g,Kc(e,!1,t,n);try{var y=r(),M=D.S;if(M!==null&&M(g,y),y!==null&&typeof y=="object"&&typeof y.then=="function"){var k=Vc(y,s);Wl(e,t,k,fn(e))}else Wl(e,t,s,fn(e))}catch(z){Wl(e,t,{then:function(){},status:"rejected",reason:z},fn())}finally{G.p=c,D.T=d}}function eg(){}function Xc(e,t,n,s){if(e.tag!==5)throw Error(b(476));var r=xf(e).queue;Nf(e,r,t,me,n===null?eg:function(){return Uf(e),n(s)})}function xf(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:me,baseState:me,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:O,lastRenderedState:me},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:O,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function Uf(e){var t=xf(e).next.queue;Wl(e,t,{},fn())}function Zc(){return Rt(mr)}function Df(){return u().memoizedState}function kf(){return u().memoizedState}function tg(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=fn();e=ti(n);var s=ni(t,e,n);s!==null&&(hn(s,t,n),es(s,t,n)),t={cache:Fn()},e.payload=t;return}t=t.return}}function ng(e,t,n){var s=fn();n={lane:s,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},ko(e)?jf(t,n):(n=Mt(e,t,n,s),n!==null&&(hn(n,e,s),Bf(n,t,s)))}function Lf(e,t,n){var s=fn();Wl(e,t,n,s)}function Wl(e,t,n,s){var r={lane:s,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(ko(e))jf(t,r);else{var c=e.alternate;if(e.lanes===0&&(c===null||c.lanes===0)&&(c=t.lastRenderedReducer,c!==null))try{var d=t.lastRenderedState,g=c(d,n);if(r.hasEagerState=!0,r.eagerState=g,Yt(g,d))return Mn(e,t,r,0),Fe===null&&ws(),!1}catch{}finally{}if(n=Mt(e,t,r,s),n!==null)return hn(n,e,s),Bf(n,t,s),!0}return!1}function Kc(e,t,n,s){if(s={lane:2,revertLane:Eu(),action:s,hasEagerState:!1,eagerState:null,next:null},ko(e)){if(t)throw Error(b(479))}else t=Mt(e,n,s,2),t!==null&&hn(t,e,2)}function ko(e){var t=e.alternate;return e===we||t!==null&&t===we}function jf(e,t){Ei=Gs=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Bf(e,t,n){if((n&4194048)!==0){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,Zt(e,n)}}var Lo={readContext:Rt,use:p,useCallback:rt,useContext:rt,useEffect:rt,useImperativeHandle:rt,useLayoutEffect:rt,useInsertionEffect:rt,useMemo:rt,useReducer:rt,useRef:rt,useState:rt,useDebugValue:rt,useDeferredValue:rt,useTransition:rt,useSyncExternalStore:rt,useId:rt,useHostTransitionStatus:rt,useFormState:rt,useActionState:rt,useOptimistic:rt,useMemoCache:rt,useCacheRefresh:rt},qf={readContext:Rt,use:p,useCallback:function(e,t){return o().memoizedState=[e,t===void 0?null:t],e},useContext:Rt,useEffect:Af,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,Do(4194308,4,Cf.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Do(4194308,4,e,t)},useInsertionEffect:function(e,t){Do(4,2,e,t)},useMemo:function(e,t){var n=o();t=t===void 0?null:t;var s=e();if(rn){ut(!0);try{e()}finally{ut(!1)}}return n.memoizedState=[s,t],s},useReducer:function(e,t,n){var s=o();if(n!==void 0){var r=n(t);if(rn){ut(!0);try{n(t)}finally{ut(!1)}}}else r=t;return s.memoizedState=s.baseState=r,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},s.queue=e,e=e.dispatch=ng.bind(null,we,e),[s.memoizedState,e]},useRef:function(e){var t=o();return e={current:e},t.memoizedState=e},useState:function(e){e=Ie(e);var t=e.queue,n=Lf.bind(null,we,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Pc,useDeferredValue:function(e,t){var n=o();return Qc(n,e,t)},useTransition:function(){var e=Ie(!1);return e=Nf.bind(null,we,e.queue,!0,!1),o().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var s=we,r=o();if(Me){if(n===void 0)throw Error(b(407));n=n()}else{if(n=t(),Fe===null)throw Error(b(349));(Be&124)!==0||ie(s,t,n)}r.memoizedState=n;var c={value:n,getSnapshot:t};return r.queue=c,Af(Se.bind(null,s,c,e),[e]),s.flags|=2048,zs(9,Uo(),ae.bind(null,s,c,n,t),null),n},useId:function(){var e=o(),t=Fe.identifierPrefix;if(Me){var n=Un,s=xn;n=(s&~(1<<32-et(s)-1)).toString(32)+n,t="«"+t+"R"+n,n=si++,0<n&&(t+="H"+n.toString(32)),t+="»"}else n=Ic++,t="«"+t+"r"+n.toString(32)+"»";return e.memoizedState=t},useHostTransitionStatus:Zc,useFormState:pf,useActionState:pf,useOptimistic:function(e){var t=o();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Kc.bind(null,we,!0,n),n.dispatch=t,[e,t]},useMemoCache:_,useCacheRefresh:function(){return o().memoizedState=tg.bind(null,we)}},Gf={readContext:Rt,use:p,useCallback:Ef,useContext:Rt,useEffect:Of,useImperativeHandle:_f,useInsertionEffect:Tf,useLayoutEffect:Rf,useMemo:Mf,useReducer:L,useRef:Sf,useState:function(){return L(O)},useDebugValue:Pc,useDeferredValue:function(e,t){var n=u();return wf(n,Ve.memoizedState,e,t)},useTransition:function(){var e=L(O)[0],t=u().memoizedState;return[typeof e=="boolean"?e:m(e),t]},useSyncExternalStore:B,useId:Df,useHostTransitionStatus:Zc,useFormState:yf,useActionState:yf,useOptimistic:function(e,t){var n=u();return _e(n,Ve,e,t)},useMemoCache:_,useCacheRefresh:kf},ig={readContext:Rt,use:p,useCallback:Ef,useContext:Rt,useEffect:Of,useImperativeHandle:_f,useInsertionEffect:Tf,useLayoutEffect:Rf,useMemo:Mf,useReducer:K,useRef:Sf,useState:function(){return K(O)},useDebugValue:Pc,useDeferredValue:function(e,t){var n=u();return Ve===null?Qc(n,e,t):wf(n,Ve.memoizedState,e,t)},useTransition:function(){var e=K(O)[0],t=u().memoizedState;return[typeof e=="boolean"?e:m(e),t]},useSyncExternalStore:B,useId:Df,useHostTransitionStatus:Zc,useFormState:bf,useActionState:bf,useOptimistic:function(e,t){var n=u();return Ve!==null?_e(n,Ve,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:_,useCacheRefresh:kf},Hs=null,$l=0;function jo(e){var t=$l;return $l+=1,Hs===null&&(Hs=[]),Mo(Hs,e,t)}function Fl(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Bo(e,t){throw t.$$typeof===he?Error(b(525)):(e=Object.prototype.toString.call(t),Error(b(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function zf(e){var t=e._init;return t(e._payload)}function Hf(e){function t(T,A){if(e){var C=T.deletions;C===null?(T.deletions=[A],T.flags|=16):C.push(A)}}function n(T,A){if(!e)return null;for(;A!==null;)t(T,A),A=A.sibling;return null}function s(T){for(var A=new Map;T!==null;)T.key!==null?A.set(T.key,T):A.set(T.index,T),T=T.sibling;return A}function r(T,A){return T=wn(T,A),T.index=0,T.sibling=null,T}function c(T,A,C){return T.index=C,e?(C=T.alternate,C!==null?(C=C.index,C<A?(T.flags|=67108866,A):C):(T.flags|=67108866,A)):(T.flags|=1048576,A)}function d(T){return e&&T.alternate===null&&(T.flags|=67108866),T}function g(T,A,C,q){return A===null||A.tag!==6?(A=Dl(C,T.mode,q),A.return=T,A):(A=r(A,C),A.return=T,A)}function y(T,A,C,q){var oe=C.type;return oe===ye?k(T,A,C.props.children,q,C.key):A!==null&&(A.elementType===oe||typeof oe=="object"&&oe!==null&&oe.$$typeof===Ot&&zf(oe)===A.type)?(A=r(A,C.props),Fl(A,C),A.return=T,A):(A=Pa(C.type,C.key,C.props,null,T.mode,q),Fl(A,C),A.return=T,A)}function M(T,A,C,q){return A===null||A.tag!==4||A.stateNode.containerInfo!==C.containerInfo||A.stateNode.implementation!==C.implementation?(A=xs(C,T.mode,q),A.return=T,A):(A=r(A,C.children||[]),A.return=T,A)}function k(T,A,C,q,oe){return A===null||A.tag!==7?(A=Ti(C,T.mode,q,oe),A.return=T,A):(A=r(A,C),A.return=T,A)}function z(T,A,C){if(typeof A=="string"&&A!==""||typeof A=="number"||typeof A=="bigint")return A=Dl(""+A,T.mode,C),A.return=T,A;if(typeof A=="object"&&A!==null){switch(A.$$typeof){case le:return C=Pa(A.type,A.key,A.props,null,T.mode,C),Fl(C,A),C.return=T,C;case H:return A=xs(A,T.mode,C),A.return=T,A;case Ot:var q=A._init;return A=q(A._payload),z(T,A,C)}if(Le(A)||qe(A))return A=Ti(A,T.mode,C,null),A.return=T,A;if(typeof A.then=="function")return z(T,jo(A),C);if(A.$$typeof===se)return z(T,nn(T,A),C);Bo(T,A)}return null}function w(T,A,C,q){var oe=A!==null?A.key:null;if(typeof C=="string"&&C!==""||typeof C=="number"||typeof C=="bigint")return oe!==null?null:g(T,A,""+C,q);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case le:return C.key===oe?y(T,A,C,q):null;case H:return C.key===oe?M(T,A,C,q):null;case Ot:return oe=C._init,C=oe(C._payload),w(T,A,C,q)}if(Le(C)||qe(C))return oe!==null?null:k(T,A,C,q,null);if(typeof C.then=="function")return w(T,A,jo(C),q);if(C.$$typeof===se)return w(T,A,nn(T,C),q);Bo(T,C)}return null}function N(T,A,C,q,oe){if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return T=T.get(C)||null,g(A,T,""+q,oe);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case le:return T=T.get(q.key===null?C:q.key)||null,y(A,T,q,oe);case H:return T=T.get(q.key===null?C:q.key)||null,M(A,T,q,oe);case Ot:var xe=q._init;return q=xe(q._payload),N(T,A,C,q,oe)}if(Le(q)||qe(q))return T=T.get(C)||null,k(A,T,q,oe,null);if(typeof q.then=="function")return N(T,A,C,jo(q),oe);if(q.$$typeof===se)return N(T,A,C,nn(A,q),oe);Bo(A,q)}return null}function Ee(T,A,C,q){for(var oe=null,xe=null,pe=A,Re=A=0,Ut=null;pe!==null&&Re<C.length;Re++){pe.index>Re?(Ut=pe,pe=null):Ut=pe.sibling;var ze=w(T,pe,C[Re],q);if(ze===null){pe===null&&(pe=Ut);break}e&&pe&&ze.alternate===null&&t(T,pe),A=c(ze,A,Re),xe===null?oe=ze:xe.sibling=ze,xe=ze,pe=Ut}if(Re===C.length)return n(T,pe),Me&&Ri(T,Re),oe;if(pe===null){for(;Re<C.length;Re++)pe=z(T,C[Re],q),pe!==null&&(A=c(pe,A,Re),xe===null?oe=pe:xe.sibling=pe,xe=pe);return Me&&Ri(T,Re),oe}for(pe=s(pe);Re<C.length;Re++)Ut=N(pe,T,Re,C[Re],q),Ut!==null&&(e&&Ut.alternate!==null&&pe.delete(Ut.key===null?Re:Ut.key),A=c(Ut,A,Re),xe===null?oe=Ut:xe.sibling=Ut,xe=Ut);return e&&pe.forEach(function(xa){return t(T,xa)}),Me&&Ri(T,Re),oe}function Ae(T,A,C,q){if(C==null)throw Error(b(151));for(var oe=null,xe=null,pe=A,Re=A=0,Ut=null,ze=C.next();pe!==null&&!ze.done;Re++,ze=C.next()){pe.index>Re?(Ut=pe,pe=null):Ut=pe.sibling;var xa=w(T,pe,ze.value,q);if(xa===null){pe===null&&(pe=Ut);break}e&&pe&&xa.alternate===null&&t(T,pe),A=c(xa,A,Re),xe===null?oe=xa:xe.sibling=xa,xe=xa,pe=Ut}if(ze.done)return n(T,pe),Me&&Ri(T,Re),oe;if(pe===null){for(;!ze.done;Re++,ze=C.next())ze=z(T,ze.value,q),ze!==null&&(A=c(ze,A,Re),xe===null?oe=ze:xe.sibling=ze,xe=ze);return Me&&Ri(T,Re),oe}for(pe=s(pe);!ze.done;Re++,ze=C.next())ze=N(pe,T,Re,ze.value,q),ze!==null&&(e&&ze.alternate!==null&&pe.delete(ze.key===null?Re:ze.key),A=c(ze,A,Re),xe===null?oe=ze:xe.sibling=ze,xe=ze);return e&&pe.forEach(function(am){return t(T,am)}),Me&&Ri(T,Re),oe}function Je(T,A,C,q){if(typeof C=="object"&&C!==null&&C.type===ye&&C.key===null&&(C=C.props.children),typeof C=="object"&&C!==null){switch(C.$$typeof){case le:e:{for(var oe=C.key;A!==null;){if(A.key===oe){if(oe=C.type,oe===ye){if(A.tag===7){n(T,A.sibling),q=r(A,C.props.children),q.return=T,T=q;break e}}else if(A.elementType===oe||typeof oe=="object"&&oe!==null&&oe.$$typeof===Ot&&zf(oe)===A.type){n(T,A.sibling),q=r(A,C.props),Fl(q,C),q.return=T,T=q;break e}n(T,A);break}else t(T,A);A=A.sibling}C.type===ye?(q=Ti(C.props.children,T.mode,q,C.key),q.return=T,T=q):(q=Pa(C.type,C.key,C.props,null,T.mode,q),Fl(q,C),q.return=T,T=q)}return d(T);case H:e:{for(oe=C.key;A!==null;){if(A.key===oe)if(A.tag===4&&A.stateNode.containerInfo===C.containerInfo&&A.stateNode.implementation===C.implementation){n(T,A.sibling),q=r(A,C.children||[]),q.return=T,T=q;break e}else{n(T,A);break}else t(T,A);A=A.sibling}q=xs(C,T.mode,q),q.return=T,T=q}return d(T);case Ot:return oe=C._init,C=oe(C._payload),Je(T,A,C,q)}if(Le(C))return Ee(T,A,C,q);if(qe(C)){if(oe=qe(C),typeof oe!="function")throw Error(b(150));return C=oe.call(C),Ae(T,A,C,q)}if(typeof C.then=="function")return Je(T,A,jo(C),q);if(C.$$typeof===se)return Je(T,A,nn(T,C),q);Bo(T,C)}return typeof C=="string"&&C!==""||typeof C=="number"||typeof C=="bigint"?(C=""+C,A!==null&&A.tag===6?(n(T,A.sibling),q=r(A,C),q.return=T,T=q):(n(T,A),q=Dl(C,T.mode,q),q.return=T,T=q),d(T)):n(T,A)}return function(T,A,C,q){try{$l=0;var oe=Je(T,A,C,q);return Hs=null,oe}catch(pe){if(pe===Wa||pe===ks)throw pe;var xe=Pt(29,pe,null,T.mode);return xe.lanes=q,xe.return=T,xe}finally{}}}var Vs=Hf(!0),Vf=Hf(!1),bn=I(null),li=null;function pa(e){var t=e.alternate;F(_t,_t.current&1),F(bn,e),li===null&&(t===null||ii.current!==null||t.memoizedState!==null)&&(li=e)}function If(e){if(e.tag===22){if(F(_t,_t.current),F(bn,e),li===null){var t=e.alternate;t!==null&&t.memoizedState!==null&&(li=e)}}else ya()}function ya(){F(_t,_t.current),F(bn,bn.current)}function Ni(e){W(bn),li===e&&(li=null),W(_t)}var _t=I(0);function qo(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||Gu(n)))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function Jc(e,t,n,s){t=e.memoizedState,n=n(s,t),n=n==null?t:Q({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Wc={enqueueSetState:function(e,t,n){e=e._reactInternals;var s=fn(),r=ti(s);r.payload=t,n!=null&&(r.callback=n),t=ni(e,r,s),t!==null&&(hn(t,e,s),es(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=fn(),r=ti(s);r.tag=1,r.payload=t,n!=null&&(r.callback=n),t=ni(e,r,s),t!==null&&(hn(t,e,s),es(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=fn(),s=ti(n);s.tag=2,t!=null&&(s.callback=t),t=ni(e,s,n),t!==null&&(hn(t,e,n),es(t,e,n))}};function Yf(e,t,n,s,r,c,d){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,c,d):t.prototype&&t.prototype.isPureReactComponent?!Kn(n,s)||!Kn(r,c):!0}function Pf(e,t,n,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&Wc.enqueueReplaceState(t,t.state,null)}function as(e,t){var n=t;if("ref"in t){n={};for(var s in t)s!=="ref"&&(n[s]=t[s])}if(e=e.defaultProps){n===t&&(n=Q({},n));for(var r in e)n[r]===void 0&&(n[r]=e[r])}return n}var Go=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function Qf(e){Go(e)}function Xf(e){console.error(e)}function Zf(e){Go(e)}function zo(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(s){setTimeout(function(){throw s})}}function Kf(e,t,n){try{var s=e.onCaughtError;s(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function $c(e,t,n){return n=ti(n),n.tag=3,n.payload={element:null},n.callback=function(){zo(e,t)},n}function Jf(e){return e=ti(e),e.tag=3,e}function Wf(e,t,n,s){var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var c=s.value;e.payload=function(){return r(c)},e.callback=function(){Kf(t,n,s)}}var d=n.stateNode;d!==null&&typeof d.componentDidCatch=="function"&&(e.callback=function(){Kf(t,n,s),typeof r!="function"&&(Ta===null?Ta=new Set([this]):Ta.add(this));var g=s.stack;this.componentDidCatch(s.value,{componentStack:g!==null?g:""})})}function ag(e,t,n,s,r){if(n.flags|=32768,s!==null&&typeof s=="object"&&typeof s.then=="function"){if(t=n.alternate,t!==null&&Xa(t,n,r,!0),n=bn.current,n!==null){switch(n.tag){case 13:return li===null?Ou():n.alternate===null&&ht===0&&(ht=3),n.flags&=-257,n.flags|=65536,n.lanes=r,s===Hl?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([s]):t.add(s),Ru(e,s,r)),!1;case 22:return n.flags|=65536,s===Hl?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([s])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([s]):n.add(s)),Ru(e,s,r)),!1}throw Error(b(435,n.tag))}return Ru(e,s,r),Ou(),!1}if(Me)return t=bn.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=r,s!==Ci&&(e=Error(b(422),{cause:s}),jn(Ft(e,n)))):(s!==Ci&&(t=Error(b(423),{cause:s}),jn(Ft(t,n))),e=e.current.alternate,e.flags|=65536,r&=-r,e.lanes|=r,s=Ft(s,n),r=$c(e.stateNode,s,r),Il(e,r),ht!==4&&(ht=2)),!1;var c=Error(b(520),{cause:s});if(c=Ft(c,n),lr===null?lr=[c]:lr.push(c),ht!==4&&(ht=2),t===null)return!0;s=Ft(s,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=r&-r,n.lanes|=e,e=$c(n.stateNode,s,e),Il(n,e),!1;case 1:if(t=n.type,c=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||c!==null&&typeof c.componentDidCatch=="function"&&(Ta===null||!Ta.has(c))))return n.flags|=65536,r&=-r,n.lanes|=r,r=Jf(r),Wf(r,e,n,s),Il(n,r),!1}n=n.return}while(n!==null);return!1}var $f=Error(b(461)),Nt=!1;function jt(e,t,n,s){t.child=e===null?Vf(t,null,n,s):Vs(t,e.child,n,s)}function Ff(e,t,n,s,r){n=n.render;var c=t.ref;if("ref"in s){var d={};for(var g in s)g!=="ref"&&(d[g]=s[g])}else d=s;return _i(t),s=Zl(e,t,n,d,c,r),g=i(),e!==null&&!Nt?(a(e,t,r),xi(e,t,r)):(Me&&g&&kl(t),t.flags|=1,jt(e,t,s,r),t.child)}function eh(e,t,n,s,r){if(e===null){var c=n.type;return typeof c=="function"&&!Ya(c)&&c.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=c,th(e,t,c,s,r)):(e=Pa(n.type,null,s,t,t.mode,r),e.ref=t.ref,e.return=t,t.child=e)}if(c=e.child,!lu(e,r)){var d=c.memoizedProps;if(n=n.compare,n=n!==null?n:Kn,n(d,s)&&e.ref===t.ref)return xi(e,t,r)}return t.flags|=1,e=wn(c,s),e.ref=t.ref,e.return=t,t.child=e}function th(e,t,n,s,r){if(e!==null){var c=e.memoizedProps;if(Kn(c,s)&&e.ref===t.ref)if(Nt=!1,t.pendingProps=s=c,lu(e,r))(e.flags&131072)!==0&&(Nt=!0);else return t.lanes=e.lanes,xi(e,t,r)}return Fc(e,t,n,s,r)}function nh(e,t,n){var s=t.pendingProps,r=s.children,c=e!==null?e.memoizedState:null;if(s.mode==="hidden"){if((t.flags&128)!==0){if(s=c!==null?c.baseLanes|n:n,e!==null){for(r=t.child=e.child,c=0;r!==null;)c=c|r.lanes|r.childLanes,r=r.sibling;t.childLanes=c&~s}else t.childLanes=0,t.child=null;return ih(e,t,s,n)}if((n&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&ha(t,c!==null?c.cachePool:null),c!==null?Bs(t,c):qs(),If(t);else return t.lanes=t.childLanes=536870912,ih(e,t,c!==null?c.baseLanes|n:n,n)}else c!==null?(ha(t,c.cachePool),Bs(t,c),ya(),t.memoizedState=null):(e!==null&&ha(t,null),qs(),ya());return jt(e,t,r,n),t.child}function ih(e,t,n,s){var r=zl();return r=r===null?null:{parent:$e._currentValue,pool:r},t.memoizedState={baseLanes:n,cachePool:r},e!==null&&ha(t,null),qs(),If(t),e!==null&&Xa(e,t,s,!0),null}function Ho(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(b(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function Fc(e,t,n,s,r){return _i(t),n=Zl(e,t,n,s,void 0,r),s=i(),e!==null&&!Nt?(a(e,t,r),xi(e,t,r)):(Me&&s&&kl(t),t.flags|=1,jt(e,t,n,r),t.child)}function ah(e,t,n,s,r,c){return _i(t),t.updateQueue=null,n=xo(t,s,n,r),Kl(e),s=i(),e!==null&&!Nt?(a(e,t,c),xi(e,t,c)):(Me&&s&&kl(t),t.flags|=1,jt(e,t,n,c),t.child)}function sh(e,t,n,s,r){if(_i(t),t.stateNode===null){var c=Oi,d=n.contextType;typeof d=="object"&&d!==null&&(c=Rt(d)),c=new n(s,c),t.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=Wc,t.stateNode=c,c._reactInternals=t,c=t.stateNode,c.props=s,c.state=t.memoizedState,c.refs={},Ls(t),d=n.contextType,c.context=typeof d=="object"&&d!==null?Rt(d):Oi,c.state=t.memoizedState,d=n.getDerivedStateFromProps,typeof d=="function"&&(Jc(t,n,d,s),c.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof c.getSnapshotBeforeUpdate=="function"||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(d=c.state,typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount(),d!==c.state&&Wc.enqueueReplaceState(c,c.state,null),ns(t,s,c,r),ts(),c.state=t.memoizedState),typeof c.componentDidMount=="function"&&(t.flags|=4194308),s=!0}else if(e===null){c=t.stateNode;var g=t.memoizedProps,y=as(n,g);c.props=y;var M=c.context,k=n.contextType;d=Oi,typeof k=="object"&&k!==null&&(d=Rt(k));var z=n.getDerivedStateFromProps;k=typeof z=="function"||typeof c.getSnapshotBeforeUpdate=="function",g=t.pendingProps!==g,k||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(g||M!==d)&&Pf(t,c,s,d),qn=!1;var w=t.memoizedState;c.state=w,ns(t,s,c,r),ts(),M=t.memoizedState,g||w!==M||qn?(typeof z=="function"&&(Jc(t,n,z,s),M=t.memoizedState),(y=qn||Yf(t,n,y,s,w,M,d))?(k||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount()),typeof c.componentDidMount=="function"&&(t.flags|=4194308)):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=M),c.props=s,c.state=M,c.context=d,s=y):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{c=t.stateNode,Vl(e,t),d=t.memoizedProps,k=as(n,d),c.props=k,z=t.pendingProps,w=c.context,M=n.contextType,y=Oi,typeof M=="object"&&M!==null&&(y=Rt(M)),g=n.getDerivedStateFromProps,(M=typeof g=="function"||typeof c.getSnapshotBeforeUpdate=="function")||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(d!==z||w!==y)&&Pf(t,c,s,y),qn=!1,w=t.memoizedState,c.state=w,ns(t,s,c,r),ts();var N=t.memoizedState;d!==z||w!==N||qn||e!==null&&e.dependencies!==null&&Za(e.dependencies)?(typeof g=="function"&&(Jc(t,n,g,s),N=t.memoizedState),(k=qn||Yf(t,n,k,s,w,N,y)||e!==null&&e.dependencies!==null&&Za(e.dependencies))?(M||typeof c.UNSAFE_componentWillUpdate!="function"&&typeof c.componentWillUpdate!="function"||(typeof c.componentWillUpdate=="function"&&c.componentWillUpdate(s,N,y),typeof c.UNSAFE_componentWillUpdate=="function"&&c.UNSAFE_componentWillUpdate(s,N,y)),typeof c.componentDidUpdate=="function"&&(t.flags|=4),typeof c.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof c.componentDidUpdate!="function"||d===e.memoizedProps&&w===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||d===e.memoizedProps&&w===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=N),c.props=s,c.state=N,c.context=y,s=k):(typeof c.componentDidUpdate!="function"||d===e.memoizedProps&&w===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||d===e.memoizedProps&&w===e.memoizedState||(t.flags|=1024),s=!1)}return c=s,Ho(e,t),s=(t.flags&128)!==0,c||s?(c=t.stateNode,n=s&&typeof n.getDerivedStateFromError!="function"?null:c.render(),t.flags|=1,e!==null&&s?(t.child=Vs(t,e.child,null,r),t.child=Vs(t,null,n,r)):jt(e,t,n,r),t.memoizedState=c.state,e=t.child):e=xi(e,t,r),e}function lh(e,t,n,s){return la(),t.flags|=256,jt(e,t,n,s),t.child}var eu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function tu(e){return{baseLanes:e,cachePool:Co()}}function nu(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=Sn),e}function rh(e,t,n){var s=t.pendingProps,r=!1,c=(t.flags&128)!==0,d;if((d=c)||(d=e!==null&&e.memoizedState===null?!1:(_t.current&2)!==0),d&&(r=!0,t.flags&=-129),d=(t.flags&32)!==0,t.flags&=-33,e===null){if(Me){if(r?pa(t):ya(),Me){var g=at,y;if(y=g){e:{for(y=g,g=tn;y.nodeType!==8;){if(!g){g=null;break e}if(y=zn(y.nextSibling),y===null){g=null;break e}}g=y}g!==null?(t.memoizedState={dehydrated:g,treeContext:Nn!==null?{id:xn,overflow:Un}:null,retryLane:536870912,hydrationErrors:null},y=Pt(18,null,null,0),y.stateNode=g,y.return=t,t.child=y,wt=t,at=null,y=!0):y=!1}y||kn(t)}if(g=t.memoizedState,g!==null&&(g=g.dehydrated,g!==null))return Gu(g)?t.lanes=32:t.lanes=536870912,null;Ni(t)}return g=s.children,s=s.fallback,r?(ya(),r=t.mode,g=Vo({mode:"hidden",children:g},r),s=Ti(s,r,n,null),g.return=t,s.return=t,g.sibling=s,t.child=g,r=t.child,r.memoizedState=tu(n),r.childLanes=nu(e,d,n),t.memoizedState=eu,s):(pa(t),iu(t,g))}if(y=e.memoizedState,y!==null&&(g=y.dehydrated,g!==null)){if(c)t.flags&256?(pa(t),t.flags&=-257,t=au(e,t,n)):t.memoizedState!==null?(ya(),t.child=e.child,t.flags|=128,t=null):(ya(),r=s.fallback,g=t.mode,s=Vo({mode:"visible",children:s.children},g),r=Ti(r,g,n,null),r.flags|=2,s.return=t,r.return=t,s.sibling=r,t.child=s,Vs(t,e.child,null,n),s=t.child,s.memoizedState=tu(n),s.childLanes=nu(e,d,n),t.memoizedState=eu,t=r);else if(pa(t),Gu(g)){if(d=g.nextSibling&&g.nextSibling.dataset,d)var M=d.dgst;d=M,s=Error(b(419)),s.stack="",s.digest=d,jn({value:s,source:null,stack:null}),t=au(e,t,n)}else if(Nt||Xa(e,t,n,!1),d=(n&e.childLanes)!==0,Nt||d){if(d=Fe,d!==null&&(s=n&-n,s=(s&42)!==0?1:rl(s),s=(s&(d.suspendedLanes|n))!==0?0:s,s!==0&&s!==y.retryLane))throw y.retryLane=s,ia(e,s),hn(d,e,s),$f;g.data==="$?"||Ou(),t=au(e,t,n)}else g.data==="$?"?(t.flags|=192,t.child=e.child,t=null):(e=y.treeContext,at=zn(g.nextSibling),wt=t,Me=!0,Dn=null,tn=!1,e!==null&&(Ht[en++]=xn,Ht[en++]=Un,Ht[en++]=Nn,xn=e.id,Un=e.overflow,Nn=t),t=iu(t,s.children),t.flags|=4096);return t}return r?(ya(),r=s.fallback,g=t.mode,y=e.child,M=y.sibling,s=wn(y,{mode:"hidden",children:s.children}),s.subtreeFlags=y.subtreeFlags&65011712,M!==null?r=wn(M,r):(r=Ti(r,g,n,null),r.flags|=2),r.return=t,s.return=t,s.sibling=r,t.child=s,s=r,r=t.child,g=e.child.memoizedState,g===null?g=tu(n):(y=g.cachePool,y!==null?(M=$e._currentValue,y=y.parent!==M?{parent:M,pool:M}:y):y=Co(),g={baseLanes:g.baseLanes|n,cachePool:y}),r.memoizedState=g,r.childLanes=nu(e,d,n),t.memoizedState=eu,s):(pa(t),n=e.child,e=n.sibling,n=wn(n,{mode:"visible",children:s.children}),n.return=t,n.sibling=null,e!==null&&(d=t.deletions,d===null?(t.deletions=[e],t.flags|=16):d.push(e)),t.child=n,t.memoizedState=null,n)}function iu(e,t){return t=Vo({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function Vo(e,t){return e=Pt(22,e,null,t),e.lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function au(e,t,n){return Vs(t,e.child,null,n),e=iu(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function oh(e,t,n){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),oa(e.return,t,n)}function su(e,t,n,s,r){var c=e.memoizedState;c===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(c.isBackwards=t,c.rendering=null,c.renderingStartTime=0,c.last=s,c.tail=n,c.tailMode=r)}function ch(e,t,n){var s=t.pendingProps,r=s.revealOrder,c=s.tail;if(jt(e,t,s.children,n),s=_t.current,(s&2)!==0)s=s&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&oh(e,n,t);else if(e.tag===19)oh(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}switch(F(_t,s),r){case"forwards":for(n=t.child,r=null;n!==null;)e=n.alternate,e!==null&&qo(e)===null&&(r=n),n=n.sibling;n=r,n===null?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),su(t,!1,r,n,c);break;case"backwards":for(n=null,r=t.child,t.child=null;r!==null;){if(e=r.alternate,e!==null&&qo(e)===null){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}su(t,!0,n,null,c);break;case"together":su(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function xi(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Oa|=t.lanes,(n&t.childLanes)===0)if(e!==null){if(Xa(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(b(153));if(t.child!==null){for(e=t.child,n=wn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=wn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function lu(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Za(e)))}function sg(e,t,n){switch(t.tag){case 3:Ye(t,t.stateNode.containerInfo),vn(t,$e,e.memoizedState.cache),la();break;case 27:case 5:Bi(t);break;case 4:Ye(t,t.stateNode.containerInfo);break;case 10:vn(t,t.type,t.memoizedProps.value);break;case 13:var s=t.memoizedState;if(s!==null)return s.dehydrated!==null?(pa(t),t.flags|=128,null):(n&t.child.childLanes)!==0?rh(e,t,n):(pa(t),e=xi(e,t,n),e!==null?e.sibling:null);pa(t);break;case 19:var r=(e.flags&128)!==0;if(s=(n&t.childLanes)!==0,s||(Xa(e,t,n,!1),s=(n&t.childLanes)!==0),r){if(s)return ch(e,t,n);t.flags|=128}if(r=t.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),F(_t,_t.current),s)break;return null;case 22:case 23:return t.lanes=0,nh(e,t,n);case 24:vn(t,$e,e.memoizedState.cache)}return xi(e,t,n)}function uh(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)Nt=!0;else{if(!lu(e,n)&&(t.flags&128)===0)return Nt=!1,sg(e,t,n);Nt=(e.flags&131072)!==0}else Nt=!1,Me&&(t.flags&1048576)!==0&&So(t,Ds,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var s=t.elementType,r=s._init;if(s=r(s._payload),t.type=s,typeof s=="function")Ya(s)?(e=as(s,e),t.tag=1,t=sh(null,t,s,e,n)):(t.tag=0,t=Fc(null,t,s,e,n));else{if(s!=null){if(r=s.$$typeof,r===R){t.tag=11,t=Ff(null,t,s,e,n);break e}else if(r===mt){t.tag=14,t=eh(null,t,s,e,n);break e}}throw t=U(s)||s,Error(b(306,t,""))}}return t;case 0:return Fc(e,t,t.type,t.pendingProps,n);case 1:return s=t.type,r=as(s,t.pendingProps),sh(e,t,s,r,n);case 3:e:{if(Ye(t,t.stateNode.containerInfo),e===null)throw Error(b(387));s=t.pendingProps;var c=t.memoizedState;r=c.element,Vl(e,t),ns(t,s,null,n);var d=t.memoizedState;if(s=d.cache,vn(t,$e,s),s!==c.cache&&ql(t,[$e],n,!0),ts(),s=d.element,c.isDehydrated)if(c={element:s,isDehydrated:!1,cache:d.cache},t.updateQueue.baseState=c,t.memoizedState=c,t.flags&256){t=lh(e,t,s,n);break e}else if(s!==r){r=Ft(Error(b(424)),t),jn(r),t=lh(e,t,s,n);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(at=zn(e.firstChild),wt=t,Me=!0,Dn=null,tn=!0,n=Vf(t,null,s,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(la(),s===r){t=xi(e,t,n);break e}jt(e,t,s,n)}t=t.child}return t;case 26:return Ho(e,t),e===null?(n=gd(t.type,null,t.pendingProps,null))?t.memoizedState=n:Me||(n=t.type,e=t.pendingProps,s=nc(Te.current).createElement(n),s[Tt]=t,s[kt]=e,qt(s,n,e),yt(s),t.stateNode=s):t.memoizedState=gd(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Bi(t),e===null&&Me&&(s=t.stateNode=fd(t.type,t.pendingProps,Te.current),wt=t,tn=!0,r=at,_a(t.type)?(zu=r,at=zn(s.firstChild)):at=r),jt(e,t,t.pendingProps.children,n),Ho(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Me&&((r=s=at)&&(s=Dg(s,t.type,t.pendingProps,tn),s!==null?(t.stateNode=s,wt=t,at=zn(s.firstChild),tn=!1,r=!0):r=!1),r||kn(t)),Bi(t),r=t.type,c=t.pendingProps,d=e!==null?e.memoizedProps:null,s=c.children,ju(r,c)?s=null:d!==null&&ju(r,d)&&(t.flags|=32),t.memoizedState!==null&&(r=Zl(e,t,Yc,null,null,n),mr._currentValue=r),Ho(e,t),jt(e,t,s,n),t.child;case 6:return e===null&&Me&&((e=n=at)&&(n=kg(n,t.pendingProps,tn),n!==null?(t.stateNode=n,wt=t,at=null,e=!0):e=!1),e||kn(t)),null;case 13:return rh(e,t,n);case 4:return Ye(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=Vs(t,null,s,n):jt(e,t,s,n),t.child;case 11:return Ff(e,t,t.type,t.pendingProps,n);case 7:return jt(e,t,t.pendingProps,n),t.child;case 8:return jt(e,t,t.pendingProps.children,n),t.child;case 12:return jt(e,t,t.pendingProps.children,n),t.child;case 10:return s=t.pendingProps,vn(t,t.type,s.value),jt(e,t,s.children,n),t.child;case 9:return r=t.type._context,s=t.pendingProps.children,_i(t),r=Rt(r),s=s(r),t.flags|=1,jt(e,t,s,n),t.child;case 14:return eh(e,t,t.type,t.pendingProps,n);case 15:return th(e,t,t.type,t.pendingProps,n);case 19:return ch(e,t,n);case 31:return s=t.pendingProps,n=t.mode,s={mode:s.mode,children:s.children},e===null?(n=Vo(s,n),n.ref=t.ref,t.child=n,n.return=t,t=n):(n=wn(e.child,s),n.ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return nh(e,t,n);case 24:return _i(t),s=Rt($e),e===null?(r=zl(),r===null&&(r=Fe,c=Fn(),r.pooledCache=c,c.refCount++,c!==null&&(r.pooledCacheLanes|=n),r=c),t.memoizedState={parent:s,cache:r},Ls(t),vn(t,$e,r)):((e.lanes&n)!==0&&(Vl(e,t),ns(t,null,null,n),ts()),r=e.memoizedState,c=t.memoizedState,r.parent!==s?(r={parent:s,cache:s},t.memoizedState=r,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=r),vn(t,$e,s)):(s=c.cache,vn(t,$e,s),s!==r.cache&&ql(t,[$e],n,!0))),jt(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(b(156,t.tag))}function Ui(e){e.flags|=4}function fh(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!bd(t)){if(t=bn.current,t!==null&&((Be&4194048)===Be?li!==null:(Be&62914560)!==Be&&(Be&536870912)===0||t!==li))throw Fa=Hl,_o;e.flags|=8192}}function Io(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?ka():536870912,e.lanes|=t,Qs|=t)}function er(e,t){if(!Me)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function ot(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,s=0;if(t)for(var r=e.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&65011712,s|=r.flags&65011712,r.return=e,r=r.sibling;else for(r=e.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function lg(e,t,n){var s=t.pendingProps;switch(Ll(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ot(t),null;case 1:return ot(t),null;case 3:return n=t.stateNode,s=null,e!==null&&(s=e.memoizedState.cache),t.memoizedState.cache!==s&&(t.flags|=2048),St($e),ln(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Ln(t)?Ui(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,ra())),ot(t),null;case 26:return n=t.memoizedState,e===null?(Ui(t),n!==null?(ot(t),fh(t,n)):(ot(t),t.flags&=-16777217)):n?n!==e.memoizedState?(Ui(t),ot(t),fh(t,n)):(ot(t),t.flags&=-16777217):(e.memoizedProps!==s&&Ui(t),ot(t),t.flags&=-16777217),null;case 27:qi(t),n=Te.current;var r=t.type;if(e!==null&&t.stateNode!=null)e.memoizedProps!==s&&Ui(t);else{if(!s){if(t.stateNode===null)throw Error(b(166));return ot(t),null}e=ve.current,Ln(t)?jl(t):(e=fd(r,s,n),t.stateNode=e,Ui(t))}return ot(t),null;case 5:if(qi(t),n=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==s&&Ui(t);else{if(!s){if(t.stateNode===null)throw Error(b(166));return ot(t),null}if(e=ve.current,Ln(t))jl(t);else{switch(r=nc(Te.current),e){case 1:e=r.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=r.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":e=r.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof s.is=="string"?r.createElement("select",{is:s.is}):r.createElement("select"),s.multiple?e.multiple=!0:s.size&&(e.size=s.size);break;default:e=typeof s.is=="string"?r.createElement(n,{is:s.is}):r.createElement(n)}}e[Tt]=t,e[kt]=s;e:for(r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.tag!==27&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break e;for(;r.sibling===null;){if(r.return===null||r.return===t)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}t.stateNode=e;e:switch(qt(e,n,s),n){case"button":case"input":case"select":case"textarea":e=!!s.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Ui(t)}}return ot(t),t.flags&=-16777217,null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==s&&Ui(t);else{if(typeof s!="string"&&t.stateNode===null)throw Error(b(166));if(e=Te.current,Ln(t)){if(e=t.stateNode,n=t.memoizedProps,s=null,r=wt,r!==null)switch(r.tag){case 27:case 5:s=r.memoizedProps}e[Tt]=t,e=!!(e.nodeValue===n||s!==null&&s.suppressHydrationWarning===!0||ad(e.nodeValue,n)),e||kn(t)}else e=nc(e).createTextNode(s),e[Tt]=t,t.stateNode=e}return ot(t),null;case 13:if(s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(r=Ln(t),s!==null&&s.dehydrated!==null){if(e===null){if(!r)throw Error(b(318));if(r=t.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(b(317));r[Tt]=t}else la(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;ot(t),r=!1}else r=ra(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=r),r=!0;if(!r)return t.flags&256?(Ni(t),t):(Ni(t),null)}if(Ni(t),(t.flags&128)!==0)return t.lanes=n,t;if(n=s!==null,e=e!==null&&e.memoizedState!==null,n){s=t.child,r=null,s.alternate!==null&&s.alternate.memoizedState!==null&&s.alternate.memoizedState.cachePool!==null&&(r=s.alternate.memoizedState.cachePool.pool);var c=null;s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),c!==r&&(s.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),Io(t,t.updateQueue),ot(t),null;case 4:return ln(),e===null&&xu(t.stateNode.containerInfo),ot(t),null;case 10:return St(t.type),ot(t),null;case 19:if(W(_t),r=t.memoizedState,r===null)return ot(t),null;if(s=(t.flags&128)!==0,c=r.rendering,c===null)if(s)er(r,!1);else{if(ht!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(c=qo(e),c!==null){for(t.flags|=128,er(r,!1),e=c.updateQueue,t.updateQueue=e,Io(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)bo(n,e),n=n.sibling;return F(_t,_t.current&1|2),t.child}e=e.sibling}r.tail!==null&&X()>Qo&&(t.flags|=128,s=!0,er(r,!1),t.lanes=4194304)}else{if(!s)if(e=qo(c),e!==null){if(t.flags|=128,s=!0,e=e.updateQueue,t.updateQueue=e,Io(t,e),er(r,!0),r.tail===null&&r.tailMode==="hidden"&&!c.alternate&&!Me)return ot(t),null}else 2*X()-r.renderingStartTime>Qo&&n!==536870912&&(t.flags|=128,s=!0,er(r,!1),t.lanes=4194304);r.isBackwards?(c.sibling=t.child,t.child=c):(e=r.last,e!==null?e.sibling=c:t.child=c,r.last=c)}return r.tail!==null?(t=r.tail,r.rendering=t,r.tail=t.sibling,r.renderingStartTime=X(),t.sibling=null,e=_t.current,F(_t,s?e&1|2:e&1),t):(ot(t),null);case 22:case 23:return Ni(t),Ql(),s=t.memoizedState!==null,e!==null?e.memoizedState!==null!==s&&(t.flags|=8192):s&&(t.flags|=8192),s?(n&536870912)!==0&&(t.flags&128)===0&&(ot(t),t.subtreeFlags&6&&(t.flags|=8192)):ot(t),n=t.updateQueue,n!==null&&Io(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),s=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(s=t.memoizedState.cachePool.pool),s!==n&&(t.flags|=2048),e!==null&&W(ei),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),St($e),ot(t),null;case 25:return null;case 30:return null}throw Error(b(156,t.tag))}function rg(e,t){switch(Ll(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return St($e),ln(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return qi(t),null;case 13:if(Ni(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(b(340));la()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return W(_t),null;case 4:return ln(),null;case 10:return St(t.type),null;case 22:case 23:return Ni(t),Ql(),e!==null&&W(ei),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return St($e),null;case 25:return null;default:return null}}function hh(e,t){switch(Ll(t),t.tag){case 3:St($e),ln();break;case 26:case 27:case 5:qi(t);break;case 4:ln();break;case 13:Ni(t);break;case 19:W(_t);break;case 10:St(t.type);break;case 22:case 23:Ni(t),Ql(),e!==null&&W(ei);break;case 24:St($e)}}function tr(e,t){try{var n=t.updateQueue,s=n!==null?n.lastEffect:null;if(s!==null){var r=s.next;n=r;do{if((n.tag&e)===e){s=void 0;var c=n.create,d=n.inst;s=c(),d.destroy=s}n=n.next}while(n!==r)}}catch(g){We(t,t.return,g)}}function va(e,t,n){try{var s=t.updateQueue,r=s!==null?s.lastEffect:null;if(r!==null){var c=r.next;s=c;do{if((s.tag&e)===e){var d=s.inst,g=d.destroy;if(g!==void 0){d.destroy=void 0,r=t;var y=n,M=g;try{M()}catch(k){We(r,y,k)}}}s=s.next}while(s!==c)}}catch(k){We(t,t.return,k)}}function dh(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{Pl(t,n)}catch(s){We(e,e.return,s)}}}function gh(e,t,n){n.props=as(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(s){We(e,t,s)}}function nr(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var s=e.stateNode;break;case 30:s=e.stateNode;break;default:s=e.stateNode}typeof n=="function"?e.refCleanup=n(s):n.current=s}}catch(r){We(e,t,r)}}function ri(e,t){var n=e.ref,s=e.refCleanup;if(n!==null)if(typeof s=="function")try{s()}catch(r){We(e,t,r)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(r){We(e,t,r)}else n.current=null}function mh(e){var t=e.type,n=e.memoizedProps,s=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&s.focus();break e;case"img":n.src?s.src=n.src:n.srcSet&&(s.srcset=n.srcSet)}}catch(r){We(e,e.return,r)}}function ru(e,t,n){try{var s=e.stateNode;Mg(s,e.type,n,t),s[kt]=t}catch(r){We(e,e.return,r)}}function ph(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&_a(e.type)||e.tag===4}function ou(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||ph(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&_a(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function cu(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=tc));else if(s!==4&&(s===27&&_a(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(cu(e,t,n),e=e.sibling;e!==null;)cu(e,t,n),e=e.sibling}function Yo(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(s!==4&&(s===27&&_a(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(Yo(e,t,n),e=e.sibling;e!==null;)Yo(e,t,n),e=e.sibling}function yh(e){var t=e.stateNode,n=e.memoizedProps;try{for(var s=e.type,r=t.attributes;r.length;)t.removeAttributeNode(r[0]);qt(t,s,n),t[Tt]=e,t[kt]=n}catch(c){We(e,e.return,c)}}var Di=!1,gt=!1,uu=!1,vh=typeof WeakSet=="function"?WeakSet:Set,xt=null;function og(e,t){if(e=e.containerInfo,ku=oc,e=zt(e),Ia(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,c=s.focusNode;s=s.focusOffset;try{n.nodeType,c.nodeType}catch{n=null;break e}var d=0,g=-1,y=-1,M=0,k=0,z=e,w=null;t:for(;;){for(var N;z!==n||r!==0&&z.nodeType!==3||(g=d+r),z!==c||s!==0&&z.nodeType!==3||(y=d+s),z.nodeType===3&&(d+=z.nodeValue.length),(N=z.firstChild)!==null;)w=z,z=N;for(;;){if(z===e)break t;if(w===n&&++M===r&&(g=d),w===c&&++k===s&&(y=d),(N=z.nextSibling)!==null)break;z=w,w=z.parentNode}z=N}n=g===-1||y===-1?null:{start:g,end:y}}else n=null}n=n||{start:0,end:0}}else n=null;for(Lu={focusedElem:e,selectionRange:n},oc=!1,xt=t;xt!==null;)if(t=xt,e=t.child,(t.subtreeFlags&1024)!==0&&e!==null)e.return=t,xt=e;else for(;xt!==null;){switch(t=xt,c=t.alternate,e=t.flags,t.tag){case 0:break;case 11:case 15:break;case 1:if((e&1024)!==0&&c!==null){e=void 0,n=t,r=c.memoizedProps,c=c.memoizedState,s=n.stateNode;try{var Ee=as(n.type,r,n.elementType===n.type);e=s.getSnapshotBeforeUpdate(Ee,c),s.__reactInternalSnapshotBeforeUpdate=e}catch(Ae){We(n,n.return,Ae)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)qu(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":qu(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(b(163))}if(e=t.sibling,e!==null){e.return=t.return,xt=e;break}xt=t.return}}function bh(e,t,n){var s=n.flags;switch(n.tag){case 0:case 11:case 15:ba(e,n),s&4&&tr(5,n);break;case 1:if(ba(e,n),s&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(d){We(n,n.return,d)}else{var r=as(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(r,t,e.__reactInternalSnapshotBeforeUpdate)}catch(d){We(n,n.return,d)}}s&64&&dh(n),s&512&&nr(n,n.return);break;case 3:if(ba(e,n),s&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{Pl(e,t)}catch(d){We(n,n.return,d)}}break;case 27:t===null&&s&4&&yh(n);case 26:case 5:ba(e,n),t===null&&s&4&&mh(n),s&512&&nr(n,n.return);break;case 12:ba(e,n);break;case 13:ba(e,n),s&4&&Oh(e,n),s&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=yg.bind(null,n),Lg(e,n))));break;case 22:if(s=n.memoizedState!==null||Di,!s){t=t!==null&&t.memoizedState!==null||gt,r=Di;var c=gt;Di=s,(gt=t)&&!c?Sa(e,n,(n.subtreeFlags&8772)!==0):ba(e,n),Di=r,gt=c}break;case 30:break;default:ba(e,n)}}function Sh(e){var t=e.alternate;t!==null&&(e.alternate=null,Sh(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&fl(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var st=null,an=!1;function ki(e,t,n){for(n=n.child;n!==null;)Ah(e,t,n),n=n.sibling}function Ah(e,t,n){if(Xe&&typeof Xe.onCommitFiberUnmount=="function")try{Xe.onCommitFiberUnmount(Vn,n)}catch{}switch(n.tag){case 26:gt||ri(n,t),ki(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:gt||ri(n,t);var s=st,r=an;_a(n.type)&&(st=n.stateNode,an=!1),ki(e,t,n),fr(n.stateNode),st=s,an=r;break;case 5:gt||ri(n,t);case 6:if(s=st,r=an,st=null,ki(e,t,n),st=s,an=r,st!==null)if(an)try{(st.nodeType===9?st.body:st.nodeName==="HTML"?st.ownerDocument.body:st).removeChild(n.stateNode)}catch(c){We(n,t,c)}else try{st.removeChild(n.stateNode)}catch(c){We(n,t,c)}break;case 18:st!==null&&(an?(e=st,cd(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,n.stateNode),br(e)):cd(st,n.stateNode));break;case 4:s=st,r=an,st=n.stateNode.containerInfo,an=!0,ki(e,t,n),st=s,an=r;break;case 0:case 11:case 14:case 15:gt||va(2,n,t),gt||va(4,n,t),ki(e,t,n);break;case 1:gt||(ri(n,t),s=n.stateNode,typeof s.componentWillUnmount=="function"&&gh(n,t,s)),ki(e,t,n);break;case 21:ki(e,t,n);break;case 22:gt=(s=gt)||n.memoizedState!==null,ki(e,t,n),gt=s;break;default:ki(e,t,n)}}function Oh(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{br(e)}catch(n){We(t,t.return,n)}}function cg(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new vh),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new vh),t;default:throw Error(b(435,e.tag))}}function fu(e,t){var n=cg(e);t.forEach(function(s){var r=vg.bind(null,e,s);n.has(s)||(n.add(s),s.then(r,r))})}function on(e,t){var n=t.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s],c=e,d=t,g=d;e:for(;g!==null;){switch(g.tag){case 27:if(_a(g.type)){st=g.stateNode,an=!1;break e}break;case 5:st=g.stateNode,an=!1;break e;case 3:case 4:st=g.stateNode.containerInfo,an=!0;break e}g=g.return}if(st===null)throw Error(b(160));Ah(c,d,r),st=null,an=!1,c=r.alternate,c!==null&&(c.return=null),r.return=null}if(t.subtreeFlags&13878)for(t=t.child;t!==null;)Th(t,e),t=t.sibling}var Gn=null;function Th(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:on(t,e),cn(e),s&4&&(va(3,e,e.return),tr(3,e),va(5,e,e.return));break;case 1:on(t,e),cn(e),s&512&&(gt||n===null||ri(n,n.return)),s&64&&Di&&(e=e.updateQueue,e!==null&&(s=e.callbacks,s!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?s:n.concat(s))));break;case 26:var r=Gn;if(on(t,e),cn(e),s&512&&(gt||n===null||ri(n,n.return)),s&4){var c=n!==null?n.memoizedState:null;if(s=e.memoizedState,n===null)if(s===null)if(e.stateNode===null){e:{s=e.type,n=e.memoizedProps,r=r.ownerDocument||r;t:switch(s){case"title":c=r.getElementsByTagName("title")[0],(!c||c[La]||c[Tt]||c.namespaceURI==="http://www.w3.org/2000/svg"||c.hasAttribute("itemprop"))&&(c=r.createElement(s),r.head.insertBefore(c,r.querySelector("head > title"))),qt(c,s,n),c[Tt]=e,yt(c),s=c;break e;case"link":var d=yd("link","href",r).get(s+(n.href||""));if(d){for(var g=0;g<d.length;g++)if(c=d[g],c.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&c.getAttribute("rel")===(n.rel==null?null:n.rel)&&c.getAttribute("title")===(n.title==null?null:n.title)&&c.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){d.splice(g,1);break t}}c=r.createElement(s),qt(c,s,n),r.head.appendChild(c);break;case"meta":if(d=yd("meta","content",r).get(s+(n.content||""))){for(g=0;g<d.length;g++)if(c=d[g],c.getAttribute("content")===(n.content==null?null:""+n.content)&&c.getAttribute("name")===(n.name==null?null:n.name)&&c.getAttribute("property")===(n.property==null?null:n.property)&&c.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&c.getAttribute("charset")===(n.charSet==null?null:n.charSet)){d.splice(g,1);break t}}c=r.createElement(s),qt(c,s,n),r.head.appendChild(c);break;default:throw Error(b(468,s))}c[Tt]=e,yt(c),s=c}e.stateNode=s}else vd(r,e.type,e.stateNode);else e.stateNode=pd(r,s,e.memoizedProps);else c!==s?(c===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):c.count--,s===null?vd(r,e.type,e.stateNode):pd(r,s,e.memoizedProps)):s===null&&e.stateNode!==null&&ru(e,e.memoizedProps,n.memoizedProps)}break;case 27:on(t,e),cn(e),s&512&&(gt||n===null||ri(n,n.return)),n!==null&&s&4&&ru(e,e.memoizedProps,n.memoizedProps);break;case 5:if(on(t,e),cn(e),s&512&&(gt||n===null||ri(n,n.return)),e.flags&32){r=e.stateNode;try{fe(r,"")}catch(N){We(e,e.return,N)}}s&4&&e.stateNode!=null&&(r=e.memoizedProps,ru(e,r,n!==null?n.memoizedProps:r)),s&1024&&(uu=!0);break;case 6:if(on(t,e),cn(e),s&4){if(e.stateNode===null)throw Error(b(162));s=e.memoizedProps,n=e.stateNode;try{n.nodeValue=s}catch(N){We(e,e.return,N)}}break;case 3:if(sc=null,r=Gn,Gn=ic(t.containerInfo),on(t,e),Gn=r,cn(e),s&4&&n!==null&&n.memoizedState.isDehydrated)try{br(t.containerInfo)}catch(N){We(e,e.return,N)}uu&&(uu=!1,Rh(e));break;case 4:s=Gn,Gn=ic(e.stateNode.containerInfo),on(t,e),cn(e),Gn=s;break;case 12:on(t,e),cn(e);break;case 13:on(t,e),cn(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(yu=X()),s&4&&(s=e.updateQueue,s!==null&&(e.updateQueue=null,fu(e,s)));break;case 22:r=e.memoizedState!==null;var y=n!==null&&n.memoizedState!==null,M=Di,k=gt;if(Di=M||r,gt=k||y,on(t,e),gt=k,Di=M,cn(e),s&8192)e:for(t=e.stateNode,t._visibility=r?t._visibility&-2:t._visibility|1,r&&(n===null||y||Di||gt||ss(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){y=n=t;try{if(c=y.stateNode,r)d=c.style,typeof d.setProperty=="function"?d.setProperty("display","none","important"):d.display="none";else{g=y.stateNode;var z=y.memoizedProps.style,w=z!=null&&z.hasOwnProperty("display")?z.display:null;g.style.display=w==null||typeof w=="boolean"?"":(""+w).trim()}}catch(N){We(y,y.return,N)}}}else if(t.tag===6){if(n===null){y=t;try{y.stateNode.nodeValue=r?"":y.memoizedProps}catch(N){We(y,y.return,N)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}s&4&&(s=e.updateQueue,s!==null&&(n=s.retryQueue,n!==null&&(s.retryQueue=null,fu(e,n))));break;case 19:on(t,e),cn(e),s&4&&(s=e.updateQueue,s!==null&&(e.updateQueue=null,fu(e,s)));break;case 30:break;case 21:break;default:on(t,e),cn(e)}}function cn(e){var t=e.flags;if(t&2){try{for(var n,s=e.return;s!==null;){if(ph(s)){n=s;break}s=s.return}if(n==null)throw Error(b(160));switch(n.tag){case 27:var r=n.stateNode,c=ou(e);Yo(e,c,r);break;case 5:var d=n.stateNode;n.flags&32&&(fe(d,""),n.flags&=-33);var g=ou(e);Yo(e,g,d);break;case 3:case 4:var y=n.stateNode.containerInfo,M=ou(e);cu(e,M,y);break;default:throw Error(b(161))}}catch(k){We(e,e.return,k)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Rh(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;Rh(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function ba(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)bh(e,t.alternate,t),t=t.sibling}function ss(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:va(4,t,t.return),ss(t);break;case 1:ri(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&gh(t,t.return,n),ss(t);break;case 27:fr(t.stateNode);case 26:case 5:ri(t,t.return),ss(t);break;case 22:t.memoizedState===null&&ss(t);break;case 30:ss(t);break;default:ss(t)}e=e.sibling}}function Sa(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var s=t.alternate,r=e,c=t,d=c.flags;switch(c.tag){case 0:case 11:case 15:Sa(r,c,n),tr(4,c);break;case 1:if(Sa(r,c,n),s=c,r=s.stateNode,typeof r.componentDidMount=="function")try{r.componentDidMount()}catch(M){We(s,s.return,M)}if(s=c,r=s.updateQueue,r!==null){var g=s.stateNode;try{var y=r.shared.hiddenCallbacks;if(y!==null)for(r.shared.hiddenCallbacks=null,r=0;r<y.length;r++)da(y[r],g)}catch(M){We(s,s.return,M)}}n&&d&64&&dh(c),nr(c,c.return);break;case 27:yh(c);case 26:case 5:Sa(r,c,n),n&&s===null&&d&4&&mh(c),nr(c,c.return);break;case 12:Sa(r,c,n);break;case 13:Sa(r,c,n),n&&d&4&&Oh(r,c);break;case 22:c.memoizedState===null&&Sa(r,c,n),nr(c,c.return);break;case 30:break;default:Sa(r,c,n)}t=t.sibling}}function hu(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&Ja(n))}function du(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Ja(e))}function oi(e,t,n,s){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Ch(e,t,n,s),t=t.sibling}function Ch(e,t,n,s){var r=t.flags;switch(t.tag){case 0:case 11:case 15:oi(e,t,n,s),r&2048&&tr(9,t);break;case 1:oi(e,t,n,s);break;case 3:oi(e,t,n,s),r&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Ja(e)));break;case 12:if(r&2048){oi(e,t,n,s),e=t.stateNode;try{var c=t.memoizedProps,d=c.id,g=c.onPostCommit;typeof g=="function"&&g(d,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(y){We(t,t.return,y)}}else oi(e,t,n,s);break;case 13:oi(e,t,n,s);break;case 23:break;case 22:c=t.stateNode,d=t.alternate,t.memoizedState!==null?c._visibility&2?oi(e,t,n,s):ir(e,t):c._visibility&2?oi(e,t,n,s):(c._visibility|=2,Is(e,t,n,s,(t.subtreeFlags&10256)!==0)),r&2048&&hu(d,t);break;case 24:oi(e,t,n,s),r&2048&&du(t.alternate,t);break;default:oi(e,t,n,s)}}function Is(e,t,n,s,r){for(r=r&&(t.subtreeFlags&10256)!==0,t=t.child;t!==null;){var c=e,d=t,g=n,y=s,M=d.flags;switch(d.tag){case 0:case 11:case 15:Is(c,d,g,y,r),tr(8,d);break;case 23:break;case 22:var k=d.stateNode;d.memoizedState!==null?k._visibility&2?Is(c,d,g,y,r):ir(c,d):(k._visibility|=2,Is(c,d,g,y,r)),r&&M&2048&&hu(d.alternate,d);break;case 24:Is(c,d,g,y,r),r&&M&2048&&du(d.alternate,d);break;default:Is(c,d,g,y,r)}t=t.sibling}}function ir(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,s=t,r=s.flags;switch(s.tag){case 22:ir(n,s),r&2048&&hu(s.alternate,s);break;case 24:ir(n,s),r&2048&&du(s.alternate,s);break;default:ir(n,s)}t=t.sibling}}var ar=8192;function Ys(e){if(e.subtreeFlags&ar)for(e=e.child;e!==null;)_h(e),e=e.sibling}function _h(e){switch(e.tag){case 26:Ys(e),e.flags&ar&&e.memoizedState!==null&&Zg(Gn,e.memoizedState,e.memoizedProps);break;case 5:Ys(e);break;case 3:case 4:var t=Gn;Gn=ic(e.stateNode.containerInfo),Ys(e),Gn=t;break;case 22:e.memoizedState===null&&(t=e.alternate,t!==null&&t.memoizedState!==null?(t=ar,ar=16777216,Ys(e),ar=t):Ys(e));break;default:Ys(e)}}function Eh(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function sr(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var s=t[n];xt=s,wh(s,e)}Eh(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Mh(e),e=e.sibling}function Mh(e){switch(e.tag){case 0:case 11:case 15:sr(e),e.flags&2048&&va(9,e,e.return);break;case 3:sr(e);break;case 12:sr(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Po(e)):sr(e);break;default:sr(e)}}function Po(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var s=t[n];xt=s,wh(s,e)}Eh(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:va(8,t,t.return),Po(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,Po(t));break;default:Po(t)}e=e.sibling}}function wh(e,t){for(;xt!==null;){var n=xt;switch(n.tag){case 0:case 11:case 15:va(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var s=n.memoizedState.cachePool.pool;s!=null&&s.refCount++}break;case 24:Ja(n.memoizedState.cache)}if(s=n.child,s!==null)s.return=n,xt=s;else e:for(n=e;xt!==null;){s=xt;var r=s.sibling,c=s.return;if(Sh(s),s===n){xt=null;break e}if(r!==null){r.return=c,xt=r;break e}xt=c}}}var ug={getCacheForType:function(e){var t=Rt($e),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n}},fg=typeof WeakMap=="function"?WeakMap:Map,Pe=0,Fe=null,Ue=null,Be=0,Qe=0,un=null,Aa=!1,Ps=!1,gu=!1,Li=0,ht=0,Oa=0,ls=0,mu=0,Sn=0,Qs=0,lr=null,sn=null,pu=!1,yu=0,Qo=1/0,Xo=null,Ta=null,Bt=0,Ra=null,Xs=null,Zs=0,vu=0,bu=null,Nh=null,rr=0,Su=null;function fn(){if((Pe&2)!==0&&Be!==0)return Be&-Be;if(D.T!==null){var e=ua;return e!==0?e:Eu()}return cl()}function xh(){Sn===0&&(Sn=(Be&536870912)===0||Me?ll():536870912);var e=bn.current;return e!==null&&(e.flags|=32),Sn}function hn(e,t,n){(e===Fe&&(Qe===2||Qe===9)||e.cancelPendingCommit!==null)&&(Ks(e,0),Ca(e,Be,Sn,!1)),Yi(e,n),((Pe&2)===0||e!==Fe)&&(e===Fe&&((Pe&2)===0&&(ls|=n),ht===4&&Ca(e,Be,Sn,!1)),ci(e))}function Uh(e,t,n){if((Pe&6)!==0)throw Error(b(327));var s=!n&&(t&124)===0&&(t&e.expiredLanes)===0||Ii(e,t),r=s?gg(e,t):Tu(e,t,!0),c=s;do{if(r===0){Ps&&!s&&Ca(e,t,0,!1);break}else{if(n=e.current.alternate,c&&!hg(n)){r=Tu(e,t,!1),c=!1;continue}if(r===2){if(c=t,e.errorRecoveryDisabledLanes&c)var d=0;else d=e.pendingLanes&-536870913,d=d!==0?d:d&536870912?536870912:0;if(d!==0){t=d;e:{var g=e;r=lr;var y=g.current.memoizedState.isDehydrated;if(y&&(Ks(g,d).flags|=256),d=Tu(g,d,!1),d!==2){if(gu&&!y){g.errorRecoveryDisabledLanes|=c,ls|=c,r=4;break e}c=sn,sn=r,c!==null&&(sn===null?sn=c:sn.push.apply(sn,c))}r=d}if(c=!1,r!==2)continue}}if(r===1){Ks(e,0),Ca(e,t,0,!0);break}e:{switch(s=e,c=r,c){case 0:case 1:throw Error(b(345));case 4:if((t&4194048)!==t)break;case 6:Ca(s,t,Sn,!Aa);break e;case 2:sn=null;break;case 3:case 5:break;default:throw Error(b(329))}if((t&62914560)===t&&(r=yu+300-X(),10<r)){if(Ca(s,t,Sn,!Aa),Da(s,0,!0)!==0)break e;s.timeoutHandle=rd(Dh.bind(null,s,n,sn,Xo,pu,t,Sn,ls,Qs,Aa,c,2,-0,0),r);break e}Dh(s,n,sn,Xo,pu,t,Sn,ls,Qs,Aa,c,0,-0,0)}}break}while(!0);ci(e)}function Dh(e,t,n,s,r,c,d,g,y,M,k,z,w,N){if(e.timeoutHandle=-1,z=t.subtreeFlags,(z&8192||(z&16785408)===16785408)&&(gr={stylesheets:null,count:0,unsuspend:Xg},_h(t),z=Kg(),z!==null)){e.cancelPendingCommit=z(zh.bind(null,e,t,c,n,s,r,d,g,y,k,1,w,N)),Ca(e,c,d,!M);return}zh(e,t,c,n,s,r,d,g,y)}function hg(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var s=0;s<n.length;s++){var r=n[s],c=r.getSnapshot;r=r.value;try{if(!Yt(c(),r))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ca(e,t,n,s){t&=~mu,t&=~ls,e.suspendedLanes|=t,e.pingedLanes&=~t,s&&(e.warmLanes|=t),s=e.expirationTimes;for(var r=t;0<r;){var c=31-et(r),d=1<<c;s[c]=-1,r&=~d}n!==0&&wr(e,n,t)}function Zo(){return(Pe&6)===0?(or(0),!1):!0}function Au(){if(Ue!==null){if(Qe===0)var e=Ue.return;else e=Ue,Bn=yn=null,l(e),Hs=null,$l=0,e=Ue;for(;e!==null;)hh(e.alternate,e),e=e.return;Ue=null}}function Ks(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,Ng(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),Au(),Fe=e,Ue=n=wn(e.current,null),Be=t,Qe=0,un=null,Aa=!1,Ps=Ii(e,t),gu=!1,Qs=Sn=mu=ls=Oa=ht=0,sn=lr=null,pu=!1,(t&8)!==0&&(t|=t&32);var s=e.entangledLanes;if(s!==0)for(e=e.entanglements,s&=t;0<s;){var r=31-et(s),c=1<<r;t|=e[r],s&=~c}return Li=t,ws(),n}function kh(e,t){we=null,D.H=Lo,t===Wa||t===ks?(t=wo(),Qe=3):t===_o?(t=wo(),Qe=4):Qe=t===$f?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,un=t,Ue===null&&(ht=1,zo(e,Ft(t,e.current)))}function Lh(){var e=D.H;return D.H=Lo,e===null?Lo:e}function jh(){var e=D.A;return D.A=ug,e}function Ou(){ht=4,Aa||(Be&4194048)!==Be&&bn.current!==null||(Ps=!0),(Oa&134217727)===0&&(ls&134217727)===0||Fe===null||Ca(Fe,Be,Sn,!1)}function Tu(e,t,n){var s=Pe;Pe|=2;var r=Lh(),c=jh();(Fe!==e||Be!==t)&&(Xo=null,Ks(e,t)),t=!1;var d=ht;e:do try{if(Qe!==0&&Ue!==null){var g=Ue,y=un;switch(Qe){case 8:Au(),d=6;break e;case 3:case 2:case 9:case 6:bn.current===null&&(t=!0);var M=Qe;if(Qe=0,un=null,Js(e,g,y,M),n&&Ps){d=0;break e}break;default:M=Qe,Qe=0,un=null,Js(e,g,y,M)}}dg(),d=ht;break}catch(k){kh(e,k)}while(!0);return t&&e.shellSuspendCounter++,Bn=yn=null,Pe=s,D.H=r,D.A=c,Ue===null&&(Fe=null,Be=0,ws()),d}function dg(){for(;Ue!==null;)Bh(Ue)}function gg(e,t){var n=Pe;Pe|=2;var s=Lh(),r=jh();Fe!==e||Be!==t?(Xo=null,Qo=X()+500,Ks(e,t)):Ps=Ii(e,t);e:do try{if(Qe!==0&&Ue!==null){t=Ue;var c=un;t:switch(Qe){case 1:Qe=0,un=null,Js(e,t,c,1);break;case 2:case 9:if(Eo(c)){Qe=0,un=null,qh(t);break}t=function(){Qe!==2&&Qe!==9||Fe!==e||(Qe=7),ci(e)},c.then(t,t);break e;case 3:Qe=7;break e;case 4:Qe=5;break e;case 7:Eo(c)?(Qe=0,un=null,qh(t)):(Qe=0,un=null,Js(e,t,c,7));break;case 5:var d=null;switch(Ue.tag){case 26:d=Ue.memoizedState;case 5:case 27:var g=Ue;if(!d||bd(d)){Qe=0,un=null;var y=g.sibling;if(y!==null)Ue=y;else{var M=g.return;M!==null?(Ue=M,Ko(M)):Ue=null}break t}}Qe=0,un=null,Js(e,t,c,5);break;case 6:Qe=0,un=null,Js(e,t,c,6);break;case 8:Au(),ht=6;break e;default:throw Error(b(462))}}mg();break}catch(k){kh(e,k)}while(!0);return Bn=yn=null,D.H=s,D.A=r,Pe=n,Ue!==null?0:(Fe=null,Be=0,ws(),ht)}function mg(){for(;Ue!==null&&!os();)Bh(Ue)}function Bh(e){var t=uh(e.alternate,e,Li);e.memoizedProps=e.pendingProps,t===null?Ko(e):Ue=t}function qh(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=ah(n,t,t.pendingProps,t.type,void 0,Be);break;case 11:t=ah(n,t,t.pendingProps,t.type.render,t.ref,Be);break;case 5:l(t);default:hh(n,t),t=Ue=bo(t,Li),t=uh(n,t,Li)}e.memoizedProps=e.pendingProps,t===null?Ko(e):Ue=t}function Js(e,t,n,s){Bn=yn=null,l(t),Hs=null,$l=0;var r=t.return;try{if(ag(e,r,t,n,Be)){ht=1,zo(e,Ft(n,e.current)),Ue=null;return}}catch(c){if(r!==null)throw Ue=r,c;ht=1,zo(e,Ft(n,e.current)),Ue=null;return}t.flags&32768?(Me||s===1?e=!0:Ps||(Be&536870912)!==0?e=!1:(Aa=e=!0,(s===2||s===9||s===3||s===6)&&(s=bn.current,s!==null&&s.tag===13&&(s.flags|=16384))),Gh(t,e)):Ko(t)}function Ko(e){var t=e;do{if((t.flags&32768)!==0){Gh(t,Aa);return}e=t.return;var n=lg(t.alternate,t,Li);if(n!==null){Ue=n;return}if(t=t.sibling,t!==null){Ue=t;return}Ue=t=e}while(t!==null);ht===0&&(ht=5)}function Gh(e,t){do{var n=rg(e.alternate,e);if(n!==null){n.flags&=32767,Ue=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){Ue=e;return}Ue=e=n}while(e!==null);ht=6,Ue=null}function zh(e,t,n,s,r,c,d,g,y){e.cancelPendingCommit=null;do Jo();while(Bt!==0);if((Pe&6)!==0)throw Error(b(327));if(t!==null){if(t===e.current)throw Error(b(177));if(c=t.lanes|t.childLanes,c|=xl,Mr(e,n,c,d,g,y),e===Fe&&(Ue=Fe=null,Be=0),Xs=t,Ra=e,Zs=n,vu=c,bu=r,Nh=s,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,bg(te,function(){return Ph(),null})):(e.callbackNode=null,e.callbackPriority=0),s=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||s){s=D.T,D.T=null,r=G.p,G.p=2,d=Pe,Pe|=4;try{og(e,t,n)}finally{Pe=d,G.p=r,D.T=s}}Bt=1,Hh(),Vh(),Ih()}}function Hh(){if(Bt===1){Bt=0;var e=Ra,t=Xs,n=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||n){n=D.T,D.T=null;var s=G.p;G.p=2;var r=Pe;Pe|=4;try{Th(t,e);var c=Lu,d=zt(e.containerInfo),g=c.focusedElem,y=c.selectionRange;if(d!==g&&g&&g.ownerDocument&&Ml(g.ownerDocument.documentElement,g)){if(y!==null&&Ia(g)){var M=y.start,k=y.end;if(k===void 0&&(k=M),"selectionStart"in g)g.selectionStart=M,g.selectionEnd=Math.min(k,g.value.length);else{var z=g.ownerDocument||document,w=z&&z.defaultView||window;if(w.getSelection){var N=w.getSelection(),Ee=g.textContent.length,Ae=Math.min(y.start,Ee),Je=y.end===void 0?Ae:Math.min(y.end,Ee);!N.extend&&Ae>Je&&(d=Je,Je=Ae,Ae=d);var T=_s(g,Ae),A=_s(g,Je);if(T&&A&&(N.rangeCount!==1||N.anchorNode!==T.node||N.anchorOffset!==T.offset||N.focusNode!==A.node||N.focusOffset!==A.offset)){var C=z.createRange();C.setStart(T.node,T.offset),N.removeAllRanges(),Ae>Je?(N.addRange(C),N.extend(A.node,A.offset)):(C.setEnd(A.node,A.offset),N.addRange(C))}}}}for(z=[],N=g;N=N.parentNode;)N.nodeType===1&&z.push({element:N,left:N.scrollLeft,top:N.scrollTop});for(typeof g.focus=="function"&&g.focus(),g=0;g<z.length;g++){var q=z[g];q.element.scrollLeft=q.left,q.element.scrollTop=q.top}}oc=!!ku,Lu=ku=null}finally{Pe=r,G.p=s,D.T=n}}e.current=t,Bt=2}}function Vh(){if(Bt===2){Bt=0;var e=Ra,t=Xs,n=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||n){n=D.T,D.T=null;var s=G.p;G.p=2;var r=Pe;Pe|=4;try{bh(e,t.alternate,t)}finally{Pe=r,G.p=s,D.T=n}}Bt=3}}function Ih(){if(Bt===4||Bt===3){Bt=0,cs();var e=Ra,t=Xs,n=Zs,s=Nh;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Bt=5:(Bt=0,Xs=Ra=null,Yh(e,e.pendingLanes));var r=e.pendingLanes;if(r===0&&(Ta=null),ol(n),t=t.stateNode,Xe&&typeof Xe.onCommitFiberRoot=="function")try{Xe.onCommitFiberRoot(Vn,t,void 0,(t.current.flags&128)===128)}catch{}if(s!==null){t=D.T,r=G.p,G.p=2,D.T=null;try{for(var c=e.onRecoverableError,d=0;d<s.length;d++){var g=s[d];c(g.value,{componentStack:g.stack})}}finally{D.T=t,G.p=r}}(Zs&3)!==0&&Jo(),ci(e),r=e.pendingLanes,(n&4194090)!==0&&(r&42)!==0?e===Su?rr++:(rr=0,Su=e):rr=0,or(0)}}function Yh(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,Ja(t)))}function Jo(e){return Hh(),Vh(),Ih(),Ph()}function Ph(){if(Bt!==5)return!1;var e=Ra,t=vu;vu=0;var n=ol(Zs),s=D.T,r=G.p;try{G.p=32>n?32:n,D.T=null,n=bu,bu=null;var c=Ra,d=Zs;if(Bt=0,Xs=Ra=null,Zs=0,(Pe&6)!==0)throw Error(b(331));var g=Pe;if(Pe|=4,Mh(c.current),Ch(c,c.current,d,n),Pe=g,or(0,!1),Xe&&typeof Xe.onPostCommitFiberRoot=="function")try{Xe.onPostCommitFiberRoot(Vn,c)}catch{}return!0}finally{G.p=r,D.T=s,Yh(e,t)}}function Qh(e,t,n){t=Ft(n,t),t=$c(e.stateNode,t,2),e=ni(e,t,2),e!==null&&(Yi(e,2),ci(e))}function We(e,t,n){if(e.tag===3)Qh(e,e,n);else for(;t!==null;){if(t.tag===3){Qh(t,e,n);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Ta===null||!Ta.has(s))){e=Ft(n,e),n=Jf(2),s=ni(t,n,2),s!==null&&(Wf(n,s,t,e),Yi(s,2),ci(s));break}}t=t.return}}function Ru(e,t,n){var s=e.pingCache;if(s===null){s=e.pingCache=new fg;var r=new Set;s.set(t,r)}else r=s.get(t),r===void 0&&(r=new Set,s.set(t,r));r.has(n)||(gu=!0,r.add(n),e=pg.bind(null,e,t,n),t.then(e,e))}function pg(e,t,n){var s=e.pingCache;s!==null&&s.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,Fe===e&&(Be&n)===n&&(ht===4||ht===3&&(Be&62914560)===Be&&300>X()-yu?(Pe&2)===0&&Ks(e,0):mu|=n,Qs===Be&&(Qs=0)),ci(e)}function Xh(e,t){t===0&&(t=ka()),e=ia(e,t),e!==null&&(Yi(e,t),ci(e))}function yg(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Xh(e,n)}function vg(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,r=e.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=e.stateNode;break;case 22:s=e.stateNode._retryCache;break;default:throw Error(b(314))}s!==null&&s.delete(t),Xh(e,n)}function bg(e,t){return Gi(e,t)}var Wo=null,Ws=null,Cu=!1,$o=!1,_u=!1,rs=0;function ci(e){e!==Ws&&e.next===null&&(Ws===null?Wo=Ws=e:Ws=Ws.next=e),$o=!0,Cu||(Cu=!0,Ag())}function or(e,t){if(!_u&&$o){_u=!0;do for(var n=!1,s=Wo;s!==null;){if(e!==0){var r=s.pendingLanes;if(r===0)var c=0;else{var d=s.suspendedLanes,g=s.pingedLanes;c=(1<<31-et(42|e)+1)-1,c&=r&~(d&~g),c=c&201326741?c&201326741|1:c?c|2:0}c!==0&&(n=!0,Wh(s,c))}else c=Be,c=Da(s,s===Fe?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),(c&3)===0||Ii(s,c)||(n=!0,Wh(s,c));s=s.next}while(n);_u=!1}}function Sg(){Zh()}function Zh(){$o=Cu=!1;var e=0;rs!==0&&(wg()&&(e=rs),rs=0);for(var t=X(),n=null,s=Wo;s!==null;){var r=s.next,c=Kh(s,t);c===0?(s.next=null,n===null?Wo=r:n.next=r,r===null&&(Ws=n)):(n=s,(e!==0||(c&3)!==0)&&($o=!0)),s=r}or(e)}function Kh(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,r=e.expirationTimes,c=e.pendingLanes&-62914561;0<c;){var d=31-et(c),g=1<<d,y=r[d];y===-1?((g&n)===0||(g&s)!==0)&&(r[d]=us(g,t)):y<=t&&(e.expiredLanes|=g),c&=~g}if(t=Fe,n=Be,n=Da(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),s=e.callbackNode,n===0||e===t&&(Qe===2||Qe===9)||e.cancelPendingCommit!==null)return s!==null&&s!==null&&zi(s),e.callbackNode=null,e.callbackPriority=0;if((n&3)===0||Ii(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(s!==null&&zi(s),ol(n)){case 2:case 8:n=ue;break;case 32:n=te;break;case 268435456:n=Dt;break;default:n=te}return s=Jh.bind(null,e),n=Gi(n,s),e.callbackPriority=t,e.callbackNode=n,t}return s!==null&&s!==null&&zi(s),e.callbackPriority=2,e.callbackNode=null,2}function Jh(e,t){if(Bt!==0&&Bt!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(Jo()&&e.callbackNode!==n)return null;var s=Be;return s=Da(e,e===Fe?s:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),s===0?null:(Uh(e,s,t),Kh(e,X()),e.callbackNode!=null&&e.callbackNode===n?Jh.bind(null,e):null)}function Wh(e,t){if(Jo())return null;Uh(e,t,!0)}function Ag(){xg(function(){(Pe&6)!==0?Gi(ce,Sg):Zh()})}function Eu(){return rs===0&&(rs=ll()),rs}function $h(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:ys(""+e)}function Fh(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function Og(e,t,n,s,r){if(t==="submit"&&n&&n.stateNode===r){var c=$h((r[kt]||null).action),d=s.submitter;d&&(t=(t=d[kt]||null)?$h(t.formAction):d.getAttribute("formAction"),t!==null&&(c=t,d=null));var g=new Os("action","action",null,s,r);e.push({event:g,listeners:[{instance:null,listener:function(){if(s.defaultPrevented){if(rs!==0){var y=d?Fh(r,d):new FormData(r);Xc(n,{pending:!0,data:y,method:r.method,action:c},null,y)}}else typeof c=="function"&&(g.preventDefault(),y=d?Fh(r,d):new FormData(r),Xc(n,{pending:!0,data:y,method:r.method,action:c},c,y))},currentTarget:r}]})}}for(var Mu=0;Mu<ta.length;Mu++){var wu=ta[Mu],Tg=wu.toLowerCase(),Rg=wu[0].toUpperCase()+wu.slice(1);vt(Tg,"on"+Rg)}vt(Wn,"onAnimationEnd"),vt(Ms,"onAnimationIteration"),vt(ho,"onAnimationStart"),vt("dblclick","onDoubleClick"),vt("focusin","onFocus"),vt("focusout","onBlur"),vt(go,"onTransitionRun"),vt(mo,"onTransitionStart"),vt(zc,"onTransitionCancel"),vt(po,"onTransitionEnd"),Yn("onMouseEnter",["mouseout","mouseover"]),Yn("onMouseLeave",["mouseout","mouseover"]),Yn("onPointerEnter",["pointerout","pointerover"]),Yn("onPointerLeave",["pointerout","pointerover"]),fi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),fi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),fi("onBeforeInput",["compositionend","keypress","textInput","paste"]),fi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),fi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),fi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Cg=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(cr));function ed(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var s=e[n],r=s.event;s=s.listeners;e:{var c=void 0;if(t)for(var d=s.length-1;0<=d;d--){var g=s[d],y=g.instance,M=g.currentTarget;if(g=g.listener,y!==c&&r.isPropagationStopped())break e;c=g,r.currentTarget=M;try{c(r)}catch(k){Go(k)}r.currentTarget=null,c=y}else for(d=0;d<s.length;d++){if(g=s[d],y=g.instance,M=g.currentTarget,g=g.listener,y!==c&&r.isPropagationStopped())break e;c=g,r.currentTarget=M;try{c(r)}catch(k){Go(k)}r.currentTarget=null,c=y}}}}function De(e,t){var n=t[fs];n===void 0&&(n=t[fs]=new Set);var s=e+"__bubble";n.has(s)||(td(t,e,2,!1),n.add(s))}function Nu(e,t,n){var s=0;t&&(s|=4),td(n,e,s,t)}var Fo="_reactListening"+Math.random().toString(36).slice(2);function xu(e){if(!e[Fo]){e[Fo]=!0,Ce.forEach(function(n){n!=="selectionchange"&&(Cg.has(n)||Nu(n,!1,e),Nu(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Fo]||(t[Fo]=!0,Nu("selectionchange",!1,t))}}function td(e,t,n,s){switch(Cd(t)){case 2:var r=$g;break;case 8:r=Fg;break;default:r=Pu}n=r.bind(null,t,n,e),r=void 0,!Zn||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(r=!0),s?r!==void 0?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):r!==void 0?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Uu(e,t,n,s,r){var c=s;if((t&1)===0&&(t&2)===0&&s!==null)e:for(;;){if(s===null)return;var d=s.tag;if(d===3||d===4){var g=s.stateNode.containerInfo;if(g===r)break;if(d===4)for(d=s.return;d!==null;){var y=d.tag;if((y===3||y===4)&&d.stateNode.containerInfo===r)return;d=d.return}for(;g!==null;){if(d=Cn(g),d===null)return;if(y=d.tag,y===5||y===6||y===26||y===27){s=c=d;continue e}g=g.parentNode}}s=s.return}bl(function(){var M=c,k=ja(n),z=[];e:{var w=yo.get(e);if(w!==void 0){var N=Os,Ee=e;switch(e){case"keypress":if(qa(n)===0)break e;case"keydown":case"keyup":N=Nc;break;case"focusin":Ee="focus",N=Ol;break;case"focusout":Ee="blur",N=Ol;break;case"beforeblur":case"afterblur":N=Ol;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":N=Al;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":N=Rs;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":N=Xr;break;case Wn:case Ms:case ho:N=_c;break;case po:N=Dc;break;case"scroll":case"scrollend":N=Oc;break;case"wheel":N=Zr;break;case"copy":case"cut":case"paste":N=zr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":N=Qr;break;case"toggle":case"beforetoggle":N=Tl}var Ae=(t&4)!==0,Je=!Ae&&(e==="scroll"||e==="scrollend"),T=Ae?w!==null?w+"Capture":null:w;Ae=[];for(var A=M,C;A!==null;){var q=A;if(C=q.stateNode,q=q.tag,q!==5&&q!==26&&q!==27||C===null||T===null||(q=Xn(A,T),q!=null&&Ae.push(ur(A,q,C))),Je)break;A=A.return}0<Ae.length&&(w=new N(w,Ee,null,n,k),z.push({event:w,listeners:Ae}))}}if((t&7)===0){e:{if(w=e==="mouseover"||e==="pointerover",N=e==="mouseout"||e==="pointerout",w&&n!==vs&&(Ee=n.relatedTarget||n.fromElement)&&(Cn(Ee)||Ee[Pi]))break e;if((N||w)&&(w=k.window===k?k:(w=k.ownerDocument)?w.defaultView||w.parentWindow:window,N?(Ee=n.relatedTarget||n.toElement,N=M,Ee=Ee?Cn(Ee):null,Ee!==null&&(Je=ne(Ee),Ae=Ee.tag,Ee!==Je||Ae!==5&&Ae!==27&&Ae!==6)&&(Ee=null)):(N=null,Ee=M),N!==Ee)){if(Ae=Al,q="onMouseLeave",T="onMouseEnter",A="mouse",(e==="pointerout"||e==="pointerover")&&(Ae=Qr,q="onPointerLeave",T="onPointerEnter",A="pointer"),Je=N==null?w:In(N),C=Ee==null?w:In(Ee),w=new Ae(q,A+"leave",N,n,k),w.target=Je,w.relatedTarget=C,q=null,Cn(k)===M&&(Ae=new Ae(T,A+"enter",Ee,n,k),Ae.target=C,Ae.relatedTarget=Je,q=Ae),Je=q,N&&Ee)t:{for(Ae=N,T=Ee,A=0,C=Ae;C;C=$s(C))A++;for(C=0,q=T;q;q=$s(q))C++;for(;0<A-C;)Ae=$s(Ae),A--;for(;0<C-A;)T=$s(T),C--;for(;A--;){if(Ae===T||T!==null&&Ae===T.alternate)break t;Ae=$s(Ae),T=$s(T)}Ae=null}else Ae=null;N!==null&&nd(z,w,N,Ae,!1),Ee!==null&&Je!==null&&nd(z,Je,Ee,Ae,!0)}}e:{if(w=M?In(M):window,N=w.nodeName&&w.nodeName.toLowerCase(),N==="select"||N==="input"&&w.type==="file")var oe=ao;else if(no(w))if(so)oe=Gc;else{oe=ro;var xe=lo}else N=w.nodeName,!N||N.toLowerCase()!=="input"||w.type!=="checkbox"&&w.type!=="radio"?M&&ps(M.elementType)&&(oe=ao):oe=oo;if(oe&&(oe=oe(e,M))){Rl(z,oe,n,k);break e}xe&&xe(e,w,M),e==="focusout"&&M&&w.type==="number"&&M.memoizedProps.value!=null&&yl(w,"number",w.value)}switch(xe=M?In(M):window,e){case"focusin":(no(xe)||xe.contentEditable==="true")&&(ea=xe,Nl=M,vi=null);break;case"focusout":vi=Nl=ea=null;break;case"mousedown":Es=!0;break;case"contextmenu":case"mouseup":case"dragend":Es=!1,uo(z,n,k);break;case"selectionchange":if(wl)break;case"keydown":case"keyup":uo(z,n,k)}var pe;if(mi)e:{switch(e){case"compositionstart":var Re="onCompositionStart";break e;case"compositionend":Re="onCompositionEnd";break e;case"compositionupdate":Re="onCompositionUpdate";break e}Re=void 0}else pi?Fr(e,n)&&(Re="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(Re="onCompositionStart");Re&&(Jr&&n.locale!=="ko"&&(pi||Re!=="onCompositionStart"?Re==="onCompositionEnd"&&pi&&(pe=gi()):(En=k,bs="value"in En?En.value:En.textContent,pi=!0)),xe=ec(M,Re),0<xe.length&&(Re=new Vr(Re,e,null,n,k),z.push({event:Re,listeners:xe}),pe?Re.data=pe:(pe=eo(n),pe!==null&&(Re.data=pe)))),(pe=jc?Bc(e,n):to(e,n))&&(Re=ec(M,"onBeforeInput"),0<Re.length&&(xe=new Vr("onBeforeInput","beforeinput",null,n,k),z.push({event:xe,listeners:Re}),xe.data=pe)),Og(z,e,M,n,k)}ed(z,t)})}function ur(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ec(e,t){for(var n=t+"Capture",s=[];e!==null;){var r=e,c=r.stateNode;if(r=r.tag,r!==5&&r!==26&&r!==27||c===null||(r=Xn(e,n),r!=null&&s.unshift(ur(e,r,c)),r=Xn(e,t),r!=null&&s.push(ur(e,r,c))),e.tag===3)return s;e=e.return}return[]}function $s(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function nd(e,t,n,s,r){for(var c=t._reactName,d=[];n!==null&&n!==s;){var g=n,y=g.alternate,M=g.stateNode;if(g=g.tag,y!==null&&y===s)break;g!==5&&g!==26&&g!==27||M===null||(y=M,r?(M=Xn(n,c),M!=null&&d.unshift(ur(n,M,y))):r||(M=Xn(n,c),M!=null&&d.push(ur(n,M,y)))),n=n.return}d.length!==0&&e.push({event:t,listeners:d})}var _g=/\r\n?/g,Eg=/\u0000|\uFFFD/g;function id(e){return(typeof e=="string"?e:""+e).replace(_g,`
`).replace(Eg,"")}function ad(e,t){return t=id(t),id(e)===t}function tc(){}function Ke(e,t,n,s,r,c){switch(n){case"children":typeof s=="string"?t==="body"||t==="textarea"&&s===""||fe(e,s):(typeof s=="number"||typeof s=="bigint")&&t!=="body"&&fe(e,""+s);break;case"className":Xi(e,"class",s);break;case"tabIndex":Xi(e,"tabindex",s);break;case"dir":case"role":case"viewBox":case"width":case"height":Xi(e,n,s);break;case"style":Br(e,s,c);break;case"data":if(t!=="object"){Xi(e,"data",s);break}case"src":case"href":if(s===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(s==null||typeof s=="function"||typeof s=="symbol"||typeof s=="boolean"){e.removeAttribute(n);break}s=ys(""+s),e.setAttribute(n,s);break;case"action":case"formAction":if(typeof s=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof c=="function"&&(n==="formAction"?(t!=="input"&&Ke(e,t,"name",r.name,r,null),Ke(e,t,"formEncType",r.formEncType,r,null),Ke(e,t,"formMethod",r.formMethod,r,null),Ke(e,t,"formTarget",r.formTarget,r,null)):(Ke(e,t,"encType",r.encType,r,null),Ke(e,t,"method",r.method,r,null),Ke(e,t,"target",r.target,r,null)));if(s==null||typeof s=="symbol"||typeof s=="boolean"){e.removeAttribute(n);break}s=ys(""+s),e.setAttribute(n,s);break;case"onClick":s!=null&&(e.onclick=tc);break;case"onScroll":s!=null&&De("scroll",e);break;case"onScrollEnd":s!=null&&De("scrollend",e);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(b(61));if(n=s.__html,n!=null){if(r.children!=null)throw Error(b(60));e.innerHTML=n}}break;case"multiple":e.multiple=s&&typeof s!="function"&&typeof s!="symbol";break;case"muted":e.muted=s&&typeof s!="function"&&typeof s!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(s==null||typeof s=="function"||typeof s=="boolean"||typeof s=="symbol"){e.removeAttribute("xlink:href");break}n=ys(""+s),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":s!=null&&typeof s!="function"&&typeof s!="symbol"?e.setAttribute(n,""+s):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":s&&typeof s!="function"&&typeof s!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":s===!0?e.setAttribute(n,""):s!==!1&&s!=null&&typeof s!="function"&&typeof s!="symbol"?e.setAttribute(n,s):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":s!=null&&typeof s!="function"&&typeof s!="symbol"&&!isNaN(s)&&1<=s?e.setAttribute(n,s):e.removeAttribute(n);break;case"rowSpan":case"start":s==null||typeof s=="function"||typeof s=="symbol"||isNaN(s)?e.removeAttribute(n):e.setAttribute(n,s);break;case"popover":De("beforetoggle",e),De("toggle",e),hi(e,"popover",s);break;case"xlinkActuate":_n(e,"http://www.w3.org/1999/xlink","xlink:actuate",s);break;case"xlinkArcrole":_n(e,"http://www.w3.org/1999/xlink","xlink:arcrole",s);break;case"xlinkRole":_n(e,"http://www.w3.org/1999/xlink","xlink:role",s);break;case"xlinkShow":_n(e,"http://www.w3.org/1999/xlink","xlink:show",s);break;case"xlinkTitle":_n(e,"http://www.w3.org/1999/xlink","xlink:title",s);break;case"xlinkType":_n(e,"http://www.w3.org/1999/xlink","xlink:type",s);break;case"xmlBase":_n(e,"http://www.w3.org/XML/1998/namespace","xml:base",s);break;case"xmlLang":_n(e,"http://www.w3.org/XML/1998/namespace","xml:lang",s);break;case"xmlSpace":_n(e,"http://www.w3.org/XML/1998/namespace","xml:space",s);break;case"is":hi(e,"is",s);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=Ac.get(n)||n,hi(e,n,s))}}function Du(e,t,n,s,r,c){switch(n){case"style":Br(e,s,c);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(b(61));if(n=s.__html,n!=null){if(r.children!=null)throw Error(b(60));e.innerHTML=n}}break;case"children":typeof s=="string"?fe(e,s):(typeof s=="number"||typeof s=="bigint")&&fe(e,""+s);break;case"onScroll":s!=null&&De("scroll",e);break;case"onScrollEnd":s!=null&&De("scrollend",e);break;case"onClick":s!=null&&(e.onclick=tc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ur.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(r=n.endsWith("Capture"),t=n.slice(2,r?n.length-7:void 0),c=e[kt]||null,c=c!=null?c[n]:null,typeof c=="function"&&e.removeEventListener(t,c,r),typeof s=="function")){typeof c!="function"&&c!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,s,r);break e}n in e?e[n]=s:s===!0?e.setAttribute(n,""):hi(e,n,s)}}}function qt(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":De("error",e),De("load",e);var s=!1,r=!1,c;for(c in n)if(n.hasOwnProperty(c)){var d=n[c];if(d!=null)switch(c){case"src":s=!0;break;case"srcSet":r=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(b(137,t));default:Ke(e,t,c,d,n,null)}}r&&Ke(e,t,"srcSet",n.srcSet,n,null),s&&Ke(e,t,"src",n.src,n,null);return;case"input":De("invalid",e);var g=c=d=r=null,y=null,M=null;for(s in n)if(n.hasOwnProperty(s)){var k=n[s];if(k!=null)switch(s){case"name":r=k;break;case"type":d=k;break;case"checked":y=k;break;case"defaultChecked":M=k;break;case"value":c=k;break;case"defaultValue":g=k;break;case"children":case"dangerouslySetInnerHTML":if(k!=null)throw Error(b(137,t));break;default:Ke(e,t,s,k,n,null)}}ms(e,c,g,y,M,d,r,!1),gs(e);return;case"select":De("invalid",e),s=d=c=null;for(r in n)if(n.hasOwnProperty(r)&&(g=n[r],g!=null))switch(r){case"value":c=g;break;case"defaultValue":d=g;break;case"multiple":s=g;default:Ke(e,t,r,g,n,null)}t=c,n=d,e.multiple=!!s,t!=null?Pn(e,!!s,t,!1):n!=null&&Pn(e,!!s,n,!0);return;case"textarea":De("invalid",e),c=r=s=null;for(d in n)if(n.hasOwnProperty(d)&&(g=n[d],g!=null))switch(d){case"value":s=g;break;case"defaultValue":r=g;break;case"children":c=g;break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(b(91));break;default:Ke(e,t,d,g,n,null)}dt(e,s,r,c),gs(e);return;case"option":for(y in n)if(n.hasOwnProperty(y)&&(s=n[y],s!=null))switch(y){case"selected":e.selected=s&&typeof s!="function"&&typeof s!="symbol";break;default:Ke(e,t,y,s,n,null)}return;case"dialog":De("beforetoggle",e),De("toggle",e),De("cancel",e),De("close",e);break;case"iframe":case"object":De("load",e);break;case"video":case"audio":for(s=0;s<cr.length;s++)De(cr[s],e);break;case"image":De("error",e),De("load",e);break;case"details":De("toggle",e);break;case"embed":case"source":case"link":De("error",e),De("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(M in n)if(n.hasOwnProperty(M)&&(s=n[M],s!=null))switch(M){case"children":case"dangerouslySetInnerHTML":throw Error(b(137,t));default:Ke(e,t,M,s,n,null)}return;default:if(ps(t)){for(k in n)n.hasOwnProperty(k)&&(s=n[k],s!==void 0&&Du(e,t,k,s,n,void 0));return}}for(g in n)n.hasOwnProperty(g)&&(s=n[g],s!=null&&Ke(e,t,g,s,n,null))}function Mg(e,t,n,s){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var r=null,c=null,d=null,g=null,y=null,M=null,k=null;for(N in n){var z=n[N];if(n.hasOwnProperty(N)&&z!=null)switch(N){case"checked":break;case"value":break;case"defaultValue":y=z;default:s.hasOwnProperty(N)||Ke(e,t,N,null,s,z)}}for(var w in s){var N=s[w];if(z=n[w],s.hasOwnProperty(w)&&(N!=null||z!=null))switch(w){case"type":c=N;break;case"name":r=N;break;case"checked":M=N;break;case"defaultChecked":k=N;break;case"value":d=N;break;case"defaultValue":g=N;break;case"children":case"dangerouslySetInnerHTML":if(N!=null)throw Error(b(137,t));break;default:N!==z&&Ke(e,t,w,N,s,z)}}pl(e,d,g,y,M,k,c,r);return;case"select":N=d=g=w=null;for(c in n)if(y=n[c],n.hasOwnProperty(c)&&y!=null)switch(c){case"value":break;case"multiple":N=y;default:s.hasOwnProperty(c)||Ke(e,t,c,null,s,y)}for(r in s)if(c=s[r],y=n[r],s.hasOwnProperty(r)&&(c!=null||y!=null))switch(r){case"value":w=c;break;case"defaultValue":g=c;break;case"multiple":d=c;default:c!==y&&Ke(e,t,r,c,s,y)}t=g,n=d,s=N,w!=null?Pn(e,!!n,w,!1):!!s!=!!n&&(t!=null?Pn(e,!!n,t,!0):Pn(e,!!n,n?[]:"",!1));return;case"textarea":N=w=null;for(g in n)if(r=n[g],n.hasOwnProperty(g)&&r!=null&&!s.hasOwnProperty(g))switch(g){case"value":break;case"children":break;default:Ke(e,t,g,null,s,r)}for(d in s)if(r=s[d],c=n[d],s.hasOwnProperty(d)&&(r!=null||c!=null))switch(d){case"value":w=r;break;case"defaultValue":N=r;break;case"children":break;case"dangerouslySetInnerHTML":if(r!=null)throw Error(b(91));break;default:r!==c&&Ke(e,t,d,r,s,c)}Lr(e,w,N);return;case"option":for(var Ee in n)if(w=n[Ee],n.hasOwnProperty(Ee)&&w!=null&&!s.hasOwnProperty(Ee))switch(Ee){case"selected":e.selected=!1;break;default:Ke(e,t,Ee,null,s,w)}for(y in s)if(w=s[y],N=n[y],s.hasOwnProperty(y)&&w!==N&&(w!=null||N!=null))switch(y){case"selected":e.selected=w&&typeof w!="function"&&typeof w!="symbol";break;default:Ke(e,t,y,w,s,N)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ae in n)w=n[Ae],n.hasOwnProperty(Ae)&&w!=null&&!s.hasOwnProperty(Ae)&&Ke(e,t,Ae,null,s,w);for(M in s)if(w=s[M],N=n[M],s.hasOwnProperty(M)&&w!==N&&(w!=null||N!=null))switch(M){case"children":case"dangerouslySetInnerHTML":if(w!=null)throw Error(b(137,t));break;default:Ke(e,t,M,w,s,N)}return;default:if(ps(t)){for(var Je in n)w=n[Je],n.hasOwnProperty(Je)&&w!==void 0&&!s.hasOwnProperty(Je)&&Du(e,t,Je,void 0,s,w);for(k in s)w=s[k],N=n[k],!s.hasOwnProperty(k)||w===N||w===void 0&&N===void 0||Du(e,t,k,w,s,N);return}}for(var T in n)w=n[T],n.hasOwnProperty(T)&&w!=null&&!s.hasOwnProperty(T)&&Ke(e,t,T,null,s,w);for(z in s)w=s[z],N=n[z],!s.hasOwnProperty(z)||w===N||w==null&&N==null||Ke(e,t,z,w,s,N)}var ku=null,Lu=null;function nc(e){return e.nodeType===9?e:e.ownerDocument}function sd(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ld(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function ju(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Bu=null;function wg(){var e=window.event;return e&&e.type==="popstate"?e===Bu?!1:(Bu=e,!0):(Bu=null,!1)}var rd=typeof setTimeout=="function"?setTimeout:void 0,Ng=typeof clearTimeout=="function"?clearTimeout:void 0,od=typeof Promise=="function"?Promise:void 0,xg=typeof queueMicrotask=="function"?queueMicrotask:typeof od<"u"?function(e){return od.resolve(null).then(e).catch(Ug)}:rd;function Ug(e){setTimeout(function(){throw e})}function _a(e){return e==="head"}function cd(e,t){var n=t,s=0,r=0;do{var c=n.nextSibling;if(e.removeChild(n),c&&c.nodeType===8)if(n=c.data,n==="/$"){if(0<s&&8>s){n=s;var d=e.ownerDocument;if(n&1&&fr(d.documentElement),n&2&&fr(d.body),n&4)for(n=d.head,fr(n),d=n.firstChild;d;){var g=d.nextSibling,y=d.nodeName;d[La]||y==="SCRIPT"||y==="STYLE"||y==="LINK"&&d.rel.toLowerCase()==="stylesheet"||n.removeChild(d),d=g}}if(r===0){e.removeChild(c),br(t);return}r--}else n==="$"||n==="$?"||n==="$!"?r++:s=n.charCodeAt(0)-48;else s=0;n=c}while(n);br(t)}function qu(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":qu(n),fl(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function Dg(e,t,n,s){for(;e.nodeType===1;){var r=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!s&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(s){if(!e[La])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(c=e.getAttribute("rel"),c==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(c!==r.rel||e.getAttribute("href")!==(r.href==null||r.href===""?null:r.href)||e.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin)||e.getAttribute("title")!==(r.title==null?null:r.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(c=e.getAttribute("src"),(c!==(r.src==null?null:r.src)||e.getAttribute("type")!==(r.type==null?null:r.type)||e.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin))&&c&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var c=r.name==null?null:""+r.name;if(r.type==="hidden"&&e.getAttribute("name")===c)return e}else return e;if(e=zn(e.nextSibling),e===null)break}return null}function kg(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=zn(e.nextSibling),e===null))return null;return e}function Gu(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState==="complete"}function Lg(e,t){var n=e.ownerDocument;if(e.data!=="$?"||n.readyState==="complete")t();else{var s=function(){t(),n.removeEventListener("DOMContentLoaded",s)};n.addEventListener("DOMContentLoaded",s),e._reactRetry=s}}function zn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="F!"||t==="F")break;if(t==="/$")return null}}return e}var zu=null;function ud(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}function fd(e,t,n){switch(t=nc(n),e){case"html":if(e=t.documentElement,!e)throw Error(b(452));return e;case"head":if(e=t.head,!e)throw Error(b(453));return e;case"body":if(e=t.body,!e)throw Error(b(454));return e;default:throw Error(b(451))}}function fr(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);fl(e)}var An=new Map,hd=new Set;function ic(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var ji=G.d;G.d={f:jg,r:Bg,D:qg,C:Gg,L:zg,m:Hg,X:Ig,S:Vg,M:Yg};function jg(){var e=ji.f(),t=Zo();return e||t}function Bg(e){var t=ui(e);t!==null&&t.tag===5&&t.type==="form"?Uf(t):ji.r(e)}var Fs=typeof document>"u"?null:document;function dd(e,t,n){var s=Fs;if(s&&typeof t=="string"&&t){var r=Jt(t);r='link[rel="'+e+'"][href="'+r+'"]',typeof n=="string"&&(r+='[crossorigin="'+n+'"]'),hd.has(r)||(hd.add(r),e={rel:e,crossOrigin:n,href:t},s.querySelector(r)===null&&(t=s.createElement("link"),qt(t,"link",e),yt(t),s.head.appendChild(t)))}}function qg(e){ji.D(e),dd("dns-prefetch",e,null)}function Gg(e,t){ji.C(e,t),dd("preconnect",e,t)}function zg(e,t,n){ji.L(e,t,n);var s=Fs;if(s&&e&&t){var r='link[rel="preload"][as="'+Jt(t)+'"]';t==="image"&&n&&n.imageSrcSet?(r+='[imagesrcset="'+Jt(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(r+='[imagesizes="'+Jt(n.imageSizes)+'"]')):r+='[href="'+Jt(e)+'"]';var c=r;switch(t){case"style":c=el(e);break;case"script":c=tl(e)}An.has(c)||(e=Q({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),An.set(c,e),s.querySelector(r)!==null||t==="style"&&s.querySelector(hr(c))||t==="script"&&s.querySelector(dr(c))||(t=s.createElement("link"),qt(t,"link",e),yt(t),s.head.appendChild(t)))}}function Hg(e,t){ji.m(e,t);var n=Fs;if(n&&e){var s=t&&typeof t.as=="string"?t.as:"script",r='link[rel="modulepreload"][as="'+Jt(s)+'"][href="'+Jt(e)+'"]',c=r;switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":c=tl(e)}if(!An.has(c)&&(e=Q({rel:"modulepreload",href:e},t),An.set(c,e),n.querySelector(r)===null)){switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(dr(c)))return}s=n.createElement("link"),qt(s,"link",e),yt(s),n.head.appendChild(s)}}}function Vg(e,t,n){ji.S(e,t,n);var s=Fs;if(s&&e){var r=Qi(s).hoistableStyles,c=el(e);t=t||"default";var d=r.get(c);if(!d){var g={loading:0,preload:null};if(d=s.querySelector(hr(c)))g.loading=5;else{e=Q({rel:"stylesheet",href:e,"data-precedence":t},n),(n=An.get(c))&&Hu(e,n);var y=d=s.createElement("link");yt(y),qt(y,"link",e),y._p=new Promise(function(M,k){y.onload=M,y.onerror=k}),y.addEventListener("load",function(){g.loading|=1}),y.addEventListener("error",function(){g.loading|=2}),g.loading|=4,ac(d,t,s)}d={type:"stylesheet",instance:d,count:1,state:g},r.set(c,d)}}}function Ig(e,t){ji.X(e,t);var n=Fs;if(n&&e){var s=Qi(n).hoistableScripts,r=tl(e),c=s.get(r);c||(c=n.querySelector(dr(r)),c||(e=Q({src:e,async:!0},t),(t=An.get(r))&&Vu(e,t),c=n.createElement("script"),yt(c),qt(c,"link",e),n.head.appendChild(c)),c={type:"script",instance:c,count:1,state:null},s.set(r,c))}}function Yg(e,t){ji.M(e,t);var n=Fs;if(n&&e){var s=Qi(n).hoistableScripts,r=tl(e),c=s.get(r);c||(c=n.querySelector(dr(r)),c||(e=Q({src:e,async:!0,type:"module"},t),(t=An.get(r))&&Vu(e,t),c=n.createElement("script"),yt(c),qt(c,"link",e),n.head.appendChild(c)),c={type:"script",instance:c,count:1,state:null},s.set(r,c))}}function gd(e,t,n,s){var r=(r=Te.current)?ic(r):null;if(!r)throw Error(b(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=el(n.href),n=Qi(r).hoistableStyles,s=n.get(t),s||(s={type:"style",instance:null,count:0,state:null},n.set(t,s)),s):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=el(n.href);var c=Qi(r).hoistableStyles,d=c.get(e);if(d||(r=r.ownerDocument||r,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},c.set(e,d),(c=r.querySelector(hr(e)))&&!c._p&&(d.instance=c,d.state.loading=5),An.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},An.set(e,n),c||Pg(r,e,n,d.state))),t&&s===null)throw Error(b(528,""));return d}if(t&&s!==null)throw Error(b(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=tl(n),n=Qi(r).hoistableScripts,s=n.get(t),s||(s={type:"script",instance:null,count:0,state:null},n.set(t,s)),s):{type:"void",instance:null,count:0,state:null};default:throw Error(b(444,e))}}function el(e){return'href="'+Jt(e)+'"'}function hr(e){return'link[rel="stylesheet"]['+e+"]"}function md(e){return Q({},e,{"data-precedence":e.precedence,precedence:null})}function Pg(e,t,n,s){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?s.loading=1:(t=e.createElement("link"),s.preload=t,t.addEventListener("load",function(){return s.loading|=1}),t.addEventListener("error",function(){return s.loading|=2}),qt(t,"link",n),yt(t),e.head.appendChild(t))}function tl(e){return'[src="'+Jt(e)+'"]'}function dr(e){return"script[async]"+e}function pd(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var s=e.querySelector('style[data-href~="'+Jt(n.href)+'"]');if(s)return t.instance=s,yt(s),s;var r=Q({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return s=(e.ownerDocument||e).createElement("style"),yt(s),qt(s,"style",r),ac(s,n.precedence,e),t.instance=s;case"stylesheet":r=el(n.href);var c=e.querySelector(hr(r));if(c)return t.state.loading|=4,t.instance=c,yt(c),c;s=md(n),(r=An.get(r))&&Hu(s,r),c=(e.ownerDocument||e).createElement("link"),yt(c);var d=c;return d._p=new Promise(function(g,y){d.onload=g,d.onerror=y}),qt(c,"link",s),t.state.loading|=4,ac(c,n.precedence,e),t.instance=c;case"script":return c=tl(n.src),(r=e.querySelector(dr(c)))?(t.instance=r,yt(r),r):(s=n,(r=An.get(c))&&(s=Q({},n),Vu(s,r)),e=e.ownerDocument||e,r=e.createElement("script"),yt(r),qt(r,"link",s),e.head.appendChild(r),t.instance=r);case"void":return null;default:throw Error(b(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(s=t.instance,t.state.loading|=4,ac(s,n.precedence,e));return t.instance}function ac(e,t,n){for(var s=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),r=s.length?s[s.length-1]:null,c=r,d=0;d<s.length;d++){var g=s[d];if(g.dataset.precedence===t)c=g;else if(c!==r)break}c?c.parentNode.insertBefore(e,c.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function Hu(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Vu(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var sc=null;function yd(e,t,n){if(sc===null){var s=new Map,r=sc=new Map;r.set(n,s)}else r=sc,s=r.get(n),s||(s=new Map,r.set(n,s));if(s.has(e))return s;for(s.set(e,null),n=n.getElementsByTagName(e),r=0;r<n.length;r++){var c=n[r];if(!(c[La]||c[Tt]||e==="link"&&c.getAttribute("rel")==="stylesheet")&&c.namespaceURI!=="http://www.w3.org/2000/svg"){var d=c.getAttribute(t)||"";d=e+d;var g=s.get(d);g?g.push(c):s.set(d,[c])}}return s}function vd(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function Qg(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function bd(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}var gr=null;function Xg(){}function Zg(e,t,n){if(gr===null)throw Error(b(475));var s=gr;if(t.type==="stylesheet"&&(typeof n.media!="string"||matchMedia(n.media).matches!==!1)&&(t.state.loading&4)===0){if(t.instance===null){var r=el(n.href),c=e.querySelector(hr(r));if(c){e=c._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(s.count++,s=lc.bind(s),e.then(s,s)),t.state.loading|=4,t.instance=c,yt(c);return}c=e.ownerDocument||e,n=md(n),(r=An.get(r))&&Hu(n,r),c=c.createElement("link"),yt(c);var d=c;d._p=new Promise(function(g,y){d.onload=g,d.onerror=y}),qt(c,"link",n),t.instance=c}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(t,e),(e=t.state.preload)&&(t.state.loading&3)===0&&(s.count++,t=lc.bind(s),e.addEventListener("load",t),e.addEventListener("error",t))}}function Kg(){if(gr===null)throw Error(b(475));var e=gr;return e.stylesheets&&e.count===0&&Iu(e,e.stylesheets),0<e.count?function(t){var n=setTimeout(function(){if(e.stylesheets&&Iu(e,e.stylesheets),e.unsuspend){var s=e.unsuspend;e.unsuspend=null,s()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}function lc(){if(this.count--,this.count===0){if(this.stylesheets)Iu(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var rc=null;function Iu(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,rc=new Map,t.forEach(Jg,e),rc=null,lc.call(e))}function Jg(e,t){if(!(t.state.loading&4)){var n=rc.get(e);if(n)var s=n.get(null);else{n=new Map,rc.set(e,n);for(var r=e.querySelectorAll("link[data-precedence],style[data-precedence]"),c=0;c<r.length;c++){var d=r[c];(d.nodeName==="LINK"||d.getAttribute("media")!=="not all")&&(n.set(d.dataset.precedence,d),s=d)}s&&n.set(null,s)}r=t.instance,d=r.getAttribute("data-precedence"),c=n.get(d)||s,c===s&&n.set(null,r),n.set(d,r),this.count++,s=lc.bind(this),r.addEventListener("load",s),r.addEventListener("error",s),c?c.parentNode.insertBefore(r,c.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(r,e.firstChild)),t.state.loading|=4}}var mr={$$typeof:se,Provider:null,Consumer:null,_currentValue:me,_currentValue2:me,_threadCount:0};function Wg(e,t,n,s,r,c,d,g){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=pt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pt(0),this.hiddenUpdates=pt(null),this.identifierPrefix=s,this.onUncaughtError=r,this.onCaughtError=c,this.onRecoverableError=d,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=g,this.incompleteTransitions=new Map}function Sd(e,t,n,s,r,c,d,g,y,M,k,z){return e=new Wg(e,t,n,d,g,y,M,z),t=1,c===!0&&(t|=24),c=Pt(3,null,null,t),e.current=c,c.stateNode=e,t=Fn(),t.refCount++,e.pooledCache=t,t.refCount++,c.memoizedState={element:s,isDehydrated:n,cache:t},Ls(c),e}function Ad(e){return e?(e=Oi,e):Oi}function Od(e,t,n,s,r,c){r=Ad(r),s.context===null?s.context=r:s.pendingContext=r,s=ti(t),s.payload={element:n},c=c===void 0?null:c,c!==null&&(s.callback=c),n=ni(e,s,t),n!==null&&(hn(n,e,t),es(n,e,t))}function Td(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Yu(e,t){Td(e,t),(e=e.alternate)&&Td(e,t)}function Rd(e){if(e.tag===13){var t=ia(e,67108864);t!==null&&hn(t,e,67108864),Yu(e,67108864)}}var oc=!0;function $g(e,t,n,s){var r=D.T;D.T=null;var c=G.p;try{G.p=2,Pu(e,t,n,s)}finally{G.p=c,D.T=r}}function Fg(e,t,n,s){var r=D.T;D.T=null;var c=G.p;try{G.p=8,Pu(e,t,n,s)}finally{G.p=c,D.T=r}}function Pu(e,t,n,s){if(oc){var r=Qu(s);if(r===null)Uu(e,t,s,cc,n),_d(e,s);else if(tm(r,e,t,n,s))s.stopPropagation();else if(_d(e,s),t&4&&-1<em.indexOf(e)){for(;r!==null;){var c=ui(r);if(c!==null)switch(c.tag){case 3:if(c=c.stateNode,c.current.memoizedState.isDehydrated){var d=Tn(c.pendingLanes);if(d!==0){var g=c;for(g.pendingLanes|=2,g.entangledLanes|=2;d;){var y=1<<31-et(d);g.entanglements[1]|=y,d&=~y}ci(c),(Pe&6)===0&&(Qo=X()+500,or(0))}}break;case 13:g=ia(c,2),g!==null&&hn(g,c,2),Zo(),Yu(c,2)}if(c=Qu(s),c===null&&Uu(e,t,s,cc,n),c===r)break;r=c}r!==null&&s.stopPropagation()}else Uu(e,t,s,null,n)}}function Qu(e){return e=ja(e),Xu(e)}var cc=null;function Xu(e){if(cc=null,e=Cn(e),e!==null){var t=ne(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=de(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return cc=e,null}function Cd(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Z()){case ce:return 2;case ue:return 8;case te:case ct:return 32;case Dt:return 268435456;default:return 32}default:return 32}}var Zu=!1,Ea=null,Ma=null,wa=null,pr=new Map,yr=new Map,Na=[],em="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function _d(e,t){switch(e){case"focusin":case"focusout":Ea=null;break;case"dragenter":case"dragleave":Ma=null;break;case"mouseover":case"mouseout":wa=null;break;case"pointerover":case"pointerout":pr.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":yr.delete(t.pointerId)}}function vr(e,t,n,s,r,c){return e===null||e.nativeEvent!==c?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:c,targetContainers:[r]},t!==null&&(t=ui(t),t!==null&&Rd(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,r!==null&&t.indexOf(r)===-1&&t.push(r),e)}function tm(e,t,n,s,r){switch(t){case"focusin":return Ea=vr(Ea,e,t,n,s,r),!0;case"dragenter":return Ma=vr(Ma,e,t,n,s,r),!0;case"mouseover":return wa=vr(wa,e,t,n,s,r),!0;case"pointerover":var c=r.pointerId;return pr.set(c,vr(pr.get(c)||null,e,t,n,s,r)),!0;case"gotpointercapture":return c=r.pointerId,yr.set(c,vr(yr.get(c)||null,e,t,n,s,r)),!0}return!1}function Ed(e){var t=Cn(e.target);if(t!==null){var n=ne(t);if(n!==null){if(t=n.tag,t===13){if(t=de(n),t!==null){e.blockedOn=t,Nr(e.priority,function(){if(n.tag===13){var s=fn();s=rl(s);var r=ia(n,s);r!==null&&hn(r,n,s),Yu(n,s)}});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function uc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qu(e.nativeEvent);if(n===null){n=e.nativeEvent;var s=new n.constructor(n.type,n);vs=s,n.target.dispatchEvent(s),vs=null}else return t=ui(n),t!==null&&Rd(t),e.blockedOn=n,!1;t.shift()}return!0}function Md(e,t,n){uc(e)&&n.delete(t)}function nm(){Zu=!1,Ea!==null&&uc(Ea)&&(Ea=null),Ma!==null&&uc(Ma)&&(Ma=null),wa!==null&&uc(wa)&&(wa=null),pr.forEach(Md),yr.forEach(Md)}function fc(e,t){e.blockedOn===t&&(e.blockedOn=null,Zu||(Zu=!0,E.unstable_scheduleCallback(E.unstable_NormalPriority,nm)))}var hc=null;function wd(e){hc!==e&&(hc=e,E.unstable_scheduleCallback(E.unstable_NormalPriority,function(){hc===e&&(hc=null);for(var t=0;t<e.length;t+=3){var n=e[t],s=e[t+1],r=e[t+2];if(typeof s!="function"){if(Xu(s||n)===null)continue;break}var c=ui(n);c!==null&&(e.splice(t,3),t-=3,Xc(c,{pending:!0,data:r,method:n.method,action:s},s,r))}}))}function br(e){function t(y){return fc(y,e)}Ea!==null&&fc(Ea,e),Ma!==null&&fc(Ma,e),wa!==null&&fc(wa,e),pr.forEach(t),yr.forEach(t);for(var n=0;n<Na.length;n++){var s=Na[n];s.blockedOn===e&&(s.blockedOn=null)}for(;0<Na.length&&(n=Na[0],n.blockedOn===null);)Ed(n),n.blockedOn===null&&Na.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(s=0;s<n.length;s+=3){var r=n[s],c=n[s+1],d=r[kt]||null;if(typeof c=="function")d||wd(n);else if(d){var g=null;if(c&&c.hasAttribute("formAction")){if(r=c,d=c[kt]||null)g=d.formAction;else if(Xu(r)!==null)continue}else g=d.action;typeof g=="function"?n[s+1]=g:(n.splice(s,3),s-=3),wd(n)}}}function Ku(e){this._internalRoot=e}dc.prototype.render=Ku.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(b(409));var n=t.current,s=fn();Od(n,s,e,t,null,null)},dc.prototype.unmount=Ku.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Od(e.current,2,null,e,null,null),Zo(),t[Pi]=null}};function dc(e){this._internalRoot=e}dc.prototype.unstable_scheduleHydration=function(e){if(e){var t=cl();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Na.length&&t!==0&&t<Na[n].priority;n++);Na.splice(n,0,e),n===0&&Ed(e)}};var Nd=Y.version;if(Nd!=="19.1.0")throw Error(b(527,Nd,"19.1.0"));G.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(b(188)):(e=Object.keys(e).join(","),Error(b(268,e)));return e=V(t),e=e!==null?x(e):null,e=e===null?null:e.stateNode,e};var im={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:D,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gc.isDisabled&&gc.supportsFiber)try{Vn=gc.inject(im),Xe=gc}catch{}}return Ar.createRoot=function(e,t){if(!$(e))throw Error(b(299));var n=!1,s="",r=Qf,c=Xf,d=Zf,g=null;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onUncaughtError!==void 0&&(r=t.onUncaughtError),t.onCaughtError!==void 0&&(c=t.onCaughtError),t.onRecoverableError!==void 0&&(d=t.onRecoverableError),t.unstable_transitionCallbacks!==void 0&&(g=t.unstable_transitionCallbacks)),t=Sd(e,1,!1,null,null,n,s,r,c,d,g,null),e[Pi]=t.current,xu(e),new Ku(t)},Ar.hydrateRoot=function(e,t,n){if(!$(e))throw Error(b(299));var s=!1,r="",c=Qf,d=Xf,g=Zf,y=null,M=null;return n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(r=n.identifierPrefix),n.onUncaughtError!==void 0&&(c=n.onUncaughtError),n.onCaughtError!==void 0&&(d=n.onCaughtError),n.onRecoverableError!==void 0&&(g=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(y=n.unstable_transitionCallbacks),n.formState!==void 0&&(M=n.formState)),t=Sd(e,1,!0,t,n??null,s,r,c,d,g,y,M),t.context=Ad(null),n=t.current,s=fn(),s=rl(s),r=ti(s),r.callback=null,ni(n,r,s),n=s,t.current.lanes=n,Yi(t,n),ci(t),e[Pi]=t.current,xu(e),new dc(t)},Ar.version="19.1.0",Ar}var zd;function dm(){if(zd)return $u.exports;zd=1;function E(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(E)}catch(Y){console.error(Y)}}return E(),$u.exports=hm(),$u.exports}var gm=dm();const nl=(E,Y)=>{const[P,b]=At.useState(()=>{const $=localStorage.getItem(E);if($)try{return JSON.parse($)}catch(ne){console.error(`Error loading ${E} from localStorage:`,ne)}return Y});return At.useEffect(()=>{localStorage.setItem(E,JSON.stringify(P))},[E,P]),[P,b]};var mc={exports:{}};/*@license Copyright 2015-2022 Ably Real-time Ltd (ably.com)

Ably JavaScript Library v2.10.0
https://github.com/ably/ably-js

Released under the Apache Licence v2.0*/var mm=mc.exports,Hd;function pm(){return Hd||(Hd=1,function(E,Y){(function(P,b){E.exports=b()})(mm,()=>{var P={},b={exports:P},$=Object.defineProperty,ne=Object.defineProperties,de=Object.getOwnPropertyDescriptor,ee=Object.getOwnPropertyDescriptors,V=Object.getOwnPropertyNames,x=Object.getOwnPropertySymbols,Q=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable,le=(i,a,l)=>a in i?$(i,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):i[a]=l,H=(i,a)=>{for(var l in a||(a={}))Q.call(a,l)&&le(i,l,a[l]);if(x)for(var l of x(a))he.call(a,l)&&le(i,l,a[l]);return i},ye=(i,a)=>ne(i,ee(a)),Oe=(i,a)=>{var l={};for(var o in i)Q.call(i,o)&&a.indexOf(o)<0&&(l[o]=i[o]);if(i!=null&&x)for(var o of x(i))a.indexOf(o)<0&&he.call(i,o)&&(l[o]=i[o]);return l},ge=(i,a)=>{for(var l in a)$(i,l,{get:a[l],enumerable:!0})},re=(i,a,l,o)=>{if(a&&typeof a=="object"||typeof a=="function")for(let u of V(a))!Q.call(i,u)&&u!==l&&$(i,u,{get:()=>a[u],enumerable:!(o=de(a,u))||o.enumerable});return i},be=i=>re($({},"__esModule",{value:!0}),i),se={};ge(se,{ErrorInfo:()=>U,Realtime:()=>Dn,Rest:()=>Ms,default:()=>xo,makeProtocolMessageFromDeserialized:()=>Ml,msgpack:()=>Mi}),b.exports=be(se);var R=class{},J=typeof globalThis<"u"?globalThis:typeof window<"u"?window:self;function nt(i,a){return`${i}`.padStart(a?3:2,"0")}function mt(i){return R.Config.logTimestamps?function(a){const l=new Date;i(nt(l.getHours())+":"+nt(l.getMinutes())+":"+nt(l.getSeconds())+"."+nt(l.getMilliseconds(),1)+" "+a)}:function(a){i(a)}}var Ot=()=>{var i;let a,l;return typeof((i=J?.console)==null?void 0:i.log)=="function"?(a=function(...o){console.log.apply(console,o)},l=console.warn?function(...o){console.warn.apply(console,o)}:a):a=l=function(){},[a,l].map(mt)},lt=class Or{constructor(){this.deprecated=(a,l)=>{this.deprecationWarning(`${a} is deprecated and will be removed in a future version. ${l}`)},this.shouldLog=a=>a<=this.logLevel,this.setLog=(a,l)=>{a!==void 0&&(this.logLevel=a),l!==void 0&&(this.logHandler=this.logErrorHandler=l)},this.logLevel=Or.defaultLogLevel,this.logHandler=Or.defaultLogHandler,this.logErrorHandler=Or.defaultLogErrorHandler}static initLogHandlers(){const[a,l]=Ot();this.defaultLogHandler=a,this.defaultLogErrorHandler=l,this.defaultLogger=new Or}static logActionNoStrip(a,l,o,u){a.logAction(l,o,u)}logAction(a,l,o){this.shouldLog(a)&&(a===1?this.logErrorHandler:this.logHandler)("Ably: "+l+": "+o,a)}renamedClientOption(a,l){this.deprecationWarning(`The \`${a}\` client option has been renamed to \`${l}\`. Please update your code to use \`${l}\` instead. \`${a}\` will be removed in a future version.`)}renamedMethod(a,l,o){this.deprecationWarning(`\`${a}\`’s \`${l}\` method has been renamed to \`${o}\`. Please update your code to use \`${o}\` instead. \`${l}\` will be removed in a future version.`)}deprecationWarning(a){this.shouldLog(1)&&this.logErrorHandler(`Ably: Deprecation warning - ${a}`,1)}};lt.defaultLogLevel=1,lt.LOG_NONE=0,lt.LOG_ERROR=1,lt.LOG_MAJOR=2,lt.LOG_MINOR=3,lt.LOG_MICRO=4,lt.logAction=(i,a,l,o)=>{lt.logActionNoStrip(i,a,l,o)};var Hn=lt,h=Hn,qe={};ge(qe,{Format:()=>cs,allSame:()=>os,allToLowerCase:()=>sl,allToUpperCase:()=>_r,arrChooseN:()=>Vn,arrDeleteValue:()=>Bi,arrEquals:()=>ll,arrIntersect:()=>Ye,arrIntersectOb:()=>ln,arrPopRandomElement:()=>X,arrWithoutValue:()=>qi,cheapRandStr:()=>dn,containsValue:()=>Te,copy:()=>me,createMissingPluginError:()=>ka,dataSizeBytes:()=>Dt,decodeBody:()=>ut,encodeBody:()=>et,ensureArray:()=>Ge,forInOwnNonNullProperties:()=>zi,getBackoffCoefficient:()=>Er,getGlobalObject:()=>Tn,getJitterCoefficient:()=>Ua,getRetryTime:()=>Vi,inherits:()=>ke,inspectBody:()=>ct,inspectError:()=>te,intersect:()=>Et,isEmpty:()=>I,isErrorInfoOrPartialErrorInfo:()=>ue,isNil:()=>W,isObject:()=>S,keysArray:()=>On,matchDerivedChannel:()=>Ii,mixin:()=>G,parseQueryString:()=>ce,prototypicalClone:()=>ve,randomString:()=>Hi,shallowClone:()=>F,shallowEquals:()=>Da,throwMissingPluginError:()=>pt,toBase64:()=>us,toQueryString:()=>Z,valuesArray:()=>Gi,whenPromiseSettles:()=>Xe,withTimeoutAsync:()=>Yi});function Xt(i){let a="["+i.constructor.name;return i.message&&(a+=": "+i.message),i.statusCode&&(a+="; statusCode="+i.statusCode),i.code&&(a+="; code="+i.code),i.cause&&(a+="; cause="+te(i.cause)),i.href&&!(i.message&&i.message.indexOf("help.ably.io")>-1)&&(a+="; see "+i.href+" "),a+="]",a}var U=class af extends Error{constructor(a,l,o,u){super(a),typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(this,af.prototype),this.code=l,this.statusCode=o,this.cause=u}toString(){return Xt(this)}static fromValues(a){const{message:l,code:o,statusCode:u}=a;if(typeof l!="string"||typeof o!="number"||typeof u!="number")throw new Error("ErrorInfo.fromValues(): invalid values: "+R.Config.inspect(a));const f=Object.assign(new af(l,o,u),a);return f.code&&!f.href&&(f.href="https://help.ably.io/error/"+f.code),f}},Le=class sf extends Error{constructor(a,l,o,u){super(a),typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(this,sf.prototype),this.code=l,this.statusCode=o,this.cause=u}toString(){return Xt(this)}static fromValues(a){const{message:l,code:o,statusCode:u}=a;if(typeof l!="string"||!W(o)&&typeof o!="number"||!W(u)&&typeof u!="number")throw new Error("PartialErrorInfo.fromValues(): invalid values: "+R.Config.inspect(a));const f=Object.assign(new sf(l,o,u),a);return f.code&&!f.href&&(f.href="https://help.ably.io/error/"+f.code),f}};function D(i){return Math.floor(Math.random()*i.length)}function G(i,...a){for(let l=0;l<a.length;l++){const o=a[l];if(!o)break;for(const u in o)Object.prototype.hasOwnProperty.call(o,u)&&(i[u]=o[u])}return i}function me(i){return G({},i)}function Ge(i){return W(i)?[]:Array.isArray(i)?i:[i]}function S(i){return Object.prototype.toString.call(i)=="[object Object]"}function I(i){for(const a in i)return!1;return!0}function W(i){return i==null}function F(i){const a=new Object;for(const l in i)a[l]=i[l];return a}function ve(i,a){class l{}l.prototype=i;const o=new l;return a&&G(o,a),o}var ke=function(i,a){if(R.Config.inherits){R.Config.inherits(i,a);return}i.super_=a,i.prototype=ve(a.prototype,{constructor:i})};function Te(i,a){for(const l in i)if(i[l]==a)return!0;return!1}function Et(i,a){return Array.isArray(a)?Ye(i,a):ln(i,a)}function Ye(i,a){const l=[];for(let o=0;o<i.length;o++){const u=i[o];a.indexOf(u)!=-1&&l.push(u)}return l}function ln(i,a){const l=[];for(let o=0;o<i.length;o++){const u=i[o];u in a&&l.push(u)}return l}function Bi(i,a){const l=i.indexOf(a),o=l!=-1;return o&&i.splice(l,1),o}function qi(i,a){const l=i.slice();return Bi(l,a),l}function On(i,a){const l=[];for(const o in i)a&&!Object.prototype.hasOwnProperty.call(i,o)||l.push(o);return l}function Gi(i,a){const l=[];for(const o in i)a&&!Object.prototype.hasOwnProperty.call(i,o)||l.push(i[o]);return l}function zi(i,a){for(const l in i)Object.prototype.hasOwnProperty.call(i,l)&&i[l]&&a(l)}function os(i,a){if(i.length===0)return!0;const l=i[0][a];return i.every(function(o){return o[a]===l})}var cs=(i=>(i.msgpack="msgpack",i.json="json",i))(cs||{});function X(i){return i.splice(D(i),1)[0]}function Z(i){const a=[];if(i)for(const l in i)a.push(encodeURIComponent(l)+"="+encodeURIComponent(i[l]));return a.length?"?"+a.join("&"):""}function ce(i){let a;const l=/([^?&=]+)=?([^&]*)/g,o={};for(;a=l.exec(i);)o[decodeURIComponent(a[1])]=decodeURIComponent(a[2]);return o}function ue(i){return typeof i=="object"&&i!==null&&(i instanceof U||i instanceof Le)}function te(i){var a,l;return i instanceof Error||((a=i?.constructor)==null?void 0:a.name)==="ErrorInfo"||((l=i?.constructor)==null?void 0:l.name)==="PartialErrorInfo"?i.toString():R.Config.inspect(i)}function ct(i){return R.BufferUtils.isBuffer(i)?i.toString():typeof i=="string"?i:R.Config.inspect(i)}function Dt(i){if(R.BufferUtils.isBuffer(i))return R.BufferUtils.byteLength(i);if(typeof i=="string")return R.Config.stringByteSize(i);if(typeof i=="number")return 8;if(typeof i=="boolean")return 1;throw new Error(`Expected input of Utils.dataSizeBytes to be a string, a number, a boolean or a buffer, but was: ${typeof i}`)}function dn(){return String(Math.random()).substr(2)}var Hi=async i=>{const a=await R.Config.getRandomArrayBuffer(i);return R.BufferUtils.base64Encode(a)};function Vn(i,a){const l=Math.min(a,i.length),o=i.slice(),u=[];for(let f=0;f<l;f++)u.push(X(o));return u}function Xe(i,a){i.then(l=>{a?.(null,l)}).catch(l=>{a?.(l)})}function ut(i,a,l){return l=="msgpack"?(a||pt("MsgPack"),a.decode(i)):JSON.parse(String(i))}function et(i,a,l){return l=="msgpack"?(a||pt("MsgPack"),a.encode(i,!0)):JSON.stringify(i)}function sl(i){return i.map(function(a){return a&&a.toLowerCase()})}function _r(i){return i.map(function(a){return a&&a.toUpperCase()})}function Er(i){return Math.min((i+2)/3,2)}function Ua(){return 1-Math.random()*.2}function Vi(i,a){return i*Er(a)*Ua()}function Tn(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:self}function Da(i,a){return Object.keys(i).every(l=>i[l]===a[l])&&Object.keys(a).every(l=>a[l]===i[l])}function Ii(i){const a=/^(\[([^?]*)(?:(.*))\])?(.+)$/,l=i.match(a);if(!l||!l.length||l.length<5)throw new U("regex match failed",400,40010);if(l[2])throw new U(`cannot use a derived option with a ${l[2]} channel`,400,40010);return{qualifierParam:l[3]||"",channelName:l[4]}}function us(i){const a=R.BufferUtils,l=a.utf8Encode(i);return a.base64Encode(l)}function ll(i,a){return i.length===a.length&&i.every(function(l,o){return l===a[o]})}function ka(i){return new U(`${i} plugin not provided`,40019,400)}function pt(i){throw ka(i)}async function Yi(i,a=5e3,l="Timeout expired"){const o=new U(l,5e4,500);return Promise.race([i,new Promise((u,f)=>setTimeout(()=>f(o),a))])}var Mr="2.10.0",wr="ably-js/"+Mr,Zt={ENDPOINT:"main",ENVIRONMENT:"",REST_HOST:"rest.ably.io",REALTIME_HOST:"realtime.ably.io",FALLBACK_HOSTS:["main.a.fallback.ably-realtime.com","main.b.fallback.ably-realtime.com","main.c.fallback.ably-realtime.com","main.d.fallback.ably-realtime.com","main.e.fallback.ably-realtime.com"],PORT:80,TLS_PORT:443,TIMEOUTS:{disconnectedRetryTimeout:15e3,suspendedRetryTimeout:3e4,httpRequestTimeout:1e4,httpMaxRetryDuration:15e3,channelRetryTimeout:15e3,fallbackRetryTimeout:6e5,connectionStateTtl:12e4,realtimeRequestTimeout:1e4,recvTimeout:9e4,webSocketConnectTimeout:1e4,webSocketSlowTimeout:4e3},httpMaxRetryCount:3,maxMessageSize:65536,version:Mr,protocolVersion:3,agent:wr,getPort:rl,getHttpScheme:ol,getPrimaryDomainFromEndpoint:Nr,getEndpointFallbackHosts:Rn,getFallbackHosts:kt,getHosts:Pi,checkHost:fs,objectifyOptions:xr,normaliseOptions:fl,defaultGetHeaders:Qi,defaultPostHeaders:yt};function rl(i,a){return a||i.tls?i.tlsPort:i.port}function ol(i){return i.tls?"https://":"http://"}function cl(i){return i.includes(".")||i.includes("::")||i==="localhost"}function Nr(i){return cl(i)?i:i.startsWith("nonprod:")?`${i.replace("nonprod:","")}.realtime.ably-nonprod.net`:`${i}.realtime.ably.net`}function Rn(i){if(cl(i))return[];if(i.startsWith("nonprod:")){const a=i.replace("nonprod:","");return Tt(a,"ably-realtime-nonprod.com")}return Tt(i,"ably-realtime.com")}function Tt(i,a){return["a","b","c","d","e"].map(l=>`${i}.${l}.fallback.${a}`)}function kt(i){const a=i.fallbackHosts,l=typeof i.httpMaxRetryCount<"u"?i.httpMaxRetryCount:Zt.httpMaxRetryCount;return a?Vn(a,l):[]}function Pi(i){return[i.primaryDomain].concat(kt(i))}function fs(i){if(typeof i!="string")throw new U("host must be a string; was a "+typeof i,4e4,400);if(!i.length)throw new U("host must not be zero-length",4e4,400)}function yc(i){const a={};for(const l in Zt.TIMEOUTS)a[l]=i[l]||Zt.TIMEOUTS[l];return a}function ul(i){let a=Zt.agent;if(i.agents)for(var l in i.agents)a+=" "+l+"/"+i.agents[l];return a}function xr(i,a,l,o,u){if(i===void 0){const m=a?`${l} must be initialized with either a client options object, an Ably API key, or an Ably Token`:`${l} must be initialized with a client options object`;throw h.logAction(o,h.LOG_ERROR,`${l}()`,m),new Error(m)}let f;if(typeof i=="string")if(i.indexOf(":")==-1){if(!a){const m=`${l} cannot be initialized with just an Ably Token; you must provide a client options object with a \`plugins\` property. (Set this Ably Token as the object’s \`token\` property.)`;throw h.logAction(o,h.LOG_ERROR,`${l}()`,m),new Error(m)}f={token:i}}else{if(!a){const m=`${l} cannot be initialized with just an Ably API key; you must provide a client options object with a \`plugins\` property. (Set this Ably API key as the object’s \`key\` property.)`;throw h.logAction(o,h.LOG_ERROR,`${l}()`,m),new Error(m)}f={key:i}}else f=i;return u&&(f=ye(H({},f),{plugins:H(H({},u),f.plugins)})),f}function La(i){if(i.endpoint&&(i.environment||i.restHost||i.realtimeHost))throw new U("The `endpoint` option cannot be used in conjunction with the `environment`, `restHost`, or `realtimeHost` options.",40106,400);if(i.environment&&(i.restHost||i.realtimeHost))throw new U("The `environment` option cannot be used in conjunction with the `restHost`, or `realtimeHost` options.",40106,400)}function fl(i,a,l){const o=l??h.defaultLogger;i.environment&&o.deprecated("The `environment` client option","Use the `endpoint` client option instead."),i.restHost&&o.deprecated("The `restHost` client option","Use the `endpoint` client option instead."),i.realtimeHost&&o.deprecated("The `realtimeHost` client option","Use the `endpoint` client option instead."),La(i),typeof i.recover=="function"&&i.closeOnUnload===!0&&(h.logAction(o,h.LOG_ERROR,"Defaults.normaliseOptions","closeOnUnload was true and a session recovery function was set - these are mutually exclusive, so unsetting the latter"),i.recover=void 0),"closeOnUnload"in i||(i.closeOnUnload=!i.recover),"queueMessages"in i||(i.queueMessages=!0);const u=i.endpoint||Zt.ENDPOINT;!i.fallbackHosts&&!i.restHost&&!i.realtimeHost&&!i.port&&!i.tlsPort&&(i.fallbackHosts=Rn(i.environment||u));const f=i.environment&&`${i.environment}.realtime.ably.net`,p=i.restHost||i.realtimeHost||f||Nr(u);(i.fallbackHosts||[]).concat(p).forEach(fs),i.port=i.port||Zt.PORT,i.tlsPort=i.tlsPort||Zt.TLS_PORT,"tls"in i||(i.tls=!0);const _=yc(i);a?"useBinaryProtocol"in i?i.useBinaryProtocol=R.Config.supportsBinary&&i.useBinaryProtocol:i.useBinaryProtocol=R.Config.preferBinary:i.useBinaryProtocol=!1;const O={};i.clientId&&(O["X-Ably-ClientId"]=R.BufferUtils.base64Encode(R.BufferUtils.utf8Encode(i.clientId))),"idempotentRestPublishing"in i||(i.idempotentRestPublishing=!0);let L=null,j=i.connectivityCheckUrl;if(i.connectivityCheckUrl){let[B,ie]=i.connectivityCheckUrl.split("?");L=ie?ce(ie):{},B.indexOf("://")===-1&&(B="https://"+B),j=B}let K=i.wsConnectivityCheckUrl;return K&&K.indexOf("://")===-1&&(K="wss://"+K),ye(H({},i),{primaryDomain:p,maxMessageSize:i.maxMessageSize||Zt.maxMessageSize,timeouts:_,connectivityCheckParams:L,connectivityCheckUrl:j,wsConnectivityCheckUrl:K,headers:O})}function Cn(i,a,l){const o=l||{};if(o.cipher){i||pt("Crypto");const u=i.getCipher(o.cipher,a);o.cipher=u.cipherParams,o.channelCipher=u.cipher}else"cipher"in o&&(o.cipher=void 0,o.channelCipher=null);return o}var ui={json:"application/json",xml:"application/xml",html:"text/html",msgpack:"application/x-msgpack",text:"text/plain"},In={format:"json",protocolVersion:Zt.protocolVersion};function Qi(i,{format:a=In.format,protocolVersion:l=In.protocolVersion}={}){return{accept:ui[a],"X-Ably-Version":l.toString(),"Ably-Agent":ul(i)}}function yt(i,{format:a=In.format,protocolVersion:l=In.protocolVersion}={}){let o;return{accept:o=ui[a],"content-type":o,"X-Ably-Version":l.toString(),"Ably-Agent":ul(i)}}var Ce=Zt;function Ur(i){return Object.assign(Zt,i)}var fi=class Pd{constructor(a,l){this.logger=a,this.members=l||[]}call(a,l){for(const o of this.members)if(o)try{o(a,l)}catch(u){h.logAction(this.logger,h.LOG_ERROR,"Multicaster multiple callback handler","Unexpected exception: "+u+"; stack = "+u.stack)}}push(...a){this.members.push(...a)}createPromise(){return new Promise((a,l)=>{this.push((o,u)=>{o?l(o):a(u)})})}resolveAll(a){this.call(null,a)}rejectAll(a){this.call(a)}static create(a,l){const o=new Pd(a,l);return Object.assign((u,f)=>o.call(u,f),{push:u=>o.push(u),createPromise:()=>o.createPromise(),resolveAll:u=>o.resolveAll(u),rejectAll:u=>o.rejectAll(u)})}},Yn=fi,Dr=(i=>(i.Get="get",i.Delete="delete",i.Post="post",i.Put="put",i.Patch="patch",i))(Dr||{}),it=Dr,hl=(i=>(i[i.Success=200]="Success",i[i.NoContent=204]="NoContent",i[i.BadRequest=400]="BadRequest",i[i.Unauthorized=401]="Unauthorized",i[i.Forbidden=403]="Forbidden",i[i.RequestTimeout=408]="RequestTimeout",i[i.InternalServerError=500]="InternalServerError",i))(hl||{});function vc(i){return i>=200&&i<400}var hi=hl,Xi=Math.pow(2,17);function _n(){return("000000"+Math.floor(Math.random()*1e16)).slice(-16)}function dl(i){return!!i.connection}function gl(i){return ue(i)?(i.code||(i.statusCode===403?i.code=40300:(i.code=40170,i.statusCode=401)),i):new U(te(i),i.code||40170,i.statusCode||401)}var Zi=(i,a)=>{const l=R.BufferUtils,o=l.utf8Encode(i),u=l.utf8Encode(a),f=l.hmacSha256(o,u);return l.base64Encode(f)};function hs(i){if(!i)return"";typeof i=="string"&&(i=JSON.parse(i));const a=Object.create(null),l=On(i,!0);if(!l)return"";l.sort();for(let o=0;o<l.length;o++)a[l[o]]=i[l[o]].sort();return JSON.stringify(a)}function ds(i,a){if(i.authCallback)h.logAction(a,h.LOG_MINOR,"Auth()","using token auth with authCallback");else if(i.authUrl)h.logAction(a,h.LOG_MINOR,"Auth()","using token auth with authUrl");else if(i.key)h.logAction(a,h.LOG_MINOR,"Auth()","using token auth with client-side signing");else if(i.tokenDetails)h.logAction(a,h.LOG_MINOR,"Auth()","using token auth with supplied token only");else{const l="authOptions must include valid authentication parameters";throw h.logAction(a,h.LOG_ERROR,"Auth()",l),new Error(l)}}function bc(i){return"useTokenAuth"in i&&!i.useTokenAuth}function ml(i){return i.useTokenAuth||!bc(i)&&(i.authCallback||i.authUrl||i.token||i.tokenDetails)}function Kt(i){return!i.key&&!i.authCallback&&!i.authUrl}var kr=0;function Sc(){return kr++}var gs=class{constructor(i,a){if(this.authOptions={},this.client=i,this.tokenParams=a.defaultTokenParams||{},this.currentTokenRequestId=null,this.waitingForTokenRequest=null,ml(a))Kt(a)&&h.logAction(this.logger,h.LOG_ERROR,"Auth()","Warning: library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),this._saveTokenOptions(a.defaultTokenParams,a),ds(this.authOptions,this.logger);else{if(!a.key){const l="No authentication options provided; need one of: key, authUrl, or authCallback (or for testing only, token or tokenDetails)";throw h.logAction(this.logger,h.LOG_ERROR,"Auth()",l),new U(l,40160,401)}h.logAction(this.logger,h.LOG_MINOR,"Auth()","anonymous, using basic auth"),this._saveBasicOptions(a)}}get logger(){return this.client.logger}async authorize(i,a){if(a&&a.key&&this.authOptions.key!==a.key)throw new U("Unable to update auth options with incompatible key",40102,401);try{let l=await this._forceNewToken(i??null,a??null);return dl(this.client)?new Promise((o,u)=>{this.client.connection.connectionManager.onAuthUpdated(l,(f,m)=>f?u(f):o(m))}):l}catch(l){throw this.client.connection&&l.statusCode===hi.Forbidden&&this.client.connection.connectionManager.actOnErrorFromAuthorize(l),l}}async _forceNewToken(i,a){this.tokenDetails=null,this._saveTokenOptions(i,a),ds(this.authOptions,this.logger);try{return this._ensureValidAuthCredentials(!0)}finally{delete this.tokenParams.timestamp,delete this.authOptions.queryTime}}async requestToken(i,a){const l=a||this.authOptions,o=i||me(this.tokenParams);let u,f=this.client;if(l.authCallback)h.logAction(this.logger,h.LOG_MINOR,"Auth.requestToken()","using token auth with authCallback"),u=l.authCallback;else if(l.authUrl)h.logAction(this.logger,h.LOG_MINOR,"Auth.requestToken()","using token auth with authUrl"),u=(p,_)=>{const O=G({accept:"application/json, text/plain"},l.authHeaders),L=l.authMethod&&l.authMethod.toLowerCase()==="post";let j;const K=l.authUrl.indexOf("?");K>-1&&(j=ce(l.authUrl.slice(K)),l.authUrl=l.authUrl.slice(0,K),L||(l.authParams=G(j,l.authParams)));const B=G({},l.authParams||{},p),ie=ae=>{var Se,je;let He=(Se=ae.body)!=null?Se:null,Ie=null;if(ae.error)h.logAction(this.logger,h.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received Error: "+te(ae.error));else{const Ct=(je=ae.headers["content-type"])!=null?je:null;Array.isArray(Ct)?Ie=Ct.join(", "):Ie=Ct,h.logAction(this.logger,h.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received; content-type: "+Ie+"; body: "+ct(He))}if(ae.error){_(ae.error,null);return}if(ae.unpacked){_(null,He);return}if(R.BufferUtils.isBuffer(He)&&(He=He.toString()),!Ie){_(new U("authUrl response is missing a content-type header",40170,401),null);return}const _e=Ie.indexOf("application/json")>-1,Qt=Ie.indexOf("text/plain")>-1||Ie.indexOf("application/jwt")>-1;if(!_e&&!Qt){_(new U("authUrl responded with unacceptable content-type "+Ie+", should be either text/plain, application/jwt or application/json",40170,401),null);return}if(_e){if(He.length>Xi){_(new U("authUrl response exceeded max permitted length",40170,401),null);return}try{He=JSON.parse(He)}catch(Ct){_(new U("Unexpected error processing authURL response; err = "+Ct.message,40170,401),null);return}}_(null,He,Ie)};if(h.logAction(this.logger,h.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Requesting token from "+l.authUrl+"; Params: "+JSON.stringify(B)+"; method: "+(L?"POST":"GET")),L){const ae=O||{};ae["content-type"]="application/x-www-form-urlencoded";const Se=Z(B).slice(1);Xe(this.client.http.doUri(it.Post,l.authUrl,ae,Se,j),(je,He)=>ie(je||He))}else Xe(this.client.http.doUri(it.Get,l.authUrl,O||{},null,B),(ae,Se)=>ie(ae||Se))};else if(l.key)h.logAction(this.logger,h.LOG_MINOR,"Auth.requestToken()","using token auth with client-side signing"),u=(p,_)=>{Xe(this.createTokenRequest(p,l),(O,L)=>_(O,L??null))};else{const p="Need a new token, but authOptions does not include any way to request one (no authUrl, authCallback, or key)";throw h.logAction(this.logger,h.LOG_ERROR,"Auth()","library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),new U(p,40171,403)}"capability"in o&&(o.capability=hs(o.capability));const m=(p,_)=>{const O=p.keyName,L="/keys/"+O+"/requestToken",j=function(B){return f.baseUri(B)+L},K=Ce.defaultPostHeaders(this.client.options);l.requestHeaders&&G(K,l.requestHeaders),h.logAction(this.logger,h.LOG_MICRO,"Auth.requestToken().requestToken","Sending POST to "+L+"; Token params: "+JSON.stringify(p)),Xe(this.client.http.do(it.Post,j,K,JSON.stringify(p),null),(B,ie)=>B?_(B):_(ie.error,ie.body,ie.unpacked))};return new Promise((p,_)=>{let O=!1,L=this.client.options.timeouts.realtimeRequestTimeout,j=setTimeout(()=>{O=!0;const K="Token request callback timed out after "+L/1e3+" seconds";h.logAction(this.logger,h.LOG_ERROR,"Auth.requestToken()",K),_(new U(K,40170,401))},L);u(o,(K,B,ie)=>{if(O)return;if(clearTimeout(j),K){h.logAction(this.logger,h.LOG_ERROR,"Auth.requestToken()","token request signing call returned error; err = "+te(K)),_(gl(K));return}if(typeof B=="string"){B.length===0?_(new U("Token string is empty",40170,401)):B.length>Xi?_(new U("Token string exceeded max permitted length (was "+B.length+" bytes)",40170,401)):B==="undefined"||B==="null"?_(new U("Token string was literal null/undefined",40170,401)):B[0]==="{"&&!(ie&&ie.indexOf("application/jwt")>-1)?_(new U("Token was double-encoded; make sure you're not JSON-encoding an already encoded token request or details",40170,401)):p({token:B});return}if(typeof B!="object"||B===null){const Se="Expected token request callback to call back with a token string or token request/details object, but got a "+typeof B;h.logAction(this.logger,h.LOG_ERROR,"Auth.requestToken()",Se),_(new U(Se,40170,401));return}const ae=JSON.stringify(B).length;if(ae>Xi&&!l.suppressMaxLengthCheck){_(new U("Token request/details object exceeded max permitted stringified size (was "+ae+" bytes)",40170,401));return}if("issued"in B){p(B);return}if(!("keyName"in B)){const Se="Expected token request callback to call back with a token string, token request object, or token details object";h.logAction(this.logger,h.LOG_ERROR,"Auth.requestToken()",Se),_(new U(Se,40170,401));return}m(B,(Se,je,He)=>{if(Se){h.logAction(this.logger,h.LOG_ERROR,"Auth.requestToken()","token request API call returned error; err = "+te(Se)),_(gl(Se));return}He||(je=JSON.parse(je)),h.logAction(this.logger,h.LOG_MINOR,"Auth.getToken()","token received"),p(je)})})})}async createTokenRequest(i,a){a=a||this.authOptions,i=i||me(this.tokenParams);const l=a.key;if(!l)throw new U("No key specified",40101,403);const o=l.split(":"),u=o[0],f=o[1];if(!f)throw new U("Invalid key specified",40101,403);if(i.clientId==="")throw new U("clientId can’t be an empty string",40012,400);"capability"in i&&(i.capability=hs(i.capability));const m=G({keyName:u},i),p=i.clientId||"",_=i.ttl||"",O=i.capability||"";m.timestamp||(m.timestamp=await this._getTimestamp(a&&a.queryTime));const L=m.nonce||(m.nonce=_n()),j=m.timestamp,K=m.keyName+`
`+_+`
`+O+`
`+p+`
`+j+`
`+L+`
`;return m.mac=m.mac||Zi(K,f),h.logAction(this.logger,h.LOG_MINOR,"Auth.getTokenRequest()","generated signed request"),m}async getAuthParams(){if(this.method=="basic")return{key:this.key};{let i=await this._ensureValidAuthCredentials(!1);if(!i)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");return{access_token:i.token}}}async getAuthHeaders(){if(this.method=="basic")return{authorization:"Basic "+this.basicKey};{const i=await this._ensureValidAuthCredentials(!1);if(!i)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");return{authorization:"Bearer "+us(i.token)}}}_saveBasicOptions(i){this.method="basic",this.key=i.key,this.basicKey=us(i.key),this.authOptions=i||{},"clientId"in i&&this._userSetClientId(i.clientId)}_saveTokenOptions(i,a){this.method="token",i&&(this.tokenParams=i),a&&(a.token&&(a.tokenDetails=typeof a.token=="string"?{token:a.token}:a.token),a.tokenDetails&&(this.tokenDetails=a.tokenDetails),"clientId"in a&&this._userSetClientId(a.clientId),this.authOptions=a)}async _ensureValidAuthCredentials(i){const a=this.tokenDetails;if(a){if(this._tokenClientIdMismatch(a.clientId))throw new U("Mismatch between clientId in token ("+a.clientId+") and current clientId ("+this.clientId+")",40102,403);if(!this.client.isTimeOffsetSet()||!a.expires||a.expires>=this.client.getTimestampUsingOffset())return h.logAction(this.logger,h.LOG_MINOR,"Auth.getToken()","using cached token; expires = "+a.expires),a;h.logAction(this.logger,h.LOG_MINOR,"Auth.getToken()","deleting expired token"),this.tokenDetails=null}const l=(this.waitingForTokenRequest||(this.waitingForTokenRequest=Yn.create(this.logger))).createPromise();if(this.currentTokenRequestId!==null&&!i)return l;const o=this.currentTokenRequestId=Sc();let u,f=null;try{u=await this.requestToken(this.tokenParams,this.authOptions)}catch(p){f=p}if(this.currentTokenRequestId>o)return h.logAction(this.logger,h.LOG_MINOR,"Auth._ensureValidAuthCredentials()","Discarding token request response; overtaken by newer one"),l;this.currentTokenRequestId=null;const m=this.waitingForTokenRequest;return this.waitingForTokenRequest=null,f?(m?.rejectAll(f),l):(m?.resolveAll(this.tokenDetails=u),l)}_userSetClientId(i){if(typeof i=="string"||i===null){if(i==="*")throw new U('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, instantiate the library with {defaultTokenParams: {clientId: "*"}}), or if calling authorize(), pass it in as a tokenParam: authorize({clientId: "*"}, authOptions)',40012,400);{const a=this._uncheckedSetClientId(i);if(a)throw a}}else throw new U("clientId must be either a string or null",40012,400)}_uncheckedSetClientId(i){if(this._tokenClientIdMismatch(i)){const a="Unexpected clientId mismatch: client has "+this.clientId+", requested "+i,l=new U(a,40102,401);return h.logAction(this.logger,h.LOG_ERROR,"Auth._uncheckedSetClientId()",a),l}else return this.clientId=this.tokenParams.clientId=i,null}_tokenClientIdMismatch(i){return!!(this.clientId&&this.clientId!=="*"&&i&&i!=="*"&&this.clientId!==i)}static isTokenErr(i){return i.code&&i.code>=40140&&i.code<40150}revokeTokens(i,a){return this.client.rest.revokeTokens(i,a)}async _getTimestamp(i){return this.client.getTimestamp(i||!!this.authOptions.queryTime)}},gn=gs;function Ki(i){const a=[];if(i)for(const l in i)a.push(l+"="+i[l]);return a.join("&")}function Ji(i,a){return i+(a?"?":"")+Ki(a)}function Jt(i,a,l,o,u){i.error?h.logActionNoStrip(u,h.LOG_MICRO,"Http."+a+"()","Received Error; "+Ji(l,o)+"; Error: "+te(i.error)):h.logActionNoStrip(u,h.LOG_MICRO,"Http."+a+"()","Received; "+Ji(l,o)+"; Headers: "+Ki(i.headers)+"; StatusCode: "+i.statusCode+"; Body"+(R.BufferUtils.isBuffer(i.body)?" (Base64): "+R.BufferUtils.base64Encode(i.body):": "+i.body))}function pl(i,a,l,o,u){u.shouldLog(h.LOG_MICRO)&&h.logActionNoStrip(u,h.LOG_MICRO,"Http."+i+"()","Sending; "+Ji(a,o)+"; Body"+(R.BufferUtils.isBuffer(l)?" (Base64): "+R.BufferUtils.base64Encode(l):": "+l))}var ms=class{constructor(i){this.client=i,this.platformHttp=new R.Http(i),this.checkConnectivity=this.platformHttp.checkConnectivity?()=>this.platformHttp.checkConnectivity():void 0}get logger(){var i,a;return(a=(i=this.client)==null?void 0:i.logger)!=null?a:h.defaultLogger}get supportsAuthHeaders(){return this.platformHttp.supportsAuthHeaders}get supportsLinkHeaders(){return this.platformHttp.supportsLinkHeaders}_getHosts(i){const a=i.connection,l=a&&a.connectionManager.host;return l?[l].concat(Ce.getFallbackHosts(i.options)):Ce.getHosts(i.options)}async do(i,a,l,o,u){try{const f=this.client;if(!f)return{error:new U("http.do called without client",5e4,500)};const m=typeof a=="function"?a:function(j){return f.baseUri(j)+a},p=f._currentFallback;if(p)if(p.validUntil>Date.now()){const j=await this.doUri(i,m(p.host),l,o,u);return j.error&&this.platformHttp.shouldFallback(j.error)?(f._currentFallback=null,this.do(i,a,l,o,u)):j}else f._currentFallback=null;const _=this._getHosts(f);if(_.length===1)return this.doUri(i,m(_[0]),l,o,u);let O=null;const L=async(j,K)=>{const B=j.shift();O=O??new Date;const ie=await this.doUri(i,m(B),l,o,u);return ie.error&&this.platformHttp.shouldFallback(ie.error)&&j.length?Date.now()-O.getTime()>f.options.timeouts.httpMaxRetryDuration?{error:new U(`Timeout for trying fallback hosts retries. Total elapsed time exceeded the ${f.options.timeouts.httpMaxRetryDuration}ms limit`,50003,500)}:L(j,!0):(K&&(f._currentFallback={host:B,validUntil:Date.now()+f.options.timeouts.fallbackRetryTimeout}),ie)};return L(_)}catch(f){return{error:new U(`Unexpected error in Http.do: ${te(f)}`,500,5e4)}}}async doUri(i,a,l,o,u){try{pl(i,a,o,u,this.logger);const f=await this.platformHttp.doUri(i,a,l,o,u);return this.logger.shouldLog(h.LOG_MICRO)&&Jt(f,i,a,u,this.logger),f}catch(f){return{error:new U(`Unexpected error in Http.doUri: ${te(f)}`,500,5e4)}}}};function yl(i,a,l,o){try{l.apply(a,o)}catch(u){h.logAction(i,h.LOG_ERROR,"EventEmitter.emit()","Unexpected listener exception: "+u+"; stack = "+(u&&u.stack))}}function Pn(i,a,l){let o,u,f;for(let m=0;m<i.length;m++)if(o=i[m],l&&(o=o[l]),Array.isArray(o)){for(;(u=o.indexOf(a))!==-1;)o.splice(u,1);l&&o.length===0&&delete i[m][l]}else if(S(o))for(f in o)Object.prototype.hasOwnProperty.call(o,f)&&Array.isArray(o[f])&&Pn([o],a,f)}var Lr=class{constructor(i){this.logger=i,this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null)}on(...i){if(i.length===1){const a=i[0];if(typeof a=="function")this.any.push(a);else throw new Error("EventListener.on(): Invalid arguments: "+R.Config.inspect(i))}if(i.length===2){const[a,l]=i;if(typeof l!="function")throw new Error("EventListener.on(): Invalid arguments: "+R.Config.inspect(i));if(W(a))this.any.push(l);else if(Array.isArray(a))a.forEach(o=>{this.on(o,l)});else{if(typeof a!="string")throw new Error("EventListener.on(): Invalid arguments: "+R.Config.inspect(i));(this.events[a]||(this.events[a]=[])).push(l)}}}off(...i){if(i.length==0||W(i[0])&&W(i[1])){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null);return}const[a,l]=i;let o=null,u=null;if(i.length===1||!l)typeof a=="function"?o=a:u=a;else{if(typeof l!="function")throw new Error("EventEmitter.off(): invalid arguments:"+R.Config.inspect(i));[u,o]=[a,l]}if(o&&W(u)){Pn([this.any,this.events,this.anyOnce,this.eventsOnce],o);return}if(Array.isArray(u)){u.forEach(f=>{this.off(f,o)});return}if(typeof u!="string")throw new Error("EventEmitter.off(): invalid arguments:"+R.Config.inspect(i));o?Pn([this.events,this.eventsOnce],o,u):(delete this.events[u],delete this.eventsOnce[u])}listeners(i){if(i){const a=this.events[i]||[];return this.eventsOnce[i]&&Array.prototype.push.apply(a,this.eventsOnce[i]),a.length?a:null}return this.any.length?this.any:null}emit(i,...a){const l={event:i},o=[];this.anyOnce.length&&(Array.prototype.push.apply(o,this.anyOnce),this.anyOnce=[]),this.any.length&&Array.prototype.push.apply(o,this.any);const u=this.eventsOnce[i];u&&(Array.prototype.push.apply(o,u),delete this.eventsOnce[i]);const f=this.events[i];f&&Array.prototype.push.apply(o,f),o.forEach(m=>{yl(this.logger,l,m,a)})}once(...i){const a=i.length;if(a===0||a===1&&typeof i[0]!="function"){const u=i[0];return new Promise(f=>{this.once(u,f)})}const[l,o]=i;if(i.length===1&&typeof l=="function")this.anyOnce.push(l);else if(W(l)){if(typeof o!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+R.Config.inspect(i));this.anyOnce.push(o)}else if(Array.isArray(l)){const u=this,f=function(){const m=Array.prototype.slice.call(arguments);if(l.forEach(function(p){u.off(p,f)}),typeof o!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+R.Config.inspect(i));o.apply(this,m)};l.forEach(function(m){u.on(m,f)})}else{if(typeof l!="string")throw new Error("EventEmitter.once(): Invalid arguments:"+R.Config.inspect(i));const u=this.eventsOnce[l]||(this.eventsOnce[l]=[]);if(o){if(typeof o!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+R.Config.inspect(i));u.push(o)}}}async whenState(i,a){if(typeof i!="string"||typeof a!="string")throw new Error("whenState requires a valid state String argument");return i===a?null:this.once(i)}},dt=Lr,fe={HEARTBEAT:0,ACK:1,NACK:2,CONNECT:3,CONNECTED:4,DISCONNECT:5,DISCONNECTED:6,CLOSE:7,CLOSED:8,ERROR:9,ATTACH:10,ATTACHED:11,DETACH:12,DETACHED:13,PRESENCE:14,MESSAGE:15,SYNC:16,AUTH:17,ACTIVATE:18,OBJECT:19,OBJECT_SYNC:20,ANNOTATION:21},jr=[];Object.keys(fe).forEach(function(i){jr[fe[i]]=i});var Lt={HAS_PRESENCE:1,HAS_BACKLOG:2,RESUMED:4,TRANSIENT:16,ATTACH_RESUME:32,HAS_OBJECTS:128,PRESENCE:65536,PUBLISH:1<<17,SUBSCRIBE:1<<18,PRESENCE_SUBSCRIBE:1<<19,ANNOTATION_PUBLISH:1<<21,ANNOTATION_SUBSCRIBE:1<<22,OBJECT_SUBSCRIBE:1<<24,OBJECT_PUBLISH:1<<25},Br=Object.keys(Lt);Lt.MODE_ALL=Lt.PRESENCE|Lt.PUBLISH|Lt.SUBSCRIBE|Lt.PRESENCE_SUBSCRIBE|Lt.ANNOTATION_PUBLISH|Lt.ANNOTATION_SUBSCRIBE|Lt.OBJECT_SUBSCRIBE|Lt.OBJECT_PUBLISH;var ps=["PRESENCE","PUBLISH","SUBSCRIBE","PRESENCE_SUBSCRIBE","ANNOTATION_PUBLISH","ANNOTATION_SUBSCRIBE","OBJECT_SUBSCRIBE","OBJECT_PUBLISH"];function Ac(i){return!i||!i.channelOptions?{channelOptions:i,plugins:{},baseEncodedPreviousPayload:void 0}:i}function qr(i,a,l){if(l&&l.cipher){i||pt("Crypto");const o=i.getCipher(l.cipher,a);return{cipher:o.cipherParams,channelCipher:o.cipher}}return l??{}}async function ys(i,a){const{data:l,encoding:o}=await vs(i.data,i.encoding,a);return i.data=l,i.encoding=o,i}async function vs(i,a,l){let o=l.channelCipher,u=i,f=a?a+"/":"";R.BufferUtils.isBuffer(u)||(u=R.BufferUtils.utf8Encode(String(u)),f=f+"utf-8/");const m=await o.encrypt(u);return f=f+"cipher+"+o.algorithm,{data:m,encoding:f}}async function ja(i,a){const l=typeof i.data=="string"||R.BufferUtils.isBuffer(i.data)||i.data===null||i.data===void 0,{data:o,encoding:u}=di(i.data,i.encoding,l);return i.data=o,i.encoding=u,a!=null&&a.cipher?ys(i,a):i}function di(i,a,l){if(l)return{data:i,encoding:a};if(S(i)||Array.isArray(i))return{data:JSON.stringify(i),encoding:a?a+"/json":"json"};throw new U("Data type is unsupported",40013,400)}async function Qn(i,a){const{data:l,encoding:o,error:u}=await vl(i.data,i.encoding,a);if(i.data=l,i.encoding=o,u)throw u}async function vl(i,a,l){const o=Ac(l);let u=i,f=i,m=a,p;if(a){const _=a.split("/");let O,L=_.length,j="";try{for(;(O=L)>0;){const K=_[--L].match(/([-\w]+)(\+([\w-]+))?/);if(!K)break;switch(j=K[1],j){case"base64":f=R.BufferUtils.base64Decode(String(f)),O==_.length&&(u=f);continue;case"utf-8":f=R.BufferUtils.utf8Decode(f);continue;case"json":f=JSON.parse(f);continue;case"cipher":if(o.channelOptions!=null&&o.channelOptions.cipher&&o.channelOptions.channelCipher){const B=K[3],ie=o.channelOptions.channelCipher;if(B!=ie.algorithm)throw new Error("Unable to decrypt message with given cipher; incompatible cipher params");f=await ie.decrypt(f);continue}else throw new Error("Unable to decrypt message; not an encrypted channel");case"vcdiff":if(!o.plugins||!o.plugins.vcdiff)throw new U("Missing Vcdiff decoder (https://github.com/ably-forks/vcdiff-decoder)",40019,400);if(typeof Uint8Array>"u")throw new U("Delta decoding not supported on this browser (need ArrayBuffer & Uint8Array)",40020,400);try{let B=o.baseEncodedPreviousPayload;typeof B=="string"&&(B=R.BufferUtils.utf8Encode(B));const ie=R.BufferUtils.toBuffer(B);f=R.BufferUtils.toBuffer(f),f=R.BufferUtils.arrayBufferViewToBuffer(o.plugins.vcdiff.decode(f,ie)),u=f}catch(B){throw new U("Vcdiff delta decode failed with "+B,40018,400)}continue;default:throw new Error("Unknown encoding")}}}catch(K){const B=K;p=new U(`Error processing the ${j} encoding, decoder returned ‘${B.message}’`,B.code||40013,400)}finally{m=O<=0?null:_.slice(0,O).join("/")}}return p?{error:p,data:f,encoding:m}:(o.baseEncodedPreviousPayload=u,{data:f,encoding:m})}function Ba(...i){const a=i.length>0?"json":"msgpack",{data:l,encoding:o}=bl(this.data,this.encoding,a);return Object.assign({},this,{encoding:o,data:l})}function bl(i,a,l){return!i||!R.BufferUtils.isBuffer(i)?{data:i,encoding:a}:l==="msgpack"?{data:R.BufferUtils.toBuffer(i),encoding:a}:{data:R.BufferUtils.base64Encode(i),encoding:a?a+"/base64":"base64"}}var Xn={encryptData:vs,encodeData:di,encodeDataForWire:bl,decodeData:vl};function Wt(i){const{id:a,connectionId:l,timestamp:o}=i;let u;switch(i.action){case fe.MESSAGE:{u=i.messages;break}case fe.PRESENCE:case fe.SYNC:u=i.presence;break;case fe.ANNOTATION:u=i.annotations;break;case fe.OBJECT:case fe.OBJECT_SYNC:u=i.state;break;default:throw new U("Unexpected action "+i.action,4e4,400)}for(let f=0;f<u.length;f++){const m=u[f];m.connectionId||(m.connectionId=l),m.timestamp||(m.timestamp=o),a&&!m.id&&(m.id=a+":"+f)}}function Zn(i,a){let l="["+a;for(const o in i)o==="data"?typeof i.data=="string"?l+="; data="+i.data:R.BufferUtils.isBuffer(i.data)?l+="; data (buffer)="+R.BufferUtils.base64Encode(i.data):typeof i.data<"u"&&(l+="; data (json)="+JSON.stringify(i.data)):o&&(o==="extras"||o==="operation")?l+="; "+o+"="+JSON.stringify(i[o]):i[o]!==void 0&&(l+="; "+o+"="+i[o]);return l+="]",l}var mn=class{},En=class{constructor(i){this.Platform=R,this.ErrorInfo=U,this.Logger=h,this.Defaults=Ce,this.Utils=qe,this.EventEmitter=dt,this.MessageEncoding=Xn;var a,l,o,u,f,m,p,_,O,L;this._additionalHTTPRequestImplementations=(a=i.plugins)!=null?a:null,this.logger=new h,this.logger.setLog(i.logLevel,i.logHandler),h.logAction(this.logger,h.LOG_MICRO,"BaseClient()","initialized with clientOptions "+R.Config.inspect(i)),this._MsgPack=(o=(l=i.plugins)==null?void 0:l.MsgPack)!=null?o:null;const j=this.options=Ce.normaliseOptions(i,this._MsgPack,this.logger);if(j.key){const K=j.key.match(/^([^:\s]+):([^:.\s]+)$/);if(!K){const B="invalid key parameter";throw h.logAction(this.logger,h.LOG_ERROR,"BaseClient()",B),new U(B,40400,404)}j.keyName=K[1],j.keySecret=K[2]}if("clientId"in j)if(typeof j.clientId=="string"||j.clientId===null){if(j.clientId==="*")throw new U('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, use {defaultTokenParams: {clientId: "*"}})',40012,400)}else throw new U("clientId must be either a string or null",40012,400);h.logAction(this.logger,h.LOG_MINOR,"BaseClient()","started; version = "+Ce.version),this._currentFallback=null,this.serverTimeOffset=null,this.http=new ms(this),this.auth=new gn(this,j),this._rest=(u=i.plugins)!=null&&u.Rest?new i.plugins.Rest(this):null,this._Crypto=(m=(f=i.plugins)==null?void 0:f.Crypto)!=null?m:null,this.__FilteredSubscriptions=(_=(p=i.plugins)==null?void 0:p.MessageInteractions)!=null?_:null,this._Annotations=(L=(O=i.plugins)==null?void 0:O.Annotations)!=null?L:null}get rest(){return this._rest||pt("Rest"),this._rest}get _FilteredSubscriptions(){return this.__FilteredSubscriptions||pt("MessageInteractions"),this.__FilteredSubscriptions}get channels(){return this.rest.channels}get push(){return this.rest.push}device(){var i;return(!((i=this.options.plugins)!=null&&i.Push)||!this.push.LocalDevice)&&pt("Push"),this._device||(this._device=this.push.LocalDevice.load(this)),this._device}baseUri(i){return Ce.getHttpScheme(this.options)+i+":"+Ce.getPort(this.options,!1)}async stats(i){return this.rest.stats(i)}async time(i){return this.rest.time(i)}async request(i,a,l,o,u,f){return this.rest.request(i,a,l,o,u,f)}batchPublish(i){return this.rest.batchPublish(i)}batchPresence(i){return this.rest.batchPresence(i)}setLog(i){this.logger.setLog(i.level,i.handler)}async getTimestamp(i){return!this.isTimeOffsetSet()&&i?this.time():this.getTimestampUsingOffset()}getTimestampUsingOffset(){return Date.now()+(this.serverTimeOffset||0)}isTimeOffsetSet(){return this.serverTimeOffset!==null}};En.Platform=R;var bs=En,Ss=class il{toJSON(){var a,l,o;return{id:this.id,deviceSecret:this.deviceSecret,platform:this.platform,formFactor:this.formFactor,clientId:this.clientId,metadata:this.metadata,deviceIdentityToken:this.deviceIdentityToken,push:{recipient:(a=this.push)==null?void 0:a.recipient,state:(l=this.push)==null?void 0:l.state,error:(o=this.push)==null?void 0:o.error}}}toString(){var a,l,o,u;let f="[DeviceDetails";return this.id&&(f+="; id="+this.id),this.platform&&(f+="; platform="+this.platform),this.formFactor&&(f+="; formFactor="+this.formFactor),this.clientId&&(f+="; clientId="+this.clientId),this.metadata&&(f+="; metadata="+this.metadata),this.deviceIdentityToken&&(f+="; deviceIdentityToken="+JSON.stringify(this.deviceIdentityToken)),(a=this.push)!=null&&a.recipient&&(f+="; push.recipient="+JSON.stringify(this.push.recipient)),(l=this.push)!=null&&l.state&&(f+="; push.state="+this.push.state),(o=this.push)!=null&&o.error&&(f+="; push.error="+JSON.stringify(this.push.error)),(u=this.push)!=null&&u.metadata&&(f+="; push.metadata="+this.push.metadata),f+="]",f}static toRequestBody(a,l,o){return et(a,l,o)}static fromResponseBody(a,l,o){return o&&(a=ut(a,l,o)),Array.isArray(a)?il.fromValuesArray(a):il.fromValues(a)}static fromValues(a){return a.error=a.error&&U.fromValues(a.error),Object.assign(new il,a)}static fromLocalDevice(a){return Object.assign(new il,a)}static fromValuesArray(a){const l=a.length,o=new Array(l);for(let u=0;u<l;u++)o[u]=il.fromValues(a[u]);return o}},gi=Ss;async function qa(i,a,l,o){if(i.http.supportsAuthHeaders){const u=await i.auth.getAuthHeaders();return o(G(u,a),l)}else{const u=await i.auth.getAuthParams();return o(a,G(u,l))}}function As(i,a,l){if(i.err&&!i.body)return{err:i.err};if(i.statusCode===hi.NoContent)return ye(H({},i),{body:[],unpacked:!0});let o=i.body;if(!i.unpacked)try{o=ut(o,a,l)}catch(p){return ue(p)?{err:p}:{err:new Le(te(p),null)}}if(!o)return{err:new Le("unenvelope(): Response body is missing",null)};const{statusCode:u,response:f,headers:m}=o;if(u===void 0)return ye(H({},i),{body:o,unpacked:!0});if(u<200||u>=300){let p=f&&f.error||i.err;return p||(p=new Error("Error in unenveloping "+o),p.statusCode=u),{err:p,body:f,headers:m,unpacked:!0,statusCode:u}}return{err:i.err,body:f,headers:m,unpacked:!0,statusCode:u}}function Gr(i,a,l,o,u){i.err?h.logAction(u,h.LOG_MICRO,"Resource."+a+"()","Received Error; "+Ji(l,o)+"; Error: "+te(i.err)):h.logAction(u,h.LOG_MICRO,"Resource."+a+"()","Received; "+Ji(l,o)+"; Headers: "+Ki(i.headers)+"; StatusCode: "+i.statusCode+"; Body: "+(R.BufferUtils.isBuffer(i.body)?" (Base64): "+R.BufferUtils.base64Encode(i.body):": "+R.Config.inspect(i.body)))}var Gt=class al{static async get(a,l,o,u,f,m){return al.do(it.Get,a,l,null,o,u,f,m??!1)}static async delete(a,l,o,u,f,m){return al.do(it.Delete,a,l,null,o,u,f,m)}static async post(a,l,o,u,f,m,p){return al.do(it.Post,a,l,o,u,f,m,p)}static async patch(a,l,o,u,f,m,p){return al.do(it.Patch,a,l,o,u,f,m,p)}static async put(a,l,o,u,f,m,p){return al.do(it.Put,a,l,o,u,f,m,p)}static async do(a,l,o,u,f,m,p,_){p&&((m=m||{}).envelope=p);const O=l.logger;async function L(K,B){var ie;if(O.shouldLog(h.LOG_MICRO)){let Se=u;if(((ie=K["content-type"])==null?void 0:ie.indexOf("msgpack"))>0)try{l._MsgPack||pt("MsgPack"),Se=l._MsgPack.decode(u)}catch(je){h.logAction(O,h.LOG_MICRO,"Resource."+a+"()","Sending MsgPack Decoding Error: "+te(je))}h.logAction(O,h.LOG_MICRO,"Resource."+a+"()","Sending; "+Ji(o,B)+"; Body: "+Se)}const ae=await l.http.do(a,o,K,u,B);return ae.error&&gn.isTokenErr(ae.error)?(await l.auth.authorize(null,null),qa(l,K,B,L)):{err:ae.error,body:ae.body,headers:ae.headers,unpacked:ae.unpacked,statusCode:ae.statusCode}}let j=await qa(l,f,m,L);if(p&&(j=As(j,l._MsgPack,p)),O.shouldLog(h.LOG_MICRO)&&Gr(j,a,o,m,O),_){if(j.err)throw j.err;{const K=H({},j);return delete K.err,K}}return j}},Ze=Gt;function Os(i){const a=i.match(/^\.\/(\w+)\?(.*)$/);return a&&a[2]&&ce(a[2])}function Ga(i){typeof i=="string"&&(i=i.split(","));const a={};for(let l=0;l<i.length;l++){const o=i[l].match(/^\s*<(.+)>;\s*rel="(\w+)"$/);if(o){const u=Os(o[1]);u&&(a[o[2]]=u)}}return a}function Oc(i,a,l){return!(l&&(a||typeof i.code=="number"))}var Sl=class{constructor(i,a,l,o,u,f){this.client=i,this.path=a,this.headers=l,this.envelope=o??null,this.bodyHandler=u,this.useHttpPaginatedResponse=f||!1}get logger(){return this.client.logger}async get(i){const a=await Ze.get(this.client,this.path,this.headers,i,this.envelope,!1);return this.handlePage(a)}async delete(i){const a=await Ze.delete(this.client,this.path,this.headers,i,this.envelope,!1);return this.handlePage(a)}async post(i,a){const l=await Ze.post(this.client,this.path,a,this.headers,i,this.envelope,!1);return this.handlePage(l)}async put(i,a){const l=await Ze.put(this.client,this.path,a,this.headers,i,this.envelope,!1);return this.handlePage(l)}async patch(i,a){const l=await Ze.patch(this.client,this.path,a,this.headers,i,this.envelope,!1);return this.handlePage(l)}async handlePage(i){if(i.err&&Oc(i.err,i.body,this.useHttpPaginatedResponse))throw h.logAction(this.logger,h.LOG_ERROR,"PaginatedResource.handlePage()","Unexpected error getting resource: err = "+te(i.err)),i.err;let a,l,o;try{a=i.statusCode==hi.NoContent?[]:await this.bodyHandler(i.body,i.headers||{},i.unpacked)}catch(u){throw i.err||u}return i.headers&&(l=i.headers.Link||i.headers.link)&&(o=Ga(l)),this.useHttpPaginatedResponse?new za(this,a,i.headers||{},i.statusCode,o,i.err):new Ts(this,a,o)}},Ts=class{constructor(i,a,l){this.resource=i,this.items=a,this._relParams=l}async first(){if(this.hasFirst())return this.get(this._relParams.first);throw new U("No link to the first page of results",40400,404)}async current(){if(this.hasCurrent())return this.get(this._relParams.current);throw new U("No link to the current page of results",40400,404)}async next(){return this.hasNext()?this.get(this._relParams.next):null}hasFirst(){return this._relParams!=null&&"first"in this._relParams}hasCurrent(){return this._relParams!=null&&"current"in this._relParams}hasNext(){return this._relParams!=null&&"next"in this._relParams}isLast(){return!this.hasNext()}async get(i){const a=this.resource,l=await Ze.get(a.client,a.path,a.headers,i,a.envelope,!1);return a.handlePage(l)}},za=class extends Ts{constructor(i,a,l,o,u,f){super(i,a,u),this.statusCode=o,this.success=o<300&&o>=200,this.headers=l,this.errorCode=f&&f.code,this.errorMessage=f&&f.message}toJSON(){return{items:this.items,statusCode:this.statusCode,success:this.success,headers:this.headers,errorCode:this.errorCode,errorMessage:this.errorMessage}}},It=Sl,Al=class Tr{toJSON(){return{channel:this.channel,deviceId:this.deviceId,clientId:this.clientId}}toString(){let a="[PushChannelSubscription";return this.channel&&(a+="; channel="+this.channel),this.deviceId&&(a+="; deviceId="+this.deviceId),this.clientId&&(a+="; clientId="+this.clientId),a+="]",a}static fromResponseBody(a,l,o){return o&&(a=ut(a,l,o)),Array.isArray(a)?Tr.fromValuesArray(a):Tr.fromValues(a)}static fromValues(a){return Object.assign(new Tr,a)}static fromValuesArray(a){const l=a.length,o=new Array(l);for(let u=0;u<l;u++)o[u]=Tr.fromValues(a[u]);return o}};Al.toRequestBody=et;var Tc=Al,Rs=Tc,Rc=class{constructor(i){var a;this.client=i,this.admin=new Ol(i),R.Config.push&&((a=i.options.plugins)!=null&&a.Push)&&(this.stateMachine=new i.options.plugins.Push.ActivationStateMachine(i),this.LocalDevice=i.options.plugins.Push.localDeviceFactory(gi))}async activate(i,a){await new Promise((l,o)=>{var u;if(!((u=this.client.options.plugins)!=null&&u.Push)){o(ka("Push"));return}if(!this.stateMachine){o(new U("This platform is not supported as a target of push notifications",4e4,400));return}if(this.stateMachine.activatedCallback){o(new U("Activation already in progress",4e4,400));return}this.stateMachine.activatedCallback=f=>{if(f){o(f);return}l()},this.stateMachine.updateFailedCallback=a,this.stateMachine.handleEvent(new this.client.options.plugins.Push.CalledActivate(this.stateMachine,i))})}async deactivate(i){await new Promise((a,l)=>{var o;if(!((o=this.client.options.plugins)!=null&&o.Push)){l(ka("Push"));return}if(!this.stateMachine){l(new U("This platform is not supported as a target of push notifications",4e4,400));return}if(this.stateMachine.deactivatedCallback){l(new U("Deactivation already in progress",4e4,400));return}this.stateMachine.deactivatedCallback=u=>{if(u){l(u);return}a()},this.stateMachine.handleEvent(new this.client.options.plugins.Push.CalledDeactivate(this.stateMachine,i))})}},Ol=class{constructor(i){this.client=i,this.deviceRegistrations=new Cc(i),this.channelSubscriptions=new _c(i)}async publish(i,a){const l=this.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=Ce.defaultPostHeaders(l.options,{format:o}),f={},m=G({recipient:i},a);G(u,l.options.headers),l.options.pushFullWait&&G(f,{fullWait:"true"});const p=et(m,l._MsgPack,o);await Ze.post(l,"/push/publish",p,u,f,null,!0)}},Cc=class{constructor(i){this.client=i}async save(i){const a=this.client,l=gi.fromValues(i),o=a.options.useBinaryProtocol?"msgpack":"json",u=Ce.defaultPostHeaders(a.options,{format:o}),f={};G(u,a.options.headers),a.options.pushFullWait&&G(f,{fullWait:"true"});const m=et(l,a._MsgPack,o),p=await Ze.put(a,"/push/deviceRegistrations/"+encodeURIComponent(i.id),m,u,f,null,!0);return gi.fromResponseBody(p.body,a._MsgPack,p.unpacked?void 0:o)}async get(i){const a=this.client,l=a.options.useBinaryProtocol?"msgpack":"json",o=Ce.defaultGetHeaders(a.options,{format:l}),u=i.id||i;if(typeof u!="string"||!u.length)throw new U("First argument to DeviceRegistrations#get must be a deviceId string or DeviceDetails",4e4,400);G(o,a.options.headers);const f=await Ze.get(a,"/push/deviceRegistrations/"+encodeURIComponent(u),o,{},null,!0);return gi.fromResponseBody(f.body,a._MsgPack,f.unpacked?void 0:l)}async list(i){const a=this.client,l=a.options.useBinaryProtocol?"msgpack":"json",o=this.client.http.supportsLinkHeaders?void 0:l,u=Ce.defaultGetHeaders(a.options,{format:l});return G(u,a.options.headers),new It(a,"/push/deviceRegistrations",u,o,async function(f,m,p){return gi.fromResponseBody(f,a._MsgPack,p?void 0:l)}).get(i)}async remove(i){const a=this.client,l=a.options.useBinaryProtocol?"msgpack":"json",o=Ce.defaultGetHeaders(a.options,{format:l}),u={},f=i.id||i;if(typeof f!="string"||!f.length)throw new U("First argument to DeviceRegistrations#remove must be a deviceId string or DeviceDetails",4e4,400);G(o,a.options.headers),a.options.pushFullWait&&G(u,{fullWait:"true"}),await Ze.delete(a,"/push/deviceRegistrations/"+encodeURIComponent(f),o,u,null,!0)}async removeWhere(i){const a=this.client,l=a.options.useBinaryProtocol?"msgpack":"json",o=Ce.defaultGetHeaders(a.options,{format:l});G(o,a.options.headers),a.options.pushFullWait&&G(i,{fullWait:"true"}),await Ze.delete(a,"/push/deviceRegistrations",o,i,null,!0)}},_c=class Qd{constructor(a){this.remove=Qd.prototype.removeWhere,this.client=a}async save(a){const l=this.client,o=Rs.fromValues(a),u=l.options.useBinaryProtocol?"msgpack":"json",f=Ce.defaultPostHeaders(l.options,{format:u}),m={};G(f,l.options.headers),l.options.pushFullWait&&G(m,{fullWait:"true"});const p=et(o,l._MsgPack,u),_=await Ze.post(l,"/push/channelSubscriptions",p,f,m,null,!0);return Rs.fromResponseBody(_.body,l._MsgPack,_.unpacked?void 0:u)}async list(a){const l=this.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=this.client.http.supportsLinkHeaders?void 0:o,f=Ce.defaultGetHeaders(l.options,{format:o});return G(f,l.options.headers),new It(l,"/push/channelSubscriptions",f,u,async function(m,p,_){return Rs.fromResponseBody(m,l._MsgPack,_?void 0:o)}).get(a)}async removeWhere(a){const l=this.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=Ce.defaultGetHeaders(l.options,{format:o});G(u,l.options.headers),l.options.pushFullWait&&G(a,{fullWait:"true"}),await Ze.delete(l,"/push/channelSubscriptions",u,a,null,!0)}async listChannels(a){const l=this.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=this.client.http.supportsLinkHeaders?void 0:o,f=Ce.defaultGetHeaders(l.options,{format:o});return G(f,l.options.headers),l.options.pushFullWait&&G(a,{fullWait:"true"}),new It(l,"/push/channels",f,u,async function(m,p,_){const O=!_&&o?ut(m,l._MsgPack,o):m;for(let L=0;L<O.length;L++)O[L]=String(O[L]);return O}).get(a)}},Ec=Rc,zr=["absent","present","enter","leave","update"];async function Hr(i,a,l,o){const u=qr(a,i,o??null);return Ha.fromValues(l).decode(u,i)}async function Vr(i,a,l,o){return Promise.all(l.map(function(u){return Hr(i,a,u,o)}))}async function Mc(i,a){return Ha.fromValues(i).decode(a.channelOptions,a.logger)}async function Ir(i,a){return Promise.all(i.map(function(l){return Mc(l,a)}))}var Yr=class Rr extends mn{isSynthesized(){return!this.id||!this.connectionId?!0:this.id.substring(this.connectionId.length,0)!==this.connectionId}parseId(){if(!this.id)throw new Error("parseId(): Presence message does not contain an id");const a=this.id.split(":");return{connectionId:a[0],msgSerial:parseInt(a[1],10),index:parseInt(a[2],10)}}async encode(a){const l=Object.assign(new Ha,this,{action:zr.indexOf(this.action||"present")});return ja(l,a)}static fromValues(a){return Object.assign(new Rr,a)}static fromValuesArray(a){return a.map(l=>Rr.fromValues(l))}static fromData(a){return a instanceof Rr?a:Rr.fromValues({data:a})}toString(){return Zn(this,"PresenceMessage")}},Ha=class lf extends mn{toJSON(...a){return Ba.call(this,...a)}static fromValues(a){return Object.assign(new lf,a)}static fromValuesArray(a){return a.map(l=>lf.fromValues(l))}async decode(a,l){const o=Object.assign(new Yr,ye(H({},this),{action:zr[this.action]}));try{await Qn(o,a)}catch(u){h.logAction(l,h.LOG_ERROR,"WirePresenceMessage.decode()",te(u))}return o}toString(){return Zn(this,"WirePresenceMessage")}},pn=Yr,wc=class{constructor(i){this.channel=i}get logger(){return this.channel.logger}async get(i){h.logAction(this.logger,h.LOG_MICRO,"RestPresence.get()","channel = "+this.channel.name);const a=this.channel.client,l=a.options.useBinaryProtocol?"msgpack":"json",o=this.channel.client.http.supportsLinkHeaders?void 0:l,u=Ce.defaultGetHeaders(a.options,{format:l});return G(u,a.options.headers),new It(a,this.channel.client.rest.presenceMixin.basePath(this),u,o,async(f,m,p)=>{const _=p?f:ut(f,a._MsgPack,l);return Ir(_,this.channel)}).get(i)}async history(i){return h.logAction(this.logger,h.LOG_MICRO,"RestPresence.history()","channel = "+this.channel.name),this.channel.client.rest.presenceMixin.history(this,i)}},Nc=wc,Pr=["message.create","message.update","message.delete","meta","message.summary"];function Qr(i){return Pr[i||0]||"unknown"}function xc(i){let a=0;return i.name&&(a+=i.name.length),i.clientId&&(a+=i.clientId.length),i.extras&&(a+=JSON.stringify(i.extras).length),i.data&&(a+=Dt(i.data)),a}async function Xr(i,a,l,o){const u=qr(a,i,o??null);return mi.fromValues(l).decode(u,i)}async function Uc(i,a,l,o){return Promise.all(l.map(function(u){return Xr(i,a,u,o)}))}async function Dc(i,a){return mi.fromValues(i).decode(a.channelOptions,a.logger)}async function kc(i,a){return Promise.all(i.map(function(l){return Dc(l,a)}))}async function Zr(i,a){return Promise.all(i.map(l=>l.encode(a)))}var Lc=et;function Tl(i){let a,l=0;for(let o=0;o<i.length;o++)a=i[o],l+=a.size||(a.size=xc(a));return l}var Kr=class rf extends mn{expandFields(){this.action==="message.create"&&(this.version&&!this.serial&&(this.serial=this.version),this.timestamp&&!this.createdAt&&(this.createdAt=this.timestamp))}async encode(a){const l=Object.assign(new mi,this,{action:Pr.indexOf(this.action||"message.create")});return ja(l,a)}static fromValues(a){return Object.assign(new rf,a)}static fromValuesArray(a){return a.map(l=>rf.fromValues(l))}toString(){return Zn(this,"Message")}},mi=class of extends mn{toJSON(...a){return Ba.call(this,...a)}static fromValues(a){return Object.assign(new of,a)}static fromValuesArray(a){return a.map(l=>of.fromValues(l))}async decodeWithErr(a,l){const o=Object.assign(new Kr,ye(H({},this),{action:Qr(this.action)}));let u;try{await Qn(o,a)}catch(f){h.logAction(l,h.LOG_ERROR,"WireMessage.decode()",te(f)),u=f}return o.expandFields(),{decoded:o,err:u}}async decode(a,l){const{decoded:o}=await this.decodeWithErr(a,l);return o}toString(){return Zn(this,"WireMessage")}},$t=Kr,jc=9;function Jr(i){return i.every(function(a){return!a.id})}var Wr=class{constructor(i,a,l){this._annotations=null;var o,u;h.logAction(i.logger,h.LOG_MINOR,"RestChannel()","started; name = "+a),this.name=a,this.client=i,this.presence=new Nc(this),this.channelOptions=Cn((o=i._Crypto)!=null?o:null,this.logger,l),(u=i.options.plugins)!=null&&u.Push&&(this._push=new i.options.plugins.Push.PushChannel(this)),i._Annotations&&(this._annotations=new i._Annotations.RestAnnotations(this))}get annotations(){return this._annotations||pt("Annotations"),this._annotations}get push(){return this._push||pt("Push"),this._push}get logger(){return this.client.logger}setOptions(i){var a;this.channelOptions=Cn((a=this.client._Crypto)!=null?a:null,this.logger,i)}async history(i){return h.logAction(this.logger,h.LOG_MICRO,"RestChannel.history()","channel = "+this.name),this.client.rest.channelMixin.history(this,i)}async publish(...i){const a=i[0],l=i[1];let o,u;if(typeof a=="string"||a===null)o=[$t.fromValues({name:a,data:l})],u=i[2];else if(S(a))o=[$t.fromValues(a)],u=i[1];else if(Array.isArray(a))o=$t.fromValuesArray(a),u=i[1];else throw new U("The single-argument form of publish() expects a message object or an array of message objects",40013,400);u||(u={});const f=this.client,m=f.options,p=m.useBinaryProtocol?"msgpack":"json",_=f.options.idempotentRestPublishing,O=Ce.defaultPostHeaders(f.options,{format:p});if(G(O,m.headers),_&&Jr(o)){const B=await Hi(jc);o.forEach(function(ie,ae){ie.id=B+":"+ae.toString()})}const L=await Zr(o,this.channelOptions),j=Tl(L),K=m.maxMessageSize;if(j>K)throw new U(`Maximum size of messages that can be published at once exceeded (was ${j} bytes; limit is ${K} bytes)`,40009,400);await this._publish(Lc(L,f._MsgPack,p),O,u)}async _publish(i,a,l){await Ze.post(this.client,this.client.rest.channelMixin.basePath(this)+"/messages",i,a,l,null,!0)}async status(){return this.client.rest.channelMixin.status(this)}},$r=Wr,Fr=class Xd{constructor(a){this.entries=a&&a.entries||void 0,this.schema=a&&a.schema||void 0,this.appId=a&&a.appId||void 0,this.inProgress=a&&a.inProgress||void 0,this.unit=a&&a.unit||void 0,this.intervalId=a&&a.intervalId||void 0}static fromValues(a){return new Xd(a)}},eo=Fr,pi=class{static basePath(i){return"/channels/"+encodeURIComponent(i.name)}static history(i,a){const l=i.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=i.client.http.supportsLinkHeaders?void 0:o,f=Ce.defaultGetHeaders(l.options,{format:o});return G(f,l.options.headers),new It(l,this.basePath(i)+"/messages",f,u,async function(m,p,_){const O=_?m:ut(m,l._MsgPack,o);return kc(O,i)}).get(a)}static async status(i){const a=i.client.options.useBinaryProtocol?"msgpack":"json",l=Ce.defaultPostHeaders(i.client.options,{format:a});return(await Ze.get(i.client,this.basePath(i),l,{},a,!0)).body}},Bc=class{static basePath(i){return pi.basePath(i.channel)+"/presence"}static async history(i,a){const l=i.channel.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=i.channel.client.http.supportsLinkHeaders?void 0:o,f=Ce.defaultGetHeaders(l.options,{format:o});return G(f,l.options.headers),new It(l,this.basePath(i)+"/history",f,u,async(m,p,_)=>{const O=_?m:ut(m,l._MsgPack,o);return Ir(O,i.channel)}).get(a)}},to=class{constructor(i){this.channelMixin=pi,this.presenceMixin=Bc,this.Resource=Ze,this.PaginatedResource=It,this.DeviceDetails=gi,this.PushChannelSubscription=Rs,this.client=i,this.channels=new qc(this.client),this.push=new Ec(this.client)}async stats(i){const a=Ce.defaultGetHeaders(this.client.options),l=this.client.options.useBinaryProtocol?"msgpack":"json",o=this.client.http.supportsLinkHeaders?void 0:l;return G(a,this.client.options.headers),new It(this.client,"/stats",a,o,function(u,f,m){const p=m?u:JSON.parse(u);for(let _=0;_<p.length;_++)p[_]=eo.fromValues(p[_]);return p}).get(i)}async time(i){const a=Ce.defaultGetHeaders(this.client.options);this.client.options.headers&&G(a,this.client.options.headers);const l=p=>this.client.baseUri(p)+"/time";let{error:o,body:u,unpacked:f}=await this.client.http.do(it.Get,l,a,null,i);if(o)throw o;f||(u=JSON.parse(u));const m=u[0];if(!m)throw new U("Internal error (unexpected result type from GET /time)",5e4,500);return this.client.serverTimeOffset=m-Date.now(),m}async request(i,a,l,o,u,f){var m;const[p,_,O]=this.client.options.useBinaryProtocol?(this.client._MsgPack||pt("MsgPack"),[this.client._MsgPack.encode,this.client._MsgPack.decode,"msgpack"]):[JSON.stringify,JSON.parse,"json"],L=this.client.http.supportsLinkHeaders?void 0:O;o=o||{};const j=i.toLowerCase(),K=j=="get"?Ce.defaultGetHeaders(this.client.options,{format:O,protocolVersion:l}):Ce.defaultPostHeaders(this.client.options,{format:O,protocolVersion:l});typeof u!="string"&&(u=(m=p(u))!=null?m:null),G(K,this.client.options.headers),f&&G(K,f);const B=new It(this.client,a,K,L,async function(ie,ae,Se){return Ge(Se?ie:_(ie))},!0);if(!R.Http.methods.includes(j))throw new U("Unsupported method "+j,40500,405);return R.Http.methodsWithBody.includes(j)?B[j](o,u):B[j](o)}async batchPublish(i){let a,l;Array.isArray(i)?(a=i,l=!1):(a=[i],l=!0);const o=this.client.options.useBinaryProtocol?"msgpack":"json",u=Ce.defaultPostHeaders(this.client.options,{format:o});this.client.options.headers&&G(u,this.client.options.headers);const f=et(a,this.client._MsgPack,o),m=await Ze.post(this.client,"/messages",f,u,{},null,!0),p=m.unpacked?m.body:ut(m.body,this.client._MsgPack,o);return l?p[0]:p}async batchPresence(i){const a=this.client.options.useBinaryProtocol?"msgpack":"json",l=Ce.defaultPostHeaders(this.client.options,{format:a});this.client.options.headers&&G(l,this.client.options.headers);const o=i.join(","),u=await Ze.get(this.client,"/presence",l,{channels:o},null,!0);return u.unpacked?u.body:ut(u.body,this.client._MsgPack,a)}async revokeTokens(i,a){if(ml(this.client.options))throw new U("Cannot revoke tokens when using token auth",40162,401);const l=this.client.options.keyName;let o=a??{};const u=H({targets:i.map(O=>`${O.type}:${O.value}`)},o),f=this.client.options.useBinaryProtocol?"msgpack":"json",m=Ce.defaultPostHeaders(this.client.options,{format:f});this.client.options.headers&&G(m,this.client.options.headers);const p=et(u,this.client._MsgPack,f),_=await Ze.post(this.client,`/keys/${l}/revokeTokens`,p,m,{},null,!0);return _.unpacked?_.body:ut(_.body,this.client._MsgPack,f)}},qc=class{constructor(i){this.client=i,this.all=Object.create(null)}get(i,a){i=String(i);let l=this.all[i];return l?a&&l.setOptions(a):this.all[i]=l=new $r(this.client,i,a),l}release(i){delete this.all[String(i)]}},no=class extends bs{constructor(i){super(Ce.objectifyOptions(i,!1,"BaseRest",h.defaultLogger,{Rest:to}))}},Rl={Rest:to},Wi=class extends $t{static async fromEncoded(i,a){return Xr(h.defaultLogger,R.Crypto,i,a)}static async fromEncodedArray(i,a){return Uc(h.defaultLogger,R.Crypto,i,a)}static fromValues(i){return $t.fromValues(i)}},$i=class extends pn{static async fromEncoded(i,a){return Hr(h.defaultLogger,R.Crypto,i,a)}static async fromEncodedArray(i,a){return Vr(h.defaultLogger,R.Crypto,i,a)}static fromValues(i){return pn.fromValues(i)}},io=["annotation.create","annotation.delete"];async function Va(i,a,l){return yi.fromValues(a).decode(l||{},i)}async function ao(i,a,l){return Promise.all(a.map(function(o){return Va(i,o,l)}))}async function so(i,a){return yi.fromValues(i).decode(a.channelOptions,a.logger)}async function Cl(i,a){return Promise.all(i.map(function(l){return so(l,a)}))}var Cs=class cf extends mn{async encode(){const a=Object.assign(new yi,this,{action:io.indexOf(this.action||"annotation.create")});return ja(a,{})}static fromValues(a){return Object.assign(new cf,a)}static fromValuesArray(a){return a.map(l=>cf.fromValues(l))}toString(){return Zn(this,"Annotation")}},yi=class uf extends mn{toJSON(...a){return Ba.call(this,...a)}static fromValues(a){return Object.assign(new uf,a)}static fromValuesArray(a){return a.map(l=>uf.fromValues(l))}async decode(a,l){const o=Object.assign(new Cs,ye(H({},this),{action:io[this.action]}));try{await Qn(o,a)}catch(u){h.logAction(l,h.LOG_ERROR,"WireAnnotation.decode()",te(u))}return o}toString(){return Zn(this,"WireAnnotation")}},Fi=Cs,_l=class extends Fi{static async fromEncoded(i,a){return Va(h.defaultLogger,i,a)}static async fromEncodedArray(i,a){return ao(h.defaultLogger,i,a)}static fromValues(i){return Fi.fromValues(i)}};function lo(i){let a;switch(typeof i){case"string":a=i;break;case"object":a=i.serial;break}if(!a||typeof a!="string")throw new U("First argument of annotations.publish() must be either a Message (or at least an object with a string `serial` property) or a message serial (string)",40003,400);return a}function ro(i,a){const l=lo(i);if(!a||typeof a!="object")throw new U("Second argument of annotations.publish() must be an object (the intended annotation to publish)",40003,400);const o=Fi.fromValues(a);return o.messageSerial=l,o.action||(o.action="annotation.create"),o}function oo(i,a){return i.client.rest.channelMixin.basePath(i)+"/messages/"+encodeURIComponent(a)+"/annotations"}var Gc=class{constructor(i){this.channel=i}async publish(i,a){const l=ro(i,a),o=await l.encode(),u=this.channel.client,f=u.options,m=f.useBinaryProtocol?"msgpack":"json",p=Ce.defaultPostHeaders(u.options,{format:m}),_={};G(p,u.options.headers);const O=et([o],u._MsgPack,m);await Ze.post(u,oo(this.channel,l.messageSerial),O,p,_,null,!0)}async delete(i,a){return a.action="annotation.delete",this.publish(i,a)}async get(i,a){const l=this.channel.client,o=lo(i),u=l.options.useBinaryProtocol?"msgpack":"json",f=l.http.supportsLinkHeaders?void 0:u,m=Ce.defaultGetHeaders(l.options,{format:u});return G(m,l.options.headers),new It(l,oo(this.channel,o),m,f,async(p,_,O)=>{const L=O?p:ut(p,l._MsgPack,u);return Cl(L,this.channel)}).get(a)}},El=Gc,Yt=et;function Kn(i){const a=[];if(i)for(let l=0;l<i.length;l++)a.push(i[l].toString());return"[ "+a.join(", ")+" ]"}function co(i,a,l,o,u,f){const m=ut(i,a,f);return _s(m,l,o,u)}function _s(i,a,l,o){let u;i.error&&(u=U.fromValues(i.error));let f;i.messages&&(f=mi.fromValuesArray(i.messages));let m;a&&i.presence&&(m=a.WirePresenceMessage.fromValuesArray(i.presence));let p;l&&i.annotations&&(p=l.WireAnnotation.fromValuesArray(i.annotations));let _;return o&&i.state&&(_=o.ObjectMessage.fromValuesArray(i.state,qe,Xn)),Object.assign(new wl,ye(H({},i),{presence:m,messages:f,annotations:p,state:_,error:u}))}function Ml(i){return a=>{var l;return _s(a,{WirePresenceMessage:Ha},{WireAnnotation:yi},(l=i?.ObjectsPlugin)!=null?l:null)}}function zt(i){return Object.assign(new wl,i)}function Ia(i,a,l,o){let u="[ProtocolMessage";i.action!==void 0&&(u+="; action="+jr[i.action]||i.action);const f=["id","channel","channelSerial","connectionId","count","msgSerial","timestamp"];let m;for(let p=0;p<f.length;p++)m=f[p],i[m]!==void 0&&(u+="; "+m+"="+i[m]);if(i.messages&&(u+="; messages="+Kn(mi.fromValuesArray(i.messages))),i.presence&&a&&(u+="; presence="+Kn(a.WirePresenceMessage.fromValuesArray(i.presence))),i.annotations&&l&&(u+="; annotations="+Kn(l.WireAnnotation.fromValuesArray(i.annotations))),i.state&&o&&(u+="; state="+Kn(o.ObjectMessage.fromValuesArray(i.state,qe,Xn))),i.error&&(u+="; error="+U.fromValues(i.error).toString()),i.auth&&i.auth.accessToken&&(u+="; token="+i.auth.accessToken),i.flags&&(u+="; flags="+Br.filter(i.hasFlag).join(",")),i.params){let p="";zi(i.params,function(_){p.length>0&&(p+="; "),p+=_+"="+i.params[_]}),p.length>0&&(u+="; params=["+p+"]")}return u+="]",u}var wl=class{constructor(){this.hasFlag=i=>(this.flags&Lt[i])>0}setFlag(i){return this.flags=this.flags|Lt[i]}getMode(){return(this.flags||0)&Lt.MODE_ALL}encodeModesToFlags(i){i.forEach(a=>this.setFlag(a))}decodeModesFromFlags(){const i=[];return ps.forEach(a=>{this.hasFlag(a)&&i.push(a)}),i.length>0?i:void 0}},ea=wl,Nl=class{constructor(i,a,l,o,u){this.previous=i,this.current=a,a==="attached"&&(this.resumed=l,this.hasBacklog=o),u&&(this.reason=u)}},vi=Nl,Es=function(){};function uo(i){if(i&&"params"in i&&!S(i.params))return new U("options.params must be an object",4e4,400);if(i&&"modes"in i){if(!Array.isArray(i.modes))return new U("options.modes must be an array",4e4,400);for(let a=0;a<i.modes.length;a++){const l=i.modes[a];if(!l||typeof l!="string"||!ps.includes(String.prototype.toUpperCase.call(l)))return new U("Invalid channel mode: "+l,4e4,400)}}}var bi=class ff extends dt{constructor(a,l,o){var u,f,m;super(a.logger),this._annotations=null,this._mode=0,this.retryCount=0,this.history=async function(p){h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.history()","channel = "+this.name);const _=this.client.rest.channelMixin;if(p&&p.untilAttach){if(this.state!=="attached")throw new U("option untilAttach requires the channel to be attached",4e4,400);if(!this.properties.attachSerial)throw new U("untilAttach was specified and channel is attached, but attachSerial is not defined",4e4,400);delete p.untilAttach,p.from_serial=this.properties.attachSerial}return _.history(this,p)},this.whenState=p=>dt.prototype.whenState.call(this,p,this.state),h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel()","started; name = "+l),this.name=l,this.channelOptions=Cn((u=a._Crypto)!=null?u:null,this.logger,o),this.client=a,this._presence=a._RealtimePresence?new a._RealtimePresence.RealtimePresence(this):null,a._Annotations&&(this._annotations=new a._Annotations.RealtimeAnnotations(this)),this.connectionManager=a.connection.connectionManager,this.state="initialized",this.subscriptions=new dt(this.logger),this.syncChannelSerial=void 0,this.properties={attachSerial:void 0,channelSerial:void 0},this.setOptions(o),this.errorReason=null,this._attachResume=!1,this._decodingContext={channelOptions:this.channelOptions,plugins:a.options.plugins||{},baseEncodedPreviousPayload:void 0},this._lastPayload={messageId:null,protocolMessageChannelSerial:null,decodeFailureRecoveryInProgress:null},this._allChannelChanges=new dt(this.logger),(f=a.options.plugins)!=null&&f.Push&&(this._push=new a.options.plugins.Push.PushChannel(this)),(m=a.options.plugins)!=null&&m.Objects&&(this._objects=new a.options.plugins.Objects.Objects(this))}get presence(){return this._presence||pt("RealtimePresence"),this._presence}get annotations(){return this._annotations||pt("Annotations"),this._annotations}get push(){return this._push||pt("Push"),this._push}get objects(){return this._objects||pt("Objects"),this._objects}invalidStateError(){return new U("Channel operation failed as channel state is "+this.state,90001,400,this.errorReason||void 0)}static processListenerArgs(a){return a=Array.prototype.slice.call(a),typeof a[0]=="function"&&a.unshift(null),a}async setOptions(a){var l;const o=this.channelOptions,u=uo(a);if(u)throw u;if(this.channelOptions=Cn((l=this.client._Crypto)!=null?l:null,this.logger,a),this._decodingContext&&(this._decodingContext.channelOptions=this.channelOptions),this._shouldReattachToSetOptions(a,o))return this.attachImpl(),new Promise((f,m)=>{this._allChannelChanges.once(["attached","update","detached","failed"],function(p){switch(this.event){case"update":case"attached":f();break;default:m(p.reason)}})})}_shouldReattachToSetOptions(a,l){if(!(this.state==="attached"||this.state==="attaching"))return!1;if(a?.params){const o=Si(a.params),u=Si(l.params);if(Object.keys(o).length!==Object.keys(u).length||!Da(u,o))return!0}return!!(a?.modes&&(!l.modes||!ll(a.modes,l.modes)))}async publish(...a){let l;if(a.length==1)if(S(a[0]))l=[$t.fromValues(a[0])];else if(Array.isArray(a[0]))l=$t.fromValuesArray(a[0]);else throw new U("The single-argument form of publish() expects a message object or an array of message objects",40013,400);else l=[$t.fromValues({name:a[0],data:a[1]})];const u=this.client.options.maxMessageSize,f=await Zr(l,this.channelOptions),m=Tl(f);if(m>u)throw new U(`Maximum size of messages that can be published at once exceeded (was ${m} bytes; limit is ${u} bytes)`,40009,400);this.throwIfUnpublishableState(),h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.publish()","sending message; channel state is "+this.state+", message count = "+f.length);const p=zt({action:fe.MESSAGE,channel:this.name,messages:f});return this.sendMessage(p)}throwIfUnpublishableState(){if(!this.connectionManager.activeState())throw this.connectionManager.getError();if(this.state==="failed"||this.state==="suspended")throw this.invalidStateError()}onEvent(a){h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.onEvent()","received message");const l=this.subscriptions;for(let o=0;o<a.length;o++){const u=a[o];l.emit(u.name,u)}}async attach(){return this.state==="attached"?null:new Promise((a,l)=>{this._attach(!1,null,(o,u)=>o?l(o):a(u))})}_attach(a,l,o){o||(o=f=>{f&&h.logAction(this.logger,h.LOG_ERROR,"RealtimeChannel._attach()","Channel attach failed: "+f.toString())});const u=this.connectionManager;if(!u.activeState()){o(u.getError());return}(this.state!=="attaching"||a)&&this.requestState("attaching",l),this.once(function(f){switch(this.event){case"attached":o?.(null,f);break;case"detached":case"suspended":case"failed":o?.(f.reason||u.getError()||new U("Unable to attach; reason unknown; state = "+this.event,9e4,500));break;case"detaching":o?.(new U("Attach request superseded by a subsequent detach request",9e4,409));break}})}attachImpl(){h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.attachImpl()","sending ATTACH message");const a=zt({action:fe.ATTACH,channel:this.name,params:this.channelOptions.params,channelSerial:this.properties.channelSerial});this.channelOptions.modes&&a.encodeModesToFlags(_r(this.channelOptions.modes)),this._attachResume&&a.setFlag("ATTACH_RESUME"),this._lastPayload.decodeFailureRecoveryInProgress&&(a.channelSerial=this._lastPayload.protocolMessageChannelSerial),this.sendMessage(a).catch(Es)}async detach(){const a=this.connectionManager;if(!a.activeState())throw a.getError();switch(this.state){case"suspended":this.notifyState("detached");return;case"detached":return;case"failed":throw new U("Unable to detach; channel state = failed",90001,400);default:this.requestState("detaching");case"detaching":return new Promise((l,o)=>{this.once(function(u){switch(this.event){case"detached":l();break;case"attached":case"suspended":case"failed":o(u.reason||a.getError()||new U("Unable to detach; reason unknown; state = "+this.event,9e4,500));break;case"attaching":o(new U("Detach request superseded by a subsequent attach request",9e4,409));break}})})}}detachImpl(){h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.detach()","sending DETACH message");const a=zt({action:fe.DETACH,channel:this.name});this.sendMessage(a).catch(Es)}async subscribe(...a){const[l,o]=ff.processListenerArgs(a);if(this.state==="failed")throw U.fromValues(this.invalidStateError());return l&&typeof l=="object"&&!Array.isArray(l)?this.client._FilteredSubscriptions.subscribeFilter(this,l,o):this.subscriptions.on(l,o),this.channelOptions.attachOnSubscribe!==!1?this.attach():null}unsubscribe(...a){var l;const[o,u]=ff.processListenerArgs(a);if(typeof o=="object"&&!u||(l=this.filteredSubscriptions)!=null&&l.has(u)){this.client._FilteredSubscriptions.getAndDeleteFilteredSubscriptions(this,o,u).forEach(f=>this.subscriptions.off(f));return}this.subscriptions.off(o,u)}sync(){switch(this.state){case"initialized":case"detaching":case"detached":throw new Le("Unable to sync to channel; not attached",4e4)}const a=this.connectionManager;if(!a.activeState())throw a.getError();const l=zt({action:fe.SYNC,channel:this.name});this.syncChannelSerial&&(l.channelSerial=this.syncChannelSerial),a.send(l)}async sendMessage(a){return new Promise((l,o)=>{this.connectionManager.send(a,this.client.options.queueMessages,u=>{u?o(u):l()})})}async sendPresence(a){const l=zt({action:fe.PRESENCE,channel:this.name,presence:a});return this.sendMessage(l)}sendState(a){const l=zt({action:fe.OBJECT,channel:this.name,state:a});return this.sendMessage(l)}async processMessage(a){(a.action===fe.ATTACHED||a.action===fe.MESSAGE||a.action===fe.PRESENCE||a.action===fe.OBJECT||a.action===fe.ANNOTATION)&&this.setChannelSerial(a.channelSerial);let l,o=!1;switch(a.action){case fe.ATTACHED:{this.properties.attachSerial=a.channelSerial,this._mode=a.getMode(),this.params=a.params||{};const u=a.decodeModesFromFlags();this.modes=u&&sl(u)||void 0;const f=a.hasFlag("RESUMED"),m=a.hasFlag("HAS_PRESENCE"),p=a.hasFlag("HAS_BACKLOG"),_=a.hasFlag("HAS_OBJECTS");if(this.state==="attached"){f||(this._presence&&this._presence.onAttached(m),this._objects&&this._objects.onAttached(_));const O=new vi(this.state,this.state,f,p,a.error);this._allChannelChanges.emit("update",O),(!f||this.channelOptions.updateOnAttached)&&this.emit("update",O)}else this.state==="detaching"?this.checkPendingState():this.notifyState("attached",a.error,f,m,p,_);break}case fe.DETACHED:{const u=a.error?U.fromValues(a.error):new U("Channel detached",90001,404);this.state==="detaching"?this.notifyState("detached",u):this.state==="attaching"?this.notifyState("suspended",u):(this.state==="attached"||this.state==="suspended")&&this.requestState("attaching",u);break}case fe.SYNC:if(o=!0,l=this.syncChannelSerial=a.channelSerial,!a.presence)break;case fe.PRESENCE:{if(!a.presence)break;Wt(a);const u=this.channelOptions;if(this._presence){const f=await Promise.all(a.presence.map(m=>m.decode(u,this.logger)));this._presence.setPresence(f,o,l)}break}case fe.OBJECT:case fe.OBJECT_SYNC:{if(!this._objects||!a.state)return;Wt(a);const u=a.state,f=this.client.connection.connectionManager.getActiveTransportFormat();await Promise.all(u.map(m=>this.client._objectsPlugin.ObjectMessage.decode(m,this.client,this.logger,h,qe,f))),a.action===fe.OBJECT?this._objects.handleObjectMessages(u):this._objects.handleObjectSyncMessages(u,a.channelSerial);break}case fe.MESSAGE:{if(this.state!=="attached"){h.logAction(this.logger,h.LOG_MAJOR,"RealtimeChannel.processMessage()",'Message "'+a.id+'" skipped as this channel "'+this.name+'" state is not "attached" (state is "'+this.state+'").');return}Wt(a);const u=a.messages,f=u[0],m=u[u.length-1];if(f.extras&&f.extras.delta&&f.extras.delta.from!==this._lastPayload.messageId){const _='Delta message decode failure - previous message not available for message "'+a.id+'" on this channel "'+this.name+'".';h.logAction(this.logger,h.LOG_ERROR,"RealtimeChannel.processMessage()",_),this._startDecodeFailureRecovery(new U(_,40018,400));break}let p=[];for(let _=0;_<u.length;_++){const{decoded:O,err:L}=await u[_].decodeWithErr(this._decodingContext,this.logger);if(p[_]=O,L)switch(L.code){case 40018:this._startDecodeFailureRecovery(L);return;case 40019:case 40021:this.notifyState("failed",L);return}}this._lastPayload.messageId=m.id,this._lastPayload.protocolMessageChannelSerial=a.channelSerial,this.onEvent(p);break}case fe.ANNOTATION:{Wt(a);const u=this.channelOptions;if(this._annotations){const f=await Promise.all((a.annotations||[]).map(m=>m.decode(u,this.logger)));this._annotations._processIncoming(f)}break}case fe.ERROR:{const u=a.error;u&&u.code==80016?this.checkPendingState():this.notifyState("failed",U.fromValues(u));break}default:h.logAction(this.logger,h.LOG_MAJOR,"RealtimeChannel.processMessage()","Protocol error: unrecognised message action ("+a.action+")")}}_startDecodeFailureRecovery(a){this._lastPayload.decodeFailureRecoveryInProgress||(h.logAction(this.logger,h.LOG_MAJOR,"RealtimeChannel.processMessage()","Starting decode failure recovery process."),this._lastPayload.decodeFailureRecoveryInProgress=!0,this._attach(!0,a,()=>{this._lastPayload.decodeFailureRecoveryInProgress=!1}))}onAttached(){h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.onAttached","activating channel; name = "+this.name)}notifyState(a,l,o,u,f,m){if(h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.notifyState","name = "+this.name+", current state = "+this.state+", notifying state "+a),this.clearStateTimer(),["detached","suspended","failed"].includes(a)&&(this.properties.channelSerial=null),a===this.state)return;this._presence&&this._presence.actOnChannelState(a,u,l),this._objects&&this._objects.actOnChannelState(a,m),a==="suspended"&&this.connectionManager.state.sendEvents?this.startRetryTimer():this.cancelRetryTimer(),l&&(this.errorReason=l);const p=new vi(this.state,a,o,f,l),_='Channel state for channel "'+this.name+'"',O=a+(l?"; reason: "+l:"");a==="failed"?h.logAction(this.logger,h.LOG_ERROR,_,O):h.logAction(this.logger,h.LOG_MAJOR,_,O),a!=="attaching"&&a!=="suspended"&&(this.retryCount=0),a==="attached"&&this.onAttached(),a==="attached"?this._attachResume=!0:(a==="detaching"||a==="failed")&&(this._attachResume=!1),this.state=a,this._allChannelChanges.emit(a,p),this.emit(a,p)}requestState(a,l){h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.requestState","name = "+this.name+", state = "+a),this.notifyState(a,l),this.checkPendingState()}checkPendingState(){if(!this.connectionManager.state.sendEvents){h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.checkPendingState","sendEvents is false; state is "+this.connectionManager.state.state);return}switch(h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.checkPendingState","name = "+this.name+", state = "+this.state),this.state){case"attaching":this.startStateTimerIfNotRunning(),this.attachImpl();break;case"detaching":this.startStateTimerIfNotRunning(),this.detachImpl();break;case"attached":this.sync();break}}timeoutPendingState(){switch(this.state){case"attaching":{const a=new U("Channel attach timed out",90007,408);this.notifyState("suspended",a);break}case"detaching":{const a=new U("Channel detach timed out",90007,408);this.notifyState("attached",a);break}default:this.checkPendingState();break}}startStateTimerIfNotRunning(){this.stateTimer||(this.stateTimer=setTimeout(()=>{h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.startStateTimerIfNotRunning","timer expired"),this.stateTimer=null,this.timeoutPendingState()},this.client.options.timeouts.realtimeRequestTimeout))}clearStateTimer(){const a=this.stateTimer;a&&(clearTimeout(a),this.stateTimer=null)}startRetryTimer(){if(this.retryTimer)return;this.retryCount++;const a=Vi(this.client.options.timeouts.channelRetryTimeout,this.retryCount);this.retryTimer=setTimeout(()=>{this.state==="suspended"&&this.connectionManager.state.sendEvents&&(this.retryTimer=null,h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel retry timer expired","attempting a new attach"),this.requestState("attaching"))},a)}cancelRetryTimer(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)}getReleaseErr(){const a=this.state;return a==="initialized"||a==="detached"||a==="failed"?null:new U("Can only release a channel in a state where there is no possibility of further updates from the server being received (initialized, detached, or failed); was "+a,90001,400)}setChannelSerial(a){h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.setChannelSerial()","Updating channel serial; serial = "+a+"; previous = "+this.properties.channelSerial),a&&(this.properties.channelSerial=a)}async status(){return this.client.rest.channelMixin.status(this)}};function Si(i){const a=i||{},{agent:l}=a;return Oe(a,["agent"])}var Ai=bi,fo=class{constructor(i){this.channel=i,this.logger=i.logger,this.subscriptions=new dt(this.logger)}async publish(i,a){const l=this.channel.name,o=ro(i,a),u=await o.encode();this.channel.throwIfUnpublishableState(),h.logAction(this.logger,h.LOG_MICRO,"RealtimeAnnotations.publish()","channelName = "+l+", sending annotation with messageSerial = "+o.messageSerial+", type = "+o.type);const f=zt({action:fe.ANNOTATION,channel:l,annotations:[u]});return this.channel.sendMessage(f)}async delete(i,a){return a.action="annotation.delete",this.publish(i,a)}async subscribe(...i){const a=Ai.processListenerArgs(i),l=a[0],o=a[1],u=this.channel;if(u.state==="failed")throw U.fromValues(u.invalidStateError());if(this.subscriptions.on(l,o),this.channel.channelOptions.attachOnSubscribe!==!1&&await u.attach(),(this.channel.state==="attached"&&this.channel._mode&Lt.ANNOTATION_SUBSCRIBE)===0)throw new U("You are trying to add an annotation listener, but you haven't requested the annotation_subscribe channel mode in ChannelOptions, so this won't do anything (we only deliver annotations to clients who have explicitly requested them)",93001,400)}unsubscribe(...i){const a=Ai.processListenerArgs(i),l=a[0],o=a[1];this.subscriptions.off(l,o)}_processIncoming(i){for(const a of i)this.subscriptions.emit(a.type||"",a)}async get(i,a){return El.prototype.get.call(this,i,a)}},Jn=fo,Wn=class pc extends no{constructor(a){var l,o;if(!pc._MsgPack)throw new Error("Expected DefaultRest._MsgPack to have been set");super(Ce.objectifyOptions(a,!0,"Rest",h.defaultLogger,ye(H({},Rl),{Crypto:(l=pc.Crypto)!=null?l:void 0,MsgPack:(o=pc._MsgPack)!=null?o:void 0,Annotations:{Annotation:Fi,WireAnnotation:yi,RealtimeAnnotations:Jn,RestAnnotations:El}})))}static get Crypto(){if(this._Crypto===null)throw new Error("Encryption not enabled; use ably.encryption.js instead");return this._Crypto}static set Crypto(a){this._Crypto=a}};Wn._Crypto=null,Wn.Message=Wi,Wn.PresenceMessage=$i,Wn.Annotation=_l,Wn._MsgPack=null,Wn._Http=ms;var Ms=Wn,ho=class extends dt{constructor(i){super(i),this.messages=[]}count(){return this.messages.length}push(i){this.messages.push(i)}shift(){return this.messages.shift()}last(){return this.messages[this.messages.length-1]}copyAll(){return this.messages.slice()}append(i){this.messages.push.apply(this.messages,i)}prepend(i){this.messages.unshift.apply(this.messages,i)}completeMessages(i,a,l){h.logAction(this.logger,h.LOG_MICRO,"MessageQueue.completeMessages()","serial = "+i+"; count = "+a),l=l||null;const o=this.messages;if(o.length===0)throw new Error("MessageQueue.completeMessages(): completeMessages called on any empty MessageQueue");const u=o[0];if(u){const f=u.message.msgSerial,m=i+a;if(m>f){const p=o.splice(0,m-f);for(const _ of p)_.callback(l)}o.length==0&&this.emit("idle")}}completeAllMessages(i){this.completeMessages(0,Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,i)}resetSendAttempted(){for(let i of this.messages)i.sendAttempted=!1}clear(){h.logAction(this.logger,h.LOG_MICRO,"MessageQueue.clear()","clearing "+this.messages.length+" messages"),this.messages=[],this.emit("idle")}},go=ho,mo=class{constructor(i,a){this.message=i,this.callback=a,this.merged=!1;const l=i.action;this.sendAttempted=!1,this.ackRequired=typeof l=="number"&&[fe.MESSAGE,fe.PRESENCE,fe.ANNOTATION,fe.OBJECT].includes(l)}},zc=class extends dt{constructor(i){super(i.logger),this.transport=i,this.messageQueue=new go(this.logger),i.on("ack",(a,l)=>{this.onAck(a,l)}),i.on("nack",(a,l,o)=>{this.onNack(a,l,o)})}onAck(i,a){h.logAction(this.logger,h.LOG_MICRO,"Protocol.onAck()","serial = "+i+"; count = "+a),this.messageQueue.completeMessages(i,a)}onNack(i,a,l){h.logAction(this.logger,h.LOG_ERROR,"Protocol.onNack()","serial = "+i+"; count = "+a+"; err = "+te(l)),l||(l=new U("Unable to send message; channel not responding",50001,500)),this.messageQueue.completeMessages(i,a,l)}onceIdle(i){const a=this.messageQueue;if(a.count()===0){i();return}a.once("idle",i)}send(i){i.ackRequired&&this.messageQueue.push(i),this.logger.shouldLog(h.LOG_MICRO)&&h.logActionNoStrip(this.logger,h.LOG_MICRO,"Protocol.send()","sending msg; "+Ia(i.message,this.transport.connectionManager.realtime._RealtimePresence,this.transport.connectionManager.realtime._Annotations,this.transport.connectionManager.realtime._objectsPlugin)),i.sendAttempted=!0,this.transport.send(i.message)}getTransport(){return this.transport}getPendingMessages(){return this.messageQueue.copyAll()}clearPendingMessages(){return this.messageQueue.clear()}finish(){const i=this.transport;this.onceIdle(function(){i.disconnect()})}},po=zc,yo=class{constructor(i,a,l,o){this.previous=i,this.current=a,l&&(this.retryIn=l),o&&(this.reason=o)}},ta=yo,vt={DISCONNECTED:80003,SUSPENDED:80002,FAILED:8e4,CLOSING:80017,CLOSED:80017,UNKNOWN_CONNECTION_ERR:50002,UNKNOWN_CHANNEL_ERR:50001},vo={disconnected:()=>U.fromValues({statusCode:400,code:vt.DISCONNECTED,message:"Connection to server temporarily unavailable"}),suspended:()=>U.fromValues({statusCode:400,code:vt.SUSPENDED,message:"Connection to server unavailable"}),failed:()=>U.fromValues({statusCode:400,code:vt.FAILED,message:"Connection failed or disconnected by server"}),closing:()=>U.fromValues({statusCode:400,code:vt.CLOSING,message:"Connection closing"}),closed:()=>U.fromValues({statusCode:400,code:vt.CLOSED,message:"Connection closed"}),unknownConnectionErr:()=>U.fromValues({statusCode:500,code:vt.UNKNOWN_CONNECTION_ERR,message:"Internal connection error"}),unknownChannelErr:()=>U.fromValues({statusCode:500,code:vt.UNKNOWN_CONNECTION_ERR,message:"Internal channel error"})};function Ft(i){return!i.statusCode||!i.code||i.statusCode>=500?!0:Object.values(vt).includes(i.code)}var bt=vo,na=zt({action:fe.CLOSE}),xl=zt({action:fe.DISCONNECT}),ws=class extends dt{constructor(i,a,l,o){super(i.logger),o&&(l.format=void 0,l.heartbeats=!0),this.connectionManager=i,this.auth=a,this.params=l,this.timeouts=l.options.timeouts,this.format=l.format,this.isConnected=!1,this.isFinished=!1,this.isDisposed=!1,this.maxIdleInterval=null,this.idleTimer=null,this.lastActivity=null}connect(){}close(){this.isConnected&&this.requestClose(),this.finish("closed",bt.closed())}disconnect(i){this.isConnected&&this.requestDisconnect(),this.finish("disconnected",i||bt.disconnected())}fail(i){this.isConnected&&this.requestDisconnect(),this.finish("failed",i||bt.failed())}finish(i,a){var l;this.isFinished||(this.isFinished=!0,this.isConnected=!1,this.maxIdleInterval=null,clearTimeout((l=this.idleTimer)!=null?l:void 0),this.idleTimer=null,this.emit(i,a),this.dispose())}onProtocolMessage(i){switch(this.logger.shouldLog(h.LOG_MICRO)&&h.logActionNoStrip(this.logger,h.LOG_MICRO,"Transport.onProtocolMessage()","received on "+this.shortName+": "+Ia(i,this.connectionManager.realtime._RealtimePresence,this.connectionManager.realtime._Annotations,this.connectionManager.realtime._objectsPlugin)+"; connectionId = "+this.connectionManager.connectionId),this.onActivity(),i.action){case fe.HEARTBEAT:h.logActionNoStrip(this.logger,h.LOG_MICRO,"Transport.onProtocolMessage()",this.shortName+" heartbeat; connectionId = "+this.connectionManager.connectionId),this.emit("heartbeat",i.id);break;case fe.CONNECTED:this.onConnect(i),this.emit("connected",i.error,i.connectionId,i.connectionDetails,i);break;case fe.CLOSED:this.onClose(i);break;case fe.DISCONNECTED:this.onDisconnect(i);break;case fe.ACK:this.emit("ack",i.msgSerial,i.count);break;case fe.NACK:this.emit("nack",i.msgSerial,i.count,i.error);break;case fe.SYNC:this.connectionManager.onChannelMessage(i,this);break;case fe.ACTIVATE:break;case fe.AUTH:Xe(this.auth.authorize(),a=>{a&&h.logAction(this.logger,h.LOG_ERROR,"Transport.onProtocolMessage()","Ably requested re-authentication, but unable to obtain a new token: "+te(a))});break;case fe.ERROR:if(h.logAction(this.logger,h.LOG_MINOR,"Transport.onProtocolMessage()","received error action; connectionId = "+this.connectionManager.connectionId+"; err = "+R.Config.inspect(i.error)+(i.channel?", channel: "+i.channel:"")),i.channel===void 0){this.onFatalError(i);break}this.connectionManager.onChannelMessage(i,this);break;default:this.connectionManager.onChannelMessage(i,this)}}onConnect(i){if(this.isConnected=!0,!i.connectionDetails)throw new Error("Transport.onConnect(): Connect message recieved without connectionDetails");const a=i.connectionDetails.maxIdleInterval;a&&(this.maxIdleInterval=a+this.timeouts.realtimeRequestTimeout,this.onActivity())}onDisconnect(i){const a=i&&i.error;h.logAction(this.logger,h.LOG_MINOR,"Transport.onDisconnect()","err = "+te(a)),this.finish("disconnected",a)}onFatalError(i){const a=i&&i.error;h.logAction(this.logger,h.LOG_MINOR,"Transport.onFatalError()","err = "+te(a)),this.finish("failed",a)}onClose(i){const a=i&&i.error;h.logAction(this.logger,h.LOG_MINOR,"Transport.onClose()","err = "+te(a)),this.finish("closed",a)}requestClose(){h.logAction(this.logger,h.LOG_MINOR,"Transport.requestClose()",""),this.send(na)}requestDisconnect(){h.logAction(this.logger,h.LOG_MINOR,"Transport.requestDisconnect()",""),this.send(xl)}ping(i){const a={action:fe.HEARTBEAT};i&&(a.id=i),this.send(zt(a))}dispose(){h.logAction(this.logger,h.LOG_MINOR,"Transport.dispose()",""),this.isDisposed=!0,this.off()}onActivity(){this.maxIdleInterval&&(this.lastActivity=this.connectionManager.lastActivity=Date.now(),this.setIdleTimer(this.maxIdleInterval+100))}setIdleTimer(i){this.idleTimer||(this.idleTimer=setTimeout(()=>{this.onIdleTimerExpire()},i))}onIdleTimerExpire(){if(!this.lastActivity||!this.maxIdleInterval)throw new Error("Transport.onIdleTimerExpire(): lastActivity/maxIdleInterval not set");this.idleTimer=null;const i=Date.now()-this.lastActivity,a=this.maxIdleInterval-i;if(a<=0){const l="No activity seen from realtime in "+i+"ms; assuming connection has dropped";h.logAction(this.logger,h.LOG_ERROR,"Transport.onIdleTimerExpire()",l),this.disconnect(new U(l,80003,408))}else this.setIdleTimer(a+100)}static tryConnect(i,a,l,o,u){const f=new i(a,l,o);let m;const p=function(O){clearTimeout(m),u({event:this.event,error:O})},_=a.options.timeouts.realtimeRequestTimeout;return m=setTimeout(()=>{f.off(["preconnect","disconnected","failed"]),f.dispose(),p.call({event:"disconnected"},new U("Timeout waiting for transport to indicate itself viable",5e4,500))},_),f.on(["failed","disconnected"],p),f.on("preconnect",function(){h.logAction(a.logger,h.LOG_MINOR,"Transport.tryConnect()","viable transport "+f),clearTimeout(m),f.off(["failed","disconnected"],p),u(null,f)}),f.connect(),f}static isAvailable(){throw new U("isAvailable not implemented for transport",5e4,500)}},Mn=ws,Mt;(i=>{i.WebSocket="web_socket",i.Comet="comet",i.XhrPolling="xhr_polling"})(Mt||(Mt={}));var ia=typeof globalThis<"u"?globalThis:typeof window<"u"?window:self,Ns=()=>{var i;return typeof R.WebStorage<"u"&&((i=R.WebStorage)==null?void 0:i.localSupported)},$n=()=>{var i;return typeof R.WebStorage<"u"&&((i=R.WebStorage)==null?void 0:i.sessionSupported)},Oi=function(){},Ul="ably-transport-preference";function Pt(i,a,l){let o;if(i.channel!==a.channel||(o=i.action)!==fe.PRESENCE&&o!==fe.MESSAGE||o!==a.action)return!1;const u=o===fe.PRESENCE?"presence":"messages",f=i[u].concat(a[u]);return Tl(f)>l||!os(f,"clientId")||!f.every(function(p){return!p.id})?!1:(i[u]=f,!0)}function Ya(i){try{return JSON.parse(i)}catch{return null}}var wn=class{constructor(i,a,l,o){this.options=i,this.host=a,this.mode=l,this.connectionKey=o,this.format=i.useBinaryProtocol?"msgpack":"json"}getConnectParams(i){const a=i?me(i):{},l=this.options;switch(this.mode){case"resume":a.resume=this.connectionKey;break;case"recover":{const o=Ya(l.recover);o&&(a.recover=o.connectionKey);break}}return l.clientId!==void 0&&(a.clientId=l.clientId),l.echoMessages===!1&&(a.echo="false"),this.format!==void 0&&(a.format=this.format),this.stream!==void 0&&(a.stream=this.stream),this.heartbeats!==void 0&&(a.heartbeats=this.heartbeats),a.v=Ce.protocolVersion,a.agent=ul(this.options),l.transportParams!==void 0&&G(a,l.transportParams),a}toString(){let i="[mode="+this.mode;return this.host&&(i+=",host="+this.host),this.connectionKey&&(i+=",connectionKey="+this.connectionKey),this.format&&(i+=",format="+this.format),i+="]",i}},bo=class Zd extends dt{constructor(a,l){super(a.logger),this.supportedTransports={},this.disconnectedRetryCount=0,this.pendingChannelMessagesState={isProcessing:!1,queue:[]},this.realtime=a,this.initTransports(),this.options=l;const o=l.timeouts,u=o.webSocketConnectTimeout+o.realtimeRequestTimeout;if(this.states={initialized:{state:"initialized",terminal:!1,queueEvents:!0,sendEvents:!1,failState:"disconnected"},connecting:{state:"connecting",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:u,failState:"disconnected"},connected:{state:"connected",terminal:!1,queueEvents:!1,sendEvents:!0,failState:"disconnected"},disconnected:{state:"disconnected",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:o.disconnectedRetryTimeout,failState:"disconnected"},suspended:{state:"suspended",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:o.suspendedRetryTimeout,failState:"suspended"},closing:{state:"closing",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:o.realtimeRequestTimeout,failState:"closed"},closed:{state:"closed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"closed"},failed:{state:"failed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"failed"}},this.state=this.states.initialized,this.errorReason=null,this.queuedMessages=new go(this.logger),this.msgSerial=0,this.connectionDetails=void 0,this.connectionId=void 0,this.connectionKey=void 0,this.connectionStateTtl=o.connectionStateTtl,this.maxIdleInterval=null,this.transports=Et(l.transports||Ce.defaultTransports,this.supportedTransports),this.transportPreference=null,this.transports.includes(Mt.WebSocket)&&(this.webSocketTransportAvailable=!0),this.transports.includes(Mt.XhrPolling)?this.baseTransport=Mt.XhrPolling:this.transports.includes(Mt.Comet)&&(this.baseTransport=Mt.Comet),this.domains=Ce.getHosts(l),this.activeProtocol=null,this.host=null,this.lastAutoReconnectAttempt=null,this.lastActivity=null,this.forceFallbackHost=!1,this.connectCounter=0,this.wsCheckResult=null,this.webSocketSlowTimer=null,this.webSocketGiveUpTimer=null,this.abandonedWebSocket=!1,h.logAction(this.logger,h.LOG_MINOR,"Realtime.ConnectionManager()","started"),h.logAction(this.logger,h.LOG_MICRO,"Realtime.ConnectionManager()","requested transports = ["+(l.transports||Ce.defaultTransports)+"]"),h.logAction(this.logger,h.LOG_MICRO,"Realtime.ConnectionManager()","available transports = ["+this.transports+"]"),h.logAction(this.logger,h.LOG_MICRO,"Realtime.ConnectionManager()","http domains = ["+this.domains+"]"),!this.transports.length){const m="no requested transports available";throw h.logAction(this.logger,h.LOG_ERROR,"realtime.ConnectionManager()",m),new Error(m)}const f=R.Config.addEventListener;f&&($n()&&typeof l.recover=="function"&&f("beforeunload",this.persistConnection.bind(this)),l.closeOnUnload===!0&&f("beforeunload",()=>{h.logAction(this.logger,h.LOG_MAJOR,"Realtime.ConnectionManager()","beforeunload event has triggered the connection to close as closeOnUnload is true"),this.requestState({state:"closing"})}),f("online",()=>{var m;this.state==this.states.disconnected||this.state==this.states.suspended?(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager caught browser ‘online’ event","reattempting connection"),this.requestState({state:"connecting"})):this.state==this.states.connecting&&((m=this.pendingTransport)==null||m.off(),this.disconnectAllTransports(),this.startConnect())}),f("offline",()=>{this.state==this.states.connected&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager caught browser ‘offline’ event","disconnecting active transport"),this.disconnectAllTransports())}))}static supportedTransports(a){const l={supportedTransports:{}};return this.initTransports(a,l),l.supportedTransports}static initTransports(a,l){const o=H(H({},R.Transports.bundledImplementations),a);[Mt.WebSocket,...R.Transports.order].forEach(u=>{const f=o[u];f&&f.isAvailable()&&(l.supportedTransports[u]=f)})}initTransports(){Zd.initTransports(this.realtime._additionalTransportImplementations,this)}createTransportParams(a,l){return new wn(this.options,a,l,this.connectionKey)}getTransportParams(a){(o=>{if(this.connectionKey){o("resume");return}if(typeof this.options.recover=="string"){o("recover");return}const u=this.options.recover,f=this.getSessionRecoverData(),m=this.sessionRecoveryName();if(f&&typeof u=="function"){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.getTransportParams()","Calling clientOptions-provided recover function with last session data (recovery scope: "+m+")"),u(f,p=>{p?(this.options.recover=f.recoveryKey,o("recover")):o("clean")});return}o("clean")})(o=>{const u=this.createTransportParams(null,o);if(o==="recover"){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport recovery mode = recover; recoveryKey = "+this.options.recover);const f=Ya(this.options.recover);f&&(this.msgSerial=f.msgSerial)}else h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport params = "+u.toString());a(u)})}tryATransport(a,l,o){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.tryATransport()","trying "+l),this.proposedTransport=Mn.tryConnect(this.supportedTransports[l],this,this.realtime.auth,a,(u,f)=>{const m=this.state;if(m==this.states.closing||m==this.states.closed||m==this.states.failed){f&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.tryATransport()","connection "+m.state+" while we were attempting the transport; closing "+f),f.close()),o(!0);return}if(u){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.tryATransport()","transport "+l+" "+u.event+", err: "+u.error.toString()),gn.isTokenErr(u.error)&&!(this.errorReason&&gn.isTokenErr(this.errorReason))?(this.errorReason=u.error,Xe(this.realtime.auth._forceNewToken(null,null),p=>{if(p){this.actOnErrorFromAuthorize(p);return}this.tryATransport(a,l,o)})):u.event==="failed"?(this.notifyState({state:"failed",error:u.error}),o(!0)):u.event==="disconnected"&&(Ft(u.error)?o(!1):(this.notifyState({state:this.states.connecting.failState,error:u.error}),o(!0)));return}h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.tryATransport()","viable transport "+l+"; setting pending"),this.setTransportPending(f,a),o(null,f)})}setTransportPending(a,l){const o=l.mode;h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.setTransportPending()","transport = "+a+"; mode = "+o),this.pendingTransport=a,this.cancelWebSocketSlowTimer(),this.cancelWebSocketGiveUpTimer(),a.once("connected",(f,m,p)=>{this.activateTransport(f,a,m,p),o==="recover"&&this.options.recover&&(delete this.options.recover,this.unpersistConnection())});const u=this;a.on(["disconnected","closed","failed"],function(f){u.deactivateTransport(a,this.event,f)}),this.emit("transport.pending",a)}activateTransport(a,l,o,u){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.activateTransport()","transport = "+l),a&&h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.activateTransport()","error = "+a),o&&h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.activateTransport()","connectionId =  "+o),u&&h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.activateTransport()","connectionDetails =  "+JSON.stringify(u)),this.persistTransportPreference(l);const f=this.state,m=this.states.connected.state;if(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.activateTransport()","current state = "+f.state),f.state==this.states.closing.state||f.state==this.states.closed.state||f.state==this.states.failed.state)return h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.activateTransport()","Disconnecting transport and abandoning"),l.disconnect(),!1;if(delete this.pendingTransport,!l.isConnected)return h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.activateTransport()","Declining to activate transport "+l+" since it appears to no longer be connected"),!1;const p=this.activeProtocol;this.activeProtocol=new po(l),this.host=l.params.host;const _=u.connectionKey;if(_&&this.connectionKey!=_&&this.setConnection(o,u,!!a),this.onConnectionDetailsUpdate(u,l),R.Config.nextTick(()=>{l.on("connected",(O,L,j)=>{this.onConnectionDetailsUpdate(j,l),this.emit("update",new ta(m,m,null,O))})}),f.state===this.states.connected.state?a&&(this.errorReason=this.realtime.connection.errorReason=a,this.emit("update",new ta(m,m,null,a))):(this.notifyState({state:"connected",error:a}),this.errorReason=this.realtime.connection.errorReason=a||null),this.emit("transport.active",l),p)if(p.messageQueue.count()>0&&h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.activateTransport()","Previous active protocol (for transport "+p.transport.shortName+", new one is "+l.shortName+") finishing with "+p.messageQueue.count()+" messages still pending"),p.transport===l){const O="Assumption violated: activating a transport that was also the transport for the previous active protocol; transport = "+l.shortName+"; stack = "+new Error().stack;h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.activateTransport()",O)}else p.finish();return!0}deactivateTransport(a,l,o){const u=this.activeProtocol,f=u&&u.getTransport()===a,m=a===this.pendingTransport,p=this.noTransportsScheduledForActivation();if(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.deactivateTransport()","transport = "+a),h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.deactivateTransport()","state = "+l+(f?"; was active":m?"; was pending":"")+(p?"":"; another transport is scheduled for activation")),o&&o.message&&h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.deactivateTransport()","reason =  "+o.message),f&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.deactivateTransport()","Getting, clearing, and requeuing "+this.activeProtocol.messageQueue.count()+" pending messages"),this.queuePendingMessages(u.getPendingMessages()),u.clearPendingMessages(),this.activeProtocol=this.host=null),this.emit("transport.inactive",a),f&&p||f&&l==="failed"||l==="closed"||u===null&&m){if(l==="disconnected"&&o&&o.statusCode>500&&this.domains.length>1){this.unpersistTransportPreference(),this.forceFallbackHost=!0,this.notifyState({state:l,error:o,retryImmediately:!0});return}const _=l==="failed"&&gn.isTokenErr(o)?"disconnected":l;this.notifyState({state:_,error:o});return}}noTransportsScheduledForActivation(){return!this.pendingTransport||!this.pendingTransport.isConnected}setConnection(a,l,o){const u=this.connectionId;(u&&u!==a||!u&&o)&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.setConnection()","Resetting msgSerial"),this.msgSerial=0,this.queuedMessages.resetSendAttempted()),this.connectionId!==a&&h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.setConnection()","New connectionId; reattaching any attached channels"),this.realtime.connection.id=this.connectionId=a,this.realtime.connection.key=this.connectionKey=l.connectionKey}clearConnection(){this.realtime.connection.id=this.connectionId=void 0,this.realtime.connection.key=this.connectionKey=void 0,this.msgSerial=0,this.unpersistConnection()}createRecoveryKey(){return this.connectionKey?JSON.stringify({connectionKey:this.connectionKey,msgSerial:this.msgSerial,channelSerials:this.realtime.channels.channelSerials()}):null}checkConnectionStateFreshness(){if(!this.lastActivity||!this.connectionId)return;const a=Date.now()-this.lastActivity;a>this.connectionStateTtl+this.maxIdleInterval&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.checkConnectionStateFreshness()","Last known activity from realtime was "+a+"ms ago; discarding connection state"),this.clearConnection(),this.states.connecting.failState="suspended")}persistConnection(){if($n()){const a=this.createRecoveryKey();a&&this.setSessionRecoverData({recoveryKey:a,disconnectedAt:Date.now(),location:ia.location,clientId:this.realtime.auth.clientId})}}unpersistConnection(){this.clearSessionRecoverData()}getActiveTransportFormat(){var a;return(a=this.activeProtocol)==null?void 0:a.getTransport().format}getError(){if(this.errorReason){const a=Le.fromValues(this.errorReason);return a.cause=this.errorReason,a}return this.getStateError()}getStateError(){var a,l;return(l=(a=bt)[this.state.state])==null?void 0:l.call(a)}activeState(){return this.state.queueEvents||this.state.sendEvents}enactStateChange(a){const l="Connection state",o=a.current+(a.reason?"; reason: "+a.reason:"");a.current==="failed"?h.logAction(this.logger,h.LOG_ERROR,l,o):h.logAction(this.logger,h.LOG_MAJOR,l,o),h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.enactStateChange","setting new state: "+a.current+"; reason = "+(a.reason&&a.reason.message));const u=this.state=this.states[a.current];a.reason&&(this.errorReason=a.reason,this.realtime.connection.errorReason=a.reason),(u.terminal||u.state==="suspended")&&this.clearConnection(),this.emit("connectionstate",a)}startTransitionTimer(a){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.startTransitionTimer()","transitionState: "+a.state),this.transitionTimer&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.startTransitionTimer()","clearing already-running timer"),clearTimeout(this.transitionTimer)),this.transitionTimer=setTimeout(()=>{this.transitionTimer&&(this.transitionTimer=null,h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager "+a.state+" timer expired","requesting new state: "+a.failState),this.notifyState({state:a.failState}))},a.retryDelay)}cancelTransitionTimer(){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.cancelTransitionTimer()",""),this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null)}startSuspendTimer(){this.suspendTimer||(this.suspendTimer=setTimeout(()=>{this.suspendTimer&&(this.suspendTimer=null,h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager suspend timer expired","requesting new state: suspended"),this.states.connecting.failState="suspended",this.notifyState({state:"suspended"}))},this.connectionStateTtl))}checkSuspendTimer(a){a!=="disconnected"&&a!=="suspended"&&a!=="connecting"&&this.cancelSuspendTimer()}cancelSuspendTimer(){this.states.connecting.failState="disconnected",this.suspendTimer&&(clearTimeout(this.suspendTimer),this.suspendTimer=null)}startRetryTimer(a){this.retryTimer=setTimeout(()=>{h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager retry timer expired","retrying"),this.retryTimer=null,this.requestState({state:"connecting"})},a)}cancelRetryTimer(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)}startWebSocketSlowTimer(){this.webSocketSlowTimer=setTimeout(()=>{h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager WebSocket slow timer","checking connectivity"),this.checkWsConnectivity().then(()=>{h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager WebSocket slow timer","ws connectivity check succeeded"),this.wsCheckResult=!0}).catch(()=>{h.logAction(this.logger,h.LOG_MAJOR,"ConnectionManager WebSocket slow timer","ws connectivity check failed"),this.wsCheckResult=!1}),this.realtime.http.checkConnectivity&&Xe(this.realtime.http.checkConnectivity(),(a,l)=>{a||!l?(h.logAction(this.logger,h.LOG_MAJOR,"ConnectionManager WebSocket slow timer","http connectivity check failed"),this.cancelWebSocketGiveUpTimer(),this.notifyState({state:"disconnected",error:new U("Unable to connect (network unreachable)",80003,404)})):h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager WebSocket slow timer","http connectivity check succeeded")})},this.options.timeouts.webSocketSlowTimeout)}cancelWebSocketSlowTimer(){this.webSocketSlowTimer&&(clearTimeout(this.webSocketSlowTimer),this.webSocketSlowTimer=null)}startWebSocketGiveUpTimer(a){this.webSocketGiveUpTimer=setTimeout(()=>{var l,o;this.wsCheckResult||(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager WebSocket give up timer","websocket connection took more than 10s; "+(this.baseTransport?"trying base transport":"")),this.baseTransport?(this.abandonedWebSocket=!0,(l=this.proposedTransport)==null||l.dispose(),(o=this.pendingTransport)==null||o.dispose(),this.connectBase(a,++this.connectCounter)):h.logAction(this.logger,h.LOG_MAJOR,"ConnectionManager WebSocket give up timer","websocket connectivity appears to be unavailable but no other transports to try"))},this.options.timeouts.webSocketConnectTimeout)}cancelWebSocketGiveUpTimer(){this.webSocketGiveUpTimer&&(clearTimeout(this.webSocketGiveUpTimer),this.webSocketGiveUpTimer=null)}notifyState(a){var l,o;const u=a.state,f=u==="disconnected"&&(this.state===this.states.connected||a.retryImmediately||this.state===this.states.connecting&&a.error&&gn.isTokenErr(a.error)&&!(this.errorReason&&gn.isTokenErr(this.errorReason)));if(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.notifyState()","new state: "+u+(f?"; will retry connection immediately":"")),u==this.state.state||(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.cancelWebSocketSlowTimer(),this.cancelWebSocketGiveUpTimer(),this.checkSuspendTimer(a.state),(u==="suspended"||u==="connected")&&(this.disconnectedRetryCount=0),this.state.terminal))return;const m=this.states[a.state];let p=m.retryDelay;m.state==="disconnected"&&(this.disconnectedRetryCount++,p=Vi(m.retryDelay,this.disconnectedRetryCount));const _=new ta(this.state.state,m.state,p,a.error||((o=(l=bt)[m.state])==null?void 0:o.call(l)));if(f){const O=()=>{this.state===this.states.disconnected&&(this.lastAutoReconnectAttempt=Date.now(),this.requestState({state:"connecting"}))},L=this.lastAutoReconnectAttempt&&Date.now()-this.lastAutoReconnectAttempt+1;L&&L<1e3?(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.notifyState()","Last reconnect attempt was only "+L+"ms ago, waiting another "+(1e3-L)+"ms before trying again"),setTimeout(O,1e3-L)):R.Config.nextTick(O)}else(u==="disconnected"||u==="suspended")&&this.startRetryTimer(p);(u==="disconnected"&&!f||u==="suspended"||m.terminal)&&R.Config.nextTick(()=>{this.disconnectAllTransports()}),u=="connected"&&!this.activeProtocol&&h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.notifyState()","Broken invariant: attempted to go into connected state, but there is no active protocol"),this.enactStateChange(_),this.state.sendEvents?this.sendQueuedMessages():this.state.queueEvents||(this.realtime.channels.propogateConnectionInterruption(u,_.reason),this.failQueuedMessages(_.reason))}requestState(a){var l,o;const u=a.state;if(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.requestState()","requested state: "+u+"; current state: "+this.state.state),u==this.state.state||(this.cancelWebSocketSlowTimer(),this.cancelWebSocketGiveUpTimer(),this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(u),u=="connecting"&&this.state.state=="connected")||u=="closing"&&this.state.state=="closed")return;const f=this.states[u],m=new ta(this.state.state,f.state,null,a.error||((o=(l=bt)[f.state])==null?void 0:o.call(l)));this.enactStateChange(m),u=="connecting"&&R.Config.nextTick(()=>{this.startConnect()}),u=="closing"&&this.closeImpl()}startConnect(){if(this.state!==this.states.connecting){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.startConnect()","Must be in connecting state to connect, but was "+this.state.state);return}const a=this.realtime.auth,l=++this.connectCounter,o=()=>{this.checkConnectionStateFreshness(),this.getTransportParams(u=>{if(u.mode==="recover"&&u.options.recover){const f=Ya(u.options.recover);f&&this.realtime.channels.recoverChannels(f.channelSerials)}l===this.connectCounter&&this.connectImpl(u,l)})};if(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.startConnect()","starting connection"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),a.method==="basic")o();else{const u=f=>{l===this.connectCounter&&(f?this.actOnErrorFromAuthorize(f):o())};this.errorReason&&gn.isTokenErr(this.errorReason)?Xe(a._forceNewToken(null,null),u):Xe(a._ensureValidAuthCredentials(!1),u)}}connectImpl(a,l){const o=this.state.state;if(o!==this.states.connecting.state){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.connectImpl()","Must be in connecting state to connect, but was "+o);return}const u=this.getTransportPreference();u&&u===this.baseTransport&&this.webSocketTransportAvailable&&this.checkWsConnectivity().then(()=>{this.unpersistTransportPreference(),this.state===this.states.connecting&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.connectImpl():","web socket connectivity available, cancelling connection attempt with "+this.baseTransport),this.disconnectAllTransports(),this.connectWs(a,++this.connectCounter))}).catch(Oi),u&&u===this.baseTransport||this.baseTransport&&!this.webSocketTransportAvailable?this.connectBase(a,l):this.connectWs(a,l)}connectWs(a,l){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.connectWs()"),this.wsCheckResult=null,this.abandonedWebSocket=!1,this.startWebSocketSlowTimer(),this.startWebSocketGiveUpTimer(a),this.tryTransportWithFallbacks("web_socket",a,!0,l,()=>this.wsCheckResult!==!1&&!this.abandonedWebSocket)}connectBase(a,l){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.connectBase()"),this.baseTransport?this.tryTransportWithFallbacks(this.baseTransport,a,!1,l,()=>!0):this.notifyState({state:"disconnected",error:new U("No transports left to try",8e4,404)})}tryTransportWithFallbacks(a,l,o,u,f){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.tryTransportWithFallbacks()",a);const m=j=>{this.notifyState({state:this.states.connecting.failState,error:j})},p=this.domains.slice(),_=(j,K)=>{if(u===this.connectCounter){if(!f()){K&&K.dispose();return}!K&&!j&&L()}},O=p.shift();if(!O){m(new U("Unable to connect (no available host)",80003,404));return}l.host=O;const L=()=>{if(!p.length){m(new U("Unable to connect (and no more fallback hosts to try)",80003,404));return}if(!this.realtime.http.checkConnectivity){m(new Le("Internal error: Http.checkConnectivity not set",null,500));return}Xe(this.realtime.http.checkConnectivity(),(j,K)=>{if(u===this.connectCounter&&f()){if(j){m(j);return}if(!K){m(new U("Unable to connect (network unreachable)",80003,404));return}l.host=X(p),this.tryATransport(l,a,_)}})};if(this.forceFallbackHost&&p.length){this.forceFallbackHost=!1,L();return}this.tryATransport(l,a,_)}closeImpl(){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.closeImpl()","closing connection"),this.cancelSuspendTimer(),this.startTransitionTimer(this.states.closing),this.pendingTransport&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.closeImpl()","Closing pending transport: "+this.pendingTransport),this.pendingTransport.close()),this.activeProtocol&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.closeImpl()","Closing active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().close()),this.notifyState({state:"closed"})}onAuthUpdated(a,l){var o;switch(this.state.state){case"connected":{h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Sending AUTH message on active transport");const u=(o=this.activeProtocol)==null?void 0:o.getTransport();u&&u.onAuthUpdated&&u.onAuthUpdated(a);const f=zt({action:fe.AUTH,auth:{accessToken:a.token}});this.send(f);const m=()=>{this.off(p),l(null,a)},p=_=>{_.current==="failed"&&(this.off(m),this.off(p),l(_.reason||this.getStateError()))};this.once("connectiondetails",m),this.on("connectionstate",p);break}case"connecting":h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Aborting current connection attempts in order to start again with the new auth details"),this.disconnectAllTransports();default:{h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Connection state is "+this.state.state+"; waiting until either connected or failed");const u=f=>{switch(f.current){case"connected":this.off(u),l(null,a);break;case"failed":case"closed":case"suspended":this.off(u),l(f.reason||this.getStateError());break}};this.on("connectionstate",u),this.state.state==="connecting"?this.startConnect():this.requestState({state:"connecting"})}}}disconnectAllTransports(){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.disconnectAllTransports()","Disconnecting all transports"),this.connectCounter++,this.pendingTransport&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting pending transport: "+this.pendingTransport),this.pendingTransport.disconnect()),delete this.pendingTransport,this.proposedTransport&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting proposed transport: "+this.pendingTransport),this.proposedTransport.disconnect()),delete this.pendingTransport,this.activeProtocol&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().disconnect())}send(a,l,o){o=o||Oi;const u=this.state;if(u.sendEvents){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.send()","sending event"),this.sendImpl(new mo(a,o));return}if(!(l&&u.queueEvents)){const m="rejecting event, queueEvent was "+l+", state was "+u.state;h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.send()",m),o(this.errorReason||new U(m,9e4,400));return}this.logger.shouldLog(h.LOG_MICRO)&&h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.send()","queueing msg; "+Ia(a,this.realtime._RealtimePresence,this.realtime._Annotations,this.realtime._objectsPlugin)),this.queue(a,o)}sendImpl(a){const l=a.message;a.ackRequired&&!a.sendAttempted&&(l.msgSerial=this.msgSerial++);try{this.activeProtocol.send(a)}catch(o){h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.sendImpl()","Unexpected exception in transport.send(): "+o.stack)}}queue(a,l){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.queue()","queueing event");const o=this.queuedMessages.last(),u=this.options.maxMessageSize;o&&!o.sendAttempted&&Pt(o.message,a,u)?(o.merged||(o.callback=Yn.create(this.logger,[o.callback]),o.merged=!0),o.callback.push(l)):this.queuedMessages.push(new mo(a,l))}sendQueuedMessages(){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.sendQueuedMessages()","sending "+this.queuedMessages.count()+" queued messages");let a;for(;a=this.queuedMessages.shift();)this.sendImpl(a)}queuePendingMessages(a){a&&a.length&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.queuePendingMessages()","queueing "+a.length+" pending messages"),this.queuedMessages.prepend(a))}failQueuedMessages(a){const l=this.queuedMessages.count();l>0&&(h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.failQueuedMessages()","failing "+l+" queued messages, err = "+te(a)),this.queuedMessages.completeAllMessages(a))}onChannelMessage(a,l){this.pendingChannelMessagesState.queue.push({message:a,transport:l}),this.pendingChannelMessagesState.isProcessing||this.processNextPendingChannelMessage()}processNextPendingChannelMessage(){if(this.pendingChannelMessagesState.queue.length>0){this.pendingChannelMessagesState.isProcessing=!0;const a=this.pendingChannelMessagesState.queue.shift();this.processChannelMessage(a.message).catch(l=>{h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.processNextPendingChannelMessage() received error ",l)}).finally(()=>{this.pendingChannelMessagesState.isProcessing=!1,this.processNextPendingChannelMessage()})}}async processChannelMessage(a){await this.realtime.channels.processChannelMessage(a)}async ping(){var a;if(this.state.state!=="connected")throw new U("Unable to ping service; not connected",4e4,400);const l=(a=this.activeProtocol)==null?void 0:a.getTransport();if(!l)throw this.getStateError();h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.ping()","transport = "+l);const o=Date.now(),u=dn();return Yi(new Promise(f=>{const m=p=>{p===u&&(l.off("heartbeat",m),f(Date.now()-o))};l.on("heartbeat",m),l.ping(u)}),this.options.timeouts.realtimeRequestTimeout,"Timeout waiting for heartbeat response")}abort(a){this.activeProtocol.getTransport().fail(a)}getTransportPreference(){var a,l;return this.transportPreference||Ns()&&((l=(a=R.WebStorage)==null?void 0:a.get)==null?void 0:l.call(a,Ul))}persistTransportPreference(a){var l,o;this.transportPreference=a.shortName,Ns()&&((o=(l=R.WebStorage)==null?void 0:l.set)==null||o.call(l,Ul,a.shortName))}unpersistTransportPreference(){var a,l;this.transportPreference=null,Ns()&&((l=(a=R.WebStorage)==null?void 0:a.remove)==null||l.call(a,Ul))}actOnErrorFromAuthorize(a){if(a.code===40171)this.notifyState({state:"failed",error:a});else if(a.code===40102)this.notifyState({state:"failed",error:a});else if(a.statusCode===hi.Forbidden){const l="Client configured authentication provider returned 403; failing the connection";h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.actOnErrorFromAuthorize()",l),this.notifyState({state:"failed",error:new U(l,80019,403,a)})}else{const l="Client configured authentication provider request failed";h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.actOnErrorFromAuthorize",l),this.notifyState({state:this.state.failState,error:new U(l,80019,401,a)})}}onConnectionDetailsUpdate(a,l){if(!a)return;this.connectionDetails=a,a.maxMessageSize&&(this.options.maxMessageSize=a.maxMessageSize);const o=a.clientId;if(o){const f=this.realtime.auth._uncheckedSetClientId(o);if(f){h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.onConnectionDetailsUpdate()",f.message),l.fail(f);return}}const u=a.connectionStateTtl;u&&(this.connectionStateTtl=u),this.maxIdleInterval=a.maxIdleInterval,this.emit("connectiondetails",a)}checkWsConnectivity(){const a=this.options.wsConnectivityCheckUrl||Ce.wsConnectivityCheckUrl,l=new R.Config.WebSocket(a);return new Promise((o,u)=>{let f=!1;l.onopen=()=>{f||(f=!0,o(),l.close())},l.onclose=l.onerror=()=>{f||(f=!0,u())}})}sessionRecoveryName(){return this.options.recoveryKeyStorageName||"ably-connection-recovery"}getSessionRecoverData(){var a,l;return $n()&&((l=(a=R.WebStorage)==null?void 0:a.getSession)==null?void 0:l.call(a,this.sessionRecoveryName()))}setSessionRecoverData(a){var l,o;return $n()&&((o=(l=R.WebStorage)==null?void 0:l.setSession)==null?void 0:o.call(l,this.sessionRecoveryName(),a))}clearSessionRecoverData(){var a,l;return $n()&&((l=(a=R.WebStorage)==null?void 0:a.removeSession)==null?void 0:l.call(a,this.sessionRecoveryName()))}},Pa=bo,Ti=class extends dt{constructor(i,a){super(i.logger),this.whenState=l=>dt.prototype.whenState.call(this,l,this.state),this.ably=i,this.connectionManager=new Pa(i,a),this.state=this.connectionManager.state.state,this.key=void 0,this.id=void 0,this.errorReason=null,this.connectionManager.on("connectionstate",l=>{const o=this.state=l.current;R.Config.nextTick(()=>{this.emit(o,l)})}),this.connectionManager.on("update",l=>{R.Config.nextTick(()=>{this.emit("update",l)})})}connect(){h.logAction(this.logger,h.LOG_MINOR,"Connection.connect()",""),this.connectionManager.requestState({state:"connecting"})}async ping(){return h.logAction(this.logger,h.LOG_MINOR,"Connection.ping()",""),this.connectionManager.ping()}close(){h.logAction(this.logger,h.LOG_MINOR,"Connection.close()","connectionKey = "+this.key),this.connectionManager.requestState({state:"closing"})}get recoveryKey(){return this.logger.deprecationWarning("The `Connection.recoveryKey` attribute has been replaced by the `Connection.createRecoveryKey()` method. Replace your usage of `recoveryKey` with the return value of `createRecoveryKey()`. `recoveryKey` will be removed in a future version."),this.createRecoveryKey()}createRecoveryKey(){return this.connectionManager.createRecoveryKey()}},Dl=Ti,xs=class Kd extends bs{constructor(a){var l,o,u,f;if(super(Ce.objectifyOptions(a,!1,"BaseRealtime",h.defaultLogger)),h.logAction(this.logger,h.LOG_MINOR,"Realtime()",""),typeof EdgeRuntime=="string")throw new U(`Ably.Realtime instance cannot be used in Vercel Edge runtime. If you are running Vercel Edge functions, please replace your "new Ably.Realtime()" with "new Ably.Rest()" and use Ably Rest API instead of the Realtime API. If you are server-rendering your application in the Vercel Edge runtime, please use the condition "if (typeof EdgeRuntime === 'string')" to prevent instantiating Ably.Realtime instance during SSR in the Vercel Edge runtime.`,4e4,400);this._additionalTransportImplementations=Kd.transportImplementationsFromPlugins(this.options.plugins),this._RealtimePresence=(o=(l=this.options.plugins)==null?void 0:l.RealtimePresence)!=null?o:null,this._objectsPlugin=(f=(u=this.options.plugins)==null?void 0:u.Objects)!=null?f:null,this.connection=new Dl(this,this.options),this._channels=new sa(this),this.options.autoConnect!==!1&&this.connect()}static transportImplementationsFromPlugins(a){const l={};return a?.WebSocketTransport&&(l[Mt.WebSocket]=a.WebSocketTransport),a?.XHRPolling&&(l[Mt.XhrPolling]=a.XHRPolling),l}get channels(){return this._channels}connect(){h.logAction(this.logger,h.LOG_MINOR,"Realtime.connect()",""),this.connection.connect()}close(){h.logAction(this.logger,h.LOG_MINOR,"Realtime.close()",""),this.connection.close()}};xs.EventEmitter=dt;var aa=xs,sa=class extends dt{constructor(i){super(i.logger),this.realtime=i,this.all=Object.create(null),i.connection.connectionManager.on("transport.active",()=>{this.onTransportActive()})}channelSerials(){let i={};for(const a of On(this.all,!0)){const l=this.all[a];l.properties.channelSerial&&(i[a]=l.properties.channelSerial)}return i}recoverChannels(i){for(const a of On(i,!0)){const l=this.get(a);l.properties.channelSerial=i[a]}}async processChannelMessage(i){const a=i.channel;if(a===void 0){h.logAction(this.logger,h.LOG_ERROR,"Channels.processChannelMessage()","received event unspecified channel, action = "+i.action);return}const l=this.all[a];if(!l){h.logAction(this.logger,h.LOG_ERROR,"Channels.processChannelMessage()","received event for non-existent channel: "+a);return}await l.processMessage(i)}onTransportActive(){for(const i in this.all){const a=this.all[i];a.state==="attaching"||a.state==="detaching"?a.checkPendingState():a.state==="suspended"?a._attach(!1,null):a.state==="attached"&&a.requestState("attaching")}}propogateConnectionInterruption(i,a){const l={closing:"detached",closed:"detached",failed:"failed",suspended:"suspended"},o=["attaching","attached","detaching","suspended"],u=l[i];for(const f in this.all){const m=this.all[f];o.includes(m.state)&&m.notifyState(u,a)}}get(i,a){i=String(i);let l=this.all[i];if(!l)l=this.all[i]=new Ai(this.realtime,i,a);else if(a){if(l._shouldReattachToSetOptions(a,l.channelOptions))throw new U("Channels.get() cannot be used to set channel options that would cause the channel to reattach. Please, use RealtimeChannel.setOptions() instead.",4e4,400);l.setOptions(a)}return l}getDerived(i,a,l){if(a.filter){const o=us(a.filter),u=Ii(i);i=`[filter=${o}${u.qualifierParam}]${u.channelName}`}return this.get(i,l)}release(i){i=String(i);const a=this.all[i];if(!a)return;const l=a.getReleaseErr();if(l)throw l;delete this.all[i]}},Us=aa;function Ds(i,a){if(i.isSynthesized()||a.isSynthesized())return i.timestamp>=a.timestamp;const l=i.parseId(),o=a.parseId();return l.msgSerial===o.msgSerial?l.index>o.index:l.msgSerial>o.msgSerial}var Ht=class extends dt{constructor(i,a,l=Ds){super(i.logger),this.presence=i,this.map=Object.create(null),this.syncInProgress=!1,this.residualMembers=null,this.memberKey=a,this.newerThan=l}get(i){return this.map[i]}getClient(i){const a=this.map,l=[];for(const o in a){const u=a[o];u.clientId==i&&u.action!="absent"&&l.push(u)}return l}list(i){const a=this.map,l=i&&i.clientId,o=i&&i.connectionId,u=[];for(const f in a){const m=a[f];m.action!=="absent"&&(l&&l!=m.clientId||o&&o!=m.connectionId||u.push(m))}return u}put(i){(i.action==="enter"||i.action==="update")&&(i=pn.fromValues(i),i.action="present");const a=this.map,l=this.memberKey(i);this.residualMembers&&delete this.residualMembers[l];const o=a[l];return o&&!this.newerThan(i,o)?!1:(a[l]=i,!0)}values(){const i=this.map,a=[];for(const l in i){const o=i[l];o.action!="absent"&&a.push(o)}return a}remove(i){const a=this.map,l=this.memberKey(i),o=a[l];return o&&!this.newerThan(i,o)?!1:(this.syncInProgress?(i=pn.fromValues(i),i.action="absent",a[l]=i):delete a[l],!!o)}startSync(){const i=this.map,a=this.syncInProgress;h.logAction(this.logger,h.LOG_MINOR,"PresenceMap.startSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+a),this.syncInProgress||(this.residualMembers=me(i),this.setInProgress(!0))}endSync(){const i=this.map,a=this.syncInProgress;if(h.logAction(this.logger,h.LOG_MINOR,"PresenceMap.endSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+a),a){for(const l in i)i[l].action==="absent"&&delete i[l];this.presence._synthesizeLeaves(Gi(this.residualMembers));for(const l in this.residualMembers)delete i[l];this.residualMembers=null,this.setInProgress(!1)}this.emit("sync")}waitSync(i){const a=this.syncInProgress;if(h.logAction(this.logger,h.LOG_MINOR,"PresenceMap.waitSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+a),!a){i();return}this.once("sync",i)}clear(){this.map={},this.setInProgress(!1),this.residualMembers=null}setInProgress(i){h.logAction(this.logger,h.LOG_MICRO,"PresenceMap.setInProgress()","inProgress = "+i),this.syncInProgress=i,this.presence.syncComplete=!i}};function en(i){return i.channel.client.auth.clientId}function Nn(i){const a=i.channel.client,l=a.auth.clientId;return(!l||l==="*")&&a.connection.state==="connected"}function xn(i,a,l){switch(i.state){case"attached":case"suspended":l();break;case"initialized":case"detached":case"detaching":case"attaching":Xe(i.attach(),function(o){o?a(o):l()});break;default:a(U.fromValues(i.invalidStateError()))}}var Un=class extends dt{constructor(i){super(i.logger),this.channel=i,this.syncComplete=!1,this.members=new Ht(this,a=>a.clientId+":"+a.connectionId),this._myMembers=new Ht(this,a=>a.clientId),this.subscriptions=new dt(this.logger),this.pendingPresence=[]}async enter(i){if(Nn(this))throw new U("clientId must be specified to enter a presence channel",40012,400);return this._enterOrUpdateClient(void 0,void 0,i,"enter")}async update(i){if(Nn(this))throw new U("clientId must be specified to update presence data",40012,400);return this._enterOrUpdateClient(void 0,void 0,i,"update")}async enterClient(i,a){return this._enterOrUpdateClient(void 0,i,a,"enter")}async updateClient(i,a){return this._enterOrUpdateClient(void 0,i,a,"update")}async _enterOrUpdateClient(i,a,l,o){const u=this.channel;if(!u.connectionManager.activeState())throw u.connectionManager.getError();h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence."+o+"Client()","channel = "+u.name+", id = "+i+", client = "+(a||"(implicit) "+en(this)));const f=pn.fromData(l);f.action=o,i&&(f.id=i),a&&(f.clientId=a);const m=await f.encode(u.channelOptions);switch(u.state){case"attached":return u.sendPresence([m]);case"initialized":case"detached":u.attach();case"attaching":return new Promise((p,_)=>{this.pendingPresence.push({presence:m,callback:O=>O?_(O):p()})});default:{const p=new Le("Unable to "+o+" presence channel while in "+u.state+" state",90001);throw p.code=90001,p}}}async leave(i){if(Nn(this))throw new U("clientId must have been specified to enter or leave a presence channel",40012,400);return this.leaveClient(void 0,i)}async leaveClient(i,a){const l=this.channel;if(!l.connectionManager.activeState())throw l.connectionManager.getError();h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence.leaveClient()","leaving; channel = "+this.channel.name+", client = "+i);const o=pn.fromData(a);o.action="leave",i&&(o.clientId=i);const u=await o.encode(l.channelOptions);switch(l.state){case"attached":return l.sendPresence([u]);case"attaching":return new Promise((f,m)=>{this.pendingPresence.push({presence:u,callback:p=>p?m(p):f()})});case"initialized":case"failed":throw new Le("Unable to leave presence channel (incompatible state)",90001);default:throw l.invalidStateError()}}async get(i){const a=!i||("waitForSync"in i?i.waitForSync:!0);return new Promise((l,o)=>{function u(f){l(i?f.list(i):f.values())}if(this.channel.state==="suspended"){a?o(U.fromValues({statusCode:400,code:91005,message:"Presence state is out of sync due to channel being in the SUSPENDED state"})):u(this.members);return}xn(this.channel,f=>o(f),()=>{const f=this.members;a?f.waitSync(function(){u(f)}):u(f)})})}async history(i){h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence.history()","channel = "+this.name);const a=this.channel.client.rest.presenceMixin;if(i&&i.untilAttach)if(this.channel.state==="attached")delete i.untilAttach,i.from_serial=this.channel.properties.attachSerial;else throw new U("option untilAttach requires the channel to be attached, was: "+this.channel.state,4e4,400);return a.history(this,i)}setPresence(i,a,l){h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence.setPresence()","received presence for "+i.length+" participants; syncChannelSerial = "+l);let o,u;const f=this.members,m=this._myMembers,p=[],_=this.channel.connectionManager.connectionId;a&&(this.members.startSync(),l&&(u=l.match(/^[\w-]+:(.*)$/))&&(o=u[1]));for(let O of i)switch(O.action){case"leave":f.remove(O)&&p.push(O),O.connectionId===_&&!O.isSynthesized()&&m.remove(O);break;case"enter":case"present":case"update":f.put(O)&&p.push(O),O.connectionId===_&&m.put(O);break}a&&!o&&(f.endSync(),this.channel.syncChannelSerial=null);for(let O=0;O<p.length;O++){const L=p[O];this.subscriptions.emit(L.action,L)}}onAttached(i){h.logAction(this.logger,h.LOG_MINOR,"RealtimePresence.onAttached()","channel = "+this.channel.name+", hasPresence = "+i),i?this.members.startSync():(this._synthesizeLeaves(this.members.values()),this.members.clear()),this._ensureMyMembersPresent();const a=this.pendingPresence,l=a.length;if(l){this.pendingPresence=[];const o=[],u=Yn.create(this.logger);h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence.onAttached","sending "+l+" queued presence messages");for(let f=0;f<l;f++){const m=a[f];o.push(m.presence),u.push(m.callback)}this.channel.sendPresence(o).then(()=>u()).catch(f=>u(f))}}actOnChannelState(i,a,l){switch(i){case"attached":this.onAttached(a);break;case"detached":case"failed":this._clearMyMembers(),this.members.clear();case"suspended":this.failPendingPresence(l);break}}failPendingPresence(i){if(this.pendingPresence.length){h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.failPendingPresence","channel; name = "+this.channel.name+", err = "+te(i));for(let a=0;a<this.pendingPresence.length;a++)try{this.pendingPresence[a].callback(i)}catch{}this.pendingPresence=[]}}_clearMyMembers(){this._myMembers.clear()}_ensureMyMembersPresent(){const i=this._myMembers,a=this.channel.connectionManager.connectionId;for(const l in i.map){const o=i.map[l];h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence._ensureMyMembersPresent()",'Auto-reentering clientId "'+o.clientId+'" into the presence set');const u=o.connectionId===a?o.id:void 0;this._enterOrUpdateClient(u,o.clientId,o.data,"enter").catch(f=>{const m=new U("Presence auto re-enter failed",91004,400,f);h.logAction(this.logger,h.LOG_ERROR,"RealtimePresence._ensureMyMembersPresent()","Presence auto re-enter failed; reason = "+te(f));const p=new vi(this.channel.state,this.channel.state,!0,!1,m);this.channel.emit("update",p)})}}_synthesizeLeaves(i){const a=this.subscriptions;i.forEach(function(l){const o=pn.fromValues({action:"leave",connectionId:l.connectionId,clientId:l.clientId,data:l.data,encoding:l.encoding,timestamp:Date.now()});a.emit("leave",o)})}async subscribe(...i){const a=Ai.processListenerArgs(i),l=a[0],o=a[1],u=this.channel;if(u.state==="failed")throw U.fromValues(u.invalidStateError());this.subscriptions.on(l,o),u.channelOptions.attachOnSubscribe!==!1&&await u.attach()}unsubscribe(...i){const a=Ai.processListenerArgs(i),l=a[0],o=a[1];this.subscriptions.off(l,o)}},Ri=Un,So=Mt.WebSocket;function kl(i){return!!i.on}var Ll=class extends Mn{constructor(i,a,l){super(i,a,l),this.shortName=So,l.heartbeats=R.Config.useProtocolHeartbeats,this.wsHost=l.host}static isAvailable(){return!!R.Config.WebSocket}createWebSocket(i,a){return this.uri=i+Z(a),new R.Config.WebSocket(this.uri)}toString(){return"WebSocketTransport; uri="+this.uri}connect(){h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.connect()","starting"),Mn.prototype.connect.call(this);const i=this,a=this.params,l=a.options,u=(l.tls?"wss://":"ws://")+this.wsHost+":"+Ce.getPort(l)+"/";h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.connect()","uri: "+u),Xe(this.auth.getAuthParams(),function(f,m){if(i.isDisposed)return;let p="";for(const O in m)p+=" "+O+": "+m[O]+";";if(h.logAction(i.logger,h.LOG_MINOR,"WebSocketTransport.connect()","authParams:"+p+" err: "+f),f){i.disconnect(f);return}const _=a.getConnectParams(m);try{const O=i.wsConnection=i.createWebSocket(u,_);O.binaryType=R.Config.binaryType,O.onopen=function(){i.onWsOpen()},O.onclose=function(L){i.onWsClose(L)},O.onmessage=function(L){i.onWsData(L.data)},O.onerror=function(L){i.onWsError(L)},kl(O)&&O.on("ping",function(){i.onActivity()})}catch(O){h.logAction(i.logger,h.LOG_ERROR,"WebSocketTransport.connect()","Unexpected exception creating websocket: err = "+(O.stack||O.message)),i.disconnect(O)}})}send(i){const a=this.wsConnection;if(!a){h.logAction(this.logger,h.LOG_ERROR,"WebSocketTransport.send()","No socket connection");return}try{a.send(Yt(i,this.connectionManager.realtime._MsgPack,this.params.format))}catch(l){const o="Exception from ws connection when trying to send: "+te(l);h.logAction(this.logger,h.LOG_ERROR,"WebSocketTransport.send()",o),this.finish("disconnected",new U(o,5e4,500))}}onWsData(i){h.logAction(this.logger,h.LOG_MICRO,"WebSocketTransport.onWsData()","data received; length = "+i.length+"; type = "+typeof i);try{this.onProtocolMessage(co(i,this.connectionManager.realtime._MsgPack,this.connectionManager.realtime._RealtimePresence,this.connectionManager.realtime._Annotations,this.connectionManager.realtime._objectsPlugin,this.format))}catch(a){h.logAction(this.logger,h.LOG_ERROR,"WebSocketTransport.onWsData()","Unexpected exception handing channel message: "+a.stack)}}onWsOpen(){h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.onWsOpen()","opened WebSocket"),this.emit("preconnect")}onWsClose(i){let a,l;if(typeof i=="object"?(l=i.code,a=i.wasClean||l===1e3):(l=i,a=l==1e3),delete this.wsConnection,a){h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.onWsClose()","Cleanly closed WebSocket");const o=new U("Websocket closed",80003,400);this.finish("disconnected",o)}else{const o="Unclean disconnection of WebSocket ; code = "+l,u=new U(o,80003,400);h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.onWsClose()",o),this.finish("disconnected",u)}this.emit("disposed")}onWsError(i){h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.onError()","Error from WebSocket: "+i.message),R.Config.nextTick(()=>{this.disconnect(Error(i.message))})}dispose(){h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.dispose()",""),this.isDisposed=!0;const i=this.wsConnection;i&&(i.onmessage=function(){},delete this.wsConnection,R.Config.nextTick(()=>{if(h.logAction(this.logger,h.LOG_MICRO,"WebSocketTransport.dispose()","closing websocket"),!i)throw new Error("WebSocketTransport.dispose(): wsConnection is not defined");i.close()}))}},wt=Ll,at=class{static subscribeFilter(i,a,l){const o=u=>{var f,m,p,_,O,L;const j={name:u.name,refTimeserial:(m=(f=u.extras)==null?void 0:f.ref)==null?void 0:m.timeserial,refType:(_=(p=u.extras)==null?void 0:p.ref)==null?void 0:_.type,isRef:!!((L=(O=u.extras)==null?void 0:O.ref)!=null&&L.timeserial),clientId:u.clientId};Object.entries(a).find(([K,B])=>B!==void 0?j[K]!==B:!1)||l(u)};this.addFilteredSubscription(i,a,l,o),i.subscriptions.on(o)}static addFilteredSubscription(i,a,l,o){var u;if(i.filteredSubscriptions||(i.filteredSubscriptions=new Map),i.filteredSubscriptions.has(l)){const f=i.filteredSubscriptions.get(l);f.set(a,((u=f?.get(a))==null?void 0:u.concat(o))||[o])}else i.filteredSubscriptions.set(l,new Map([[a,[o]]]))}static getAndDeleteFilteredSubscriptions(i,a,l){if(!i.filteredSubscriptions)return[];if(!l&&a)return Array.from(i.filteredSubscriptions.entries()).map(([f,m])=>{var p;let _=m.get(a);return m.delete(a),m.size===0&&((p=i.filteredSubscriptions)==null||p.delete(f)),_}).reduce((f,m)=>m?f.concat(...m):f,[]);if(!l||!i.filteredSubscriptions.has(l))return[];const o=i.filteredSubscriptions.get(l);if(!a){const f=Array.from(o.values()).reduce((m,p)=>m.concat(...p),[]);return i.filteredSubscriptions.delete(l),f}let u=o.get(a);return o.delete(a),u||[]}},Me=class hf extends Us{constructor(a){var l;const o=hf._MsgPack;if(!o)throw new Error("Expected DefaultRealtime._MsgPack to have been set");super(Ce.objectifyOptions(a,!0,"Realtime",h.defaultLogger,ye(H({},Rl),{Crypto:(l=hf.Crypto)!=null?l:void 0,MsgPack:o,RealtimePresence:{RealtimePresence:Ri,PresenceMessage:pn,WirePresenceMessage:Ha},Annotations:{Annotation:Fi,WireAnnotation:yi,RealtimeAnnotations:Jn,RestAnnotations:El},WebSocketTransport:wt,MessageInteractions:at})))}static get Crypto(){if(this._Crypto===null)throw new Error("Encryption not enabled; use ably.encryption.js instead");return this._Crypto}static set Crypto(a){this._Crypto=a}};Me.Utils=qe,Me.ConnectionManager=Pa,Me.ProtocolMessage=ea,Me._Crypto=null,Me.Message=Wi,Me.PresenceMessage=$i,Me.Annotation=_l,Me._MsgPack=null,Me._Http=ms,Me._PresenceMap=Ht,Me._MessageEncoding=Xn;var Dn=Me,tn=Uint8Array,Ci=Uint32Array,kn=Math.pow,jl=new Ci(8),Bl=[],Ln=new Ci(64);function la(i){return(i-(i|0))*kn(2,32)|0}for(var ra=2,jn=0;jn<64;){for(Qa=!0,yn=2;yn<=ra/2;yn++)ra%yn===0&&(Qa=!1);Qa&&(jn<8&&(jl[jn]=la(kn(ra,1/2))),Bl[jn]=la(kn(ra,1/3)),jn++),ra++}var Qa,yn,Bn=!!new tn(new Ci([1]).buffer)[0];function vn(i){return Bn?i>>>24|(i>>>16&255)<<8|(i&65280)<<8|i<<24:i}function St(i,a){return i>>>a|i<<32-a}function oa(i){var a=jl.slice(),l=i.length,o=l*8,u=512-(o+64)%512-1+o+65,f=new tn(u/8),m=new Ci(f.buffer);f.set(i,0),f[l]=128,m[m.length-1]=vn(o);for(var p,_=0;_<u/32;_+=16){var O=a.slice();for(p=0;p<64;p++){var L;if(p<16)L=vn(m[_+p]);else{var j=Ln[p-15],K=Ln[p-2];L=Ln[p-7]+Ln[p-16]+(St(j,7)^St(j,18)^j>>>3)+(St(K,17)^St(K,19)^K>>>10)}Ln[p]=L|=0;for(var B=(St(O[4],6)^St(O[4],11)^St(O[4],25))+(O[4]&O[5]^~O[4]&O[6])+O[7]+L+Bl[p],ie=(St(O[0],2)^St(O[0],13)^St(O[0],22))+(O[0]&O[1]^O[2]&(O[0]^O[1])),ae=7;ae>0;ae--)O[ae]=O[ae-1];O[0]=B+ie|0,O[4]=O[4]+B|0}for(p=0;p<8;p++)a[p]=a[p]+O[p]|0}return new tn(new Ci(a.map(function(Se){return vn(Se)})).buffer)}function ql(i,a){if(i.length>64&&(i=oa(i)),i.length<64){const p=new Uint8Array(64);p.set(i,0),i=p}for(var l=new Uint8Array(64),o=new Uint8Array(64),u=0;u<64;u++)l[u]=54^i[u],o[u]=92^i[u];var f=new Uint8Array(a.length+64);f.set(l,0),f.set(a,64);var m=new Uint8Array(96);return m.set(o,0),m.set(oa(f),64),oa(m)}var Xa=class{constructor(){this.base64CharSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",this.hexCharSet="0123456789abcdef"}uint8ViewToBase64(i){let a="";const l=this.base64CharSet,o=i.byteLength,u=o%3,f=o-u;let m,p,_,O,L;for(let j=0;j<f;j=j+3)L=i[j]<<16|i[j+1]<<8|i[j+2],m=(L&16515072)>>18,p=(L&258048)>>12,_=(L&4032)>>6,O=L&63,a+=l[m]+l[p]+l[_]+l[O];return u==1?(L=i[f],m=(L&252)>>2,p=(L&3)<<4,a+=l[m]+l[p]+"=="):u==2&&(L=i[f]<<8|i[f+1],m=(L&64512)>>10,p=(L&1008)>>4,_=(L&15)<<2,a+=l[m]+l[p]+l[_]+"="),a}base64ToArrayBuffer(i){const a=atob?.(i),l=a.length,o=new Uint8Array(l);for(let u=0;u<l;u++){const f=a.charCodeAt(u);o[u]=f}return this.toArrayBuffer(o)}isBuffer(i){return i instanceof ArrayBuffer||ArrayBuffer.isView(i)}toBuffer(i){if(!ArrayBuffer)throw new Error("Can't convert to Buffer: browser does not support the necessary types");if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(this.toArrayBuffer(i));throw new Error("BufferUtils.toBuffer expected an ArrayBuffer or a view onto one")}toArrayBuffer(i){if(!ArrayBuffer)throw new Error("Can't convert to ArrayBuffer: browser does not support the necessary types");if(i instanceof ArrayBuffer)return i;if(ArrayBuffer.isView(i))return i.buffer.slice(i.byteOffset,i.byteOffset+i.byteLength);throw new Error("BufferUtils.toArrayBuffer expected an ArrayBuffer or a view onto one")}base64Encode(i){return this.uint8ViewToBase64(this.toBuffer(i))}base64UrlEncode(i){return this.base64Encode(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}base64Decode(i){if(ArrayBuffer&&R.Config.atob)return this.base64ToArrayBuffer(i);throw new Error("Expected ArrayBuffer to exist and Platform.Config.atob to be configured")}hexEncode(i){return this.toBuffer(i).reduce((l,o)=>l+o.toString(16).padStart(2,"0"),"")}hexDecode(i){if(i.length%2!==0)throw new Error("Can't create a byte array from a hex string of odd length");const a=new Uint8Array(i.length/2);for(let l=0;l<a.length;l++)a[l]=parseInt(i.slice(2*l,2*(l+1)),16);return this.toArrayBuffer(a)}utf8Encode(i){if(R.Config.TextEncoder){const a=new R.Config.TextEncoder().encode(i);return this.toArrayBuffer(a)}else throw new Error("Expected TextEncoder to be configured")}utf8Decode(i){if(!this.isBuffer(i))throw new Error("Expected input of utf8decode to be an arraybuffer or typed array");if(TextDecoder)return new TextDecoder().decode(i);throw new Error("Expected TextDecoder to be configured")}areBuffersEqual(i,a){if(!i||!a)return!1;const l=this.toArrayBuffer(i),o=this.toArrayBuffer(a);if(l.byteLength!=o.byteLength)return!1;const u=new Uint8Array(l),f=new Uint8Array(o);for(var m=0;m<u.length;m++)if(u[m]!=f[m])return!1;return!0}byteLength(i){return i instanceof ArrayBuffer||ArrayBuffer.isView(i)?i.byteLength:-1}arrayBufferViewToBuffer(i){return this.toArrayBuffer(i)}concat(i){const a=i.reduce((u,f)=>u+f.byteLength,0),l=new Uint8Array(a);let o=0;for(const u of i){const f=this.toBuffer(u);l.set(f,o),o+=f.byteLength}return l.buffer}sha256(i){const a=oa(this.toBuffer(i));return this.toArrayBuffer(a)}hmacSha256(i,a){const l=ql(this.toBuffer(a),this.toBuffer(i));return this.toArrayBuffer(l)}},Za=new Xa,_i=function(i,a){var l="aes",o=256,u="cbc",f=16;function m(K){if(K.algorithm==="aes"&&K.mode==="cbc"){if(K.keyLength===128||K.keyLength===256)return;throw new Error("Unsupported key length "+K.keyLength+" for aes-cbc encryption. Encryption key must be 128 or 256 bits (16 or 32 ASCII characters)")}}function p(K){return K.replace("_","/").replace("-","+")}function _(K){return K instanceof O}class O{constructor(B,ie,ae,Se){this.algorithm=B,this.keyLength=ie,this.mode=ae,this.key=Se}}class L{static getDefaultParams(B){var ie;if(!B.key)throw new Error("Crypto.getDefaultParams: a key is required");typeof B.key=="string"?ie=a.toArrayBuffer(a.base64Decode(p(B.key))):B.key instanceof ArrayBuffer?ie=B.key:ie=a.toArrayBuffer(B.key);var ae=B.algorithm||l,Se=ie.byteLength*8,je=B.mode||u,He=new O(ae,Se,je,ie);if(B.keyLength&&B.keyLength!==He.keyLength)throw new Error("Crypto.getDefaultParams: a keyLength of "+B.keyLength+" was specified, but the key actually has length "+He.keyLength);return m(He),He}static async generateRandomKey(B){try{return i.getRandomArrayBuffer((B||o)/8)}catch(ie){throw new U("Failed to generate random key: "+ie.message,400,5e4,ie)}}static getCipher(B,ie){var ae,Se=_(B)?B:this.getDefaultParams(B);return{cipherParams:Se,cipher:new j(Se,(ae=B.iv)!=null?ae:null,ie)}}}L.CipherParams=O;class j{constructor(B,ie,ae){if(this.logger=ae,!crypto.subtle)throw isSecureContext?new Error("Crypto operations are not possible since the browser’s SubtleCrypto class is unavailable (reason unknown)."):new Error("Crypto operations are is not possible since the current environment is a non-secure context and hence the browser’s SubtleCrypto class is not available.");this.algorithm=B.algorithm+"-"+String(B.keyLength)+"-"+B.mode,this.webCryptoAlgorithm=B.algorithm+"-"+B.mode,this.key=a.toArrayBuffer(B.key),this.iv=ie?a.toArrayBuffer(ie):null}concat(B,ie){const ae=new ArrayBuffer(B.byteLength+ie.byteLength),Se=new DataView(ae),je=new DataView(a.toArrayBuffer(B));for(let Ie=0;Ie<je.byteLength;Ie++)Se.setInt8(Ie,je.getInt8(Ie));const He=new DataView(a.toArrayBuffer(ie));for(let Ie=0;Ie<He.byteLength;Ie++)Se.setInt8(je.byteLength+Ie,He.getInt8(Ie));return ae}async encrypt(B){h.logAction(this.logger,h.LOG_MICRO,"CBCCipher.encrypt()","");const ie=await this.getIv(),ae=await crypto.subtle.importKey("raw",this.key,this.webCryptoAlgorithm,!1,["encrypt"]),Se=await crypto.subtle.encrypt({name:this.webCryptoAlgorithm,iv:ie},ae,B);return this.concat(ie,Se)}async decrypt(B){h.logAction(this.logger,h.LOG_MICRO,"CBCCipher.decrypt()","");const ie=a.toArrayBuffer(B),ae=ie.slice(0,f),Se=ie.slice(f),je=await crypto.subtle.importKey("raw",this.key,this.webCryptoAlgorithm,!1,["decrypt"]);return crypto.subtle.decrypt({name:this.webCryptoAlgorithm,iv:ae},je,Se)}async getIv(){if(this.iv){var B=this.iv;return this.iv=null,B}const ie=await i.getRandomArrayBuffer(f);return a.toArrayBuffer(ie)}}return L},Rt=(i=>(i[i.REQ_SEND=0]="REQ_SEND",i[i.REQ_RECV=1]="REQ_RECV",i[i.REQ_RECV_POLL=2]="REQ_RECV_POLL",i[i.REQ_RECV_STREAM=3]="REQ_RECV_STREAM",i))(Rt||{}),nn=Rt;function Gl(){return new U("No HTTP request plugin provided. Provide at least one of the FetchRequest or XHRRequest plugins.",400,4e4)}var Ka,Ao=(Ka=class{constructor(i){this.checksInProgress=null,this.checkConnectivity=void 0,this.supportsAuthHeaders=!1,this.supportsLinkHeaders=!1;var a;this.client=i??null;const l=i?.options.connectivityCheckUrl||Ce.connectivityCheckUrl,o=(a=i?.options.connectivityCheckParams)!=null?a:null,u=!i?.options.connectivityCheckUrl,f=H(H({},Ao.bundledRequestImplementations),i?._additionalHTTPRequestImplementations),m=f.XHRRequest,p=f.FetchRequest,_=!!(m||p);if(!_)throw Gl();R.Config.xhrSupported&&m?(this.supportsAuthHeaders=!0,this.Request=async function(O,L,j,K,B){return new Promise(ie=>{var ae;const Se=m.createRequest(L,j,K,B,nn.REQ_SEND,(ae=i&&i.options.timeouts)!=null?ae:null,this.logger,O);Se.once("complete",(je,He,Ie,_e,Qt)=>ie({error:je,body:He,headers:Ie,unpacked:_e,statusCode:Qt})),Se.exec()})},i?.options.disableConnectivityCheck?this.checkConnectivity=async function(){return!0}:this.checkConnectivity=async function(){var O;h.logAction(this.logger,h.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Sending; "+l);const L=await this.doUri(it.Get,l,null,null,o);let j=!1;return u?j=!L.error&&((O=L.body)==null?void 0:O.replace(/\n/,""))=="yes":j=!L.error&&vc(L.statusCode),h.logAction(this.logger,h.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Result: "+j),j}):R.Config.fetchSupported&&p?(this.supportsAuthHeaders=!0,this.Request=async(O,L,j,K,B)=>p(O,i??null,L,j,K,B),i?.options.disableConnectivityCheck?this.checkConnectivity=async function(){return!0}:this.checkConnectivity=async function(){var O;h.logAction(this.logger,h.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Sending; "+l);const L=await this.doUri(it.Get,l,null,null,null),j=!L.error&&((O=L.body)==null?void 0:O.replace(/\n/,""))=="yes";return h.logAction(this.logger,h.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Result: "+j),j}):this.Request=async()=>({error:_?new Le("no supported HTTP transports available",null,400):Gl()})}get logger(){var i,a;return(a=(i=this.client)==null?void 0:i.logger)!=null?a:h.defaultLogger}async doUri(i,a,l,o,u){return this.Request?this.Request(i,a,l,u,o):{error:new Le("Request invoked before assigned to",null,500)}}shouldFallback(i){const a=i.statusCode;return a===408&&!i.code||a===400&&!i.code||a>=500&&a<=504}},Ka.methods=[it.Get,it.Delete,it.Post,it.Put,it.Patch],Ka.methodsWithoutBody=[it.Get,it.Delete],Ka.methodsWithBody=[it.Post,it.Put,it.Patch],Ka),Oo=Ao,$e="ablyjs-storage-test",Fn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:self,Ja=class{constructor(){try{Fn.sessionStorage.setItem($e,$e),Fn.sessionStorage.removeItem($e),this.sessionSupported=!0}catch{this.sessionSupported=!1}try{Fn.localStorage.setItem($e,$e),Fn.localStorage.removeItem($e),this.localSupported=!0}catch{this.localSupported=!1}}get(i){return this._get(i,!1)}getSession(i){return this._get(i,!0)}remove(i){return this._remove(i,!1)}removeSession(i){return this._remove(i,!0)}set(i,a,l){return this._set(i,a,l,!1)}setSession(i,a,l){return this._set(i,a,l,!0)}_set(i,a,l,o){const u={value:a};return l&&(u.expires=Date.now()+l),this.storageInterface(o).setItem(i,JSON.stringify(u))}_get(i,a){if(a&&!this.sessionSupported)throw new Error("Session Storage not supported");if(!a&&!this.localSupported)throw new Error("Local Storage not supported");const l=this.storageInterface(a).getItem(i);if(!l)return null;const o=JSON.parse(l);return o.expires&&o.expires<Date.now()?(this.storageInterface(a).removeItem(i),null):o.value}_remove(i,a){return this.storageInterface(a).removeItem(i)}storageInterface(i){return i?Fn.sessionStorage:Fn.localStorage}},ca=new Ja,tt=Tn(),ua=typeof EdgeRuntime=="string";typeof Window>"u"&&typeof WorkerGlobalScope>"u"&&!ua&&console.log("Warning: this distribution of Ably is intended for browsers. On nodejs, please use the 'ably' package on npm");function fa(){const i=tt.location;return!tt.WebSocket||!i||!i.origin||i.origin.indexOf("http")>-1}function Hc(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope}var To=tt.navigator&&tt.navigator.userAgent.toString(),Vc=tt.location&&tt.location.href,Ro={agent:"browser",logTimestamps:!0,userAgent:To,currentUrl:Vc,binaryType:"arraybuffer",WebSocket:tt.WebSocket,fetchSupported:!!tt.fetch,xhrSupported:tt.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,allowComet:fa(),useProtocolHeartbeats:!0,supportsBinary:!!tt.TextDecoder,preferBinary:!1,ArrayBuffer:tt.ArrayBuffer,atob:tt.atob,nextTick:typeof tt.setImmediate<"u"?tt.setImmediate.bind(tt):function(i){setTimeout(i,0)},addEventListener:tt.addEventListener,inspect:JSON.stringify,stringByteSize:function(i){return tt.TextDecoder&&new tt.TextEncoder().encode(i).length||i.length},TextEncoder:tt.TextEncoder,TextDecoder:tt.TextDecoder,getRandomArrayBuffer:async function(i){const a=new Uint8Array(i);return tt.crypto.getRandomValues(a),a.buffer},isWebworker:Hc(),push:{platform:"browser",formFactor:"desktop",storage:ca}},ei=Ro;function zl(i){const a=[80015,80017,80030];return i.code?gn.isTokenErr(i)?!1:a.includes(i.code)?!0:i.code>=4e4&&i.code<5e4:!1}function ha(i){return zl(i)?[zt({action:fe.ERROR,error:i})]:[zt({action:fe.DISCONNECTED,error:i})]}var Co=class extends Mn{constructor(i,a,l){super(i,a,l,!0),this.onAuthUpdated=o=>{this.authParams={access_token:o.token}},this.stream="stream"in l?l.stream:!0,this.sendRequest=null,this.recvRequest=null,this.pendingCallback=null,this.pendingItems=null}connect(){h.logAction(this.logger,h.LOG_MINOR,"CometTransport.connect()","starting"),Mn.prototype.connect.call(this);const i=this.params,a=i.options,l=i.host||a.primaryDomain,o=Ce.getPort(a),u=a.tls?"https://":"http://";this.baseUri=u+l+":"+o+"/comet/";const f=this.baseUri+"connect";h.logAction(this.logger,h.LOG_MINOR,"CometTransport.connect()","uri: "+f),Xe(this.auth.getAuthParams(),(m,p)=>{if(m){this.disconnect(m);return}if(this.isDisposed)return;this.authParams=p;const _=this.params.getConnectParams(p);"stream"in _&&(this.stream=_.stream),h.logAction(this.logger,h.LOG_MINOR,"CometTransport.connect()","connectParams:"+Z(_));let O=!1;const L=this.recvRequest=this.createRequest(f,null,_,null,this.stream?nn.REQ_RECV_STREAM:nn.REQ_RECV);L.on("data",j=>{this.recvRequest&&(O||(O=!0,this.emit("preconnect")),this.onData(j))}),L.on("complete",j=>{if(this.recvRequest||(j=j||new U("Request cancelled",80003,400)),this.recvRequest=null,!O&&!j&&(O=!0,this.emit("preconnect")),this.onActivity(),j){j.code?this.onData(ha(j)):this.disconnect(j);return}R.Config.nextTick(()=>{this.recv()})}),L.exec()})}requestClose(){h.logAction(this.logger,h.LOG_MINOR,"CometTransport.requestClose()"),this._requestCloseOrDisconnect(!0)}requestDisconnect(){h.logAction(this.logger,h.LOG_MINOR,"CometTransport.requestDisconnect()"),this._requestCloseOrDisconnect(!1)}_requestCloseOrDisconnect(i){const a=i?this.closeUri:this.disconnectUri;if(a){const l=this.createRequest(a,null,this.authParams,null,nn.REQ_SEND);l.on("complete",o=>{o&&(h.logAction(this.logger,h.LOG_ERROR,"CometTransport.request"+(i?"Close()":"Disconnect()"),"request returned err = "+te(o)),this.finish("disconnected",o))}),l.exec()}}dispose(){h.logAction(this.logger,h.LOG_MINOR,"CometTransport.dispose()",""),this.isDisposed||(this.isDisposed=!0,this.recvRequest&&(h.logAction(this.logger,h.LOG_MINOR,"CometTransport.dispose()","aborting recv request"),this.recvRequest.abort(),this.recvRequest=null),this.finish("disconnected",bt.disconnected()),R.Config.nextTick(()=>{this.emit("disposed")}))}onConnect(i){var a;if(this.isDisposed)return;const l=(a=i.connectionDetails)==null?void 0:a.connectionKey;Mn.prototype.onConnect.call(this,i);const o=this.baseUri+l;h.logAction(this.logger,h.LOG_MICRO,"CometTransport.onConnect()","baseUri = "+o),this.sendUri=o+"/send",this.recvUri=o+"/recv",this.closeUri=o+"/close",this.disconnectUri=o+"/disconnect"}send(i){if(this.sendRequest){this.pendingItems=this.pendingItems||[],this.pendingItems.push(i);return}const a=this.pendingItems||[];a.push(i),this.pendingItems=null,this.sendItems(a)}sendAnyPending(){const i=this.pendingItems;i&&(this.pendingItems=null,this.sendItems(i))}sendItems(i){const a=this.sendRequest=this.createRequest(this.sendUri,null,this.authParams,this.encodeRequest(i),nn.REQ_SEND);a.on("complete",(l,o)=>{if(l&&h.logAction(this.logger,h.LOG_ERROR,"CometTransport.sendItems()","on complete: err = "+te(l)),this.sendRequest=null,l){l.code?this.onData(ha(l)):this.disconnect(l);return}o&&this.onData(o),this.pendingItems&&R.Config.nextTick(()=>{this.sendRequest||this.sendAnyPending()})}),a.exec()}recv(){if(this.recvRequest||!this.isConnected)return;const i=this.recvRequest=this.createRequest(this.recvUri,null,this.authParams,null,this.stream?nn.REQ_RECV_STREAM:nn.REQ_RECV_POLL);i.on("data",a=>{this.onData(a)}),i.on("complete",a=>{if(this.recvRequest=null,this.onActivity(),a){a.code?this.onData(ha(a)):this.disconnect(a);return}R.Config.nextTick(()=>{this.recv()})}),i.exec()}onData(i){try{const a=this.decodeResponse(i);if(a&&a.length)for(let l=0;l<a.length;l++)this.onProtocolMessage(_s(a[l],this.connectionManager.realtime._RealtimePresence,this.connectionManager.realtime._Annotations,this.connectionManager.realtime._objectsPlugin))}catch(a){h.logAction(this.logger,h.LOG_ERROR,"CometTransport.onData()","Unexpected exception handing channel event: "+a.stack)}}encodeRequest(i){return JSON.stringify(i)}decodeResponse(i){return typeof i=="string"?JSON.parse(i):i}},Wa=Co;function _o(i,a){return sl(On(a)).includes("x-ably-errorcode")}function ks(i,a){if(_o(i,a))return i.error&&U.fromValues(i.error)}var Hl=function(){},Eo=0,$a={};function Mo(i,a){return i.getResponseHeader&&i.getResponseHeader(a)}function Fa(i){return i.getResponseHeader&&(i.getResponseHeader("transfer-encoding")||!i.getResponseHeader("content-length"))}function wo(i){const a=i.getAllResponseHeaders().trim().split(`\r
`),l={};for(let o=0;o<a.length;o++){const u=a[o].split(":").map(f=>f.trim());l[u[0].toLowerCase()]=u[1]}return l}var No=class Jd extends dt{constructor(a,l,o,u,f,m,p,_){super(p),o=o||{},o.rnd=dn(),this.uri=a+Z(o),this.headers=l||{},this.body=u,this.method=_?_.toUpperCase():W(u)?"GET":"POST",this.requestMode=f,this.timeouts=m,this.timedOut=!1,this.requestComplete=!1,this.id=String(++Eo),$a[this.id]=this}static createRequest(a,l,o,u,f,m,p,_){const O=m||Ce.TIMEOUTS;return new Jd(a,l,me(o),u,f,O,p,_)}complete(a,l,o,u,f){this.requestComplete||(this.requestComplete=!0,!a&&l&&this.emit("data",l),this.emit("complete",a,l,o,u,f),this.dispose())}abort(){this.dispose()}exec(){let a=this.headers;const l=this.requestMode==nn.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout,o=this.timer=setTimeout(()=>{this.timedOut=!0,f.abort()},l),u=this.method,f=this.xhr=new XMLHttpRequest,m=a.accept;let p=this.body,_="text";m?m.indexOf("application/x-msgpack")===0&&(_="arraybuffer"):a.accept="application/json",p&&(a["content-type"]||(a["content-type"]="application/json")).indexOf("application/json")>-1&&typeof p!="string"&&(p=JSON.stringify(p)),f.open(u,this.uri,!0),f.responseType=_,"authorization"in a&&(f.withCredentials=!0);for(const _e in a)f.setRequestHeader(_e,a[_e]);const O=(_e,Qt,Ct,ma)=>{var wi;let is=Qt+" (event type: "+_e.type+")";(wi=this==null?void 0:this.xhr)!=null&&wi.statusText&&(is+=", current statusText is "+this.xhr.statusText),h.logAction(this.logger,h.LOG_ERROR,"Request.on"+_e.type+"()",is),this.complete(new Le(is,Ct,ma))};f.onerror=function(_e){O(_e,"XHR error occurred",null,400)},f.onabort=_e=>{this.timedOut?O(_e,"Request aborted due to request timeout expiring",null,408):O(_e,"Request cancelled",null,400)},f.ontimeout=function(_e){O(_e,"Request timed out",null,408)};let L,j,K,B=0,ie=!1;const ae=()=>{if(clearTimeout(o),K=j<400,j==204){this.complete(null,null,null,null,j);return}L=this.requestMode==nn.REQ_RECV_STREAM&&K&&Fa(f)},Se=()=>{let _e;try{const Ct=Mo(f,"content-type");if(Ct?Ct.indexOf("application/json")>=0:f.responseType=="text"){const wi=f.responseType==="arraybuffer"?R.BufferUtils.utf8Decode(f.response):String(f.responseText);wi.length?_e=JSON.parse(wi):_e=wi,ie=!0}else _e=f.response;_e.response!==void 0?(j=_e.statusCode,K=j<400,a=_e.headers,_e=_e.response):a=wo(f)}catch(Ct){this.complete(new Le("Malformed response body from server: "+Ct.message,null,400));return}if(K||Array.isArray(_e)){this.complete(null,_e,a,ie,j);return}let Qt=ks(_e,a);Qt||(Qt=new Le("Error response received from server: "+j+" body was: "+R.Config.inspect(_e),null,j)),this.complete(Qt,_e,a,ie,j)};function je(){const _e=f.responseText,Qt=_e.length-1;let Ct,ma;for(;B<Qt&&(Ct=_e.indexOf(`
`,B))>-1;)ma=_e.slice(B,Ct),B=Ct+1,He(ma)}const He=_e=>{try{_e=JSON.parse(_e)}catch(Qt){this.complete(new Le("Malformed response body from server: "+Qt.message,null,400));return}this.emit("data",_e)},Ie=()=>{je(),this.streamComplete=!0,R.Config.nextTick(()=>{this.complete()})};f.onreadystatechange=function(){const _e=f.readyState;_e<3||f.status!==0&&(j===void 0&&(j=f.status,ae()),_e==3&&L?je():_e==4&&(L?Ie():Se()))},f.send(p)}dispose(){const a=this.xhr;if(a){a.onreadystatechange=a.onerror=a.onabort=a.ontimeout=Hl,this.xhr=null;const l=this.timer;l&&(clearTimeout(l),this.timer=null),this.requestComplete||a.abort()}delete $a[this.id]}},qn=No,Ls=Mt.XhrPolling,Vl=class extends Wa{constructor(i,a,l){super(i,a,l),this.shortName=Ls,l.stream=!1,this.shortName=Ls}static isAvailable(){return!!(R.Config.xhrSupported&&R.Config.allowComet)}toString(){return"XHRPollingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected}createRequest(i,a,l,o,u){return qn.createRequest(i,a,l,o,u,this.timeouts,this.logger)}},ti=Vl,ni=["xhr_polling"],es={order:ni,bundledImplementations:{web_socket:wt,xhr_polling:ti}},Il=es,Yl={connectivityCheckUrl:"https://internet-up.ably-realtime.com/is-the-internet-up.txt",wsConnectivityCheckUrl:"wss://ws-up.ably-realtime.com",defaultTransports:[Mt.XhrPolling,Mt.WebSocket]},ts=Yl;function ns(i){if(i===void 0)return"undefined";let a,l;if(i instanceof ArrayBuffer?(l="ArrayBuffer",a=new DataView(i)):i instanceof DataView&&(l="DataView",a=i),!a)return JSON.stringify(i);const o=[];for(let u=0;u<i.byteLength;u++){if(u>20){o.push("...");break}let f=a.getUint8(u).toString(16);f.length===1&&(f="0"+f),o.push(f)}return"<"+l+" "+o.join(" ")+">"}function da(i,a,l){for(let o=0,u=l.length;o<u;o++){const f=l.charCodeAt(o);if(f<128){i.setUint8(a++,f>>>0&127|0);continue}if(f<2048){i.setUint8(a++,f>>>6&31|192),i.setUint8(a++,f>>>0&63|128);continue}if(f<65536){i.setUint8(a++,f>>>12&15|224),i.setUint8(a++,f>>>6&63|128),i.setUint8(a++,f>>>0&63|128);continue}if(f<1114112){i.setUint8(a++,f>>>18&7|240),i.setUint8(a++,f>>>12&63|128),i.setUint8(a++,f>>>6&63|128),i.setUint8(a++,f>>>0&63|128);continue}throw new Error("bad codepoint "+f)}}function Pl(i,a,l){let o="";for(let u=a,f=a+l;u<f;u++){const m=i.getUint8(u);if((m&128)===0){o+=String.fromCharCode(m);continue}if((m&224)===192){o+=String.fromCharCode((m&15)<<6|i.getUint8(++u)&63);continue}if((m&240)===224){o+=String.fromCharCode((m&15)<<12|(i.getUint8(++u)&63)<<6|(i.getUint8(++u)&63)<<0);continue}if((m&248)===240){o+=String.fromCharCode((m&7)<<18|(i.getUint8(++u)&63)<<12|(i.getUint8(++u)&63)<<6|(i.getUint8(++u)&63)<<0);continue}throw new Error("Invalid byte "+m.toString(16))}return o}function ii(i){let a=0;for(let l=0,o=i.length;l<o;l++){const u=i.charCodeAt(l);if(u<128){a+=1;continue}if(u<2048){a+=2;continue}if(u<65536){a+=3;continue}if(u<1114112){a+=4;continue}throw new Error("bad codepoint "+u)}return a}function js(i,a){const l=si(i,a);if(l===0)return;const o=new ArrayBuffer(l),u=new DataView(o);return rn(i,u,0,a),o}var Bs=65536*65536,qs=1/Bs;function Ql(i,a){return a=a||0,i.getInt32(a)*Bs+i.getUint32(a+4)}function ai(i,a){return a=a||0,i.getUint32(a)*Bs+i.getUint32(a+4)}function we(i,a,l){l<9223372036854776e3?(i.setInt32(a,Math.floor(l*qs)),i.setInt32(a+4,l&-1)):(i.setUint32(a,2147483647),i.setUint32(a+4,2147483647))}function Ve(i,a,l){l<18446744073709552e3?(i.setUint32(a,Math.floor(l*qs)),i.setInt32(a+4,l&-1)):(i.setUint32(a,4294967295),i.setUint32(a+4,4294967295))}var ft=class{constructor(i,a){this.map=l=>{const o={};for(let u=0;u<l;u++){const f=this.parse();o[f]=this.parse()}return o},this.bin=l=>{const o=new ArrayBuffer(l);return new Uint8Array(o).set(new Uint8Array(this.view.buffer,this.offset,l),0),this.offset+=l,o},this.buf=this.bin,this.str=l=>{const o=Pl(this.view,this.offset,l);return this.offset+=l,o},this.array=l=>{const o=new Array(l);for(let u=0;u<l;u++)o[u]=this.parse();return o},this.ext=l=>(this.offset+=l,{type:this.view.getInt8(this.offset),data:this.buf(l)}),this.parse=()=>{const l=this.view.getUint8(this.offset);let o,u;if((l&128)===0)return this.offset++,l;if((l&240)===128)return u=l&15,this.offset++,this.map(u);if((l&240)===144)return u=l&15,this.offset++,this.array(u);if((l&224)===160)return u=l&31,this.offset++,this.str(u);if((l&224)===224)return o=this.view.getInt8(this.offset),this.offset++,o;switch(l){case 192:return this.offset++,null;case 193:this.offset++;return;case 194:return this.offset++,!1;case 195:return this.offset++,!0;case 196:return u=this.view.getUint8(this.offset+1),this.offset+=2,this.bin(u);case 197:return u=this.view.getUint16(this.offset+1),this.offset+=3,this.bin(u);case 198:return u=this.view.getUint32(this.offset+1),this.offset+=5,this.bin(u);case 199:return u=this.view.getUint8(this.offset+1),this.offset+=2,this.ext(u);case 200:return u=this.view.getUint16(this.offset+1),this.offset+=3,this.ext(u);case 201:return u=this.view.getUint32(this.offset+1),this.offset+=5,this.ext(u);case 202:return o=this.view.getFloat32(this.offset+1),this.offset+=5,o;case 203:return o=this.view.getFloat64(this.offset+1),this.offset+=9,o;case 204:return o=this.view.getUint8(this.offset+1),this.offset+=2,o;case 205:return o=this.view.getUint16(this.offset+1),this.offset+=3,o;case 206:return o=this.view.getUint32(this.offset+1),this.offset+=5,o;case 207:return o=ai(this.view,this.offset+1),this.offset+=9,o;case 208:return o=this.view.getInt8(this.offset+1),this.offset+=2,o;case 209:return o=this.view.getInt16(this.offset+1),this.offset+=3,o;case 210:return o=this.view.getInt32(this.offset+1),this.offset+=5,o;case 211:return o=Ql(this.view,this.offset+1),this.offset+=9,o;case 212:return u=1,this.offset++,this.ext(u);case 213:return u=2,this.offset++,this.ext(u);case 214:return u=4,this.offset++,this.ext(u);case 215:return u=8,this.offset++,this.ext(u);case 216:return u=16,this.offset++,this.ext(u);case 217:return u=this.view.getUint8(this.offset+1),this.offset+=2,this.str(u);case 218:return u=this.view.getUint16(this.offset+1),this.offset+=3,this.str(u);case 219:return u=this.view.getUint32(this.offset+1),this.offset+=5,this.str(u);case 220:return u=this.view.getUint16(this.offset+1),this.offset+=3,this.array(u);case 221:return u=this.view.getUint32(this.offset+1),this.offset+=5,this.array(u);case 222:return u=this.view.getUint16(this.offset+1),this.offset+=3,this.map(u);case 223:return u=this.view.getUint32(this.offset+1),this.offset+=5,this.map(u)}throw new Error("Unknown type 0x"+l.toString(16))},this.offset=a||0,this.view=i}};function Gs(i){const a=new DataView(i),l=new ft(a),o=l.parse();if(l.offset!==i.byteLength)throw new Error(i.byteLength-l.offset+" trailing bytes");return o}function Ei(i,a){return Object.keys(i).filter(function(l){const o=i[l],u=typeof o;return(!a||o!=null)&&(u!=="function"||!!o.toJSON)})}function rn(i,a,l,o){const u=typeof i;if(typeof i=="string"){const f=ii(i);if(f<32)return a.setUint8(l,f|160),da(a,l+1,i),1+f;if(f<256)return a.setUint8(l,217),a.setUint8(l+1,f),da(a,l+2,i),2+f;if(f<65536)return a.setUint8(l,218),a.setUint16(l+1,f),da(a,l+3,i),3+f;if(f<4294967296)return a.setUint8(l,219),a.setUint32(l+1,f),da(a,l+5,i),5+f}if(ArrayBuffer.isView&&ArrayBuffer.isView(i)&&(i=i.buffer),i instanceof ArrayBuffer){const f=i.byteLength;if(f<256)return a.setUint8(l,196),a.setUint8(l+1,f),new Uint8Array(a.buffer).set(new Uint8Array(i),l+2),2+f;if(f<65536)return a.setUint8(l,197),a.setUint16(l+1,f),new Uint8Array(a.buffer).set(new Uint8Array(i),l+3),3+f;if(f<4294967296)return a.setUint8(l,198),a.setUint32(l+1,f),new Uint8Array(a.buffer).set(new Uint8Array(i),l+5),5+f}if(typeof i=="number"){if(Math.floor(i)!==i)return a.setUint8(l,203),a.setFloat64(l+1,i),9;if(i>=0){if(i<128)return a.setUint8(l,i),1;if(i<256)return a.setUint8(l,204),a.setUint8(l+1,i),2;if(i<65536)return a.setUint8(l,205),a.setUint16(l+1,i),3;if(i<4294967296)return a.setUint8(l,206),a.setUint32(l+1,i),5;if(i<18446744073709552e3)return a.setUint8(l,207),Ve(a,l+1,i),9;throw new Error("Number too big 0x"+i.toString(16))}if(i>=-32)return a.setInt8(l,i),1;if(i>=-128)return a.setUint8(l,208),a.setInt8(l+1,i),2;if(i>=-32768)return a.setUint8(l,209),a.setInt16(l+1,i),3;if(i>=-2147483648)return a.setUint8(l,210),a.setInt32(l+1,i),5;if(i>=-9223372036854776e3)return a.setUint8(l,211),we(a,l+1,i),9;throw new Error("Number too small -0x"+(-i).toString(16).substr(1))}if(u==="undefined")return o?0:(a.setUint8(l,212),a.setUint8(l+1,0),a.setUint8(l+2,0),3);if(i===null)return o?0:(a.setUint8(l,192),1);if(u==="boolean")return a.setUint8(l,i?195:194),1;if(typeof i.toJSON=="function")return rn(i.toJSON(),a,l,o);if(u==="object"){let f,m=0,p;const _=Array.isArray(i);if(_?f=i.length:(p=Ei(i,o),f=p.length),f<16?(a.setUint8(l,f|(_?144:128)),m=1):f<65536?(a.setUint8(l,_?220:222),a.setUint16(l+1,f),m=3):f<4294967296&&(a.setUint8(l,_?221:223),a.setUint32(l+1,f),m=5),_)for(let O=0;O<f;O++)m+=rn(i[O],a,l+m,o);else if(p)for(let O=0;O<f;O++){const L=p[O];m+=rn(L,a,l+m),m+=rn(i[L],a,l+m,o)}return m}if(u==="function")return 0;throw new Error("Unknown type "+u)}function si(i,a){const l=typeof i;if(l==="string"){const o=ii(i);if(o<32)return 1+o;if(o<256)return 2+o;if(o<65536)return 3+o;if(o<4294967296)return 5+o}if(ArrayBuffer.isView&&ArrayBuffer.isView(i)&&(i=i.buffer),i instanceof ArrayBuffer){const o=i.byteLength;if(o<256)return 2+o;if(o<65536)return 3+o;if(o<4294967296)return 5+o}if(typeof i=="number"){if(Math.floor(i)!==i)return 9;if(i>=0){if(i<128)return 1;if(i<256)return 2;if(i<65536)return 3;if(i<4294967296)return 5;if(i<18446744073709552e3)return 9;throw new Error("Number too big 0x"+i.toString(16))}if(i>=-32)return 1;if(i>=-128)return 2;if(i>=-32768)return 3;if(i>=-2147483648)return 5;if(i>=-9223372036854776e3)return 9;throw new Error("Number too small -0x"+i.toString(16).substr(1))}if(l==="boolean")return 1;if(i===null)return a?0:1;if(i===void 0)return a?0:3;if(typeof i.toJSON=="function")return si(i.toJSON(),a);if(l==="object"){let o,u=0;if(Array.isArray(i)){o=i.length;for(let f=0;f<o;f++)u+=si(i[f],a)}else{const f=Ei(i,a);o=f.length;for(let m=0;m<o;m++){const p=f[m];u+=si(p)+si(i[p],a)}}if(o<16)return 1+u;if(o<65536)return 3+u;if(o<4294967296)return 5+u;throw new Error("Array or object too long 0x"+o.toString(16))}if(l==="function")return 0;throw new Error("Unknown type "+l)}var Mi={encode:js,decode:Gs,inspect:ns,utf8Write:da,utf8Read:Pl,utf8ByteCount:ii};function ga(i,a){return!!a.get("x-ably-errorcode")}function Ic(i,a){if(ga(i,a))return i.error&&U.fromValues(i.error)}function rt(i){const a={};return i.forEach((l,o)=>{a[o]=l}),a}async function Xl(i,a,l,o,u,f){const m=new Headers(o||{}),p=i?i.toUpperCase():W(f)?"GET":"POST",_=new AbortController;let O;const L=new Promise(B=>{O=setTimeout(()=>{_.abort(),B({error:new Le("Request timed out",null,408)})},a?a.options.timeouts.httpRequestTimeout:Ce.TIMEOUTS.httpRequestTimeout)}),j={method:p,headers:m,body:f,signal:_.signal};R.Config.isWebworker||(j.credentials=m.has("authorization")?"include":"same-origin");const K=(async()=>{try{const B=new URLSearchParams(u||{});B.set("rnd",dn());const ie=l+"?"+B,ae=await Tn().fetch(ie,j);if(clearTimeout(O),ae.status==204)return{error:null,statusCode:ae.status};const Se=ae.headers.get("Content-Type");let je;Se&&Se.indexOf("application/x-msgpack")>-1?je=await ae.arrayBuffer():Se&&Se.indexOf("application/json")>-1?je=await ae.json():je=await ae.text();const He=!!Se&&Se.indexOf("application/x-msgpack")===-1,Ie=rt(ae.headers);return ae.ok?{error:null,body:je,headers:Ie,unpacked:He,statusCode:ae.status}:{error:Ic(je,ae.headers)||new Le("Error response received from server: "+ae.status+" body was: "+R.Config.inspect(je),null,ae.status),body:je,headers:Ie,unpacked:He,statusCode:ae.status}}catch(B){return clearTimeout(O),{error:B}}})();return Promise.race([L,K])}var Zl={XHRRequest:qn,FetchRequest:Xl},Kl=_i(ei,Za);R.Crypto=Kl,R.BufferUtils=Za,R.Http=Oo,R.Config=ei,R.Transports=Il,R.WebStorage=ca;for(const i of[Ms,Dn])i.Crypto=Kl,i._MsgPack=Mi;Oo.bundledRequestImplementations=Zl,h.initLogHandlers(),R.Defaults=Ur(ts),R.Config.agent&&(R.Defaults.agent+=" "+R.Config.agent);var xo={ErrorInfo:U,Rest:Ms,Realtime:Dn,msgpack:Mi,makeProtocolMessageFromDeserialized:Ml};if(typeof b.exports=="object"&&typeof P=="object"){var Yc=(i,a,l,o)=>{if(a&&typeof a=="object"||typeof a=="function")for(let u of Object.getOwnPropertyNames(a))!Object.prototype.hasOwnProperty.call(i,u)&&u!==l&&Object.defineProperty(i,u,{get:()=>a[u],enumerable:!(o=Object.getOwnPropertyDescriptor(a,u))||o.enumerable});return i};b.exports=Yc(b.exports,P)}return b.exports})}(mc)),mc.exports}var ym=pm();const vm=(E,Y,P,b,$,ne)=>{const de=At.useRef(null),ee=At.useRef(null),V=At.useRef(null),[x,Q]=At.useState("disconnected"),[he,le]=At.useState(new Set),H=(R,...J)=>{E.debug&&console.log(R,...J)},ye=async()=>{if(!E.websocket.enabled||!E.websocket.apiKey.trim()||!E.websocket.roomId.trim()){H("Недостаточно данных для подключения к Ably");return}try{Q("connecting"),V.current=`user-${Math.random().toString(36).substr(2,9)}`,de.current=new ym.Realtime({key:E.websocket.apiKey,clientId:V.current,recover:!0}),de.current.connection.on("connected",()=>{Q("connected"),H("Подключено к Ably. Client ID:",V.current),H("Room ID:",E.websocket.roomId)}),de.current.connection.on("disconnected",()=>{Q("disconnected"),H("Отключено от Ably")}),de.current.connection.on("failed",J=>{Q("failed"),console.error("Ошибка подключения к Ably:",J)});const R=E.websocket.roomId.trim();ee.current=de.current.channels.get(R),H("Подключаемся к каналу:",R),ee.current.on("attached",()=>{H("✅ Канал подключен и готов к работе")}),ee.current.on("failed",J=>{console.error("❌ Ошибка канала:",J)}),ee.current.subscribe("schedule-update",J=>{H("📨 Получено обновление расписания:",J.data),H("👤 От пользователя:",J.data?.userId,"Мой ID:",V.current),J.data&&J.data.schedule&&J.data.userId!==V.current?(H("✅ Применяем изменения расписания от другого пользователя"),b(J.data.schedule)):H("⏭️ Игнорируем собственное сообщение")}),ee.current.subscribe("settings-update",J=>{H("Получено обновление настроек:",J.data),J.data&&J.data.settings&&J.data.userId!==V.current&&(H("Применяем изменения настроек от другого пользователя"),$(J.data.settings))}),ee.current.subscribe("celltags-update",J=>{H("Получено обновление тегов ячеек:",J.data),J.data&&J.data.cellTags&&J.data.userId!==V.current&&(H("Применяем изменения тегов ячеек от другого пользователя"),ne(J.data.cellTags))}),ee.current.subscribe("test-message",J=>{H("🧪 Получено тестовое сообщение:",J.data),J.data.userId!==V.current&&H("✅ Тест синхронизации прошел успешно!")}),ee.current.presence.enter({username:`Пользователь ${Math.floor(Math.random()*1e3)}`,joinedAt:new Date().toISOString()}),ee.current.presence.subscribe(J=>{ee.current.presence.get((nt,mt)=>{!nt&&Array.isArray(mt)&&le(new Set(mt.map(Ot=>Ot.data.username)))})})}catch(R){console.error("Ошибка при подключении к Ably:",R),Q("failed")}},Oe=()=>{if(ee.current){try{ee.current.presence.leave(),ee.current.unsubscribe()}catch(R){H("Ошибка при отключении канала (норм):",R.message)}ee.current=null}if(de.current){try{de.current.close()}catch(R){H("Ошибка при закрытии клиента (норм):",R.message)}de.current=null}V.current=null,Q("disconnected"),le(new Set)},ge=R=>{if(H("🔄 Попытка отправки обновления расписания"),H("📊 State - channel:",!!ee.current,"connected:",x==="connected"),ee.current&&x==="connected"){const J={schedule:R,timestamp:new Date().toISOString(),userId:V.current};H("📤 Отправляем обновление расписания:",J),ee.current.publish("schedule-update",J).then(()=>{H("✅ Сообщение успешно отправлено")}).catch(nt=>{console.error("❌ Ошибка отправки сообщения:",nt)})}else H("❌ Не можем отправить: канал не готов или не подключен")},re=R=>{if(ee.current&&x==="connected"){const J={settings:{employees:R.employees,shiftTypes:R.shiftTypes,tags:R.tags},timestamp:new Date().toISOString(),userId:V.current};H("Отправляем обновление настроек:",J),ee.current.publish("settings-update",J)}},be=R=>{if(ee.current&&x==="connected"){const J={cellTags:R,timestamp:new Date().toISOString(),userId:V.current};H("Отправляем обновление тегов ячеек:",J),ee.current.publish("celltags-update",J)}},se=()=>{if(ee.current&&x==="connected"){const R={test:!0,timestamp:new Date().toISOString(),userId:V.current};H("🧪 Отправляем тестовое сообщение"),ee.current.publish("test-message",R)}};return At.useEffect(()=>{if(Oe(),E.websocket.enabled&&E.websocket.apiKey.trim()&&E.websocket.roomId.trim()){const R=setTimeout(()=>{ye()},100);return()=>{clearTimeout(R),Oe()}}return()=>{Oe()}},[E.websocket.enabled,E.websocket.apiKey,E.websocket.roomId]),{connectionState:x,onlineUsers:he,publishScheduleUpdate:ge,publishSettingsUpdate:re,publishCellTagsUpdate:be,sendTestMessage:se}},bm=["Ильвина","Инесса","Альбина","Анастасия","Арина","Ксения","Света","Елена","Леся","Алия","Даша"],Sm={morning:{label:"Утро",time:"8:00-16:00",shortLabel:"У",start:8,startMinutes:0,end:16,endMinutes:0,color:"#FFD700"},day:{label:"День",time:"10:00-18:00",shortLabel:"Д",start:10,startMinutes:0,end:18,endMinutes:0,color:"#4CAF50"},evening:{label:"Вечер",time:"16:00-00:00",shortLabel:"В",start:16,startMinutes:0,end:24,endMinutes:0,color:"#2196F3"},night:{label:"Ночь",time:"00:00-08:00",shortLabel:"Н",start:0,startMinutes:0,end:8,endMinutes:0,color:"#9C27B0"},off:{label:"Выходной",time:"",shortLabel:"В",start:null,end:null,color:"#f44336"},vacation:{label:"Отпуск",time:"",shortLabel:"О",start:null,end:null,color:"#FF9800"},sick:{label:"Больничный",time:"",shortLabel:"Б",start:null,end:null,color:"#9E9E9E"}},nf={Альбина:["morning","day","evening","night","off","vacation","sick","morning","day","evening","night","off","vacation","sick"],Анастасия:["day","day","day","day","day","off","off","day","day","day","day","day","off","off"],Арина:["evening","evening","evening","evening","evening","off","off","evening","evening","evening","evening","evening","off","off"],Алия:["morning","morning","off","off","vacation","vacation","vacation","night","night","night","night","night","off","off"]},Vd={morning:!0,day:!0,evening:!0,night:!0,off:!0,vacation:!0,sick:!0,empty:!0},Cr=["пн 23","вт 24","ср 25","чт 26","пт 27","сб 28","вс 29","пн 30","вт 1","ср 2","чт 3","пт 4","сб 5","вс 6"],Am={important:{label:"Важно",color:"#ff4444",shortLabel:"Важно"},training:{label:"Обучение",color:"#44ff44",shortLabel:"Обучение"},overtime:{label:"Сверхурочно",color:"#ffaa00",shortLabel:"Сверхурочно"}},Om=E=>Object.entries(E).map(([P,b])=>b.color?`
      .shift-${P} {
        background: ${b.color} !important;
      }
      
      .shift-${P}:hover {
        background: ${Tm(b.color,-10)} !important;
      }
    `:"").join(`
`),Tm=(E,Y)=>{const P=E.replace("#",""),b=parseInt(P.substr(0,2),16),$=parseInt(P.substr(2,2),16),ne=parseInt(P.substr(4,2),16),de=Math.max(0,Math.min(255,b+Y)),ee=Math.max(0,Math.min(255,$+Y)),V=Math.max(0,Math.min(255,ne+Y));return`#${de.toString(16).padStart(2,"0")}${ee.toString(16).padStart(2,"0")}${V.toString(16).padStart(2,"0")}`},Rm=E=>{const Y=document.getElementById("dynamic-shift-styles");Y&&Y.remove();const P=Om(E);if(!P)return;const b=document.createElement("style");b.id="dynamic-shift-styles",b.textContent=P,document.head.appendChild(b)},Cm=({currentView:E,selectedDay:Y,bulkEditMode:P,dropdownOpen:b,onViewSwitch:$,onBulkEditToggle:ne,onSettingsOpen:de,onExportData:ee,onImportData:V,onClearAllData:x,onDropdownToggle:Q,connectionState:he,onlineUsers:le,websocketEnabled:H})=>{const ye=Oe=>Cr[Oe]||"";return v.jsxs("div",{className:"header",children:[v.jsxs("div",{className:"header-left",children:[v.jsx("h1",{children:"Расписание смен"}),H&&v.jsxs("div",{className:`connection-status ${he}`,children:[he==="connected"&&"🟢 Подключено",he==="connecting"&&"🟡 Подключение...",he==="disconnected"&&"🔴 Отключено",he==="failed"&&"❌ Ошибка",le.size>1&&` (${le.size})`]})]}),v.jsxs("div",{className:"header-controls",children:[v.jsxs("div",{className:"view-toggle",children:[v.jsx("button",{className:`view-btn ${E==="grid"?"active":""}`,onClick:()=>$("grid"),children:"Календарь"}),Y!==null&&v.jsxs("button",{className:`view-btn ${E==="gantt"?"active":""}`,onClick:()=>$("gantt"),children:["Ганта (",ye(Y),")"]})]}),v.jsxs("div",{className:"data-controls",children:[v.jsx("button",{className:`bulk-edit-btn ${P?"active":""}`,onClick:ne,children:P?"Выйти из массового режима":"Массовое редактирование"}),v.jsxs("div",{className:`dropdown ${b?"open":""}`,children:[v.jsx("button",{className:"dropdown-btn",onClick:Q,children:"⚙️"}),v.jsxs("div",{className:"dropdown-content",children:[v.jsx("button",{onClick:()=>{de(),Q()},children:"⚙️ Настройки"}),v.jsx("button",{onClick:()=>{ee(),Q()},children:"📥 Экспорт данных"}),v.jsxs("label",{className:"import-btn",children:["📤 Импорт данных",v.jsx("input",{type:"file",accept:".json",onChange:Oe=>{V(Oe),Q()},style:{display:"none"}})]}),v.jsx("button",{onClick:()=>{x(),Q()},className:"danger-btn",children:"🗑️ Очистить все"})]})]})]})]})]})},_m=({shiftTypes:E,filters:Y,onFilterToggle:P})=>v.jsxs("div",{className:"legend",children:[v.jsx("div",{className:"filter-header",children:"Фильтры:"}),v.jsxs("div",{className:"filter-items",children:[Object.entries(E).map(([b,$])=>v.jsxs("div",{className:`legend-item filter ${Y[b]?"active":"inactive"}`,onClick:()=>P(b),title:$.label,children:[v.jsx("div",{className:`legend-color shift-${b}`}),v.jsx("span",{children:$.label})]},b)),v.jsxs("div",{className:`legend-item filter ${Y.empty?"active":"inactive"}`,onClick:()=>P("empty"),title:"Пустые ячейки",children:[v.jsx("div",{className:"legend-color empty-shift"}),v.jsx("span",{children:"—"})]})]})]}),Em=({employees:E,schedule:Y,shiftTypes:P,selectedCells:b,bulkEditMode:$,cellTags:ne,tags:de,onCellClick:ee,onCellRightClick:V,onDateClick:x,onTagClick:Q,shouldShowEmployee:he})=>{const le=H=>P[H]?.shortLabel||"";return v.jsx("div",{className:"grid-view",children:v.jsxs("div",{className:"schedule-grid",children:[v.jsxs("div",{className:"grid-header",children:[v.jsx("div",{children:"Имя"}),Cr.map((H,ye)=>v.jsx("div",{className:`date-header ${ye===5||ye===6||ye===12||ye===13?"weekend":""} ${ye===8?"today":""}`,onClick:()=>x(ye),children:H},ye))]}),E.map((H,ye)=>he(ye)?v.jsxs("div",{className:"grid-row",children:[v.jsx("div",{className:"employee-name",children:H}),Array.from({length:14},(Oe,ge)=>{const re=`${ye}-${ge}`,be=b.has(re);return v.jsxs("div",{className:`day-cell ${be?"selected":""} ${$?"bulk-mode":""}`,onClick:()=>ee(ye,ge),onContextMenu:V,children:[Y[re]&&v.jsxs("div",{className:`shift-card shift-${Y[re]}`,children:[v.jsx("div",{className:"shift-symbol",children:le(Y[re])}),v.jsx("div",{className:"shift-tags",children:ne[re]&&ne[re].map((se,R)=>{const J=de[se];return J?v.jsx("span",{className:"shift-tag",style:{backgroundColor:J.color},title:J.label,children:J.shortLabel},se):null})})]}),!Y[re]&&v.jsx("div",{className:"empty-cell",children:v.jsx("div",{className:"shift-tags",children:ne[re]&&ne[re].map((se,R)=>{const J=de[se];return J?v.jsx("span",{className:"shift-tag",style:{backgroundColor:J.color},title:J.label,children:J.shortLabel},se):null})})})]},ge)})]},ye):null)]})})},Mm=({employees:E,schedule:Y,shiftTypes:P,selectedCells:b,bulkEditMode:$,cellTags:ne,tags:de,onCellClick:ee,onCellRightClick:V,onTagClick:x,shouldShowEmployee:Q})=>{const he=le=>P[le]?.shortLabel||"";return v.jsx("div",{className:"timeline-view",children:v.jsxs("div",{className:"timeline-container",children:[v.jsxs("div",{className:"timeline-header",children:[v.jsx("div",{className:"timeline-employee-header",children:"Сотрудник"}),v.jsx("div",{className:"timeline-dates",children:Cr.map((le,H)=>v.jsx("div",{className:`timeline-date ${H===5||H===6||H===12||H===13?"weekend":""} ${H===8?"today":""}`,children:le},H))})]}),E.map((le,H)=>Q(H)?v.jsxs("div",{className:"timeline-row",children:[v.jsx("div",{className:"timeline-employee",children:le}),v.jsx("div",{className:"timeline-schedule",children:Array.from({length:14},(ye,Oe)=>{const ge=`${H}-${Oe}`,re=b.has(ge);return v.jsxs("div",{className:`timeline-cell ${re?"selected":""} ${$?"bulk-mode":""}`,onClick:()=>ee(H,Oe),onContextMenu:V,children:[Y[ge]&&v.jsxs("div",{className:`shift-card shift-${Y[ge]}`,children:[v.jsx("div",{className:"shift-symbol",children:he(Y[ge])}),v.jsx("div",{className:"shift-tags",children:ne[ge]&&ne[ge].map((be,se)=>{const R=de[be];return R?v.jsx("span",{className:"shift-tag",style:{backgroundColor:R.color},title:R.label,children:R.shortLabel},be):null})})]}),!Y[ge]&&v.jsx("div",{className:"empty-cell",children:v.jsx("div",{className:"shift-tags",children:ne[ge]&&ne[ge].map((be,se)=>{const R=de[be];return R?v.jsx("span",{className:"shift-tag",style:{backgroundColor:R.color},title:R.label,children:R.shortLabel},be):null})})})]},Oe)})})]},H):null)]})})},wm=({selectedDay:E,onDaySelect:Y})=>v.jsxs("div",{className:"date-selector",children:[v.jsx("div",{className:"date-selector-header",children:"Выберите дату:"}),v.jsx("div",{className:"date-options",children:Cr.map((P,b)=>v.jsx("button",{className:`date-option ${E===b?"active":""} ${b===5||b===6||b===12||b===13?"weekend":""} ${b===8?"today":""}`,onClick:()=>Y(b),children:P},b))})]}),Nm=({employees:E,schedule:Y,shiftTypes:P,selectedDay:b,cellTags:$,tags:ne,onBackToGrid:de,onDaySelect:ee,onTagClick:V,shouldShowEmployee:x})=>{const Q=le=>Cr[le]||"",he=le=>{const H=P[le];return!H||H.start===null?null:{start:H.start,end:H.end,label:H.label}};return v.jsxs("div",{className:"gantt-view",children:[v.jsxs("div",{className:"gantt-header",children:[v.jsxs("h2",{children:["Расписание на ",Q(b)]}),v.jsx("button",{className:"back-btn",onClick:de,children:"← Вернуться к календарю"})]}),v.jsx(wm,{selectedDay:b,onDaySelect:ee}),v.jsxs("div",{className:"gantt-container",children:[v.jsxs("div",{className:"time-scale",children:[v.jsx("div",{className:"time-scale-header",children:"Время"}),v.jsx("div",{className:"time-hours",children:Array.from({length:24},(le,H)=>v.jsxs("div",{className:"time-hour",children:[H.toString().padStart(2,"0"),":00"]},H))})]}),v.jsxs("div",{className:"gantt-employees",children:[v.jsx("div",{className:"gantt-employees-header",children:"Сотрудник"}),v.jsx("div",{className:"gantt-rows",children:E.map((le,H)=>{const ye=`${H}-${b}`,Oe=Y[ye],ge=Oe?he(Oe):null;return x(H)?v.jsxs("div",{className:"gantt-row",children:[v.jsx("div",{className:"gantt-employee-name",children:le}),v.jsxs("div",{className:"gantt-timeline",children:[Array.from({length:24},(re,be)=>v.jsx("div",{className:"gantt-hour-cell"},be)),ge&&v.jsxs("div",{className:`gantt-shift shift-${Oe}`,style:{left:`${ge.start/24*100}%`,width:`${(ge.end-ge.start)/24*100}%`},onClick:()=>V(H,b),children:[v.jsxs("span",{className:"gantt-shift-label",children:[ge.label," (",ge.start,":00-",ge.end,":00)"]}),v.jsx("div",{className:"gantt-tags",children:$[ye]&&$[ye].map((re,be)=>{const se=ne[re];return se?v.jsx("span",{className:"gantt-tag",style:{backgroundColor:se.color},title:se.label,children:se.shortLabel},re):null})})]}),Oe&&!ge&&v.jsxs("div",{className:`gantt-status shift-${Oe}`,onClick:()=>V(H,b),children:[v.jsxs("span",{className:"gantt-status-label",children:[Oe==="off"&&"Выходной",Oe==="vacation"&&"Отпуск",Oe==="sick"&&"Больничный"]}),v.jsx("div",{className:"gantt-tags",children:$[ye]&&$[ye].map((re,be)=>{const se=ne[re];return se?v.jsx("span",{className:"gantt-tag",style:{backgroundColor:se.color},title:se.label,children:se.shortLabel},re):null})})]}),!Oe&&v.jsx("div",{className:"gantt-empty",onClick:()=>V(H,b),children:v.jsx("div",{className:"gantt-tags",children:$[ye]&&$[ye].map((re,be)=>{const se=ne[re];return se?v.jsx("span",{className:"gantt-tag",style:{backgroundColor:se.color},title:se.label,children:se.shortLabel},re):null})})})]})]},H):null})})]})]})]})},Wd=(E,Y=0)=>{const P=E.toString().padStart(2,"0"),b=Y.toString().padStart(2,"0");return`${P}:${b}`},$d=(E,Y=0)=>E*60+Y,xm=E=>{const Y=Math.floor(E/60),P=E%60;return{hours:Y,minutes:P}},Um=(E=10)=>{const Y=[];for(let P=0;P<24;P++)for(let b=0;b<60;b+=E)Y.push({value:$d(P,b),label:Wd(P,b),hours:P,minutes:b});return Y},Id=({value:E,onChange:Y,placeholder:P="Выберите время",stepMinutes:b=10})=>{const $=Um(b);let ne="";typeof E=="number"?ne=E*60:typeof E=="object"&&E.hours!==void 0&&(ne=$d(E.hours,E.minutes||0));const de=ee=>{const V=parseInt(ee.target.value),x=xm(V);Y({hours:x.hours,minutes:x.minutes,totalMinutes:V,formatted:Wd(x.hours,x.minutes)})};return v.jsxs("select",{value:ne,onChange:de,className:"time-select",children:[v.jsx("option",{value:"",children:P}),$.map(ee=>v.jsx("option",{value:ee.value,children:ee.label},ee.value))]})},Yd=({value:E,onChange:Y,label:P="Цвет"})=>{const[b,$]=At.useState(!1),ne=At.useRef(null);At.useEffect(()=>{const V=x=>{ne.current&&!ne.current.contains(x.target)&&$(!1)};return b&&document.addEventListener("mousedown",V),()=>{document.removeEventListener("mousedown",V)}},[b]);const de=["#FFD700","#FFA500","#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FECA57","#FF9FF3","#54A0FF","#5F27CD","#00D2D3","#FF9F43","#10AC84","#EE5A24","#0984E3","#6C5CE7","#A29BFE","#FD79A8","#E17055","#00B894"],ee=V=>{Y(V),$(!1)};return v.jsxs("div",{className:"color-picker",ref:ne,children:[v.jsx("label",{className:"color-picker-label",children:P}),v.jsxs("div",{className:"color-picker-container",children:[v.jsx("button",{type:"button",className:"color-picker-trigger",onClick:()=>$(!b),style:{backgroundColor:E||"#e0e0e0"},children:v.jsx("span",{className:"color-picker-value",children:E||"Выбрать"})}),b&&v.jsxs("div",{className:"color-picker-dropdown",children:[v.jsx("div",{className:"color-picker-colors",children:de.map(V=>v.jsx("button",{type:"button",className:`color-option ${E===V?"selected":""}`,style:{backgroundColor:V},onClick:()=>ee(V),title:V},V))}),v.jsxs("div",{className:"color-picker-custom",children:[v.jsx("input",{type:"color",value:E||"#e0e0e0",onChange:V=>ee(V.target.value),className:"color-picker-input"}),v.jsx("span",{children:"Свой цвет"})]})]})]})]})},Dm=({isOpen:E,settings:Y,connectionState:P,onClose:b,onEmployeeChange:$,onRemoveEmployee:ne,onAddEmployee:de,onShiftTypeChange:ee,onRemoveShiftType:V,onAddShiftType:x,onTagChange:Q,onRemoveTag:he,onAddTag:le,onSettingsChange:H,onSendTestMessage:ye})=>{const[Oe,ge]=At.useState("employees");return E?v.jsx("div",{className:"settings-overlay",onClick:b,children:v.jsxs("div",{className:"settings-modal",onClick:re=>re.stopPropagation(),children:[v.jsxs("div",{className:"settings-header",children:[v.jsx("h2",{children:"Настройки"}),v.jsx("button",{className:"close-btn",onClick:b,children:"×"})]}),v.jsxs("div",{className:"settings-tabs",children:[v.jsx("button",{className:`tab-btn ${Oe==="employees"?"active":""}`,onClick:()=>ge("employees"),children:"Сотрудники"}),v.jsx("button",{className:`tab-btn ${Oe==="shifts"?"active":""}`,onClick:()=>ge("shifts"),children:"Типы смен"}),v.jsx("button",{className:`tab-btn ${Oe==="tags"?"active":""}`,onClick:()=>ge("tags"),children:"Теги"}),v.jsx("button",{className:`tab-btn ${Oe==="sync"?"active":""}`,onClick:()=>ge("sync"),children:"Синхронизация"}),v.jsx("button",{className:`tab-btn ${Oe==="debug"?"active":""}`,onClick:()=>ge("debug"),children:"Отладка"})]}),v.jsxs("div",{className:"settings-content",children:[Oe==="employees"&&v.jsxs("div",{className:"settings-section",children:[v.jsx("h3",{children:"Сотрудники"}),v.jsx("button",{className:"add-btn",onClick:de,children:"+ Добавить сотрудника"}),v.jsx("div",{className:"employees-list",children:Y.employees.map((re,be)=>v.jsxs("div",{className:"employee-item",children:[v.jsx("input",{type:"text",value:re,onChange:se=>$(be,se.target.value)}),v.jsx("button",{className:"remove-btn",onClick:()=>ne(be),children:"🗑️"})]},be))})]}),Oe==="shifts"&&v.jsxs("div",{className:"settings-section",children:[v.jsx("h3",{children:"Типы смен"}),v.jsx("button",{className:"add-btn",onClick:x,children:"+ Добавить тип смены"}),v.jsx("div",{className:"shift-types-list",children:Object.entries(Y.shiftTypes).map(([re,be])=>v.jsxs("div",{className:"shift-type-item",children:[v.jsxs("div",{className:"shift-type-inputs",children:[v.jsx("input",{type:"text",placeholder:"Название",value:be.label,onChange:se=>ee(re,"label",se.target.value)}),v.jsx("input",{type:"text",placeholder:"Краткое",value:be.shortLabel,maxLength:2,onChange:se=>ee(re,"shortLabel",se.target.value)}),v.jsx(Yd,{value:be.color,onChange:se=>ee(re,"color",se),label:"Цвет"}),be.start!==null&&v.jsxs(v.Fragment,{children:[v.jsx(Id,{value:{hours:be.start,minutes:be.startMinutes||0},placeholder:"Начало",onChange:se=>{ee(re,"start",se.hours),ee(re,"startMinutes",se.minutes)}}),v.jsx(Id,{value:{hours:be.end,minutes:be.endMinutes||0},placeholder:"Конец",onChange:se=>{ee(re,"end",se.hours),ee(re,"endMinutes",se.minutes)}})]})]}),v.jsx("button",{className:"remove-btn",onClick:()=>V(re),children:"🗑️"})]},re))})]}),Oe==="tags"&&v.jsxs("div",{className:"settings-section",children:[v.jsx("h3",{children:"Теги"}),v.jsx("button",{className:"add-btn",onClick:le,children:"+ Добавить тег"}),v.jsx("div",{className:"tags-list",children:Object.entries(Y.tags||{}).map(([re,be])=>v.jsxs("div",{className:"tag-item",children:[v.jsxs("div",{className:"tag-inputs",children:[v.jsx("input",{type:"text",placeholder:"Название",value:be.label,maxLength:10,onChange:se=>Q(re,"label",se.target.value)}),v.jsx("input",{type:"text",placeholder:"Символ",value:be.shortLabel,maxLength:1,onChange:se=>Q(re,"shortLabel",se.target.value)}),v.jsx(Yd,{value:be.color,onChange:se=>Q(re,"color",se),label:"Цвет"})]}),v.jsx("button",{className:"remove-btn",onClick:()=>he(re),children:"🗑️"})]},re))})]}),Oe==="sync"&&v.jsxs("div",{className:"settings-section",children:[v.jsx("h3",{children:"Ably Real-time Sync"}),v.jsxs("div",{className:"websocket-settings",children:[v.jsxs("div",{className:"ably-info",children:[v.jsx("p",{children:v.jsx("strong",{children:"📋 Инструкция по настройке:"})}),v.jsxs("ol",{children:[v.jsxs("li",{children:["Зарегистрируйтесь на ",v.jsx("a",{href:"https://ably.com",target:"_blank",rel:"noopener noreferrer",children:"ably.com"})," (бесплатно)"]}),v.jsx("li",{children:"Создайте новое приложение"}),v.jsx("li",{children:'Скопируйте API ключ из раздела "API Keys"'}),v.jsx("li",{children:"Введите данные ниже и включите синхронизацию"})]})]}),v.jsxs("label",{children:[v.jsx("input",{type:"checkbox",checked:Y.websocket.enabled,onChange:re=>H("websocket.enabled",re.target.checked)}),"Включить real-time синхронизацию"]}),v.jsx("input",{type:"password",placeholder:"Ably API Key (например: abc123.def456:xyz789)",value:Y.websocket.apiKey,onChange:re=>H("websocket.apiKey",re.target.value),disabled:!Y.websocket.enabled}),v.jsx("input",{type:"text",placeholder:"Room ID (например: simple-scheduler-mv)",value:Y.websocket.roomId,onChange:re=>H("websocket.roomId",re.target.value),disabled:!Y.websocket.enabled}),P==="connected"&&v.jsx("div",{className:"ably-status success",children:"✅ Подключено! Изменения синхронизируются в реальном времени"}),P==="failed"&&v.jsx("div",{className:"ably-status error",children:"❌ Ошибка подключения. Проверьте API ключ и интернет-соединение"}),P==="connected"&&v.jsx("button",{className:"btn btn-primary",onClick:ye,style:{marginTop:"10px"},children:"🧪 Тест отправки сообщения"})]})]}),Oe==="debug"&&v.jsxs("div",{className:"settings-section",children:[v.jsx("h3",{children:"Отладка"}),v.jsxs("div",{className:"debug-settings",children:[v.jsxs("label",{children:[v.jsx("input",{type:"checkbox",checked:Y.debug,onChange:re=>H("debug",re.target.checked)}),"Включить режим отладки (показывать логи в консоли)"]}),Y.debug&&v.jsxs("div",{className:"debug-info",children:[v.jsxs("p",{children:["🐛 ",v.jsx("strong",{children:"Режим отладки включен"})]}),v.jsx("p",{children:"Все действия синхронизации будут отображаться в консоли браузера (F12 → Console)"})]})]})]})]}),v.jsxs("div",{className:"settings-footer",children:[v.jsx("button",{className:"btn btn-cancel",onClick:b,children:"Отмена"}),v.jsx("button",{className:"btn btn-primary",onClick:b,children:"Сохранить"})]})]})}):null},km=({isOpen:E,shiftTypes:Y,availableTags:P,selectedTags:b,selectedCells:$,bulkEditMode:ne,onShiftChange:de,onTagToggle:ee,onClose:V})=>{const[x,Q]=At.useState("shifts");return E?v.jsx("div",{className:"popup-overlay",onClick:V,children:v.jsxs("div",{className:"popup",onClick:he=>he.stopPropagation(),children:[v.jsxs("div",{className:"popup-header",children:[v.jsx("h3",{children:ne&&$.size>0?`Редактирование ${$.size} ячеек`:"Редактирование ячейки"}),v.jsx("button",{className:"close-btn",onClick:V,children:"×"})]}),v.jsxs("div",{className:"popup-tabs",children:[v.jsx("button",{className:`tab-btn ${x==="shifts"?"active":""}`,onClick:()=>Q("shifts"),children:"Смены"}),v.jsx("button",{className:`tab-btn ${x==="tags"?"active":""}`,onClick:()=>Q("tags"),children:"Теги"})]}),v.jsxs("div",{className:"popup-content",children:[x==="shifts"&&v.jsx("div",{className:"shifts-tab",children:v.jsxs("div",{className:"shift-options",children:[Object.entries(Y).map(([he,le])=>v.jsx("div",{className:`shift-option shift-${he}`,onClick:()=>de(he),children:v.jsxs("div",{className:"shift-option-content",children:[v.jsx("span",{className:"shift-label",children:le.label}),le.time&&v.jsx("span",{className:"shift-time",children:le.time})]})},he)),v.jsx("div",{className:"shift-option clear-option",onClick:()=>de("clear"),children:v.jsx("div",{className:"shift-option-content",children:v.jsx("span",{className:"shift-label",children:"Очистить"})})})]})}),x==="tags"&&v.jsxs("div",{className:"tags-tab",children:[v.jsx("div",{className:"tag-management-grid",children:Object.entries(P).map(([he,le])=>{const H=b.includes(he);return v.jsxs("div",{className:`tag-management-item ${H?"selected":""}`,onClick:()=>ee(he),children:[v.jsx("div",{className:"tag-color-preview",style:{backgroundColor:le.color},children:le.shortLabel}),v.jsx("span",{className:"tag-label",children:le.label}),v.jsx("div",{className:"tag-action",children:H?v.jsx("span",{className:"remove-indicator",children:"Удалить"}):v.jsx("span",{className:"add-indicator",children:"Добавить"})})]},he)})}),Object.keys(P).length===0&&v.jsxs("div",{className:"no-tags-message",children:[v.jsx("p",{children:"Нет доступных тегов."}),v.jsx("p",{children:"Создайте теги в настройках."})]})]})]}),v.jsx("div",{className:"popup-footer",children:v.jsx("button",{className:"btn btn-cancel",onClick:V,children:"Закрыть"})})]})}):null};function Lm(){const[E,Y]=nl("schedule-planner-settings",{employees:bm,shiftTypes:Sm,tags:Am,websocket:{url:"",apiKey:"",roomId:"",enabled:!1},debug:!1}),[P,b]=nl("schedule-planner-data",()=>{const X={};return E.employees.forEach((Z,ce)=>{for(let ue=0;ue<14;ue++){const te=`${ce}-${ue}`;nf[Z]&&ue<nf[Z].length&&(X[te]=nf[Z][ue])}}),X}),[$,ne]=nl("schedule-planner-view","grid"),[de,ee]=nl("schedule-planner-selected-day",null),[V,x]=nl("schedule-planner-filters",Vd),[Q,he]=nl("schedule-planner-tags",{}),[le,H]=At.useState({open:!1,empIndex:null,dayIndex:null,selectedTags:[]}),[ye,Oe]=At.useState(!1),[ge,re]=At.useState(!1),[be,se]=At.useState(new Set),[R,J]=At.useState(!1),nt=X=>{b(X)},mt=X=>{Y(Z=>({...Z,employees:X.employees||Z.employees,shiftTypes:X.shiftTypes||Z.shiftTypes,tags:X.tags||Z.tags}))},Ot=X=>{he(X)},{connectionState:lt,onlineUsers:Hn,publishScheduleUpdate:h,publishSettingsUpdate:qe,publishCellTagsUpdate:Xt,sendTestMessage:U}=vm(E,P,Q,nt,mt,Ot);At.useEffect(()=>{Rm(E.shiftTypes)},[E.shiftTypes]),At.useEffect(()=>{const X=Z=>{R&&!Z.target.closest(".dropdown")&&J(!1)};return document.addEventListener("mousedown",X),()=>{document.removeEventListener("mousedown",X)}},[R]);const Le=(X,Z)=>{const ce=[...E.employees];ce[X]=Z;const ue={...E,employees:ce};Y(ue),qe(ue)},D=X=>{const Z=E.employees.filter((ue,te)=>te!==X),ce={...E,employees:Z};Y(ce),qe(ce)},G=()=>{const X={...E,employees:[...E.employees,"Новый сотрудник"]};Y(X),qe(X)},me=(X,Z,ce)=>{const ue={...E.shiftTypes,[X]:{...E.shiftTypes[X],[Z]:ce}};if(Z==="start"||Z==="end"||Z==="startMinutes"||Z==="endMinutes"){const ct=ue[X];if(ct.start!==null&&ct.end!==null){const Dt=ct.startMinutes||0,dn=ct.endMinutes||0,Hi=`${ct.start.toString().padStart(2,"0")}:${Dt.toString().padStart(2,"0")}`,Vn=`${ct.end.toString().padStart(2,"0")}:${dn.toString().padStart(2,"0")}`;ue[X].time=`${Hi}-${Vn}`}}const te={...E,shiftTypes:ue};Y(te),qe(te)},Ge=X=>{const Z={...E.shiftTypes};delete Z[X];const ce={...E,shiftTypes:Z};Y(ce),qe(ce)},S=()=>{const X=`custom_${Date.now()}`,Z={label:"Новая смена",shortLabel:"Н",start:9,startMinutes:0,end:17,endMinutes:0,time:"9:00-17:00",color:"#4CAF50"},ce={...E.shiftTypes,[X]:Z},ue={...E,shiftTypes:ce};Y(ue),qe(ue)},I=X=>{let Z;if(ge&&be.size>0)b(ce=>(Z={...ce},be.forEach(ue=>{X==="clear"?delete Z[ue]:Z[ue]=X}),h(Z),Z)),se(new Set);else{if(le.empIndex===null||le.dayIndex===null)return;const ce=`${le.empIndex}-${le.dayIndex}`;b(ue=>(Z={...ue},X==="clear"?delete Z[ce]:Z[ce]=X,h(Z),Z))}H({open:!1,empIndex:null,dayIndex:null})},W=(X,Z)=>{if(ge){const ce=`${X}-${Z}`;se(ue=>{const te=new Set(ue);return te.has(ce)?te.delete(ce):te.add(ce),te})}else{const ce=`${X}-${Z}`,ue=Q[ce]||[];H({open:!0,empIndex:X,dayIndex:Z,selectedTags:ue})}},F=X=>{if(ge&&be.size>0){X.preventDefault();const Z=Array.from(be),ce=Z.length>0?(Q[Z[0]]||[]).filter(ue=>Z.every(te=>(Q[te]||[]).includes(ue))):[];H({open:!0,empIndex:null,dayIndex:null,selectedTags:ce})}},ve=X=>{ee(X),ne("gantt")},ke=X=>{x(Z=>({...Z,[X]:!Z[X]}))},Te=X=>{for(let Z=0;Z<14;Z++){const ce=`${X}-${Z}`,ue=P[ce];if((!ue||ue==="")&&V.empty||ue&&ue!==""&&V[ue])return!0}return!1},Et=()=>{re(!ge),se(new Set)},Ye=()=>{const X={schedule:P,filters:V,currentView:$,selectedDay:de,exportDate:new Date().toISOString(),version:"1.0"},Z=JSON.stringify(X,null,2),ce=new Blob([Z],{type:"application/json"}),ue=URL.createObjectURL(ce),te=document.createElement("a");te.href=ue,te.download=`schedule-planner-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(te),te.click(),document.body.removeChild(te),URL.revokeObjectURL(ue)},ln=X=>{const Z=X.target.files[0];if(!Z)return;const ce=new FileReader;ce.onload=ue=>{try{const te=JSON.parse(ue.target.result);te.schedule&&(b(te.schedule),h(te.schedule)),te.filters&&x(te.filters),te.currentView&&ne(te.currentView),te.selectedDay!==void 0&&ee(te.selectedDay),alert("Данные успешно импортированы!")}catch(te){alert("Ошибка при импорте данных. Проверьте формат файла."),console.error("Import error:",te)}},ce.readAsText(Z),X.target.value=""},Bi=()=>{if(confirm("Вы уверены, что хотите очистить все данные? Это действие нельзя отменить.")){const X={},Z={};b(X),he(Z),h(X),Xt(Z),x(Vd),ne("grid"),ee(null),re(!1),se(new Set),alert("Все данные очищены!")}},qi=(X,Z)=>{const ce=X.split(".");Y(ue=>{const te={...ue};let ct=te;for(let Dt=0;Dt<ce.length-1;Dt++)ct[ce[Dt]]={...ct[ce[Dt]]},ct=ct[ce[Dt]];return ct[ce[ce.length-1]]=Z,te})},On=(X,Z,ce)=>{const ue={...E.tags[X],[Z]:ce};Z==="label"&&(ue.shortLabel=ce);const te={...E.tags,[X]:ue},ct={...E,tags:te};Y(ct),qe(ct)},Gi=X=>{const Z={...E.tags};delete Z[X];const ce={...E,tags:Z};Y(ce),qe(ce)},zi=()=>{const X=`tag_${Date.now()}`,Z={label:"Новый тег",shortLabel:"Новый тег",color:"#4CAF50"},ce={...E.tags,[X]:Z},ue={...E,tags:ce};Y(ue),qe(ue)},os=X=>{H(Z=>{const ce=Z.selectedTags.includes(X)?Z.selectedTags.filter(ue=>ue!==X):[...Z.selectedTags,X];if(Z.empIndex!==null&&Z.dayIndex!==null){const ue=`${Z.empIndex}-${Z.dayIndex}`;cs(ue,ce)}else ge&&be.size>0&&he(ue=>{const te={...ue},ct=!Z.selectedTags.includes(X);return be.forEach(Dt=>{const dn=te[Dt]||[];ct?dn.includes(X)||(te[Dt]=[...dn,X]):te[Dt]=dn.filter(Hi=>Hi!==X)}),Xt(te),te});return{...Z,selectedTags:ce}})},cs=(X,Z)=>{he(ce=>{const ue={...ce,[X]:Z};return Xt(ue),ue})};return v.jsxs("div",{className:"container",children:[v.jsx(Cm,{currentView:$,selectedDay:de,bulkEditMode:ge,dropdownOpen:R,connectionState:lt,onlineUsers:Hn,websocketEnabled:E.websocket.enabled,onViewSwitch:ne,onBulkEditToggle:Et,onSettingsOpen:()=>Oe(!0),onExportData:Ye,onImportData:ln,onClearAllData:Bi,onDropdownToggle:()=>J(!R)}),v.jsxs("div",{className:"content",children:[v.jsx(_m,{shiftTypes:E.shiftTypes,filters:V,onFilterToggle:ke}),$==="grid"&&v.jsx(Em,{employees:E.employees,schedule:P,shiftTypes:E.shiftTypes,selectedCells:be,bulkEditMode:ge,cellTags:Q,tags:E.tags,onCellClick:W,onCellRightClick:F,onDateClick:ve,onTagClick:W,shouldShowEmployee:Te}),$==="timeline"&&v.jsx(Mm,{employees:E.employees,schedule:P,shiftTypes:E.shiftTypes,selectedCells:be,bulkEditMode:ge,cellTags:Q,tags:E.tags,onCellClick:W,onCellRightClick:F,onTagClick:W,shouldShowEmployee:Te}),$==="gantt"&&de!==null&&v.jsx(Nm,{employees:E.employees,schedule:P,shiftTypes:E.shiftTypes,selectedDay:de,cellTags:Q,tags:E.tags,onBackToGrid:()=>ne("grid"),onDaySelect:ee,onTagClick:W,shouldShowEmployee:Te}),v.jsx(km,{isOpen:le.open,shiftTypes:E.shiftTypes,availableTags:E.tags,selectedTags:le.selectedTags,selectedCells:be,bulkEditMode:ge,onShiftChange:I,onTagToggle:os,onClose:()=>H({open:!1,empIndex:null,dayIndex:null,selectedTags:[]})}),v.jsx(Dm,{isOpen:ye,settings:E,connectionState:lt,onClose:()=>Oe(!1),onEmployeeChange:Le,onRemoveEmployee:D,onAddEmployee:G,onShiftTypeChange:me,onRemoveShiftType:Ge,onAddShiftType:S,onTagChange:On,onRemoveTag:Gi,onAddTag:zi,onSettingsChange:qi,onSendTestMessage:U})]})]})}gm.createRoot(document.getElementById("root")).render(v.jsx(Lm,{}));
//# sourceMappingURL=index.js.map
