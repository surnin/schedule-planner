(function(){const F=document.createElement("link").relList;if(F&&F.supports&&F.supports("modulepreload"))return;for(const Z of document.querySelectorAll('link[rel="modulepreload"]'))S(Z);new MutationObserver(Z=>{for(const X of Z)if(X.type==="childList")for(const re of X.addedNodes)re.tagName==="LINK"&&re.rel==="modulepreload"&&S(re)}).observe(document,{childList:!0,subtree:!0});function P(Z){const X={};return Z.integrity&&(X.integrity=Z.integrity),Z.referrerPolicy&&(X.referrerPolicy=Z.referrerPolicy),Z.crossOrigin==="use-credentials"?X.credentials="include":Z.crossOrigin==="anonymous"?X.credentials="omit":X.credentials="same-origin",X}function S(Z){if(Z.ep)return;Z.ep=!0;const X=P(Z);fetch(Z.href,X)}})();var Ju={exports:{}},yr={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ud;function am(){if(Ud)return yr;Ud=1;var U=Symbol.for("react.transitional.element"),F=Symbol.for("react.fragment");function P(S,Z,X){var re=null;if(X!==void 0&&(re=""+X),Z.key!==void 0&&(re=""+Z.key),"key"in Z){X={};for(var ue in Z)ue!=="key"&&(X[ue]=Z[ue])}else X=Z;return Z=X.ref,{$$typeof:U,type:S,key:re,ref:Z!==void 0?Z:null,props:X}}return yr.Fragment=F,yr.jsx=P,yr.jsxs=P,yr}var xd;function sm(){return xd||(xd=1,Ju.exports=am()),Ju.exports}var E=sm(),Wu={exports:{}},Te={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dd;function lm(){if(Dd)return Te;Dd=1;var U=Symbol.for("react.transitional.element"),F=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),Z=Symbol.for("react.profiler"),X=Symbol.for("react.consumer"),re=Symbol.for("react.context"),ue=Symbol.for("react.forward_ref"),K=Symbol.for("react.suspense"),w=Symbol.for("react.memo"),V=Symbol.for("react.lazy"),I=Symbol.iterator;function ae(v){return v===null||typeof v!="object"?null:(v=I&&v[I]||v["@@iterator"],typeof v=="function"?v:null)}var $={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},be=Object.assign,rt={};function Ke(v,H,Q){this.props=v,this.context=H,this.refs=rt,this.updater=Q||$}Ke.prototype.isReactComponent={},Ke.prototype.setState=function(v,H){if(typeof v!="object"&&typeof v!="function"&&v!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,v,H,"setState")},Ke.prototype.forceUpdate=function(v){this.updater.enqueueForceUpdate(this,v,"forceUpdate")};function De(){}De.prototype=Ke.prototype;function Ae(v,H,Q){this.props=v,this.context=H,this.refs=rt,this.updater=Q||$}var $e=Ae.prototype=new De;$e.constructor=Ae,be($e,Ke.prototype),$e.isPureReactComponent=!0;var x=Array.isArray,Re={H:null,A:null,T:null,S:null,V:null},ht=Object.prototype.hasOwnProperty;function Nt(v,H,Q,W,ce,Ne){return Q=Ne.ref,{$$typeof:U,type:v,key:H,ref:Q!==void 0?Q:null,props:Ne}}function mt(v,H){return Nt(v.type,H,void 0,void 0,void 0,v.props)}function Ze(v){return typeof v=="object"&&v!==null&&v.$$typeof===U}function jn(v){var H={"=":"=0",":":"=2"};return"$"+v.replace(/[=:]/g,function(Q){return H[Q]})}var h=/\/+/g;function Fe(v,H){return typeof v=="object"&&v!==null&&v.key!=null?jn(""+v.key):H.toString(36)}function fn(){}function N(v){switch(v.status){case"fulfilled":return v.value;case"rejected":throw v.reason;default:switch(typeof v.status=="string"?v.then(fn,fn):(v.status="pending",v.then(function(H){v.status==="pending"&&(v.status="fulfilled",v.value=H)},function(H){v.status==="pending"&&(v.status="rejected",v.reason=H)})),v.status){case"fulfilled":return v.value;case"rejected":throw v.reason}}throw v}function Ue(v,H,Q,W,ce){var Ne=typeof v;(Ne==="undefined"||Ne==="boolean")&&(v=null);var me=!1;if(v===null)me=!0;else switch(Ne){case"bigint":case"string":case"number":me=!0;break;case"object":switch(v.$$typeof){case U:case F:me=!0;break;case V:return me=v._init,Ue(me(v._payload),H,Q,W,ce)}}if(me)return ce=ce(v),me=W===""?"."+Fe(v,0):W,x(ce)?(Q="",me!=null&&(Q=me.replace(h,"$&/")+"/"),Ue(ce,H,Q,"",function(ve){return ve})):ce!=null&&(Ze(ce)&&(ce=mt(ce,Q+(ce.key==null||v&&v.key===ce.key?"":(""+ce.key).replace(h,"$&/")+"/")+me)),H.push(ce)),1;me=0;var ne=W===""?".":W+":";if(x(v))for(var J=0;J<v.length;J++)W=v[J],Ne=ne+Fe(W,J),me+=Ue(W,H,Q,Ne,ce);else if(J=ae(v),typeof J=="function")for(v=J.call(v),J=0;!(W=v.next()).done;)W=W.value,Ne=ne+Fe(W,J++),me+=Ue(W,H,Q,Ne,ce);else if(Ne==="object"){if(typeof v.then=="function")return Ue(N(v),H,Q,W,ce);throw H=String(v),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(v).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.")}return me}function D(v,H,Q){if(v==null)return v;var W=[],ce=0;return Ue(v,W,"","",function(Ne){return H.call(Q,Ne,ce++)}),W}function j(v){if(v._status===-1){var H=v._result;H=H(),H.then(function(Q){(v._status===0||v._status===-1)&&(v._status=1,v._result=Q)},function(Q){(v._status===0||v._status===-1)&&(v._status=2,v._result=Q)}),v._status===-1&&(v._status=0,v._result=H)}if(v._status===1)return v._result.default;throw v._result}var le=typeof reportError=="function"?reportError:function(v){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var H=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof v=="object"&&v!==null&&typeof v.message=="string"?String(v.message):String(v),error:v});if(!window.dispatchEvent(H))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",v);return}console.error(v)};function Le(){}return Te.Children={map:D,forEach:function(v,H,Q){D(v,function(){H.apply(this,arguments)},Q)},count:function(v){var H=0;return D(v,function(){H++}),H},toArray:function(v){return D(v,function(H){return H})||[]},only:function(v){if(!Ze(v))throw Error("React.Children.only expected to receive a single React element child.");return v}},Te.Component=Ke,Te.Fragment=P,Te.Profiler=Z,Te.PureComponent=Ae,Te.StrictMode=S,Te.Suspense=K,Te.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Re,Te.__COMPILER_RUNTIME={__proto__:null,c:function(v){return Re.H.useMemoCache(v)}},Te.cache=function(v){return function(){return v.apply(null,arguments)}},Te.cloneElement=function(v,H,Q){if(v==null)throw Error("The argument must be a React element, but you passed "+v+".");var W=be({},v.props),ce=v.key,Ne=void 0;if(H!=null)for(me in H.ref!==void 0&&(Ne=void 0),H.key!==void 0&&(ce=""+H.key),H)!ht.call(H,me)||me==="key"||me==="__self"||me==="__source"||me==="ref"&&H.ref===void 0||(W[me]=H[me]);var me=arguments.length-2;if(me===1)W.children=Q;else if(1<me){for(var ne=Array(me),J=0;J<me;J++)ne[J]=arguments[J+2];W.children=ne}return Nt(v.type,ce,void 0,void 0,Ne,W)},Te.createContext=function(v){return v={$$typeof:re,_currentValue:v,_currentValue2:v,_threadCount:0,Provider:null,Consumer:null},v.Provider=v,v.Consumer={$$typeof:X,_context:v},v},Te.createElement=function(v,H,Q){var W,ce={},Ne=null;if(H!=null)for(W in H.key!==void 0&&(Ne=""+H.key),H)ht.call(H,W)&&W!=="key"&&W!=="__self"&&W!=="__source"&&(ce[W]=H[W]);var me=arguments.length-2;if(me===1)ce.children=Q;else if(1<me){for(var ne=Array(me),J=0;J<me;J++)ne[J]=arguments[J+2];ce.children=ne}if(v&&v.defaultProps)for(W in me=v.defaultProps,me)ce[W]===void 0&&(ce[W]=me[W]);return Nt(v,Ne,void 0,void 0,null,ce)},Te.createRef=function(){return{current:null}},Te.forwardRef=function(v){return{$$typeof:ue,render:v}},Te.isValidElement=Ze,Te.lazy=function(v){return{$$typeof:V,_payload:{_status:-1,_result:v},_init:j}},Te.memo=function(v,H){return{$$typeof:w,type:v,compare:H===void 0?null:H}},Te.startTransition=function(v){var H=Re.T,Q={};Re.T=Q;try{var W=v(),ce=Re.S;ce!==null&&ce(Q,W),typeof W=="object"&&W!==null&&typeof W.then=="function"&&W.then(Le,le)}catch(Ne){le(Ne)}finally{Re.T=H}},Te.unstable_useCacheRefresh=function(){return Re.H.useCacheRefresh()},Te.use=function(v){return Re.H.use(v)},Te.useActionState=function(v,H,Q){return Re.H.useActionState(v,H,Q)},Te.useCallback=function(v,H){return Re.H.useCallback(v,H)},Te.useContext=function(v){return Re.H.useContext(v)},Te.useDebugValue=function(){},Te.useDeferredValue=function(v,H){return Re.H.useDeferredValue(v,H)},Te.useEffect=function(v,H,Q){var W=Re.H;if(typeof Q=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return W.useEffect(v,H)},Te.useId=function(){return Re.H.useId()},Te.useImperativeHandle=function(v,H,Q){return Re.H.useImperativeHandle(v,H,Q)},Te.useInsertionEffect=function(v,H){return Re.H.useInsertionEffect(v,H)},Te.useLayoutEffect=function(v,H){return Re.H.useLayoutEffect(v,H)},Te.useMemo=function(v,H){return Re.H.useMemo(v,H)},Te.useOptimistic=function(v,H){return Re.H.useOptimistic(v,H)},Te.useReducer=function(v,H,Q){return Re.H.useReducer(v,H,Q)},Te.useRef=function(v){return Re.H.useRef(v)},Te.useState=function(v){return Re.H.useState(v)},Te.useSyncExternalStore=function(v,H,Q){return Re.H.useSyncExternalStore(v,H,Q)},Te.useTransition=function(){return Re.H.useTransition()},Te.version="19.1.0",Te}var kd;function df(){return kd||(kd=1,Wu.exports=lm()),Wu.exports}var an=df(),$u={exports:{}},vr={},Fu={exports:{}},ef={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ld;function rm(){return Ld||(Ld=1,function(U){function F(D,j){var le=D.length;D.push(j);e:for(;0<le;){var Le=le-1>>>1,v=D[Le];if(0<Z(v,j))D[Le]=j,D[le]=v,le=Le;else break e}}function P(D){return D.length===0?null:D[0]}function S(D){if(D.length===0)return null;var j=D[0],le=D.pop();if(le!==j){D[0]=le;e:for(var Le=0,v=D.length,H=v>>>1;Le<H;){var Q=2*(Le+1)-1,W=D[Q],ce=Q+1,Ne=D[ce];if(0>Z(W,le))ce<v&&0>Z(Ne,W)?(D[Le]=Ne,D[ce]=le,Le=ce):(D[Le]=W,D[Q]=le,Le=Q);else if(ce<v&&0>Z(Ne,le))D[Le]=Ne,D[ce]=le,Le=ce;else break e}}return j}function Z(D,j){var le=D.sortIndex-j.sortIndex;return le!==0?le:D.id-j.id}if(U.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var X=performance;U.unstable_now=function(){return X.now()}}else{var re=Date,ue=re.now();U.unstable_now=function(){return re.now()-ue}}var K=[],w=[],V=1,I=null,ae=3,$=!1,be=!1,rt=!1,Ke=!1,De=typeof setTimeout=="function"?setTimeout:null,Ae=typeof clearTimeout=="function"?clearTimeout:null,$e=typeof setImmediate<"u"?setImmediate:null;function x(D){for(var j=P(w);j!==null;){if(j.callback===null)S(w);else if(j.startTime<=D)S(w),j.sortIndex=j.expirationTime,F(K,j);else break;j=P(w)}}function Re(D){if(rt=!1,x(D),!be)if(P(K)!==null)be=!0,ht||(ht=!0,Fe());else{var j=P(w);j!==null&&Ue(Re,j.startTime-D)}}var ht=!1,Nt=-1,mt=5,Ze=-1;function jn(){return Ke?!0:!(U.unstable_now()-Ze<mt)}function h(){if(Ke=!1,ht){var D=U.unstable_now();Ze=D;var j=!0;try{e:{be=!1,rt&&(rt=!1,Ae(Nt),Nt=-1),$=!0;var le=ae;try{t:{for(x(D),I=P(K);I!==null&&!(I.expirationTime>D&&jn());){var Le=I.callback;if(typeof Le=="function"){I.callback=null,ae=I.priorityLevel;var v=Le(I.expirationTime<=D);if(D=U.unstable_now(),typeof v=="function"){I.callback=v,x(D),j=!0;break t}I===P(K)&&S(K),x(D)}else S(K);I=P(K)}if(I!==null)j=!0;else{var H=P(w);H!==null&&Ue(Re,H.startTime-D),j=!1}}break e}finally{I=null,ae=le,$=!1}j=void 0}}finally{j?Fe():ht=!1}}}var Fe;if(typeof $e=="function")Fe=function(){$e(h)};else if(typeof MessageChannel<"u"){var fn=new MessageChannel,N=fn.port2;fn.port1.onmessage=h,Fe=function(){N.postMessage(null)}}else Fe=function(){De(h,0)};function Ue(D,j){Nt=De(function(){D(U.unstable_now())},j)}U.unstable_IdlePriority=5,U.unstable_ImmediatePriority=1,U.unstable_LowPriority=4,U.unstable_NormalPriority=3,U.unstable_Profiling=null,U.unstable_UserBlockingPriority=2,U.unstable_cancelCallback=function(D){D.callback=null},U.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):mt=0<D?Math.floor(1e3/D):5},U.unstable_getCurrentPriorityLevel=function(){return ae},U.unstable_next=function(D){switch(ae){case 1:case 2:case 3:var j=3;break;default:j=ae}var le=ae;ae=j;try{return D()}finally{ae=le}},U.unstable_requestPaint=function(){Ke=!0},U.unstable_runWithPriority=function(D,j){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var le=ae;ae=D;try{return j()}finally{ae=le}},U.unstable_scheduleCallback=function(D,j,le){var Le=U.unstable_now();switch(typeof le=="object"&&le!==null?(le=le.delay,le=typeof le=="number"&&0<le?Le+le:Le):le=Le,D){case 1:var v=-1;break;case 2:v=250;break;case 5:v=1073741823;break;case 4:v=1e4;break;default:v=5e3}return v=le+v,D={id:V++,callback:j,priorityLevel:D,startTime:le,expirationTime:v,sortIndex:-1},le>Le?(D.sortIndex=le,F(w,D),P(K)===null&&D===P(w)&&(rt?(Ae(Nt),Nt=-1):rt=!0,Ue(Re,le-Le))):(D.sortIndex=v,F(K,D),be||$||(be=!0,ht||(ht=!0,Fe()))),D},U.unstable_shouldYield=jn,U.unstable_wrapCallback=function(D){var j=ae;return function(){var le=ae;ae=j;try{return D.apply(this,arguments)}finally{ae=le}}}}(ef)),ef}var Bd;function om(){return Bd||(Bd=1,Fu.exports=rm()),Fu.exports}var tf={exports:{}},Gt={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qd;function cm(){if(qd)return Gt;qd=1;var U=df();function F(K){var w="https://react.dev/errors/"+K;if(1<arguments.length){w+="?args[]="+encodeURIComponent(arguments[1]);for(var V=2;V<arguments.length;V++)w+="&args[]="+encodeURIComponent(arguments[V])}return"Minified React error #"+K+"; visit "+w+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function P(){}var S={d:{f:P,r:function(){throw Error(F(522))},D:P,C:P,L:P,m:P,X:P,S:P,M:P},p:0,findDOMNode:null},Z=Symbol.for("react.portal");function X(K,w,V){var I=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Z,key:I==null?null:""+I,children:K,containerInfo:w,implementation:V}}var re=U.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function ue(K,w){if(K==="font")return"";if(typeof w=="string")return w==="use-credentials"?w:""}return Gt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=S,Gt.createPortal=function(K,w){var V=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!w||w.nodeType!==1&&w.nodeType!==9&&w.nodeType!==11)throw Error(F(299));return X(K,w,null,V)},Gt.flushSync=function(K){var w=re.T,V=S.p;try{if(re.T=null,S.p=2,K)return K()}finally{re.T=w,S.p=V,S.d.f()}},Gt.preconnect=function(K,w){typeof K=="string"&&(w?(w=w.crossOrigin,w=typeof w=="string"?w==="use-credentials"?w:"":void 0):w=null,S.d.C(K,w))},Gt.prefetchDNS=function(K){typeof K=="string"&&S.d.D(K)},Gt.preinit=function(K,w){if(typeof K=="string"&&w&&typeof w.as=="string"){var V=w.as,I=ue(V,w.crossOrigin),ae=typeof w.integrity=="string"?w.integrity:void 0,$=typeof w.fetchPriority=="string"?w.fetchPriority:void 0;V==="style"?S.d.S(K,typeof w.precedence=="string"?w.precedence:void 0,{crossOrigin:I,integrity:ae,fetchPriority:$}):V==="script"&&S.d.X(K,{crossOrigin:I,integrity:ae,fetchPriority:$,nonce:typeof w.nonce=="string"?w.nonce:void 0})}},Gt.preinitModule=function(K,w){if(typeof K=="string")if(typeof w=="object"&&w!==null){if(w.as==null||w.as==="script"){var V=ue(w.as,w.crossOrigin);S.d.M(K,{crossOrigin:V,integrity:typeof w.integrity=="string"?w.integrity:void 0,nonce:typeof w.nonce=="string"?w.nonce:void 0})}}else w==null&&S.d.M(K)},Gt.preload=function(K,w){if(typeof K=="string"&&typeof w=="object"&&w!==null&&typeof w.as=="string"){var V=w.as,I=ue(V,w.crossOrigin);S.d.L(K,V,{crossOrigin:I,integrity:typeof w.integrity=="string"?w.integrity:void 0,nonce:typeof w.nonce=="string"?w.nonce:void 0,type:typeof w.type=="string"?w.type:void 0,fetchPriority:typeof w.fetchPriority=="string"?w.fetchPriority:void 0,referrerPolicy:typeof w.referrerPolicy=="string"?w.referrerPolicy:void 0,imageSrcSet:typeof w.imageSrcSet=="string"?w.imageSrcSet:void 0,imageSizes:typeof w.imageSizes=="string"?w.imageSizes:void 0,media:typeof w.media=="string"?w.media:void 0})}},Gt.preloadModule=function(K,w){if(typeof K=="string")if(w){var V=ue(w.as,w.crossOrigin);S.d.m(K,{as:typeof w.as=="string"&&w.as!=="script"?w.as:void 0,crossOrigin:V,integrity:typeof w.integrity=="string"?w.integrity:void 0})}else S.d.m(K)},Gt.requestFormReset=function(K){S.d.r(K)},Gt.unstable_batchedUpdates=function(K,w){return K(w)},Gt.useFormState=function(K,w,V){return re.H.useFormState(K,w,V)},Gt.useFormStatus=function(){return re.H.useHostTransitionStatus()},Gt.version="19.1.0",Gt}var jd;function um(){if(jd)return tf.exports;jd=1;function U(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(U)}catch(F){console.error(F)}}return U(),tf.exports=cm(),tf.exports}var Gd;function fm(){if(Gd)return vr;Gd=1;/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U=om(),F=df(),P=um();function S(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Z(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function X(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function re(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ue(e){if(X(e)!==e)throw Error(S(188))}function K(e){var t=e.alternate;if(!t){if(t=X(e),t===null)throw Error(S(188));return t!==e?null:e}for(var n=e,s=t;;){var r=n.return;if(r===null)break;var c=r.alternate;if(c===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===c.child){for(c=r.child;c;){if(c===n)return ue(r),e;if(c===s)return ue(r),t;c=c.sibling}throw Error(S(188))}if(n.return!==s.return)n=r,s=c;else{for(var d=!1,g=r.child;g;){if(g===n){d=!0,n=r,s=c;break}if(g===s){d=!0,s=r,n=c;break}g=g.sibling}if(!d){for(g=c.child;g;){if(g===n){d=!0,n=c,s=r;break}if(g===s){d=!0,s=c,n=r;break}g=g.sibling}if(!d)throw Error(S(189))}}if(n.alternate!==s)throw Error(S(190))}if(n.tag!==3)throw Error(S(188));return n.stateNode.current===n?e:t}function w(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=w(e),t!==null)return t;e=e.sibling}return null}var V=Object.assign,I=Symbol.for("react.element"),ae=Symbol.for("react.transitional.element"),$=Symbol.for("react.portal"),be=Symbol.for("react.fragment"),rt=Symbol.for("react.strict_mode"),Ke=Symbol.for("react.profiler"),De=Symbol.for("react.provider"),Ae=Symbol.for("react.consumer"),$e=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),Re=Symbol.for("react.suspense"),ht=Symbol.for("react.suspense_list"),Nt=Symbol.for("react.memo"),mt=Symbol.for("react.lazy"),Ze=Symbol.for("react.activity"),jn=Symbol.for("react.memo_cache_sentinel"),h=Symbol.iterator;function Fe(e){return e===null||typeof e!="object"?null:(e=h&&e[h]||e["@@iterator"],typeof e=="function"?e:null)}var fn=Symbol.for("react.client.reference");function N(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===fn?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case be:return"Fragment";case Ke:return"Profiler";case rt:return"StrictMode";case Re:return"Suspense";case ht:return"SuspenseList";case Ze:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case $:return"Portal";case $e:return(e.displayName||"Context")+".Provider";case Ae:return(e._context.displayName||"Context")+".Consumer";case x:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Nt:return t=e.displayName||null,t!==null?t:N(e.type)||"Memo";case mt:t=e._payload,e=e._init;try{return N(e(t))}catch{}}return null}var Ue=Array.isArray,D=F.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,j=P.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,le={pending:!1,data:null,method:null,action:null},Le=[],v=-1;function H(e){return{current:e}}function Q(e){0>v||(e.current=Le[v],Le[v]=null,v--)}function W(e,t){v++,Le[v]=e.current,e.current=t}var ce=H(null),Ne=H(null),me=H(null),ne=H(null);function J(e,t){switch(W(me,t),W(Ne,e),W(ce,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?sd(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=sd(t),e=ld(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}Q(ce),W(ce,e)}function ve(){Q(ce),Q(Ne),Q(me)}function Ce(e){e.memoizedState!==null&&W(ne,e);var t=ce.current,n=ld(t,e.type);t!==n&&(W(Ne,e),W(ce,n))}function _e(e){Ne.current===e&&(Q(ce),Q(Ne)),ne.current===e&&(Q(ne),hr._currentValue=le)}var ot=Object.prototype.hasOwnProperty,Yt=U.unstable_scheduleCallback,Di=U.unstable_cancelCallback,is=U.unstable_shouldYield,as=U.unstable_requestPaint,Qt=U.unstable_now,_a=U.unstable_getCurrentPriorityLevel,Ca=U.unstable_ImmediatePriority,ss=U.unstable_UserBlockingPriority,Be=U.unstable_NormalPriority,Rr=U.unstable_LowPriority,tl=U.unstable_IdlePriority,ls=U.log,_r=U.unstable_setDisableYieldValue,ki=null,Ie=null;function ct(e){if(typeof ls=="function"&&_r(e),Ie&&typeof Ie.setStrictMode=="function")try{Ie.setStrictMode(ki,e)}catch{}}var et=Math.clz32?Math.clz32:Er,nl=Math.log,Cr=Math.LN2;function Er(e){return e>>>=0,e===0?32:31-(nl(e)/Cr|0)|0}var Ea=256,Li=4194304;function Sn(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ma(e,t,n){var s=e.pendingLanes;if(s===0)return 0;var r=0,c=e.suspendedLanes,d=e.pingedLanes;e=e.warmLanes;var g=s&134217727;return g!==0?(s=g&~c,s!==0?r=Sn(s):(d&=g,d!==0?r=Sn(d):n||(n=g&~e,n!==0&&(r=Sn(n))))):(g=s&~c,g!==0?r=Sn(g):d!==0?r=Sn(d):n||(n=s&~e,n!==0&&(r=Sn(n)))),r===0?0:t!==0&&t!==r&&(t&c)===0&&(c=r&-r,n=t&-t,c>=n||c===32&&(n&4194048)!==0)?t:r}function Bi(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function rs(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function il(){var e=Ea;return Ea<<=1,(Ea&4194048)===0&&(Ea=256),e}function wa(){var e=Li;return Li<<=1,(Li&62914560)===0&&(Li=4194304),e}function pt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function qi(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Mr(e,t,n,s,r,c){var d=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var g=e.entanglements,y=e.expirationTimes,_=e.hiddenUpdates;for(n=d&~n;0<n;){var k=31-et(n),z=1<<k;g[k]=0,y[k]=-1;var C=_[k];if(C!==null)for(_[k]=null,k=0;k<C.length;k++){var M=C[k];M!==null&&(M.lane&=-536870913)}n&=~z}s!==0&&wr(e,s,0),c!==0&&r===0&&e.tag!==0&&(e.suspendedLanes|=c&~(d&~t))}function wr(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var s=31-et(t);e.entangledLanes|=t,e.entanglements[s]=e.entanglements[s]|1073741824|n&4194090}function Pt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-et(n),r=1<<s;r&t|e[s]&t&&(e[s]|=t),n&=~r}}function al(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function sl(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function ll(){var e=j.p;return e!==0?e:(e=window.event,e===void 0?32:_d(e.type))}function Nr(e,t){var n=j.p;try{return j.p=e,t()}finally{j.p=n}}var An=Math.random().toString(36).slice(2),At="__reactFiber$"+An,Ut="__reactProps$"+An,ji="__reactContainer$"+An,os="__reactEvents$"+An,yc="__reactListeners$"+An,rl="__reactHandles$"+An,Ur="__reactResources$"+An,Na="__reactMarker$"+An;function ol(e){delete e[At],delete e[Ut],delete e[os],delete e[yc],delete e[rl]}function On(e){var t=e[At];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ji]||n[At]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=ud(e);e!==null;){if(n=e[At])return n;e=ud(e)}return t}e=n,n=e.parentNode}return null}function li(e){if(e=e[At]||e[ji]){var t=e.tag;if(t===5||t===6||t===13||t===26||t===27||t===3)return e}return null}function Gn(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(S(33))}function Gi(e){var t=e[Ur];return t||(t=e[Ur]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function yt(e){e[Na]=!0}var ge=new Set,xr={};function ri(e,t){zn(e,t),zn(e+"Capture",t)}function zn(e,t){for(xr[e]=t,e=0;e<t.length;e++)ge.add(t[e])}var Dr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),nt={},cl={};function vc(e){return ot.call(cl,e)?!0:ot.call(nt,e)?!1:Dr.test(e)?cl[e]=!0:(nt[e]=!0,!1)}function oi(e,t,n){if(vc(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var s=t.toLowerCase().slice(0,5);if(s!=="data-"&&s!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function zi(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function Tn(e,t,n,s){if(s===null)e.removeAttribute(n);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+s)}}var ul,fl;function Hi(e){if(ul===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);ul=t&&t[1]||"",fl=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ul+e+fl}var cs=!1;function us(e,t){if(!e||cs)return"";cs=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var s={DetermineComponentFrameRoot:function(){try{if(t){var z=function(){throw Error()};if(Object.defineProperty(z.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(z,[])}catch(M){var C=M}Reflect.construct(e,[],z)}else{try{z.call()}catch(M){C=M}e.call(z.prototype)}}else{try{throw Error()}catch(M){C=M}(z=e())&&typeof z.catch=="function"&&z.catch(function(){})}}catch(M){if(M&&C&&typeof M.stack=="string")return[M.stack,C.stack]}return[null,null]}};s.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var r=Object.getOwnPropertyDescriptor(s.DetermineComponentFrameRoot,"name");r&&r.configurable&&Object.defineProperty(s.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var c=s.DetermineComponentFrameRoot(),d=c[0],g=c[1];if(d&&g){var y=d.split(`
`),_=g.split(`
`);for(r=s=0;s<y.length&&!y[s].includes("DetermineComponentFrameRoot");)s++;for(;r<_.length&&!_[r].includes("DetermineComponentFrameRoot");)r++;if(s===y.length||r===_.length)for(s=y.length-1,r=_.length-1;1<=s&&0<=r&&y[s]!==_[r];)r--;for(;1<=s&&0<=r;s--,r--)if(y[s]!==_[r]){if(s!==1||r!==1)do if(s--,r--,0>r||y[s]!==_[r]){var k=`
`+y[s].replace(" at new "," at ");return e.displayName&&k.includes("<anonymous>")&&(k=k.replace("<anonymous>",e.displayName)),k}while(1<=s&&0<=r);break}}}finally{cs=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?Hi(n):""}function bc(e){switch(e.tag){case 26:case 27:case 5:return Hi(e.type);case 16:return Hi("Lazy");case 13:return Hi("Suspense");case 19:return Hi("SuspenseList");case 0:case 15:return us(e.type,!1);case 11:return us(e.type.render,!1);case 1:return us(e.type,!0);case 31:return Hi("Activity");default:return""}}function hl(e){try{var t="";do t+=bc(e),e=e.return;while(e);return t}catch(n){return`
Error generating stack: `+n.message+`
`+n.stack}}function Xt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function kr(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Sc(e){var t=kr(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,c=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(d){s=""+d,c.call(this,d)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(d){s=""+d},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function fs(e){e._valueTracker||(e._valueTracker=Sc(e))}function hn(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=kr(e)?e.checked?"true":"false":e.value),e=s,e!==n?(t.setValue(e),!0):!1}function Vi(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Ii=/[\n"\\]/g;function Kt(e){return e.replace(Ii,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function dl(e,t,n,s,r,c,d,g){e.name="",d!=null&&typeof d!="function"&&typeof d!="symbol"&&typeof d!="boolean"?e.type=d:e.removeAttribute("type"),t!=null?d==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Xt(t)):e.value!==""+Xt(t)&&(e.value=""+Xt(t)):d!=="submit"&&d!=="reset"||e.removeAttribute("value"),t!=null?gl(e,d,Xt(t)):n!=null?gl(e,d,Xt(n)):s!=null&&e.removeAttribute("value"),r==null&&c!=null&&(e.defaultChecked=!!c),r!=null&&(e.checked=r&&typeof r!="function"&&typeof r!="symbol"),g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"?e.name=""+Xt(g):e.removeAttribute("name")}function hs(e,t,n,s,r,c,d,g){if(c!=null&&typeof c!="function"&&typeof c!="symbol"&&typeof c!="boolean"&&(e.type=c),t!=null||n!=null){if(!(c!=="submit"&&c!=="reset"||t!=null))return;n=n!=null?""+Xt(n):"",t=t!=null?""+Xt(t):n,g||t===e.value||(e.value=t),e.defaultValue=t}s=s??r,s=typeof s!="function"&&typeof s!="symbol"&&!!s,e.checked=g?e.checked:!!s,e.defaultChecked=!!s,d!=null&&typeof d!="function"&&typeof d!="symbol"&&typeof d!="boolean"&&(e.name=d)}function gl(e,t,n){t==="number"&&Vi(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function Hn(e,t,n,s){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&s&&(e[n].defaultSelected=!0)}else{for(n=""+Xt(n),t=null,r=0;r<e.length;r++){if(e[r].value===n){e[r].selected=!0,s&&(e[r].defaultSelected=!0);return}t!==null||e[r].disabled||(t=e[r])}t!==null&&(t.selected=!0)}}function Lr(e,t,n){if(t!=null&&(t=""+Xt(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+Xt(n):""}function dt(e,t,n,s){if(t==null){if(s!=null){if(n!=null)throw Error(S(92));if(Ue(s)){if(1<s.length)throw Error(S(93));s=s[0]}n=s}n==null&&(n=""),t=n}n=Xt(t),e.defaultValue=n,s=e.textContent,s===n&&s!==""&&s!==null&&(e.value=s)}function se(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Br=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function xt(e,t,n){var s=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?s?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":s?e.setProperty(t,n):typeof n!="number"||n===0||Br.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function qr(e,t,n){if(t!=null&&typeof t!="object")throw Error(S(62));if(e=e.style,n!=null){for(var s in n)!n.hasOwnProperty(s)||t!=null&&t.hasOwnProperty(s)||(s.indexOf("--")===0?e.setProperty(s,""):s==="float"?e.cssFloat="":e[s]="");for(var r in t)s=t[r],t.hasOwnProperty(r)&&n[r]!==s&&xt(e,r,s)}else for(var c in t)t.hasOwnProperty(c)&&xt(e,c,t[c])}function ds(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ac=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),jr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function gs(e){return jr.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var ms=null;function Ua(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ci=null,Vn=null;function ml(e){var t=li(e);if(t&&(e=t.stateNode)){var n=e[Ut]||null;e:switch(e=t.stateNode,t.type){case"input":if(dl(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+Kt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var r=s[Ut]||null;if(!r)throw Error(S(90));dl(s,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name)}}for(t=0;t<n.length;t++)s=n[t],s.form===e.form&&hn(s)}break e;case"textarea":Lr(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&Hn(e,!!n.multiple,t,!1)}}}var xa=!1;function pl(e,t,n){if(xa)return e(t,n);xa=!0;try{var s=e(t);return s}finally{if(xa=!1,(ci!==null||Vn!==null)&&(Ko(),ci&&(t=ci,e=Vn,Vn=ci=null,ml(t),e)))for(t=0;t<e.length;t++)ml(e[t])}}function In(e,t){var n=e.stateNode;if(n===null)return null;var s=n[Ut]||null;if(s===null)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(S(231,t,typeof n));return n}var Zt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Yn=!1;if(Zt)try{var dn={};Object.defineProperty(dn,"passive",{get:function(){Yn=!0}}),window.addEventListener("test",dn,dn),window.removeEventListener("test",dn,dn)}catch{Yn=!1}var Rn=null,ps=null,ys=null;function ui(){if(ys)return ys;var e,t=ps,n=t.length,s,r="value"in Rn?Rn.value:Rn.textContent,c=r.length;for(e=0;e<n&&t[e]===r[e];e++);var d=n-e;for(s=1;s<=d&&t[n-s]===r[c-s];s++);return ys=r.slice(e,1<s?1-s:void 0)}function Da(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function vs(){return!0}function Gr(){return!1}function Bt(e){function t(n,s,r,c,d){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=c,this.target=d,this.currentTarget=null;for(var g in e)e.hasOwnProperty(g)&&(n=e[g],this[g]=n?n(c):c[g]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?vs:Gr,this.isPropagationStopped=Gr,this}return V(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=vs)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=vs)},persist:function(){},isPersistent:vs}),t}var Ye={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bs=Bt(Ye),ka=V({},Ye,{view:0,detail:0}),Oc=Bt(ka),yl,Ss,La,zt=V({},ka,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gn,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==La&&(La&&e.type==="mousemove"?(yl=e.screenX-La.screenX,Ss=e.screenY-La.screenY):Ss=yl=0,La=e),yl)},movementY:function(e){return"movementY"in e?e.movementY:Ss}}),vl=Bt(zt),Tc=V({},zt,{dataTransfer:0}),As=Bt(Tc),Rc=V({},ka,{relatedTarget:0}),bl=Bt(Rc),_c=V({},Ye,{animationName:0,elapsedTime:0,pseudoElement:0}),Cc=Bt(_c),Ec=V({},Ye,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),zr=Bt(Ec),Hr=V({},Ye,{data:0}),Vr=Bt(Hr),Mc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ir={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Yr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ba(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Yr[e])?!!t[e]:!1}function gn(){return Ba}var wc=V({},ka,{key:function(e){if(e.key){var t=Mc[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Da(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Ir[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gn,charCode:function(e){return e.type==="keypress"?Da(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Da(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Nc=Bt(wc),Qr=V({},zt,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Pr=Bt(Qr),Uc=V({},ka,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gn}),Xr=Bt(Uc),xc=V({},Ye,{propertyName:0,elapsedTime:0,pseudoElement:0}),Dc=Bt(xc),kc=V({},zt,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Kr=Bt(kc),Lc=V({},Ye,{newState:0,oldState:0}),Sl=Bt(Lc),Zr=[9,13,27,32],fi=Zt&&"CompositionEvent"in window,Jt=null;Zt&&"documentMode"in document&&(Jt=document.documentMode);var Bc=Zt&&"TextEvent"in window&&!Jt,Jr=Zt&&(!fi||Jt&&8<Jt&&11>=Jt),Wr=" ",$r=!1;function Fr(e,t){switch(e){case"keyup":return Zr.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function eo(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var hi=!1;function qc(e,t){switch(e){case"compositionend":return eo(t);case"keypress":return t.which!==32?null:($r=!0,Wr);case"textInput":return e=t.data,e===Wr&&$r?null:e;default:return null}}function to(e,t){if(hi)return e==="compositionend"||!fi&&Fr(e,t)?(e=ui(),ys=ps=Rn=null,hi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Jr&&t.locale!=="ko"?null:t.data;default:return null}}var jc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function no(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!jc[e.type]:t==="textarea"}function Al(e,t,n,s){ci?Vn?Vn.push(s):Vn=[s]:ci=s,t=ec(t,"onChange"),0<t.length&&(n=new bs("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var Yi=null,Qi=null;function io(e){ed(e,0)}function qa(e){var t=Gn(e);if(hn(t))return e}function ao(e,t){if(e==="change")return t}var so=!1;if(Zt){var Ol;if(Zt){var Os="oninput"in document;if(!Os){var di=document.createElement("div");di.setAttribute("oninput","return;"),Os=typeof di.oninput=="function"}Ol=Os}else Ol=!1;so=Ol&&(!document.documentMode||9<document.documentMode)}function Pi(){Yi&&(Yi.detachEvent("onpropertychange",Tl),Qi=Yi=null)}function Tl(e){if(e.propertyName==="value"&&qa(Qi)){var t=[];Al(t,Qi,e,Ua(e)),pl(io,t)}}function lo(e,t,n){e==="focusin"?(Pi(),Yi=t,Qi=n,Yi.attachEvent("onpropertychange",Tl)):e==="focusout"&&Pi()}function ro(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return qa(Qi)}function oo(e,t){if(e==="click")return qa(t)}function Gc(e,t){if(e==="input"||e==="change")return qa(t)}function Rl(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ht=typeof Object.is=="function"?Object.is:Rl;function Qn(e,t){if(Ht(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!ot.call(t,r)||!Ht(e[r],t[r]))return!1}return!0}function co(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ts(e,t){var n=co(e);e=0;for(var s;n;){if(n.nodeType===3){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=co(n)}}function _l(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?_l(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function qt(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Vi(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Vi(e.document)}return t}function ja(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var Cl=Zt&&"documentMode"in document&&11>=document.documentMode,Xi=null,El=null,gi=null,Rs=!1;function uo(e,t,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Rs||Xi==null||Xi!==Vi(s)||(s=Xi,"selectionStart"in s&&ja(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),gi&&Qn(gi,s)||(gi=s,s=ec(El,"onSelect"),0<s.length&&(t=new bs("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=Xi)))}function mi(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var pi={animationend:mi("Animation","AnimationEnd"),animationiteration:mi("Animation","AnimationIteration"),animationstart:mi("Animation","AnimationStart"),transitionrun:mi("Transition","TransitionRun"),transitionstart:mi("Transition","TransitionStart"),transitioncancel:mi("Transition","TransitionCancel"),transitionend:mi("Transition","TransitionEnd")},yi={},fo={};Zt&&(fo=document.createElement("div").style,"AnimationEvent"in window||(delete pi.animationend.animation,delete pi.animationiteration.animation,delete pi.animationstart.animation),"TransitionEvent"in window||delete pi.transitionend.transition);function Pn(e){if(yi[e])return yi[e];if(!pi[e])return e;var t=pi[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in fo)return yi[e]=t[n];return e}var Xn=Pn("animationend"),_s=Pn("animationiteration"),ho=Pn("animationstart"),go=Pn("transitionrun"),mo=Pn("transitionstart"),zc=Pn("transitioncancel"),po=Pn("transitionend"),yo=new Map,Ki="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ki.push("scrollEnd");function vt(e,t){yo.set(e,t),ri(t,[e])}var vo=new WeakMap;function Wt(e,t){if(typeof e=="object"&&e!==null){var n=vo.get(e);return n!==void 0?n:(t={value:e,source:t,stack:hl(t)},vo.set(e,t),t)}return{value:e,source:t,stack:hl(t)}}var bt=[],Zi=0,Ml=0;function Cs(){for(var e=Zi,t=Ml=Zi=0;t<e;){var n=bt[t];bt[t++]=null;var s=bt[t];bt[t++]=null;var r=bt[t];bt[t++]=null;var c=bt[t];if(bt[t++]=null,s!==null&&r!==null){var d=s.pending;d===null?r.next=r:(r.next=d.next,d.next=r),s.pending=r}c!==0&&Es(n,r,c)}}function _n(e,t,n,s){bt[Zi++]=e,bt[Zi++]=t,bt[Zi++]=n,bt[Zi++]=s,Ml|=s,e.lanes|=s,e=e.alternate,e!==null&&(e.lanes|=s)}function _t(e,t,n,s){return _n(e,t,n,s),Kn(e)}function Ji(e,t){return _n(e,null,null,t),Kn(e)}function Es(e,t,n){e.lanes|=n;var s=e.alternate;s!==null&&(s.lanes|=n);for(var r=!1,c=e.return;c!==null;)c.childLanes|=n,s=c.alternate,s!==null&&(s.childLanes|=n),c.tag===22&&(e=c.stateNode,e===null||e._visibility&1||(r=!0)),e=c,c=c.return;return e.tag===3?(c=e.stateNode,r&&t!==null&&(r=31-et(n),e=c.hiddenUpdates,s=e[r],s===null?e[r]=[t]:s.push(t),t.lane=n|536870912),c):null}function Kn(e){if(50<ar)throw ar=0,Su=null,Error(S(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var vi={};function wl(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vt(e,t,n,s){return new wl(e,t,n,s)}function Ga(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Cn(e,t){var n=e.alternate;return n===null?(n=Vt(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function bo(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function za(e,t,n,s,r,c){var d=0;if(s=e,typeof e=="function")Ga(e)&&(d=1);else if(typeof e=="string")d=Qg(e,n,ce.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case Ze:return e=Vt(31,n,t,r),e.elementType=Ze,e.lanes=c,e;case be:return bi(n.children,r,c,t);case rt:d=8,r|=24;break;case Ke:return e=Vt(12,n,t,r|2),e.elementType=Ke,e.lanes=c,e;case Re:return e=Vt(13,n,t,r),e.elementType=Re,e.lanes=c,e;case ht:return e=Vt(19,n,t,r),e.elementType=ht,e.lanes=c,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case De:case $e:d=10;break e;case Ae:d=9;break e;case x:d=11;break e;case Nt:d=14;break e;case mt:d=16,s=null;break e}d=29,n=Error(S(130,e===null?"null":typeof e,"")),s=null}return t=Vt(d,n,t,r),t.elementType=e,t.type=s,t.lanes=c,t}function bi(e,t,n,s){return e=Vt(7,e,s,t),e.lanes=n,e}function Nl(e,t,n){return e=Vt(6,e,null,t),e.lanes=n,e}function Ms(e,t,n){return t=Vt(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Wi=[],$i=0,ws=null,Ns=0,jt=[],$t=0,En=null,Mn=1,wn="";function Si(e,t){Wi[$i++]=Ns,Wi[$i++]=ws,ws=e,Ns=t}function So(e,t,n){jt[$t++]=Mn,jt[$t++]=wn,jt[$t++]=En,En=e;var s=Mn;e=wn;var r=32-et(s)-1;s&=~(1<<r),n+=1;var c=32-et(t)+r;if(30<c){var d=r-r%5;c=(s&(1<<d)-1).toString(32),s>>=d,r-=d,Mn=1<<32-et(t)+r|n<<r|s,wn=c+e}else Mn=1<<c|n<<r|s,wn=e}function Ul(e){e.return!==null&&(Si(e,1),So(e,1,0))}function xl(e){for(;e===ws;)ws=Wi[--$i],Wi[$i]=null,Ns=Wi[--$i],Wi[$i]=null;for(;e===En;)En=jt[--$t],jt[$t]=null,wn=jt[--$t],jt[$t]=null,Mn=jt[--$t],jt[$t]=null}var Ct=null,it=null,Se=!1,Nn=null,Ft=!1,Ai=Error(S(519));function Un(e){var t=Error(S(418,""));throw Dn(Wt(t,e)),Ai}function Dl(e){var t=e.stateNode,n=e.type,s=e.memoizedProps;switch(t[At]=e,t[Ut]=s,n){case"dialog":we("cancel",t),we("close",t);break;case"iframe":case"object":case"embed":we("load",t);break;case"video":case"audio":for(n=0;n<lr.length;n++)we(lr[n],t);break;case"source":we("error",t);break;case"img":case"image":case"link":we("error",t),we("load",t);break;case"details":we("toggle",t);break;case"input":we("invalid",t),hs(t,s.value,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name,!0),fs(t);break;case"select":we("invalid",t);break;case"textarea":we("invalid",t),dt(t,s.value,s.defaultValue,s.children),fs(t)}n=s.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||s.suppressHydrationWarning===!0||ad(t.textContent,n)?(s.popover!=null&&(we("beforetoggle",t),we("toggle",t)),s.onScroll!=null&&we("scroll",t),s.onScrollEnd!=null&&we("scrollend",t),s.onClick!=null&&(t.onclick=tc),t=!0):t=!1,t||Un(e)}function kl(e){for(Ct=e.return;Ct;)switch(Ct.tag){case 5:case 13:Ft=!1;return;case 27:case 3:Ft=!0;return;default:Ct=Ct.return}}function xn(e){if(e!==Ct)return!1;if(!Se)return kl(e),Se=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||Bu(e.type,e.memoizedProps)),n=!n),n&&it&&Un(e),kl(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(S(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8)if(n=e.data,n==="/$"){if(t===0){it=qn(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++;e=e.nextSibling}it=null}}else t===27?(t=it,ba(e.type)?(e=zu,zu=null,it=e):it=t):it=Ct?qn(e.stateNode.nextSibling):null;return!0}function Fi(){it=Ct=null,Se=!1}function ea(){var e=Nn;return e!==null&&(nn===null?nn=e:nn.push.apply(nn,e),Nn=null),e}function Dn(e){Nn===null?Nn=[e]:Nn.push(e)}var Ha=H(null),mn=null,kn=null;function pn(e,t,n){W(Ha,t._currentValue),t._currentValue=n}function St(e){e._currentValue=Ha.current,Q(Ha)}function ta(e,t,n){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function Ll(e,t,n,s){var r=e.child;for(r!==null&&(r.return=e);r!==null;){var c=r.dependencies;if(c!==null){var d=r.child;c=c.firstContext;e:for(;c!==null;){var g=c;c=r;for(var y=0;y<t.length;y++)if(g.context===t[y]){c.lanes|=n,g=c.alternate,g!==null&&(g.lanes|=n),ta(c.return,n,e),s||(d=null);break e}c=g.next}}else if(r.tag===18){if(d=r.return,d===null)throw Error(S(341));d.lanes|=n,c=d.alternate,c!==null&&(c.lanes|=n),ta(d,n,e),d=null}else d=r.child;if(d!==null)d.return=r;else for(d=r;d!==null;){if(d===e){d=null;break}if(r=d.sibling,r!==null){r.return=d.return,d=r;break}d=d.return}r=d}}function Va(e,t,n,s){e=null;for(var r=t,c=!1;r!==null;){if(!c){if((r.flags&524288)!==0)c=!0;else if((r.flags&262144)!==0)break}if(r.tag===10){var d=r.alternate;if(d===null)throw Error(S(387));if(d=d.memoizedProps,d!==null){var g=r.type;Ht(r.pendingProps.value,d.value)||(e!==null?e.push(g):e=[g])}}else if(r===ne.current){if(d=r.alternate,d===null)throw Error(S(387));d.memoizedState.memoizedState!==r.memoizedState.memoizedState&&(e!==null?e.push(hr):e=[hr])}r=r.return}e!==null&&Ll(t,e,n,s),t.flags|=262144}function Ia(e){for(e=e.firstContext;e!==null;){if(!Ht(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Oi(e){mn=e,kn=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Ot(e){return Bl(mn,e)}function en(e,t){return mn===null&&Oi(e),Bl(e,t)}function Bl(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},kn===null){if(e===null)throw Error(S(308));kn=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else kn=kn.next=t;return n}var Ya=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,s){e.push(s)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},Ao=U.unstable_scheduleCallback,Oo=U.unstable_NormalPriority,Je={$$typeof:$e,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Zn(){return{controller:new Ya,data:new Map,refCount:0}}function Qa(e){e.refCount--,e.refCount===0&&Ao(Oo,function(){e.controller.abort()})}var na=null,tt=0,ia=0,aa=null;function Hc(e,t){if(na===null){var n=na=[];tt=0,ia=Eu(),aa={status:"pending",value:void 0,then:function(s){n.push(s)}}}return tt++,t.then(To,To),t}function To(){if(--tt===0&&na!==null){aa!==null&&(aa.status="fulfilled");var e=na;na=null,ia=0,aa=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function Vc(e,t){var n=[],s={status:"pending",value:null,reason:null,then:function(r){n.push(r)}};return e.then(function(){s.status="fulfilled",s.value=t;for(var r=0;r<n.length;r++)(0,n[r])(t)},function(r){for(s.status="rejected",s.reason=r,r=0;r<n.length;r++)(0,n[r])(void 0)}),s}var Ro=D.S;D.S=function(e,t){typeof t=="object"&&t!==null&&typeof t.then=="function"&&Hc(e,t),Ro!==null&&Ro(e,t)};var Jn=H(null);function ql(){var e=Jn.current;return e!==null?e:We.pooledCache}function sa(e,t){t===null?W(Jn,Jn.current):W(Jn,t.pool)}function _o(){var e=ql();return e===null?null:{parent:Je._currentValue,pool:e}}var Pa=Error(S(460)),Co=Error(S(474)),Us=Error(S(542)),jl={then:function(){}};function Eo(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Xa(){}function Mo(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(Xa,Xa),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,No(e),e;default:if(typeof t.status=="string")t.then(Xa,Xa);else{if(e=We,e!==null&&100<e.shellSuspendCounter)throw Error(S(482));e=t,e.status="pending",e.then(function(s){if(t.status==="pending"){var r=t;r.status="fulfilled",r.value=s}},function(s){if(t.status==="pending"){var r=t;r.status="rejected",r.reason=s}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,No(e),e}throw Ka=t,Pa}}var Ka=null;function wo(){if(Ka===null)throw Error(S(459));var e=Ka;return Ka=null,e}function No(e){if(e===Pa||e===Us)throw Error(S(483))}var Ln=!1;function xs(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Gl(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Wn(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function $n(e,t,n){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,(He&2)!==0){var r=s.pending;return r===null?t.next=t:(t.next=r.next,r.next=t),s.pending=t,t=Kn(e),Es(e,null,n),t}return _n(e,s,t,n),Kn(e)}function Za(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,Pt(e,n)}}function zl(e,t){var n=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,c=null;if(n=n.firstBaseUpdate,n!==null){do{var d={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};c===null?r=c=d:c=c.next=d,n=n.next}while(n!==null);c===null?r=c=t:c=c.next=t}else r=c=t;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:c,shared:s.shared,callbacks:s.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Hl=!1;function Ja(){if(Hl){var e=aa;if(e!==null)throw e}}function Wa(e,t,n,s){Hl=!1;var r=e.updateQueue;Ln=!1;var c=r.firstBaseUpdate,d=r.lastBaseUpdate,g=r.shared.pending;if(g!==null){r.shared.pending=null;var y=g,_=y.next;y.next=null,d===null?c=_:d.next=_,d=y;var k=e.alternate;k!==null&&(k=k.updateQueue,g=k.lastBaseUpdate,g!==d&&(g===null?k.firstBaseUpdate=_:g.next=_,k.lastBaseUpdate=y))}if(c!==null){var z=r.baseState;d=0,k=_=y=null,g=c;do{var C=g.lane&-536870913,M=C!==g.lane;if(M?(ke&C)===C:(s&C)===C){C!==0&&C===ia&&(Hl=!0),k!==null&&(k=k.next={lane:0,tag:g.tag,payload:g.payload,callback:null,next:null});e:{var ye=e,he=g;C=t;var Pe=n;switch(he.tag){case 1:if(ye=he.payload,typeof ye=="function"){z=ye.call(Pe,z,C);break e}z=ye;break e;case 3:ye.flags=ye.flags&-65537|128;case 0:if(ye=he.payload,C=typeof ye=="function"?ye.call(Pe,z,C):ye,C==null)break e;z=V({},z,C);break e;case 2:Ln=!0}}C=g.callback,C!==null&&(e.flags|=64,M&&(e.flags|=8192),M=r.callbacks,M===null?r.callbacks=[C]:M.push(C))}else M={lane:C,tag:g.tag,payload:g.payload,callback:g.callback,next:null},k===null?(_=k=M,y=z):k=k.next=M,d|=C;if(g=g.next,g===null){if(g=r.shared.pending,g===null)break;M=g,g=M.next,M.next=null,r.lastBaseUpdate=M,r.shared.pending=null}}while(!0);k===null&&(y=z),r.baseState=y,r.firstBaseUpdate=_,r.lastBaseUpdate=k,c===null&&(r.shared.lanes=0),ma|=d,e.lanes=d,e.memoizedState=z}}function la(e,t){if(typeof e!="function")throw Error(S(191,e));e.call(t)}function Vl(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)la(n[e],t)}var Fn=H(null),Ds=H(0);function ks(e,t){e=Ui,W(Ds,e),W(Fn,t),Ui=e|t.baseLanes}function Ls(){W(Ds,Ui),W(Fn,Fn.current)}function Il(){Ui=Ds.current,Q(Fn),Q(Ds)}var ei=0,Oe=null,Ge=null,ut=null,Bs=!1,Ti=!1,sn=!1,ti=0,Ri=0,ra=null,Ic=0;function st(){throw Error(S(321))}function Yl(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Ht(e[n],t[n]))return!1;return!0}function Ql(e,t,n,s,r,c){return ei=c,Oe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,D.H=e===null||e.memoizedState===null?jf:Gf,sn=!1,c=n(s,r),sn=!1,Ti&&(c=Uo(t,n,s,r)),Pl(e),c}function Pl(e){D.H=Lo;var t=Ge!==null&&Ge.next!==null;if(ei=0,ut=Ge=Oe=null,Bs=!1,Ri=0,ra=null,t)throw Error(S(300));e===null||Et||(e=e.dependencies,e!==null&&Ia(e)&&(Et=!0))}function Uo(e,t,n,s){Oe=e;var r=0;do{if(Ti&&(ra=null),Ri=0,Ti=!1,25<=r)throw Error(S(301));if(r+=1,ut=Ge=null,e.updateQueue!=null){var c=e.updateQueue;c.lastEffect=null,c.events=null,c.stores=null,c.memoCache!=null&&(c.memoCache.index=0)}D.H=ng,c=t(n,s)}while(Ti);return c}function Yc(){var e=D.H,t=e.useState()[0];return t=typeof t.then=="function"?m(t):t,e=e.useState()[0],(Ge!==null?Ge.memoizedState:null)!==e&&(Oe.flags|=1024),t}function i(){var e=ti!==0;return ti=0,e}function a(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function l(e){if(Bs){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Bs=!1}ei=0,ut=Ge=Oe=null,Ti=!1,Ri=ti=0,ra=null}function o(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ut===null?Oe.memoizedState=ut=e:ut=ut.next=e,ut}function u(){if(Ge===null){var e=Oe.alternate;e=e!==null?e.memoizedState:null}else e=Ge.next;var t=ut===null?Oe.memoizedState:ut.next;if(t!==null)ut=t,Ge=e;else{if(e===null)throw Oe.alternate===null?Error(S(467)):Error(S(310));Ge=e,e={memoizedState:Ge.memoizedState,baseState:Ge.baseState,baseQueue:Ge.baseQueue,queue:Ge.queue,next:null},ut===null?Oe.memoizedState=ut=e:ut=ut.next=e}return ut}function f(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function m(e){var t=Ri;return Ri+=1,ra===null&&(ra=[]),e=Mo(ra,e,t),t=Oe,(ut===null?t.memoizedState:ut.next)===null&&(t=t.alternate,D.H=t===null||t.memoizedState===null?jf:Gf),e}function p(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return m(e);if(e.$$typeof===$e)return Ot(e)}throw Error(S(438,String(e)))}function R(e){var t=null,n=Oe.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var s=Oe.alternate;s!==null&&(s=s.updateQueue,s!==null&&(s=s.memoCache,s!=null&&(t={data:s.data.map(function(r){return r.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=f(),Oe.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),s=0;s<e;s++)n[s]=jn;return t.index++,n}function A(e,t){return typeof t=="function"?t(e):t}function L(e){var t=u();return B(t,Ge,e)}function B(e,t,n){var s=e.queue;if(s===null)throw Error(S(311));s.lastRenderedReducer=n;var r=e.baseQueue,c=s.pending;if(c!==null){if(r!==null){var d=r.next;r.next=c.next,c.next=d}t.baseQueue=r=c,s.pending=null}if(c=e.baseState,r===null)e.memoizedState=c;else{t=r.next;var g=d=null,y=null,_=t,k=!1;do{var z=_.lane&-536870913;if(z!==_.lane?(ke&z)===z:(ei&z)===z){var C=_.revertLane;if(C===0)y!==null&&(y=y.next={lane:0,revertLane:0,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null}),z===ia&&(k=!0);else if((ei&C)===C){_=_.next,C===ia&&(k=!0);continue}else z={lane:0,revertLane:_.revertLane,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null},y===null?(g=y=z,d=c):y=y.next=z,Oe.lanes|=C,ma|=C;z=_.action,sn&&n(c,z),c=_.hasEagerState?_.eagerState:n(c,z)}else C={lane:z,revertLane:_.revertLane,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null},y===null?(g=y=C,d=c):y=y.next=C,Oe.lanes|=z,ma|=z;_=_.next}while(_!==null&&_!==t);if(y===null?d=c:y.next=g,!Ht(c,e.memoizedState)&&(Et=!0,k&&(n=aa,n!==null)))throw n;e.memoizedState=c,e.baseState=d,e.baseQueue=y,s.lastRenderedState=c}return r===null&&(s.lanes=0),[e.memoizedState,s.dispatch]}function Y(e){var t=u(),n=t.queue;if(n===null)throw Error(S(311));n.lastRenderedReducer=e;var s=n.dispatch,r=n.pending,c=t.memoizedState;if(r!==null){n.pending=null;var d=r=r.next;do c=e(c,d.action),d=d.next;while(d!==r);Ht(c,t.memoizedState)||(Et=!0),t.memoizedState=c,t.baseQueue===null&&(t.baseState=c),n.lastRenderedState=c}return[c,s]}function q(e,t,n){var s=Oe,r=u(),c=Se;if(c){if(n===void 0)throw Error(S(407));n=n()}else n=t();var d=!Ht((Ge||r).memoizedState,n);d&&(r.memoizedState=n,Et=!0),r=r.queue;var g=fe.bind(null,s,r,e);if(Xl(2048,8,g,[e]),r.getSnapshot!==t||d||ut!==null&&ut.memoizedState.tag&1){if(s.flags|=2048,qs(9,xo(),te.bind(null,s,r,n,t),null),We===null)throw Error(S(349));c||(ei&124)!==0||ee(s,t,n)}return n}function ee(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Oe.updateQueue,t===null?(t=f(),Oe.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function te(e,t,n,s){t.value=n,t.getSnapshot=s,xe(t)&&je(e)}function fe(e,t,n){return n(function(){xe(t)&&je(e)})}function xe(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Ht(e,n)}catch{return!0}}function je(e){var t=Ji(e,2);t!==null&&un(t,e,2)}function ze(e){var t=o();if(typeof e=="function"){var n=e;if(e=n(),sn){ct(!0);try{n()}finally{ct(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:A,lastRenderedState:e},t}function pe(e,t,n,s){return e.baseState=n,B(e,Ge,typeof s=="function"?s:A)}function It(e,t,n,s,r){if(ko(e))throw Error(S(485));if(e=t.action,e!==null){var c={payload:r,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(d){c.listeners.push(d)}};D.T!==null?n(!0):c.isTransition=!1,s(c),n=t.pending,n===null?(c.next=t.pending=c,Tt(t,c)):(c.next=n.next,t.pending=n.next=c)}}function Tt(e,t){var n=t.action,s=t.payload,r=e.state;if(t.isTransition){var c=D.T,d={};D.T=d;try{var g=n(r,s),y=D.S;y!==null&&y(d,g),oa(e,t,g)}catch(_){$a(e,t,_)}finally{D.T=c}}else try{c=n(r,s),oa(e,t,c)}catch(_){$a(e,t,_)}}function oa(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(s){_i(e,t,s)},function(s){return $a(e,t,s)}):_i(e,t,n)}function _i(e,t,n){t.status="fulfilled",t.value=n,gf(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,Tt(e,n)))}function $a(e,t,n){var s=e.pending;if(e.pending=null,s!==null){s=s.next;do t.status="rejected",t.reason=n,gf(t),t=t.next;while(t!==s)}e.action=null}function gf(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function mf(e,t){return t}function pf(e,t){if(Se){var n=We.formState;if(n!==null){e:{var s=Oe;if(Se){if(it){t:{for(var r=it,c=Ft;r.nodeType!==8;){if(!c){r=null;break t}if(r=qn(r.nextSibling),r===null){r=null;break t}}c=r.data,r=c==="F!"||c==="F"?r:null}if(r){it=qn(r.nextSibling),s=r.data==="F!";break e}}Un(s)}s=!1}s&&(t=n[0])}}return n=o(),n.memoizedState=n.baseState=t,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mf,lastRenderedState:t},n.queue=s,n=Lf.bind(null,Oe,s),s.dispatch=n,s=ze(!1),c=Zc.bind(null,Oe,!1,s.queue),s=o(),r={state:t,dispatch:null,action:e,pending:null},s.queue=r,n=It.bind(null,Oe,r,c,n),r.dispatch=n,s.memoizedState=e,[t,n,!1]}function yf(e){var t=u();return vf(t,Ge,e)}function vf(e,t,n){if(t=B(e,t,mf)[0],e=L(A)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var s=m(t)}catch(d){throw d===Pa?Us:d}else s=t;t=u();var r=t.queue,c=r.dispatch;return n!==t.memoizedState&&(Oe.flags|=2048,qs(9,xo(),$d.bind(null,r,n),null)),[s,c,e]}function $d(e,t){e.action=t}function bf(e){var t=u(),n=Ge;if(n!==null)return vf(t,n,e);u(),t=t.memoizedState,n=u();var s=n.queue.dispatch;return n.memoizedState=e,[t,s,!1]}function qs(e,t,n,s){return e={tag:e,create:n,deps:s,inst:t,next:null},t=Oe.updateQueue,t===null&&(t=f(),Oe.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e),e}function xo(){return{destroy:void 0,resource:void 0}}function Sf(){return u().memoizedState}function Do(e,t,n,s){var r=o();s=s===void 0?null:s,Oe.flags|=e,r.memoizedState=qs(1|t,xo(),n,s)}function Xl(e,t,n,s){var r=u();s=s===void 0?null:s;var c=r.memoizedState.inst;Ge!==null&&s!==null&&Yl(s,Ge.memoizedState.deps)?r.memoizedState=qs(t,c,n,s):(Oe.flags|=e,r.memoizedState=qs(1|t,c,n,s))}function Af(e,t){Do(8390656,8,e,t)}function Of(e,t){Xl(2048,8,e,t)}function Tf(e,t){return Xl(4,2,e,t)}function Rf(e,t){return Xl(4,4,e,t)}function _f(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Cf(e,t,n){n=n!=null?n.concat([e]):null,Xl(4,4,_f.bind(null,t,e),n)}function Qc(){}function Ef(e,t){var n=u();t=t===void 0?null:t;var s=n.memoizedState;return t!==null&&Yl(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function Mf(e,t){var n=u();t=t===void 0?null:t;var s=n.memoizedState;if(t!==null&&Yl(t,s[1]))return s[0];if(s=e(),sn){ct(!0);try{e()}finally{ct(!1)}}return n.memoizedState=[s,t],s}function Pc(e,t,n){return n===void 0||(ei&1073741824)!==0?e.memoizedState=t:(e.memoizedState=n,e=Uh(),Oe.lanes|=e,ma|=e,n)}function wf(e,t,n,s){return Ht(n,t)?n:Fn.current!==null?(e=Pc(e,n,s),Ht(e,t)||(Et=!0),e):(ei&42)===0?(Et=!0,e.memoizedState=n):(e=Uh(),Oe.lanes|=e,ma|=e,t)}function Nf(e,t,n,s,r){var c=j.p;j.p=c!==0&&8>c?c:8;var d=D.T,g={};D.T=g,Zc(e,!1,t,n);try{var y=r(),_=D.S;if(_!==null&&_(g,y),y!==null&&typeof y=="object"&&typeof y.then=="function"){var k=Vc(y,s);Kl(e,t,k,cn(e))}else Kl(e,t,s,cn(e))}catch(z){Kl(e,t,{then:function(){},status:"rejected",reason:z},cn())}finally{j.p=c,D.T=d}}function Fd(){}function Xc(e,t,n,s){if(e.tag!==5)throw Error(S(476));var r=Uf(e).queue;Nf(e,r,t,le,n===null?Fd:function(){return xf(e),n(s)})}function Uf(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:le,baseState:le,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:A,lastRenderedState:le},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:A,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function xf(e){var t=Uf(e).next.queue;Kl(e,t,{},cn())}function Kc(){return Ot(hr)}function Df(){return u().memoizedState}function kf(){return u().memoizedState}function eg(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=cn();e=Wn(n);var s=$n(t,e,n);s!==null&&(un(s,t,n),Za(s,t,n)),t={cache:Zn()},e.payload=t;return}t=t.return}}function tg(e,t,n){var s=cn();n={lane:s,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},ko(e)?Bf(t,n):(n=_t(e,t,n,s),n!==null&&(un(n,e,s),qf(n,t,s)))}function Lf(e,t,n){var s=cn();Kl(e,t,n,s)}function Kl(e,t,n,s){var r={lane:s,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(ko(e))Bf(t,r);else{var c=e.alternate;if(e.lanes===0&&(c===null||c.lanes===0)&&(c=t.lastRenderedReducer,c!==null))try{var d=t.lastRenderedState,g=c(d,n);if(r.hasEagerState=!0,r.eagerState=g,Ht(g,d))return _n(e,t,r,0),We===null&&Cs(),!1}catch{}finally{}if(n=_t(e,t,r,s),n!==null)return un(n,e,s),qf(n,t,s),!0}return!1}function Zc(e,t,n,s){if(s={lane:2,revertLane:Eu(),action:s,hasEagerState:!1,eagerState:null,next:null},ko(e)){if(t)throw Error(S(479))}else t=_t(e,n,s,2),t!==null&&un(t,e,2)}function ko(e){var t=e.alternate;return e===Oe||t!==null&&t===Oe}function Bf(e,t){Ti=Bs=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function qf(e,t,n){if((n&4194048)!==0){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,Pt(e,n)}}var Lo={readContext:Ot,use:p,useCallback:st,useContext:st,useEffect:st,useImperativeHandle:st,useLayoutEffect:st,useInsertionEffect:st,useMemo:st,useReducer:st,useRef:st,useState:st,useDebugValue:st,useDeferredValue:st,useTransition:st,useSyncExternalStore:st,useId:st,useHostTransitionStatus:st,useFormState:st,useActionState:st,useOptimistic:st,useMemoCache:st,useCacheRefresh:st},jf={readContext:Ot,use:p,useCallback:function(e,t){return o().memoizedState=[e,t===void 0?null:t],e},useContext:Ot,useEffect:Af,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,Do(4194308,4,_f.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Do(4194308,4,e,t)},useInsertionEffect:function(e,t){Do(4,2,e,t)},useMemo:function(e,t){var n=o();t=t===void 0?null:t;var s=e();if(sn){ct(!0);try{e()}finally{ct(!1)}}return n.memoizedState=[s,t],s},useReducer:function(e,t,n){var s=o();if(n!==void 0){var r=n(t);if(sn){ct(!0);try{n(t)}finally{ct(!1)}}}else r=t;return s.memoizedState=s.baseState=r,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},s.queue=e,e=e.dispatch=tg.bind(null,Oe,e),[s.memoizedState,e]},useRef:function(e){var t=o();return e={current:e},t.memoizedState=e},useState:function(e){e=ze(e);var t=e.queue,n=Lf.bind(null,Oe,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Qc,useDeferredValue:function(e,t){var n=o();return Pc(n,e,t)},useTransition:function(){var e=ze(!1);return e=Nf.bind(null,Oe,e.queue,!0,!1),o().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var s=Oe,r=o();if(Se){if(n===void 0)throw Error(S(407));n=n()}else{if(n=t(),We===null)throw Error(S(349));(ke&124)!==0||ee(s,t,n)}r.memoizedState=n;var c={value:n,getSnapshot:t};return r.queue=c,Af(fe.bind(null,s,c,e),[e]),s.flags|=2048,qs(9,xo(),te.bind(null,s,c,n,t),null),n},useId:function(){var e=o(),t=We.identifierPrefix;if(Se){var n=wn,s=Mn;n=(s&~(1<<32-et(s)-1)).toString(32)+n,t="«"+t+"R"+n,n=ti++,0<n&&(t+="H"+n.toString(32)),t+="»"}else n=Ic++,t="«"+t+"r"+n.toString(32)+"»";return e.memoizedState=t},useHostTransitionStatus:Kc,useFormState:pf,useActionState:pf,useOptimistic:function(e){var t=o();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Zc.bind(null,Oe,!0,n),n.dispatch=t,[e,t]},useMemoCache:R,useCacheRefresh:function(){return o().memoizedState=eg.bind(null,Oe)}},Gf={readContext:Ot,use:p,useCallback:Ef,useContext:Ot,useEffect:Of,useImperativeHandle:Cf,useInsertionEffect:Tf,useLayoutEffect:Rf,useMemo:Mf,useReducer:L,useRef:Sf,useState:function(){return L(A)},useDebugValue:Qc,useDeferredValue:function(e,t){var n=u();return wf(n,Ge.memoizedState,e,t)},useTransition:function(){var e=L(A)[0],t=u().memoizedState;return[typeof e=="boolean"?e:m(e),t]},useSyncExternalStore:q,useId:Df,useHostTransitionStatus:Kc,useFormState:yf,useActionState:yf,useOptimistic:function(e,t){var n=u();return pe(n,Ge,e,t)},useMemoCache:R,useCacheRefresh:kf},ng={readContext:Ot,use:p,useCallback:Ef,useContext:Ot,useEffect:Of,useImperativeHandle:Cf,useInsertionEffect:Tf,useLayoutEffect:Rf,useMemo:Mf,useReducer:Y,useRef:Sf,useState:function(){return Y(A)},useDebugValue:Qc,useDeferredValue:function(e,t){var n=u();return Ge===null?Pc(n,e,t):wf(n,Ge.memoizedState,e,t)},useTransition:function(){var e=Y(A)[0],t=u().memoizedState;return[typeof e=="boolean"?e:m(e),t]},useSyncExternalStore:q,useId:Df,useHostTransitionStatus:Kc,useFormState:bf,useActionState:bf,useOptimistic:function(e,t){var n=u();return Ge!==null?pe(n,Ge,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:R,useCacheRefresh:kf},js=null,Zl=0;function Bo(e){var t=Zl;return Zl+=1,js===null&&(js=[]),Mo(js,e,t)}function Jl(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function qo(e,t){throw t.$$typeof===I?Error(S(525)):(e=Object.prototype.toString.call(t),Error(S(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function zf(e){var t=e._init;return t(e._payload)}function Hf(e){function t(O,b){if(e){var T=O.deletions;T===null?(O.deletions=[b],O.flags|=16):T.push(b)}}function n(O,b){if(!e)return null;for(;b!==null;)t(O,b),b=b.sibling;return null}function s(O){for(var b=new Map;O!==null;)O.key!==null?b.set(O.key,O):b.set(O.index,O),O=O.sibling;return b}function r(O,b){return O=Cn(O,b),O.index=0,O.sibling=null,O}function c(O,b,T){return O.index=T,e?(T=O.alternate,T!==null?(T=T.index,T<b?(O.flags|=67108866,b):T):(O.flags|=67108866,b)):(O.flags|=1048576,b)}function d(O){return e&&O.alternate===null&&(O.flags|=67108866),O}function g(O,b,T,G){return b===null||b.tag!==6?(b=Nl(T,O.mode,G),b.return=O,b):(b=r(b,T),b.return=O,b)}function y(O,b,T,G){var ie=T.type;return ie===be?k(O,b,T.props.children,G,T.key):b!==null&&(b.elementType===ie||typeof ie=="object"&&ie!==null&&ie.$$typeof===mt&&zf(ie)===b.type)?(b=r(b,T.props),Jl(b,T),b.return=O,b):(b=za(T.type,T.key,T.props,null,O.mode,G),Jl(b,T),b.return=O,b)}function _(O,b,T,G){return b===null||b.tag!==4||b.stateNode.containerInfo!==T.containerInfo||b.stateNode.implementation!==T.implementation?(b=Ms(T,O.mode,G),b.return=O,b):(b=r(b,T.children||[]),b.return=O,b)}function k(O,b,T,G,ie){return b===null||b.tag!==7?(b=bi(T,O.mode,G,ie),b.return=O,b):(b=r(b,T),b.return=O,b)}function z(O,b,T){if(typeof b=="string"&&b!==""||typeof b=="number"||typeof b=="bigint")return b=Nl(""+b,O.mode,T),b.return=O,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case ae:return T=za(b.type,b.key,b.props,null,O.mode,T),Jl(T,b),T.return=O,T;case $:return b=Ms(b,O.mode,T),b.return=O,b;case mt:var G=b._init;return b=G(b._payload),z(O,b,T)}if(Ue(b)||Fe(b))return b=bi(b,O.mode,T,null),b.return=O,b;if(typeof b.then=="function")return z(O,Bo(b),T);if(b.$$typeof===$e)return z(O,en(O,b),T);qo(O,b)}return null}function C(O,b,T,G){var ie=b!==null?b.key:null;if(typeof T=="string"&&T!==""||typeof T=="number"||typeof T=="bigint")return ie!==null?null:g(O,b,""+T,G);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case ae:return T.key===ie?y(O,b,T,G):null;case $:return T.key===ie?_(O,b,T,G):null;case mt:return ie=T._init,T=ie(T._payload),C(O,b,T,G)}if(Ue(T)||Fe(T))return ie!==null?null:k(O,b,T,G,null);if(typeof T.then=="function")return C(O,b,Bo(T),G);if(T.$$typeof===$e)return C(O,b,en(O,T),G);qo(O,T)}return null}function M(O,b,T,G,ie){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return O=O.get(T)||null,g(b,O,""+G,ie);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case ae:return O=O.get(G.key===null?T:G.key)||null,y(b,O,G,ie);case $:return O=O.get(G.key===null?T:G.key)||null,_(b,O,G,ie);case mt:var Ee=G._init;return G=Ee(G._payload),M(O,b,T,G,ie)}if(Ue(G)||Fe(G))return O=O.get(T)||null,k(b,O,G,ie,null);if(typeof G.then=="function")return M(O,b,T,Bo(G),ie);if(G.$$typeof===$e)return M(O,b,T,en(b,G),ie);qo(b,G)}return null}function ye(O,b,T,G){for(var ie=null,Ee=null,oe=b,de=b=0,wt=null;oe!==null&&de<T.length;de++){oe.index>de?(wt=oe,oe=null):wt=oe.sibling;var qe=C(O,oe,T[de],G);if(qe===null){oe===null&&(oe=wt);break}e&&oe&&qe.alternate===null&&t(O,oe),b=c(qe,b,de),Ee===null?ie=qe:Ee.sibling=qe,Ee=qe,oe=wt}if(de===T.length)return n(O,oe),Se&&Si(O,de),ie;if(oe===null){for(;de<T.length;de++)oe=z(O,T[de],G),oe!==null&&(b=c(oe,b,de),Ee===null?ie=oe:Ee.sibling=oe,Ee=oe);return Se&&Si(O,de),ie}for(oe=s(oe);de<T.length;de++)wt=M(oe,O,de,T[de],G),wt!==null&&(e&&wt.alternate!==null&&oe.delete(wt.key===null?de:wt.key),b=c(wt,b,de),Ee===null?ie=wt:Ee.sibling=wt,Ee=wt);return e&&oe.forEach(function(Ra){return t(O,Ra)}),Se&&Si(O,de),ie}function he(O,b,T,G){if(T==null)throw Error(S(151));for(var ie=null,Ee=null,oe=b,de=b=0,wt=null,qe=T.next();oe!==null&&!qe.done;de++,qe=T.next()){oe.index>de?(wt=oe,oe=null):wt=oe.sibling;var Ra=C(O,oe,qe.value,G);if(Ra===null){oe===null&&(oe=wt);break}e&&oe&&Ra.alternate===null&&t(O,oe),b=c(Ra,b,de),Ee===null?ie=Ra:Ee.sibling=Ra,Ee=Ra,oe=wt}if(qe.done)return n(O,oe),Se&&Si(O,de),ie;if(oe===null){for(;!qe.done;de++,qe=T.next())qe=z(O,qe.value,G),qe!==null&&(b=c(qe,b,de),Ee===null?ie=qe:Ee.sibling=qe,Ee=qe);return Se&&Si(O,de),ie}for(oe=s(oe);!qe.done;de++,qe=T.next())qe=M(oe,O,de,qe.value,G),qe!==null&&(e&&qe.alternate!==null&&oe.delete(qe.key===null?de:qe.key),b=c(qe,b,de),Ee===null?ie=qe:Ee.sibling=qe,Ee=qe);return e&&oe.forEach(function(im){return t(O,im)}),Se&&Si(O,de),ie}function Pe(O,b,T,G){if(typeof T=="object"&&T!==null&&T.type===be&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case ae:e:{for(var ie=T.key;b!==null;){if(b.key===ie){if(ie=T.type,ie===be){if(b.tag===7){n(O,b.sibling),G=r(b,T.props.children),G.return=O,O=G;break e}}else if(b.elementType===ie||typeof ie=="object"&&ie!==null&&ie.$$typeof===mt&&zf(ie)===b.type){n(O,b.sibling),G=r(b,T.props),Jl(G,T),G.return=O,O=G;break e}n(O,b);break}else t(O,b);b=b.sibling}T.type===be?(G=bi(T.props.children,O.mode,G,T.key),G.return=O,O=G):(G=za(T.type,T.key,T.props,null,O.mode,G),Jl(G,T),G.return=O,O=G)}return d(O);case $:e:{for(ie=T.key;b!==null;){if(b.key===ie)if(b.tag===4&&b.stateNode.containerInfo===T.containerInfo&&b.stateNode.implementation===T.implementation){n(O,b.sibling),G=r(b,T.children||[]),G.return=O,O=G;break e}else{n(O,b);break}else t(O,b);b=b.sibling}G=Ms(T,O.mode,G),G.return=O,O=G}return d(O);case mt:return ie=T._init,T=ie(T._payload),Pe(O,b,T,G)}if(Ue(T))return ye(O,b,T,G);if(Fe(T)){if(ie=Fe(T),typeof ie!="function")throw Error(S(150));return T=ie.call(T),he(O,b,T,G)}if(typeof T.then=="function")return Pe(O,b,Bo(T),G);if(T.$$typeof===$e)return Pe(O,b,en(O,T),G);qo(O,T)}return typeof T=="string"&&T!==""||typeof T=="number"||typeof T=="bigint"?(T=""+T,b!==null&&b.tag===6?(n(O,b.sibling),G=r(b,T),G.return=O,O=G):(n(O,b),G=Nl(T,O.mode,G),G.return=O,O=G),d(O)):n(O,b)}return function(O,b,T,G){try{Zl=0;var ie=Pe(O,b,T,G);return js=null,ie}catch(oe){if(oe===Pa||oe===Us)throw oe;var Ee=Vt(29,oe,null,O.mode);return Ee.lanes=G,Ee.return=O,Ee}finally{}}}var Gs=Hf(!0),Vf=Hf(!1),yn=H(null),ni=null;function ca(e){var t=e.alternate;W(Rt,Rt.current&1),W(yn,e),ni===null&&(t===null||Fn.current!==null||t.memoizedState!==null)&&(ni=e)}function If(e){if(e.tag===22){if(W(Rt,Rt.current),W(yn,e),ni===null){var t=e.alternate;t!==null&&t.memoizedState!==null&&(ni=e)}}else ua()}function ua(){W(Rt,Rt.current),W(yn,yn.current)}function Ci(e){Q(yn),ni===e&&(ni=null),Q(Rt)}var Rt=H(0);function jo(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||Gu(n)))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function Jc(e,t,n,s){t=e.memoizedState,n=n(s,t),n=n==null?t:V({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Wc={enqueueSetState:function(e,t,n){e=e._reactInternals;var s=cn(),r=Wn(s);r.payload=t,n!=null&&(r.callback=n),t=$n(e,r,s),t!==null&&(un(t,e,s),Za(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=cn(),r=Wn(s);r.tag=1,r.payload=t,n!=null&&(r.callback=n),t=$n(e,r,s),t!==null&&(un(t,e,s),Za(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=cn(),s=Wn(n);s.tag=2,t!=null&&(s.callback=t),t=$n(e,s,n),t!==null&&(un(t,e,n),Za(t,e,n))}};function Yf(e,t,n,s,r,c,d){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,c,d):t.prototype&&t.prototype.isPureReactComponent?!Qn(n,s)||!Qn(r,c):!0}function Qf(e,t,n,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&Wc.enqueueReplaceState(t,t.state,null)}function Fa(e,t){var n=t;if("ref"in t){n={};for(var s in t)s!=="ref"&&(n[s]=t[s])}if(e=e.defaultProps){n===t&&(n=V({},n));for(var r in e)n[r]===void 0&&(n[r]=e[r])}return n}var Go=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function Pf(e){Go(e)}function Xf(e){console.error(e)}function Kf(e){Go(e)}function zo(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(s){setTimeout(function(){throw s})}}function Zf(e,t,n){try{var s=e.onCaughtError;s(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function $c(e,t,n){return n=Wn(n),n.tag=3,n.payload={element:null},n.callback=function(){zo(e,t)},n}function Jf(e){return e=Wn(e),e.tag=3,e}function Wf(e,t,n,s){var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var c=s.value;e.payload=function(){return r(c)},e.callback=function(){Zf(t,n,s)}}var d=n.stateNode;d!==null&&typeof d.componentDidCatch=="function"&&(e.callback=function(){Zf(t,n,s),typeof r!="function"&&(pa===null?pa=new Set([this]):pa.add(this));var g=s.stack;this.componentDidCatch(s.value,{componentStack:g!==null?g:""})})}function ig(e,t,n,s,r){if(n.flags|=32768,s!==null&&typeof s=="object"&&typeof s.then=="function"){if(t=n.alternate,t!==null&&Va(t,n,r,!0),n=yn.current,n!==null){switch(n.tag){case 13:return ni===null?Ou():n.alternate===null&&ft===0&&(ft=3),n.flags&=-257,n.flags|=65536,n.lanes=r,s===jl?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([s]):t.add(s),Ru(e,s,r)),!1;case 22:return n.flags|=65536,s===jl?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([s])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([s]):n.add(s)),Ru(e,s,r)),!1}throw Error(S(435,n.tag))}return Ru(e,s,r),Ou(),!1}if(Se)return t=yn.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=r,s!==Ai&&(e=Error(S(422),{cause:s}),Dn(Wt(e,n)))):(s!==Ai&&(t=Error(S(423),{cause:s}),Dn(Wt(t,n))),e=e.current.alternate,e.flags|=65536,r&=-r,e.lanes|=r,s=Wt(s,n),r=$c(e.stateNode,s,r),zl(e,r),ft!==4&&(ft=2)),!1;var c=Error(S(520),{cause:s});if(c=Wt(c,n),ir===null?ir=[c]:ir.push(c),ft!==4&&(ft=2),t===null)return!0;s=Wt(s,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=r&-r,n.lanes|=e,e=$c(n.stateNode,s,e),zl(n,e),!1;case 1:if(t=n.type,c=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||c!==null&&typeof c.componentDidCatch=="function"&&(pa===null||!pa.has(c))))return n.flags|=65536,r&=-r,n.lanes|=r,r=Jf(r),Wf(r,e,n,s),zl(n,r),!1}n=n.return}while(n!==null);return!1}var $f=Error(S(461)),Et=!1;function Dt(e,t,n,s){t.child=e===null?Vf(t,null,n,s):Gs(t,e.child,n,s)}function Ff(e,t,n,s,r){n=n.render;var c=t.ref;if("ref"in s){var d={};for(var g in s)g!=="ref"&&(d[g]=s[g])}else d=s;return Oi(t),s=Ql(e,t,n,d,c,r),g=i(),e!==null&&!Et?(a(e,t,r),Ei(e,t,r)):(Se&&g&&Ul(t),t.flags|=1,Dt(e,t,s,r),t.child)}function eh(e,t,n,s,r){if(e===null){var c=n.type;return typeof c=="function"&&!Ga(c)&&c.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=c,th(e,t,c,s,r)):(e=za(n.type,null,s,t,t.mode,r),e.ref=t.ref,e.return=t,t.child=e)}if(c=e.child,!lu(e,r)){var d=c.memoizedProps;if(n=n.compare,n=n!==null?n:Qn,n(d,s)&&e.ref===t.ref)return Ei(e,t,r)}return t.flags|=1,e=Cn(c,s),e.ref=t.ref,e.return=t,t.child=e}function th(e,t,n,s,r){if(e!==null){var c=e.memoizedProps;if(Qn(c,s)&&e.ref===t.ref)if(Et=!1,t.pendingProps=s=c,lu(e,r))(e.flags&131072)!==0&&(Et=!0);else return t.lanes=e.lanes,Ei(e,t,r)}return Fc(e,t,n,s,r)}function nh(e,t,n){var s=t.pendingProps,r=s.children,c=e!==null?e.memoizedState:null;if(s.mode==="hidden"){if((t.flags&128)!==0){if(s=c!==null?c.baseLanes|n:n,e!==null){for(r=t.child=e.child,c=0;r!==null;)c=c|r.lanes|r.childLanes,r=r.sibling;t.childLanes=c&~s}else t.childLanes=0,t.child=null;return ih(e,t,s,n)}if((n&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&sa(t,c!==null?c.cachePool:null),c!==null?ks(t,c):Ls(),If(t);else return t.lanes=t.childLanes=536870912,ih(e,t,c!==null?c.baseLanes|n:n,n)}else c!==null?(sa(t,c.cachePool),ks(t,c),ua(),t.memoizedState=null):(e!==null&&sa(t,null),Ls(),ua());return Dt(e,t,r,n),t.child}function ih(e,t,n,s){var r=ql();return r=r===null?null:{parent:Je._currentValue,pool:r},t.memoizedState={baseLanes:n,cachePool:r},e!==null&&sa(t,null),Ls(),If(t),e!==null&&Va(e,t,s,!0),null}function Ho(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(S(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function Fc(e,t,n,s,r){return Oi(t),n=Ql(e,t,n,s,void 0,r),s=i(),e!==null&&!Et?(a(e,t,r),Ei(e,t,r)):(Se&&s&&Ul(t),t.flags|=1,Dt(e,t,n,r),t.child)}function ah(e,t,n,s,r,c){return Oi(t),t.updateQueue=null,n=Uo(t,s,n,r),Pl(e),s=i(),e!==null&&!Et?(a(e,t,c),Ei(e,t,c)):(Se&&s&&Ul(t),t.flags|=1,Dt(e,t,n,c),t.child)}function sh(e,t,n,s,r){if(Oi(t),t.stateNode===null){var c=vi,d=n.contextType;typeof d=="object"&&d!==null&&(c=Ot(d)),c=new n(s,c),t.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=Wc,t.stateNode=c,c._reactInternals=t,c=t.stateNode,c.props=s,c.state=t.memoizedState,c.refs={},xs(t),d=n.contextType,c.context=typeof d=="object"&&d!==null?Ot(d):vi,c.state=t.memoizedState,d=n.getDerivedStateFromProps,typeof d=="function"&&(Jc(t,n,d,s),c.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof c.getSnapshotBeforeUpdate=="function"||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(d=c.state,typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount(),d!==c.state&&Wc.enqueueReplaceState(c,c.state,null),Wa(t,s,c,r),Ja(),c.state=t.memoizedState),typeof c.componentDidMount=="function"&&(t.flags|=4194308),s=!0}else if(e===null){c=t.stateNode;var g=t.memoizedProps,y=Fa(n,g);c.props=y;var _=c.context,k=n.contextType;d=vi,typeof k=="object"&&k!==null&&(d=Ot(k));var z=n.getDerivedStateFromProps;k=typeof z=="function"||typeof c.getSnapshotBeforeUpdate=="function",g=t.pendingProps!==g,k||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(g||_!==d)&&Qf(t,c,s,d),Ln=!1;var C=t.memoizedState;c.state=C,Wa(t,s,c,r),Ja(),_=t.memoizedState,g||C!==_||Ln?(typeof z=="function"&&(Jc(t,n,z,s),_=t.memoizedState),(y=Ln||Yf(t,n,y,s,C,_,d))?(k||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount()),typeof c.componentDidMount=="function"&&(t.flags|=4194308)):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=_),c.props=s,c.state=_,c.context=d,s=y):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{c=t.stateNode,Gl(e,t),d=t.memoizedProps,k=Fa(n,d),c.props=k,z=t.pendingProps,C=c.context,_=n.contextType,y=vi,typeof _=="object"&&_!==null&&(y=Ot(_)),g=n.getDerivedStateFromProps,(_=typeof g=="function"||typeof c.getSnapshotBeforeUpdate=="function")||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(d!==z||C!==y)&&Qf(t,c,s,y),Ln=!1,C=t.memoizedState,c.state=C,Wa(t,s,c,r),Ja();var M=t.memoizedState;d!==z||C!==M||Ln||e!==null&&e.dependencies!==null&&Ia(e.dependencies)?(typeof g=="function"&&(Jc(t,n,g,s),M=t.memoizedState),(k=Ln||Yf(t,n,k,s,C,M,y)||e!==null&&e.dependencies!==null&&Ia(e.dependencies))?(_||typeof c.UNSAFE_componentWillUpdate!="function"&&typeof c.componentWillUpdate!="function"||(typeof c.componentWillUpdate=="function"&&c.componentWillUpdate(s,M,y),typeof c.UNSAFE_componentWillUpdate=="function"&&c.UNSAFE_componentWillUpdate(s,M,y)),typeof c.componentDidUpdate=="function"&&(t.flags|=4),typeof c.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof c.componentDidUpdate!="function"||d===e.memoizedProps&&C===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||d===e.memoizedProps&&C===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=M),c.props=s,c.state=M,c.context=y,s=k):(typeof c.componentDidUpdate!="function"||d===e.memoizedProps&&C===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||d===e.memoizedProps&&C===e.memoizedState||(t.flags|=1024),s=!1)}return c=s,Ho(e,t),s=(t.flags&128)!==0,c||s?(c=t.stateNode,n=s&&typeof n.getDerivedStateFromError!="function"?null:c.render(),t.flags|=1,e!==null&&s?(t.child=Gs(t,e.child,null,r),t.child=Gs(t,null,n,r)):Dt(e,t,n,r),t.memoizedState=c.state,e=t.child):e=Ei(e,t,r),e}function lh(e,t,n,s){return Fi(),t.flags|=256,Dt(e,t,n,s),t.child}var eu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function tu(e){return{baseLanes:e,cachePool:_o()}}function nu(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=vn),e}function rh(e,t,n){var s=t.pendingProps,r=!1,c=(t.flags&128)!==0,d;if((d=c)||(d=e!==null&&e.memoizedState===null?!1:(Rt.current&2)!==0),d&&(r=!0,t.flags&=-129),d=(t.flags&32)!==0,t.flags&=-33,e===null){if(Se){if(r?ca(t):ua(),Se){var g=it,y;if(y=g){e:{for(y=g,g=Ft;y.nodeType!==8;){if(!g){g=null;break e}if(y=qn(y.nextSibling),y===null){g=null;break e}}g=y}g!==null?(t.memoizedState={dehydrated:g,treeContext:En!==null?{id:Mn,overflow:wn}:null,retryLane:536870912,hydrationErrors:null},y=Vt(18,null,null,0),y.stateNode=g,y.return=t,t.child=y,Ct=t,it=null,y=!0):y=!1}y||Un(t)}if(g=t.memoizedState,g!==null&&(g=g.dehydrated,g!==null))return Gu(g)?t.lanes=32:t.lanes=536870912,null;Ci(t)}return g=s.children,s=s.fallback,r?(ua(),r=t.mode,g=Vo({mode:"hidden",children:g},r),s=bi(s,r,n,null),g.return=t,s.return=t,g.sibling=s,t.child=g,r=t.child,r.memoizedState=tu(n),r.childLanes=nu(e,d,n),t.memoizedState=eu,s):(ca(t),iu(t,g))}if(y=e.memoizedState,y!==null&&(g=y.dehydrated,g!==null)){if(c)t.flags&256?(ca(t),t.flags&=-257,t=au(e,t,n)):t.memoizedState!==null?(ua(),t.child=e.child,t.flags|=128,t=null):(ua(),r=s.fallback,g=t.mode,s=Vo({mode:"visible",children:s.children},g),r=bi(r,g,n,null),r.flags|=2,s.return=t,r.return=t,s.sibling=r,t.child=s,Gs(t,e.child,null,n),s=t.child,s.memoizedState=tu(n),s.childLanes=nu(e,d,n),t.memoizedState=eu,t=r);else if(ca(t),Gu(g)){if(d=g.nextSibling&&g.nextSibling.dataset,d)var _=d.dgst;d=_,s=Error(S(419)),s.stack="",s.digest=d,Dn({value:s,source:null,stack:null}),t=au(e,t,n)}else if(Et||Va(e,t,n,!1),d=(n&e.childLanes)!==0,Et||d){if(d=We,d!==null&&(s=n&-n,s=(s&42)!==0?1:al(s),s=(s&(d.suspendedLanes|n))!==0?0:s,s!==0&&s!==y.retryLane))throw y.retryLane=s,Ji(e,s),un(d,e,s),$f;g.data==="$?"||Ou(),t=au(e,t,n)}else g.data==="$?"?(t.flags|=192,t.child=e.child,t=null):(e=y.treeContext,it=qn(g.nextSibling),Ct=t,Se=!0,Nn=null,Ft=!1,e!==null&&(jt[$t++]=Mn,jt[$t++]=wn,jt[$t++]=En,Mn=e.id,wn=e.overflow,En=t),t=iu(t,s.children),t.flags|=4096);return t}return r?(ua(),r=s.fallback,g=t.mode,y=e.child,_=y.sibling,s=Cn(y,{mode:"hidden",children:s.children}),s.subtreeFlags=y.subtreeFlags&65011712,_!==null?r=Cn(_,r):(r=bi(r,g,n,null),r.flags|=2),r.return=t,s.return=t,s.sibling=r,t.child=s,s=r,r=t.child,g=e.child.memoizedState,g===null?g=tu(n):(y=g.cachePool,y!==null?(_=Je._currentValue,y=y.parent!==_?{parent:_,pool:_}:y):y=_o(),g={baseLanes:g.baseLanes|n,cachePool:y}),r.memoizedState=g,r.childLanes=nu(e,d,n),t.memoizedState=eu,s):(ca(t),n=e.child,e=n.sibling,n=Cn(n,{mode:"visible",children:s.children}),n.return=t,n.sibling=null,e!==null&&(d=t.deletions,d===null?(t.deletions=[e],t.flags|=16):d.push(e)),t.child=n,t.memoizedState=null,n)}function iu(e,t){return t=Vo({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function Vo(e,t){return e=Vt(22,e,null,t),e.lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function au(e,t,n){return Gs(t,e.child,null,n),e=iu(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function oh(e,t,n){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),ta(e.return,t,n)}function su(e,t,n,s,r){var c=e.memoizedState;c===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(c.isBackwards=t,c.rendering=null,c.renderingStartTime=0,c.last=s,c.tail=n,c.tailMode=r)}function ch(e,t,n){var s=t.pendingProps,r=s.revealOrder,c=s.tail;if(Dt(e,t,s.children,n),s=Rt.current,(s&2)!==0)s=s&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&oh(e,n,t);else if(e.tag===19)oh(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}switch(W(Rt,s),r){case"forwards":for(n=t.child,r=null;n!==null;)e=n.alternate,e!==null&&jo(e)===null&&(r=n),n=n.sibling;n=r,n===null?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),su(t,!1,r,n,c);break;case"backwards":for(n=null,r=t.child,t.child=null;r!==null;){if(e=r.alternate,e!==null&&jo(e)===null){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}su(t,!0,n,null,c);break;case"together":su(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ei(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),ma|=t.lanes,(n&t.childLanes)===0)if(e!==null){if(Va(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(S(153));if(t.child!==null){for(e=t.child,n=Cn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Cn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function lu(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Ia(e)))}function ag(e,t,n){switch(t.tag){case 3:J(t,t.stateNode.containerInfo),pn(t,Je,e.memoizedState.cache),Fi();break;case 27:case 5:Ce(t);break;case 4:J(t,t.stateNode.containerInfo);break;case 10:pn(t,t.type,t.memoizedProps.value);break;case 13:var s=t.memoizedState;if(s!==null)return s.dehydrated!==null?(ca(t),t.flags|=128,null):(n&t.child.childLanes)!==0?rh(e,t,n):(ca(t),e=Ei(e,t,n),e!==null?e.sibling:null);ca(t);break;case 19:var r=(e.flags&128)!==0;if(s=(n&t.childLanes)!==0,s||(Va(e,t,n,!1),s=(n&t.childLanes)!==0),r){if(s)return ch(e,t,n);t.flags|=128}if(r=t.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),W(Rt,Rt.current),s)break;return null;case 22:case 23:return t.lanes=0,nh(e,t,n);case 24:pn(t,Je,e.memoizedState.cache)}return Ei(e,t,n)}function uh(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)Et=!0;else{if(!lu(e,n)&&(t.flags&128)===0)return Et=!1,ag(e,t,n);Et=(e.flags&131072)!==0}else Et=!1,Se&&(t.flags&1048576)!==0&&So(t,Ns,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var s=t.elementType,r=s._init;if(s=r(s._payload),t.type=s,typeof s=="function")Ga(s)?(e=Fa(s,e),t.tag=1,t=sh(null,t,s,e,n)):(t.tag=0,t=Fc(null,t,s,e,n));else{if(s!=null){if(r=s.$$typeof,r===x){t.tag=11,t=Ff(null,t,s,e,n);break e}else if(r===Nt){t.tag=14,t=eh(null,t,s,e,n);break e}}throw t=N(s)||s,Error(S(306,t,""))}}return t;case 0:return Fc(e,t,t.type,t.pendingProps,n);case 1:return s=t.type,r=Fa(s,t.pendingProps),sh(e,t,s,r,n);case 3:e:{if(J(t,t.stateNode.containerInfo),e===null)throw Error(S(387));s=t.pendingProps;var c=t.memoizedState;r=c.element,Gl(e,t),Wa(t,s,null,n);var d=t.memoizedState;if(s=d.cache,pn(t,Je,s),s!==c.cache&&Ll(t,[Je],n,!0),Ja(),s=d.element,c.isDehydrated)if(c={element:s,isDehydrated:!1,cache:d.cache},t.updateQueue.baseState=c,t.memoizedState=c,t.flags&256){t=lh(e,t,s,n);break e}else if(s!==r){r=Wt(Error(S(424)),t),Dn(r),t=lh(e,t,s,n);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(it=qn(e.firstChild),Ct=t,Se=!0,Nn=null,Ft=!0,n=Vf(t,null,s,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(Fi(),s===r){t=Ei(e,t,n);break e}Dt(e,t,s,n)}t=t.child}return t;case 26:return Ho(e,t),e===null?(n=gd(t.type,null,t.pendingProps,null))?t.memoizedState=n:Se||(n=t.type,e=t.pendingProps,s=nc(me.current).createElement(n),s[At]=t,s[Ut]=e,Lt(s,n,e),yt(s),t.stateNode=s):t.memoizedState=gd(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Ce(t),e===null&&Se&&(s=t.stateNode=fd(t.type,t.pendingProps,me.current),Ct=t,Ft=!0,r=it,ba(t.type)?(zu=r,it=qn(s.firstChild)):it=r),Dt(e,t,t.pendingProps.children,n),Ho(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Se&&((r=s=it)&&(s=xg(s,t.type,t.pendingProps,Ft),s!==null?(t.stateNode=s,Ct=t,it=qn(s.firstChild),Ft=!1,r=!0):r=!1),r||Un(t)),Ce(t),r=t.type,c=t.pendingProps,d=e!==null?e.memoizedProps:null,s=c.children,Bu(r,c)?s=null:d!==null&&Bu(r,d)&&(t.flags|=32),t.memoizedState!==null&&(r=Ql(e,t,Yc,null,null,n),hr._currentValue=r),Ho(e,t),Dt(e,t,s,n),t.child;case 6:return e===null&&Se&&((e=n=it)&&(n=Dg(n,t.pendingProps,Ft),n!==null?(t.stateNode=n,Ct=t,it=null,e=!0):e=!1),e||Un(t)),null;case 13:return rh(e,t,n);case 4:return J(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=Gs(t,null,s,n):Dt(e,t,s,n),t.child;case 11:return Ff(e,t,t.type,t.pendingProps,n);case 7:return Dt(e,t,t.pendingProps,n),t.child;case 8:return Dt(e,t,t.pendingProps.children,n),t.child;case 12:return Dt(e,t,t.pendingProps.children,n),t.child;case 10:return s=t.pendingProps,pn(t,t.type,s.value),Dt(e,t,s.children,n),t.child;case 9:return r=t.type._context,s=t.pendingProps.children,Oi(t),r=Ot(r),s=s(r),t.flags|=1,Dt(e,t,s,n),t.child;case 14:return eh(e,t,t.type,t.pendingProps,n);case 15:return th(e,t,t.type,t.pendingProps,n);case 19:return ch(e,t,n);case 31:return s=t.pendingProps,n=t.mode,s={mode:s.mode,children:s.children},e===null?(n=Vo(s,n),n.ref=t.ref,t.child=n,n.return=t,t=n):(n=Cn(e.child,s),n.ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return nh(e,t,n);case 24:return Oi(t),s=Ot(Je),e===null?(r=ql(),r===null&&(r=We,c=Zn(),r.pooledCache=c,c.refCount++,c!==null&&(r.pooledCacheLanes|=n),r=c),t.memoizedState={parent:s,cache:r},xs(t),pn(t,Je,r)):((e.lanes&n)!==0&&(Gl(e,t),Wa(t,null,null,n),Ja()),r=e.memoizedState,c=t.memoizedState,r.parent!==s?(r={parent:s,cache:s},t.memoizedState=r,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=r),pn(t,Je,s)):(s=c.cache,pn(t,Je,s),s!==r.cache&&Ll(t,[Je],n,!0))),Dt(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(S(156,t.tag))}function Mi(e){e.flags|=4}function fh(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!bd(t)){if(t=yn.current,t!==null&&((ke&4194048)===ke?ni!==null:(ke&62914560)!==ke&&(ke&536870912)===0||t!==ni))throw Ka=jl,Co;e.flags|=8192}}function Io(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?wa():536870912,e.lanes|=t,Is|=t)}function Wl(e,t){if(!Se)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function lt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,s=0;if(t)for(var r=e.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&65011712,s|=r.flags&65011712,r.return=e,r=r.sibling;else for(r=e.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function sg(e,t,n){var s=t.pendingProps;switch(xl(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lt(t),null;case 1:return lt(t),null;case 3:return n=t.stateNode,s=null,e!==null&&(s=e.memoizedState.cache),t.memoizedState.cache!==s&&(t.flags|=2048),St(Je),ve(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(xn(t)?Mi(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,ea())),lt(t),null;case 26:return n=t.memoizedState,e===null?(Mi(t),n!==null?(lt(t),fh(t,n)):(lt(t),t.flags&=-16777217)):n?n!==e.memoizedState?(Mi(t),lt(t),fh(t,n)):(lt(t),t.flags&=-16777217):(e.memoizedProps!==s&&Mi(t),lt(t),t.flags&=-16777217),null;case 27:_e(t),n=me.current;var r=t.type;if(e!==null&&t.stateNode!=null)e.memoizedProps!==s&&Mi(t);else{if(!s){if(t.stateNode===null)throw Error(S(166));return lt(t),null}e=ce.current,xn(t)?Dl(t):(e=fd(r,s,n),t.stateNode=e,Mi(t))}return lt(t),null;case 5:if(_e(t),n=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==s&&Mi(t);else{if(!s){if(t.stateNode===null)throw Error(S(166));return lt(t),null}if(e=ce.current,xn(t))Dl(t);else{switch(r=nc(me.current),e){case 1:e=r.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=r.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":e=r.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof s.is=="string"?r.createElement("select",{is:s.is}):r.createElement("select"),s.multiple?e.multiple=!0:s.size&&(e.size=s.size);break;default:e=typeof s.is=="string"?r.createElement(n,{is:s.is}):r.createElement(n)}}e[At]=t,e[Ut]=s;e:for(r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.tag!==27&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break e;for(;r.sibling===null;){if(r.return===null||r.return===t)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}t.stateNode=e;e:switch(Lt(e,n,s),n){case"button":case"input":case"select":case"textarea":e=!!s.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Mi(t)}}return lt(t),t.flags&=-16777217,null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==s&&Mi(t);else{if(typeof s!="string"&&t.stateNode===null)throw Error(S(166));if(e=me.current,xn(t)){if(e=t.stateNode,n=t.memoizedProps,s=null,r=Ct,r!==null)switch(r.tag){case 27:case 5:s=r.memoizedProps}e[At]=t,e=!!(e.nodeValue===n||s!==null&&s.suppressHydrationWarning===!0||ad(e.nodeValue,n)),e||Un(t)}else e=nc(e).createTextNode(s),e[At]=t,t.stateNode=e}return lt(t),null;case 13:if(s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(r=xn(t),s!==null&&s.dehydrated!==null){if(e===null){if(!r)throw Error(S(318));if(r=t.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(S(317));r[At]=t}else Fi(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;lt(t),r=!1}else r=ea(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=r),r=!0;if(!r)return t.flags&256?(Ci(t),t):(Ci(t),null)}if(Ci(t),(t.flags&128)!==0)return t.lanes=n,t;if(n=s!==null,e=e!==null&&e.memoizedState!==null,n){s=t.child,r=null,s.alternate!==null&&s.alternate.memoizedState!==null&&s.alternate.memoizedState.cachePool!==null&&(r=s.alternate.memoizedState.cachePool.pool);var c=null;s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),c!==r&&(s.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),Io(t,t.updateQueue),lt(t),null;case 4:return ve(),e===null&&Uu(t.stateNode.containerInfo),lt(t),null;case 10:return St(t.type),lt(t),null;case 19:if(Q(Rt),r=t.memoizedState,r===null)return lt(t),null;if(s=(t.flags&128)!==0,c=r.rendering,c===null)if(s)Wl(r,!1);else{if(ft!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(c=jo(e),c!==null){for(t.flags|=128,Wl(r,!1),e=c.updateQueue,t.updateQueue=e,Io(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)bo(n,e),n=n.sibling;return W(Rt,Rt.current&1|2),t.child}e=e.sibling}r.tail!==null&&Qt()>Po&&(t.flags|=128,s=!0,Wl(r,!1),t.lanes=4194304)}else{if(!s)if(e=jo(c),e!==null){if(t.flags|=128,s=!0,e=e.updateQueue,t.updateQueue=e,Io(t,e),Wl(r,!0),r.tail===null&&r.tailMode==="hidden"&&!c.alternate&&!Se)return lt(t),null}else 2*Qt()-r.renderingStartTime>Po&&n!==536870912&&(t.flags|=128,s=!0,Wl(r,!1),t.lanes=4194304);r.isBackwards?(c.sibling=t.child,t.child=c):(e=r.last,e!==null?e.sibling=c:t.child=c,r.last=c)}return r.tail!==null?(t=r.tail,r.rendering=t,r.tail=t.sibling,r.renderingStartTime=Qt(),t.sibling=null,e=Rt.current,W(Rt,s?e&1|2:e&1),t):(lt(t),null);case 22:case 23:return Ci(t),Il(),s=t.memoizedState!==null,e!==null?e.memoizedState!==null!==s&&(t.flags|=8192):s&&(t.flags|=8192),s?(n&536870912)!==0&&(t.flags&128)===0&&(lt(t),t.subtreeFlags&6&&(t.flags|=8192)):lt(t),n=t.updateQueue,n!==null&&Io(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),s=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(s=t.memoizedState.cachePool.pool),s!==n&&(t.flags|=2048),e!==null&&Q(Jn),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),St(Je),lt(t),null;case 25:return null;case 30:return null}throw Error(S(156,t.tag))}function lg(e,t){switch(xl(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return St(Je),ve(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return _e(t),null;case 13:if(Ci(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(S(340));Fi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Q(Rt),null;case 4:return ve(),null;case 10:return St(t.type),null;case 22:case 23:return Ci(t),Il(),e!==null&&Q(Jn),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return St(Je),null;case 25:return null;default:return null}}function hh(e,t){switch(xl(t),t.tag){case 3:St(Je),ve();break;case 26:case 27:case 5:_e(t);break;case 4:ve();break;case 13:Ci(t);break;case 19:Q(Rt);break;case 10:St(t.type);break;case 22:case 23:Ci(t),Il(),e!==null&&Q(Jn);break;case 24:St(Je)}}function $l(e,t){try{var n=t.updateQueue,s=n!==null?n.lastEffect:null;if(s!==null){var r=s.next;n=r;do{if((n.tag&e)===e){s=void 0;var c=n.create,d=n.inst;s=c(),d.destroy=s}n=n.next}while(n!==r)}}catch(g){Xe(t,t.return,g)}}function fa(e,t,n){try{var s=t.updateQueue,r=s!==null?s.lastEffect:null;if(r!==null){var c=r.next;s=c;do{if((s.tag&e)===e){var d=s.inst,g=d.destroy;if(g!==void 0){d.destroy=void 0,r=t;var y=n,_=g;try{_()}catch(k){Xe(r,y,k)}}}s=s.next}while(s!==c)}}catch(k){Xe(t,t.return,k)}}function dh(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{Vl(t,n)}catch(s){Xe(e,e.return,s)}}}function gh(e,t,n){n.props=Fa(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(s){Xe(e,t,s)}}function Fl(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var s=e.stateNode;break;case 30:s=e.stateNode;break;default:s=e.stateNode}typeof n=="function"?e.refCleanup=n(s):n.current=s}}catch(r){Xe(e,t,r)}}function ii(e,t){var n=e.ref,s=e.refCleanup;if(n!==null)if(typeof s=="function")try{s()}catch(r){Xe(e,t,r)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(r){Xe(e,t,r)}else n.current=null}function mh(e){var t=e.type,n=e.memoizedProps,s=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&s.focus();break e;case"img":n.src?s.src=n.src:n.srcSet&&(s.srcset=n.srcSet)}}catch(r){Xe(e,e.return,r)}}function ru(e,t,n){try{var s=e.stateNode;Eg(s,e.type,n,t),s[Ut]=t}catch(r){Xe(e,e.return,r)}}function ph(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&ba(e.type)||e.tag===4}function ou(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||ph(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&ba(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function cu(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=tc));else if(s!==4&&(s===27&&ba(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(cu(e,t,n),e=e.sibling;e!==null;)cu(e,t,n),e=e.sibling}function Yo(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(s!==4&&(s===27&&ba(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(Yo(e,t,n),e=e.sibling;e!==null;)Yo(e,t,n),e=e.sibling}function yh(e){var t=e.stateNode,n=e.memoizedProps;try{for(var s=e.type,r=t.attributes;r.length;)t.removeAttributeNode(r[0]);Lt(t,s,n),t[At]=e,t[Ut]=n}catch(c){Xe(e,e.return,c)}}var wi=!1,gt=!1,uu=!1,vh=typeof WeakSet=="function"?WeakSet:Set,Mt=null;function rg(e,t){if(e=e.containerInfo,ku=oc,e=qt(e),ja(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,c=s.focusNode;s=s.focusOffset;try{n.nodeType,c.nodeType}catch{n=null;break e}var d=0,g=-1,y=-1,_=0,k=0,z=e,C=null;t:for(;;){for(var M;z!==n||r!==0&&z.nodeType!==3||(g=d+r),z!==c||s!==0&&z.nodeType!==3||(y=d+s),z.nodeType===3&&(d+=z.nodeValue.length),(M=z.firstChild)!==null;)C=z,z=M;for(;;){if(z===e)break t;if(C===n&&++_===r&&(g=d),C===c&&++k===s&&(y=d),(M=z.nextSibling)!==null)break;z=C,C=z.parentNode}z=M}n=g===-1||y===-1?null:{start:g,end:y}}else n=null}n=n||{start:0,end:0}}else n=null;for(Lu={focusedElem:e,selectionRange:n},oc=!1,Mt=t;Mt!==null;)if(t=Mt,e=t.child,(t.subtreeFlags&1024)!==0&&e!==null)e.return=t,Mt=e;else for(;Mt!==null;){switch(t=Mt,c=t.alternate,e=t.flags,t.tag){case 0:break;case 11:case 15:break;case 1:if((e&1024)!==0&&c!==null){e=void 0,n=t,r=c.memoizedProps,c=c.memoizedState,s=n.stateNode;try{var ye=Fa(n.type,r,n.elementType===n.type);e=s.getSnapshotBeforeUpdate(ye,c),s.__reactInternalSnapshotBeforeUpdate=e}catch(he){Xe(n,n.return,he)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)ju(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":ju(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(S(163))}if(e=t.sibling,e!==null){e.return=t.return,Mt=e;break}Mt=t.return}}function bh(e,t,n){var s=n.flags;switch(n.tag){case 0:case 11:case 15:ha(e,n),s&4&&$l(5,n);break;case 1:if(ha(e,n),s&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(d){Xe(n,n.return,d)}else{var r=Fa(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(r,t,e.__reactInternalSnapshotBeforeUpdate)}catch(d){Xe(n,n.return,d)}}s&64&&dh(n),s&512&&Fl(n,n.return);break;case 3:if(ha(e,n),s&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{Vl(e,t)}catch(d){Xe(n,n.return,d)}}break;case 27:t===null&&s&4&&yh(n);case 26:case 5:ha(e,n),t===null&&s&4&&mh(n),s&512&&Fl(n,n.return);break;case 12:ha(e,n);break;case 13:ha(e,n),s&4&&Oh(e,n),s&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=pg.bind(null,n),kg(e,n))));break;case 22:if(s=n.memoizedState!==null||wi,!s){t=t!==null&&t.memoizedState!==null||gt,r=wi;var c=gt;wi=s,(gt=t)&&!c?da(e,n,(n.subtreeFlags&8772)!==0):ha(e,n),wi=r,gt=c}break;case 30:break;default:ha(e,n)}}function Sh(e){var t=e.alternate;t!==null&&(e.alternate=null,Sh(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&ol(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var at=null,tn=!1;function Ni(e,t,n){for(n=n.child;n!==null;)Ah(e,t,n),n=n.sibling}function Ah(e,t,n){if(Ie&&typeof Ie.onCommitFiberUnmount=="function")try{Ie.onCommitFiberUnmount(ki,n)}catch{}switch(n.tag){case 26:gt||ii(n,t),Ni(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:gt||ii(n,t);var s=at,r=tn;ba(n.type)&&(at=n.stateNode,tn=!1),Ni(e,t,n),or(n.stateNode),at=s,tn=r;break;case 5:gt||ii(n,t);case 6:if(s=at,r=tn,at=null,Ni(e,t,n),at=s,tn=r,at!==null)if(tn)try{(at.nodeType===9?at.body:at.nodeName==="HTML"?at.ownerDocument.body:at).removeChild(n.stateNode)}catch(c){Xe(n,t,c)}else try{at.removeChild(n.stateNode)}catch(c){Xe(n,t,c)}break;case 18:at!==null&&(tn?(e=at,cd(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,n.stateNode),pr(e)):cd(at,n.stateNode));break;case 4:s=at,r=tn,at=n.stateNode.containerInfo,tn=!0,Ni(e,t,n),at=s,tn=r;break;case 0:case 11:case 14:case 15:gt||fa(2,n,t),gt||fa(4,n,t),Ni(e,t,n);break;case 1:gt||(ii(n,t),s=n.stateNode,typeof s.componentWillUnmount=="function"&&gh(n,t,s)),Ni(e,t,n);break;case 21:Ni(e,t,n);break;case 22:gt=(s=gt)||n.memoizedState!==null,Ni(e,t,n),gt=s;break;default:Ni(e,t,n)}}function Oh(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{pr(e)}catch(n){Xe(t,t.return,n)}}function og(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new vh),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new vh),t;default:throw Error(S(435,e.tag))}}function fu(e,t){var n=og(e);t.forEach(function(s){var r=yg.bind(null,e,s);n.has(s)||(n.add(s),s.then(r,r))})}function ln(e,t){var n=t.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s],c=e,d=t,g=d;e:for(;g!==null;){switch(g.tag){case 27:if(ba(g.type)){at=g.stateNode,tn=!1;break e}break;case 5:at=g.stateNode,tn=!1;break e;case 3:case 4:at=g.stateNode.containerInfo,tn=!0;break e}g=g.return}if(at===null)throw Error(S(160));Ah(c,d,r),at=null,tn=!1,c=r.alternate,c!==null&&(c.return=null),r.return=null}if(t.subtreeFlags&13878)for(t=t.child;t!==null;)Th(t,e),t=t.sibling}var Bn=null;function Th(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:ln(t,e),rn(e),s&4&&(fa(3,e,e.return),$l(3,e),fa(5,e,e.return));break;case 1:ln(t,e),rn(e),s&512&&(gt||n===null||ii(n,n.return)),s&64&&wi&&(e=e.updateQueue,e!==null&&(s=e.callbacks,s!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?s:n.concat(s))));break;case 26:var r=Bn;if(ln(t,e),rn(e),s&512&&(gt||n===null||ii(n,n.return)),s&4){var c=n!==null?n.memoizedState:null;if(s=e.memoizedState,n===null)if(s===null)if(e.stateNode===null){e:{s=e.type,n=e.memoizedProps,r=r.ownerDocument||r;t:switch(s){case"title":c=r.getElementsByTagName("title")[0],(!c||c[Na]||c[At]||c.namespaceURI==="http://www.w3.org/2000/svg"||c.hasAttribute("itemprop"))&&(c=r.createElement(s),r.head.insertBefore(c,r.querySelector("head > title"))),Lt(c,s,n),c[At]=e,yt(c),s=c;break e;case"link":var d=yd("link","href",r).get(s+(n.href||""));if(d){for(var g=0;g<d.length;g++)if(c=d[g],c.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&c.getAttribute("rel")===(n.rel==null?null:n.rel)&&c.getAttribute("title")===(n.title==null?null:n.title)&&c.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){d.splice(g,1);break t}}c=r.createElement(s),Lt(c,s,n),r.head.appendChild(c);break;case"meta":if(d=yd("meta","content",r).get(s+(n.content||""))){for(g=0;g<d.length;g++)if(c=d[g],c.getAttribute("content")===(n.content==null?null:""+n.content)&&c.getAttribute("name")===(n.name==null?null:n.name)&&c.getAttribute("property")===(n.property==null?null:n.property)&&c.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&c.getAttribute("charset")===(n.charSet==null?null:n.charSet)){d.splice(g,1);break t}}c=r.createElement(s),Lt(c,s,n),r.head.appendChild(c);break;default:throw Error(S(468,s))}c[At]=e,yt(c),s=c}e.stateNode=s}else vd(r,e.type,e.stateNode);else e.stateNode=pd(r,s,e.memoizedProps);else c!==s?(c===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):c.count--,s===null?vd(r,e.type,e.stateNode):pd(r,s,e.memoizedProps)):s===null&&e.stateNode!==null&&ru(e,e.memoizedProps,n.memoizedProps)}break;case 27:ln(t,e),rn(e),s&512&&(gt||n===null||ii(n,n.return)),n!==null&&s&4&&ru(e,e.memoizedProps,n.memoizedProps);break;case 5:if(ln(t,e),rn(e),s&512&&(gt||n===null||ii(n,n.return)),e.flags&32){r=e.stateNode;try{se(r,"")}catch(M){Xe(e,e.return,M)}}s&4&&e.stateNode!=null&&(r=e.memoizedProps,ru(e,r,n!==null?n.memoizedProps:r)),s&1024&&(uu=!0);break;case 6:if(ln(t,e),rn(e),s&4){if(e.stateNode===null)throw Error(S(162));s=e.memoizedProps,n=e.stateNode;try{n.nodeValue=s}catch(M){Xe(e,e.return,M)}}break;case 3:if(sc=null,r=Bn,Bn=ic(t.containerInfo),ln(t,e),Bn=r,rn(e),s&4&&n!==null&&n.memoizedState.isDehydrated)try{pr(t.containerInfo)}catch(M){Xe(e,e.return,M)}uu&&(uu=!1,Rh(e));break;case 4:s=Bn,Bn=ic(e.stateNode.containerInfo),ln(t,e),rn(e),Bn=s;break;case 12:ln(t,e),rn(e);break;case 13:ln(t,e),rn(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(yu=Qt()),s&4&&(s=e.updateQueue,s!==null&&(e.updateQueue=null,fu(e,s)));break;case 22:r=e.memoizedState!==null;var y=n!==null&&n.memoizedState!==null,_=wi,k=gt;if(wi=_||r,gt=k||y,ln(t,e),gt=k,wi=_,rn(e),s&8192)e:for(t=e.stateNode,t._visibility=r?t._visibility&-2:t._visibility|1,r&&(n===null||y||wi||gt||es(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){y=n=t;try{if(c=y.stateNode,r)d=c.style,typeof d.setProperty=="function"?d.setProperty("display","none","important"):d.display="none";else{g=y.stateNode;var z=y.memoizedProps.style,C=z!=null&&z.hasOwnProperty("display")?z.display:null;g.style.display=C==null||typeof C=="boolean"?"":(""+C).trim()}}catch(M){Xe(y,y.return,M)}}}else if(t.tag===6){if(n===null){y=t;try{y.stateNode.nodeValue=r?"":y.memoizedProps}catch(M){Xe(y,y.return,M)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}s&4&&(s=e.updateQueue,s!==null&&(n=s.retryQueue,n!==null&&(s.retryQueue=null,fu(e,n))));break;case 19:ln(t,e),rn(e),s&4&&(s=e.updateQueue,s!==null&&(e.updateQueue=null,fu(e,s)));break;case 30:break;case 21:break;default:ln(t,e),rn(e)}}function rn(e){var t=e.flags;if(t&2){try{for(var n,s=e.return;s!==null;){if(ph(s)){n=s;break}s=s.return}if(n==null)throw Error(S(160));switch(n.tag){case 27:var r=n.stateNode,c=ou(e);Yo(e,c,r);break;case 5:var d=n.stateNode;n.flags&32&&(se(d,""),n.flags&=-33);var g=ou(e);Yo(e,g,d);break;case 3:case 4:var y=n.stateNode.containerInfo,_=ou(e);cu(e,_,y);break;default:throw Error(S(161))}}catch(k){Xe(e,e.return,k)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Rh(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;Rh(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function ha(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)bh(e,t.alternate,t),t=t.sibling}function es(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:fa(4,t,t.return),es(t);break;case 1:ii(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&gh(t,t.return,n),es(t);break;case 27:or(t.stateNode);case 26:case 5:ii(t,t.return),es(t);break;case 22:t.memoizedState===null&&es(t);break;case 30:es(t);break;default:es(t)}e=e.sibling}}function da(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var s=t.alternate,r=e,c=t,d=c.flags;switch(c.tag){case 0:case 11:case 15:da(r,c,n),$l(4,c);break;case 1:if(da(r,c,n),s=c,r=s.stateNode,typeof r.componentDidMount=="function")try{r.componentDidMount()}catch(_){Xe(s,s.return,_)}if(s=c,r=s.updateQueue,r!==null){var g=s.stateNode;try{var y=r.shared.hiddenCallbacks;if(y!==null)for(r.shared.hiddenCallbacks=null,r=0;r<y.length;r++)la(y[r],g)}catch(_){Xe(s,s.return,_)}}n&&d&64&&dh(c),Fl(c,c.return);break;case 27:yh(c);case 26:case 5:da(r,c,n),n&&s===null&&d&4&&mh(c),Fl(c,c.return);break;case 12:da(r,c,n);break;case 13:da(r,c,n),n&&d&4&&Oh(r,c);break;case 22:c.memoizedState===null&&da(r,c,n),Fl(c,c.return);break;case 30:break;default:da(r,c,n)}t=t.sibling}}function hu(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&Qa(n))}function du(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Qa(e))}function ai(e,t,n,s){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)_h(e,t,n,s),t=t.sibling}function _h(e,t,n,s){var r=t.flags;switch(t.tag){case 0:case 11:case 15:ai(e,t,n,s),r&2048&&$l(9,t);break;case 1:ai(e,t,n,s);break;case 3:ai(e,t,n,s),r&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Qa(e)));break;case 12:if(r&2048){ai(e,t,n,s),e=t.stateNode;try{var c=t.memoizedProps,d=c.id,g=c.onPostCommit;typeof g=="function"&&g(d,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(y){Xe(t,t.return,y)}}else ai(e,t,n,s);break;case 13:ai(e,t,n,s);break;case 23:break;case 22:c=t.stateNode,d=t.alternate,t.memoizedState!==null?c._visibility&2?ai(e,t,n,s):er(e,t):c._visibility&2?ai(e,t,n,s):(c._visibility|=2,zs(e,t,n,s,(t.subtreeFlags&10256)!==0)),r&2048&&hu(d,t);break;case 24:ai(e,t,n,s),r&2048&&du(t.alternate,t);break;default:ai(e,t,n,s)}}function zs(e,t,n,s,r){for(r=r&&(t.subtreeFlags&10256)!==0,t=t.child;t!==null;){var c=e,d=t,g=n,y=s,_=d.flags;switch(d.tag){case 0:case 11:case 15:zs(c,d,g,y,r),$l(8,d);break;case 23:break;case 22:var k=d.stateNode;d.memoizedState!==null?k._visibility&2?zs(c,d,g,y,r):er(c,d):(k._visibility|=2,zs(c,d,g,y,r)),r&&_&2048&&hu(d.alternate,d);break;case 24:zs(c,d,g,y,r),r&&_&2048&&du(d.alternate,d);break;default:zs(c,d,g,y,r)}t=t.sibling}}function er(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,s=t,r=s.flags;switch(s.tag){case 22:er(n,s),r&2048&&hu(s.alternate,s);break;case 24:er(n,s),r&2048&&du(s.alternate,s);break;default:er(n,s)}t=t.sibling}}var tr=8192;function Hs(e){if(e.subtreeFlags&tr)for(e=e.child;e!==null;)Ch(e),e=e.sibling}function Ch(e){switch(e.tag){case 26:Hs(e),e.flags&tr&&e.memoizedState!==null&&Xg(Bn,e.memoizedState,e.memoizedProps);break;case 5:Hs(e);break;case 3:case 4:var t=Bn;Bn=ic(e.stateNode.containerInfo),Hs(e),Bn=t;break;case 22:e.memoizedState===null&&(t=e.alternate,t!==null&&t.memoizedState!==null?(t=tr,tr=16777216,Hs(e),tr=t):Hs(e));break;default:Hs(e)}}function Eh(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function nr(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var s=t[n];Mt=s,wh(s,e)}Eh(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Mh(e),e=e.sibling}function Mh(e){switch(e.tag){case 0:case 11:case 15:nr(e),e.flags&2048&&fa(9,e,e.return);break;case 3:nr(e);break;case 12:nr(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Qo(e)):nr(e);break;default:nr(e)}}function Qo(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var s=t[n];Mt=s,wh(s,e)}Eh(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:fa(8,t,t.return),Qo(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,Qo(t));break;default:Qo(t)}e=e.sibling}}function wh(e,t){for(;Mt!==null;){var n=Mt;switch(n.tag){case 0:case 11:case 15:fa(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var s=n.memoizedState.cachePool.pool;s!=null&&s.refCount++}break;case 24:Qa(n.memoizedState.cache)}if(s=n.child,s!==null)s.return=n,Mt=s;else e:for(n=e;Mt!==null;){s=Mt;var r=s.sibling,c=s.return;if(Sh(s),s===n){Mt=null;break e}if(r!==null){r.return=c,Mt=r;break e}Mt=c}}}var cg={getCacheForType:function(e){var t=Ot(Je),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n}},ug=typeof WeakMap=="function"?WeakMap:Map,He=0,We=null,Me=null,ke=0,Ve=0,on=null,ga=!1,Vs=!1,gu=!1,Ui=0,ft=0,ma=0,ts=0,mu=0,vn=0,Is=0,ir=null,nn=null,pu=!1,yu=0,Po=1/0,Xo=null,pa=null,kt=0,ya=null,Ys=null,Qs=0,vu=0,bu=null,Nh=null,ar=0,Su=null;function cn(){if((He&2)!==0&&ke!==0)return ke&-ke;if(D.T!==null){var e=ia;return e!==0?e:Eu()}return ll()}function Uh(){vn===0&&(vn=(ke&536870912)===0||Se?il():536870912);var e=yn.current;return e!==null&&(e.flags|=32),vn}function un(e,t,n){(e===We&&(Ve===2||Ve===9)||e.cancelPendingCommit!==null)&&(Ps(e,0),va(e,ke,vn,!1)),qi(e,n),((He&2)===0||e!==We)&&(e===We&&((He&2)===0&&(ts|=n),ft===4&&va(e,ke,vn,!1)),si(e))}function xh(e,t,n){if((He&6)!==0)throw Error(S(327));var s=!n&&(t&124)===0&&(t&e.expiredLanes)===0||Bi(e,t),r=s?dg(e,t):Tu(e,t,!0),c=s;do{if(r===0){Vs&&!s&&va(e,t,0,!1);break}else{if(n=e.current.alternate,c&&!fg(n)){r=Tu(e,t,!1),c=!1;continue}if(r===2){if(c=t,e.errorRecoveryDisabledLanes&c)var d=0;else d=e.pendingLanes&-536870913,d=d!==0?d:d&536870912?536870912:0;if(d!==0){t=d;e:{var g=e;r=ir;var y=g.current.memoizedState.isDehydrated;if(y&&(Ps(g,d).flags|=256),d=Tu(g,d,!1),d!==2){if(gu&&!y){g.errorRecoveryDisabledLanes|=c,ts|=c,r=4;break e}c=nn,nn=r,c!==null&&(nn===null?nn=c:nn.push.apply(nn,c))}r=d}if(c=!1,r!==2)continue}}if(r===1){Ps(e,0),va(e,t,0,!0);break}e:{switch(s=e,c=r,c){case 0:case 1:throw Error(S(345));case 4:if((t&4194048)!==t)break;case 6:va(s,t,vn,!ga);break e;case 2:nn=null;break;case 3:case 5:break;default:throw Error(S(329))}if((t&62914560)===t&&(r=yu+300-Qt(),10<r)){if(va(s,t,vn,!ga),Ma(s,0,!0)!==0)break e;s.timeoutHandle=rd(Dh.bind(null,s,n,nn,Xo,pu,t,vn,ts,Is,ga,c,2,-0,0),r);break e}Dh(s,n,nn,Xo,pu,t,vn,ts,Is,ga,c,0,-0,0)}}break}while(!0);si(e)}function Dh(e,t,n,s,r,c,d,g,y,_,k,z,C,M){if(e.timeoutHandle=-1,z=t.subtreeFlags,(z&8192||(z&16785408)===16785408)&&(fr={stylesheets:null,count:0,unsuspend:Pg},Ch(t),z=Kg(),z!==null)){e.cancelPendingCommit=z(zh.bind(null,e,t,c,n,s,r,d,g,y,k,1,C,M)),va(e,c,d,!_);return}zh(e,t,c,n,s,r,d,g,y)}function fg(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var s=0;s<n.length;s++){var r=n[s],c=r.getSnapshot;r=r.value;try{if(!Ht(c(),r))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function va(e,t,n,s){t&=~mu,t&=~ts,e.suspendedLanes|=t,e.pingedLanes&=~t,s&&(e.warmLanes|=t),s=e.expirationTimes;for(var r=t;0<r;){var c=31-et(r),d=1<<c;s[c]=-1,r&=~d}n!==0&&wr(e,n,t)}function Ko(){return(He&6)===0?(sr(0),!1):!0}function Au(){if(Me!==null){if(Ve===0)var e=Me.return;else e=Me,kn=mn=null,l(e),js=null,Zl=0,e=Me;for(;e!==null;)hh(e.alternate,e),e=e.return;Me=null}}function Ps(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,wg(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),Au(),We=e,Me=n=Cn(e.current,null),ke=t,Ve=0,on=null,ga=!1,Vs=Bi(e,t),gu=!1,Is=vn=mu=ts=ma=ft=0,nn=ir=null,pu=!1,(t&8)!==0&&(t|=t&32);var s=e.entangledLanes;if(s!==0)for(e=e.entanglements,s&=t;0<s;){var r=31-et(s),c=1<<r;t|=e[r],s&=~c}return Ui=t,Cs(),n}function kh(e,t){Oe=null,D.H=Lo,t===Pa||t===Us?(t=wo(),Ve=3):t===Co?(t=wo(),Ve=4):Ve=t===$f?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,on=t,Me===null&&(ft=1,zo(e,Wt(t,e.current)))}function Lh(){var e=D.H;return D.H=Lo,e===null?Lo:e}function Bh(){var e=D.A;return D.A=cg,e}function Ou(){ft=4,ga||(ke&4194048)!==ke&&yn.current!==null||(Vs=!0),(ma&134217727)===0&&(ts&134217727)===0||We===null||va(We,ke,vn,!1)}function Tu(e,t,n){var s=He;He|=2;var r=Lh(),c=Bh();(We!==e||ke!==t)&&(Xo=null,Ps(e,t)),t=!1;var d=ft;e:do try{if(Ve!==0&&Me!==null){var g=Me,y=on;switch(Ve){case 8:Au(),d=6;break e;case 3:case 2:case 9:case 6:yn.current===null&&(t=!0);var _=Ve;if(Ve=0,on=null,Xs(e,g,y,_),n&&Vs){d=0;break e}break;default:_=Ve,Ve=0,on=null,Xs(e,g,y,_)}}hg(),d=ft;break}catch(k){kh(e,k)}while(!0);return t&&e.shellSuspendCounter++,kn=mn=null,He=s,D.H=r,D.A=c,Me===null&&(We=null,ke=0,Cs()),d}function hg(){for(;Me!==null;)qh(Me)}function dg(e,t){var n=He;He|=2;var s=Lh(),r=Bh();We!==e||ke!==t?(Xo=null,Po=Qt()+500,Ps(e,t)):Vs=Bi(e,t);e:do try{if(Ve!==0&&Me!==null){t=Me;var c=on;t:switch(Ve){case 1:Ve=0,on=null,Xs(e,t,c,1);break;case 2:case 9:if(Eo(c)){Ve=0,on=null,jh(t);break}t=function(){Ve!==2&&Ve!==9||We!==e||(Ve=7),si(e)},c.then(t,t);break e;case 3:Ve=7;break e;case 4:Ve=5;break e;case 7:Eo(c)?(Ve=0,on=null,jh(t)):(Ve=0,on=null,Xs(e,t,c,7));break;case 5:var d=null;switch(Me.tag){case 26:d=Me.memoizedState;case 5:case 27:var g=Me;if(!d||bd(d)){Ve=0,on=null;var y=g.sibling;if(y!==null)Me=y;else{var _=g.return;_!==null?(Me=_,Zo(_)):Me=null}break t}}Ve=0,on=null,Xs(e,t,c,5);break;case 6:Ve=0,on=null,Xs(e,t,c,6);break;case 8:Au(),ft=6;break e;default:throw Error(S(462))}}gg();break}catch(k){kh(e,k)}while(!0);return kn=mn=null,D.H=s,D.A=r,He=n,Me!==null?0:(We=null,ke=0,Cs(),ft)}function gg(){for(;Me!==null&&!is();)qh(Me)}function qh(e){var t=uh(e.alternate,e,Ui);e.memoizedProps=e.pendingProps,t===null?Zo(e):Me=t}function jh(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=ah(n,t,t.pendingProps,t.type,void 0,ke);break;case 11:t=ah(n,t,t.pendingProps,t.type.render,t.ref,ke);break;case 5:l(t);default:hh(n,t),t=Me=bo(t,Ui),t=uh(n,t,Ui)}e.memoizedProps=e.pendingProps,t===null?Zo(e):Me=t}function Xs(e,t,n,s){kn=mn=null,l(t),js=null,Zl=0;var r=t.return;try{if(ig(e,r,t,n,ke)){ft=1,zo(e,Wt(n,e.current)),Me=null;return}}catch(c){if(r!==null)throw Me=r,c;ft=1,zo(e,Wt(n,e.current)),Me=null;return}t.flags&32768?(Se||s===1?e=!0:Vs||(ke&536870912)!==0?e=!1:(ga=e=!0,(s===2||s===9||s===3||s===6)&&(s=yn.current,s!==null&&s.tag===13&&(s.flags|=16384))),Gh(t,e)):Zo(t)}function Zo(e){var t=e;do{if((t.flags&32768)!==0){Gh(t,ga);return}e=t.return;var n=sg(t.alternate,t,Ui);if(n!==null){Me=n;return}if(t=t.sibling,t!==null){Me=t;return}Me=t=e}while(t!==null);ft===0&&(ft=5)}function Gh(e,t){do{var n=lg(e.alternate,e);if(n!==null){n.flags&=32767,Me=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){Me=e;return}Me=e=n}while(e!==null);ft=6,Me=null}function zh(e,t,n,s,r,c,d,g,y){e.cancelPendingCommit=null;do Jo();while(kt!==0);if((He&6)!==0)throw Error(S(327));if(t!==null){if(t===e.current)throw Error(S(177));if(c=t.lanes|t.childLanes,c|=Ml,Mr(e,n,c,d,g,y),e===We&&(Me=We=null,ke=0),Ys=t,ya=e,Qs=n,vu=c,bu=r,Nh=s,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,vg(Be,function(){return Qh(),null})):(e.callbackNode=null,e.callbackPriority=0),s=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||s){s=D.T,D.T=null,r=j.p,j.p=2,d=He,He|=4;try{rg(e,t,n)}finally{He=d,j.p=r,D.T=s}}kt=1,Hh(),Vh(),Ih()}}function Hh(){if(kt===1){kt=0;var e=ya,t=Ys,n=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||n){n=D.T,D.T=null;var s=j.p;j.p=2;var r=He;He|=4;try{Th(t,e);var c=Lu,d=qt(e.containerInfo),g=c.focusedElem,y=c.selectionRange;if(d!==g&&g&&g.ownerDocument&&_l(g.ownerDocument.documentElement,g)){if(y!==null&&ja(g)){var _=y.start,k=y.end;if(k===void 0&&(k=_),"selectionStart"in g)g.selectionStart=_,g.selectionEnd=Math.min(k,g.value.length);else{var z=g.ownerDocument||document,C=z&&z.defaultView||window;if(C.getSelection){var M=C.getSelection(),ye=g.textContent.length,he=Math.min(y.start,ye),Pe=y.end===void 0?he:Math.min(y.end,ye);!M.extend&&he>Pe&&(d=Pe,Pe=he,he=d);var O=Ts(g,he),b=Ts(g,Pe);if(O&&b&&(M.rangeCount!==1||M.anchorNode!==O.node||M.anchorOffset!==O.offset||M.focusNode!==b.node||M.focusOffset!==b.offset)){var T=z.createRange();T.setStart(O.node,O.offset),M.removeAllRanges(),he>Pe?(M.addRange(T),M.extend(b.node,b.offset)):(T.setEnd(b.node,b.offset),M.addRange(T))}}}}for(z=[],M=g;M=M.parentNode;)M.nodeType===1&&z.push({element:M,left:M.scrollLeft,top:M.scrollTop});for(typeof g.focus=="function"&&g.focus(),g=0;g<z.length;g++){var G=z[g];G.element.scrollLeft=G.left,G.element.scrollTop=G.top}}oc=!!ku,Lu=ku=null}finally{He=r,j.p=s,D.T=n}}e.current=t,kt=2}}function Vh(){if(kt===2){kt=0;var e=ya,t=Ys,n=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||n){n=D.T,D.T=null;var s=j.p;j.p=2;var r=He;He|=4;try{bh(e,t.alternate,t)}finally{He=r,j.p=s,D.T=n}}kt=3}}function Ih(){if(kt===4||kt===3){kt=0,as();var e=ya,t=Ys,n=Qs,s=Nh;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?kt=5:(kt=0,Ys=ya=null,Yh(e,e.pendingLanes));var r=e.pendingLanes;if(r===0&&(pa=null),sl(n),t=t.stateNode,Ie&&typeof Ie.onCommitFiberRoot=="function")try{Ie.onCommitFiberRoot(ki,t,void 0,(t.current.flags&128)===128)}catch{}if(s!==null){t=D.T,r=j.p,j.p=2,D.T=null;try{for(var c=e.onRecoverableError,d=0;d<s.length;d++){var g=s[d];c(g.value,{componentStack:g.stack})}}finally{D.T=t,j.p=r}}(Qs&3)!==0&&Jo(),si(e),r=e.pendingLanes,(n&4194090)!==0&&(r&42)!==0?e===Su?ar++:(ar=0,Su=e):ar=0,sr(0)}}function Yh(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,Qa(t)))}function Jo(e){return Hh(),Vh(),Ih(),Qh()}function Qh(){if(kt!==5)return!1;var e=ya,t=vu;vu=0;var n=sl(Qs),s=D.T,r=j.p;try{j.p=32>n?32:n,D.T=null,n=bu,bu=null;var c=ya,d=Qs;if(kt=0,Ys=ya=null,Qs=0,(He&6)!==0)throw Error(S(331));var g=He;if(He|=4,Mh(c.current),_h(c,c.current,d,n),He=g,sr(0,!1),Ie&&typeof Ie.onPostCommitFiberRoot=="function")try{Ie.onPostCommitFiberRoot(ki,c)}catch{}return!0}finally{j.p=r,D.T=s,Yh(e,t)}}function Ph(e,t,n){t=Wt(n,t),t=$c(e.stateNode,t,2),e=$n(e,t,2),e!==null&&(qi(e,2),si(e))}function Xe(e,t,n){if(e.tag===3)Ph(e,e,n);else for(;t!==null;){if(t.tag===3){Ph(t,e,n);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(pa===null||!pa.has(s))){e=Wt(n,e),n=Jf(2),s=$n(t,n,2),s!==null&&(Wf(n,s,t,e),qi(s,2),si(s));break}}t=t.return}}function Ru(e,t,n){var s=e.pingCache;if(s===null){s=e.pingCache=new ug;var r=new Set;s.set(t,r)}else r=s.get(t),r===void 0&&(r=new Set,s.set(t,r));r.has(n)||(gu=!0,r.add(n),e=mg.bind(null,e,t,n),t.then(e,e))}function mg(e,t,n){var s=e.pingCache;s!==null&&s.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,We===e&&(ke&n)===n&&(ft===4||ft===3&&(ke&62914560)===ke&&300>Qt()-yu?(He&2)===0&&Ps(e,0):mu|=n,Is===ke&&(Is=0)),si(e)}function Xh(e,t){t===0&&(t=wa()),e=Ji(e,t),e!==null&&(qi(e,t),si(e))}function pg(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Xh(e,n)}function yg(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,r=e.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=e.stateNode;break;case 22:s=e.stateNode._retryCache;break;default:throw Error(S(314))}s!==null&&s.delete(t),Xh(e,n)}function vg(e,t){return Yt(e,t)}var Wo=null,Ks=null,_u=!1,$o=!1,Cu=!1,ns=0;function si(e){e!==Ks&&e.next===null&&(Ks===null?Wo=Ks=e:Ks=Ks.next=e),$o=!0,_u||(_u=!0,Sg())}function sr(e,t){if(!Cu&&$o){Cu=!0;do for(var n=!1,s=Wo;s!==null;){if(e!==0){var r=s.pendingLanes;if(r===0)var c=0;else{var d=s.suspendedLanes,g=s.pingedLanes;c=(1<<31-et(42|e)+1)-1,c&=r&~(d&~g),c=c&201326741?c&201326741|1:c?c|2:0}c!==0&&(n=!0,Wh(s,c))}else c=ke,c=Ma(s,s===We?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),(c&3)===0||Bi(s,c)||(n=!0,Wh(s,c));s=s.next}while(n);Cu=!1}}function bg(){Kh()}function Kh(){$o=_u=!1;var e=0;ns!==0&&(Mg()&&(e=ns),ns=0);for(var t=Qt(),n=null,s=Wo;s!==null;){var r=s.next,c=Zh(s,t);c===0?(s.next=null,n===null?Wo=r:n.next=r,r===null&&(Ks=n)):(n=s,(e!==0||(c&3)!==0)&&($o=!0)),s=r}sr(e)}function Zh(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,r=e.expirationTimes,c=e.pendingLanes&-62914561;0<c;){var d=31-et(c),g=1<<d,y=r[d];y===-1?((g&n)===0||(g&s)!==0)&&(r[d]=rs(g,t)):y<=t&&(e.expiredLanes|=g),c&=~g}if(t=We,n=ke,n=Ma(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),s=e.callbackNode,n===0||e===t&&(Ve===2||Ve===9)||e.cancelPendingCommit!==null)return s!==null&&s!==null&&Di(s),e.callbackNode=null,e.callbackPriority=0;if((n&3)===0||Bi(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(s!==null&&Di(s),sl(n)){case 2:case 8:n=ss;break;case 32:n=Be;break;case 268435456:n=tl;break;default:n=Be}return s=Jh.bind(null,e),n=Yt(n,s),e.callbackPriority=t,e.callbackNode=n,t}return s!==null&&s!==null&&Di(s),e.callbackPriority=2,e.callbackNode=null,2}function Jh(e,t){if(kt!==0&&kt!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(Jo()&&e.callbackNode!==n)return null;var s=ke;return s=Ma(e,e===We?s:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),s===0?null:(xh(e,s,t),Zh(e,Qt()),e.callbackNode!=null&&e.callbackNode===n?Jh.bind(null,e):null)}function Wh(e,t){if(Jo())return null;xh(e,t,!0)}function Sg(){Ng(function(){(He&6)!==0?Yt(Ca,bg):Kh()})}function Eu(){return ns===0&&(ns=il()),ns}function $h(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:gs(""+e)}function Fh(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function Ag(e,t,n,s,r){if(t==="submit"&&n&&n.stateNode===r){var c=$h((r[Ut]||null).action),d=s.submitter;d&&(t=(t=d[Ut]||null)?$h(t.formAction):d.getAttribute("formAction"),t!==null&&(c=t,d=null));var g=new bs("action","action",null,s,r);e.push({event:g,listeners:[{instance:null,listener:function(){if(s.defaultPrevented){if(ns!==0){var y=d?Fh(r,d):new FormData(r);Xc(n,{pending:!0,data:y,method:r.method,action:c},null,y)}}else typeof c=="function"&&(g.preventDefault(),y=d?Fh(r,d):new FormData(r),Xc(n,{pending:!0,data:y,method:r.method,action:c},c,y))},currentTarget:r}]})}}for(var Mu=0;Mu<Ki.length;Mu++){var wu=Ki[Mu],Og=wu.toLowerCase(),Tg=wu[0].toUpperCase()+wu.slice(1);vt(Og,"on"+Tg)}vt(Xn,"onAnimationEnd"),vt(_s,"onAnimationIteration"),vt(ho,"onAnimationStart"),vt("dblclick","onDoubleClick"),vt("focusin","onFocus"),vt("focusout","onBlur"),vt(go,"onTransitionRun"),vt(mo,"onTransitionStart"),vt(zc,"onTransitionCancel"),vt(po,"onTransitionEnd"),zn("onMouseEnter",["mouseout","mouseover"]),zn("onMouseLeave",["mouseout","mouseover"]),zn("onPointerEnter",["pointerout","pointerover"]),zn("onPointerLeave",["pointerout","pointerover"]),ri("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ri("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ri("onBeforeInput",["compositionend","keypress","textInput","paste"]),ri("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ri("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ri("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Rg=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(lr));function ed(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var s=e[n],r=s.event;s=s.listeners;e:{var c=void 0;if(t)for(var d=s.length-1;0<=d;d--){var g=s[d],y=g.instance,_=g.currentTarget;if(g=g.listener,y!==c&&r.isPropagationStopped())break e;c=g,r.currentTarget=_;try{c(r)}catch(k){Go(k)}r.currentTarget=null,c=y}else for(d=0;d<s.length;d++){if(g=s[d],y=g.instance,_=g.currentTarget,g=g.listener,y!==c&&r.isPropagationStopped())break e;c=g,r.currentTarget=_;try{c(r)}catch(k){Go(k)}r.currentTarget=null,c=y}}}}function we(e,t){var n=t[os];n===void 0&&(n=t[os]=new Set);var s=e+"__bubble";n.has(s)||(td(t,e,2,!1),n.add(s))}function Nu(e,t,n){var s=0;t&&(s|=4),td(n,e,s,t)}var Fo="_reactListening"+Math.random().toString(36).slice(2);function Uu(e){if(!e[Fo]){e[Fo]=!0,ge.forEach(function(n){n!=="selectionchange"&&(Rg.has(n)||Nu(n,!1,e),Nu(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Fo]||(t[Fo]=!0,Nu("selectionchange",!1,t))}}function td(e,t,n,s){switch(_d(t)){case 2:var r=Wg;break;case 8:r=$g;break;default:r=Qu}n=r.bind(null,t,n,e),r=void 0,!Yn||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(r=!0),s?r!==void 0?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):r!==void 0?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function xu(e,t,n,s,r){var c=s;if((t&1)===0&&(t&2)===0&&s!==null)e:for(;;){if(s===null)return;var d=s.tag;if(d===3||d===4){var g=s.stateNode.containerInfo;if(g===r)break;if(d===4)for(d=s.return;d!==null;){var y=d.tag;if((y===3||y===4)&&d.stateNode.containerInfo===r)return;d=d.return}for(;g!==null;){if(d=On(g),d===null)return;if(y=d.tag,y===5||y===6||y===26||y===27){s=c=d;continue e}g=g.parentNode}}s=s.return}pl(function(){var _=c,k=Ua(n),z=[];e:{var C=yo.get(e);if(C!==void 0){var M=bs,ye=e;switch(e){case"keypress":if(Da(n)===0)break e;case"keydown":case"keyup":M=Nc;break;case"focusin":ye="focus",M=bl;break;case"focusout":ye="blur",M=bl;break;case"beforeblur":case"afterblur":M=bl;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":M=vl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":M=As;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":M=Xr;break;case Xn:case _s:case ho:M=Cc;break;case po:M=Dc;break;case"scroll":case"scrollend":M=Oc;break;case"wheel":M=Kr;break;case"copy":case"cut":case"paste":M=zr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":M=Pr;break;case"toggle":case"beforetoggle":M=Sl}var he=(t&4)!==0,Pe=!he&&(e==="scroll"||e==="scrollend"),O=he?C!==null?C+"Capture":null:C;he=[];for(var b=_,T;b!==null;){var G=b;if(T=G.stateNode,G=G.tag,G!==5&&G!==26&&G!==27||T===null||O===null||(G=In(b,O),G!=null&&he.push(rr(b,G,T))),Pe)break;b=b.return}0<he.length&&(C=new M(C,ye,null,n,k),z.push({event:C,listeners:he}))}}if((t&7)===0){e:{if(C=e==="mouseover"||e==="pointerover",M=e==="mouseout"||e==="pointerout",C&&n!==ms&&(ye=n.relatedTarget||n.fromElement)&&(On(ye)||ye[ji]))break e;if((M||C)&&(C=k.window===k?k:(C=k.ownerDocument)?C.defaultView||C.parentWindow:window,M?(ye=n.relatedTarget||n.toElement,M=_,ye=ye?On(ye):null,ye!==null&&(Pe=X(ye),he=ye.tag,ye!==Pe||he!==5&&he!==27&&he!==6)&&(ye=null)):(M=null,ye=_),M!==ye)){if(he=vl,G="onMouseLeave",O="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(he=Pr,G="onPointerLeave",O="onPointerEnter",b="pointer"),Pe=M==null?C:Gn(M),T=ye==null?C:Gn(ye),C=new he(G,b+"leave",M,n,k),C.target=Pe,C.relatedTarget=T,G=null,On(k)===_&&(he=new he(O,b+"enter",ye,n,k),he.target=T,he.relatedTarget=Pe,G=he),Pe=G,M&&ye)t:{for(he=M,O=ye,b=0,T=he;T;T=Zs(T))b++;for(T=0,G=O;G;G=Zs(G))T++;for(;0<b-T;)he=Zs(he),b--;for(;0<T-b;)O=Zs(O),T--;for(;b--;){if(he===O||O!==null&&he===O.alternate)break t;he=Zs(he),O=Zs(O)}he=null}else he=null;M!==null&&nd(z,C,M,he,!1),ye!==null&&Pe!==null&&nd(z,Pe,ye,he,!0)}}e:{if(C=_?Gn(_):window,M=C.nodeName&&C.nodeName.toLowerCase(),M==="select"||M==="input"&&C.type==="file")var ie=ao;else if(no(C))if(so)ie=Gc;else{ie=ro;var Ee=lo}else M=C.nodeName,!M||M.toLowerCase()!=="input"||C.type!=="checkbox"&&C.type!=="radio"?_&&ds(_.elementType)&&(ie=ao):ie=oo;if(ie&&(ie=ie(e,_))){Al(z,ie,n,k);break e}Ee&&Ee(e,C,_),e==="focusout"&&_&&C.type==="number"&&_.memoizedProps.value!=null&&gl(C,"number",C.value)}switch(Ee=_?Gn(_):window,e){case"focusin":(no(Ee)||Ee.contentEditable==="true")&&(Xi=Ee,El=_,gi=null);break;case"focusout":gi=El=Xi=null;break;case"mousedown":Rs=!0;break;case"contextmenu":case"mouseup":case"dragend":Rs=!1,uo(z,n,k);break;case"selectionchange":if(Cl)break;case"keydown":case"keyup":uo(z,n,k)}var oe;if(fi)e:{switch(e){case"compositionstart":var de="onCompositionStart";break e;case"compositionend":de="onCompositionEnd";break e;case"compositionupdate":de="onCompositionUpdate";break e}de=void 0}else hi?Fr(e,n)&&(de="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(de="onCompositionStart");de&&(Jr&&n.locale!=="ko"&&(hi||de!=="onCompositionStart"?de==="onCompositionEnd"&&hi&&(oe=ui()):(Rn=k,ps="value"in Rn?Rn.value:Rn.textContent,hi=!0)),Ee=ec(_,de),0<Ee.length&&(de=new Vr(de,e,null,n,k),z.push({event:de,listeners:Ee}),oe?de.data=oe:(oe=eo(n),oe!==null&&(de.data=oe)))),(oe=Bc?qc(e,n):to(e,n))&&(de=ec(_,"onBeforeInput"),0<de.length&&(Ee=new Vr("onBeforeInput","beforeinput",null,n,k),z.push({event:Ee,listeners:de}),Ee.data=oe)),Ag(z,e,_,n,k)}ed(z,t)})}function rr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ec(e,t){for(var n=t+"Capture",s=[];e!==null;){var r=e,c=r.stateNode;if(r=r.tag,r!==5&&r!==26&&r!==27||c===null||(r=In(e,n),r!=null&&s.unshift(rr(e,r,c)),r=In(e,t),r!=null&&s.push(rr(e,r,c))),e.tag===3)return s;e=e.return}return[]}function Zs(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function nd(e,t,n,s,r){for(var c=t._reactName,d=[];n!==null&&n!==s;){var g=n,y=g.alternate,_=g.stateNode;if(g=g.tag,y!==null&&y===s)break;g!==5&&g!==26&&g!==27||_===null||(y=_,r?(_=In(n,c),_!=null&&d.unshift(rr(n,_,y))):r||(_=In(n,c),_!=null&&d.push(rr(n,_,y)))),n=n.return}d.length!==0&&e.push({event:t,listeners:d})}var _g=/\r\n?/g,Cg=/\u0000|\uFFFD/g;function id(e){return(typeof e=="string"?e:""+e).replace(_g,`
`).replace(Cg,"")}function ad(e,t){return t=id(t),id(e)===t}function tc(){}function Qe(e,t,n,s,r,c){switch(n){case"children":typeof s=="string"?t==="body"||t==="textarea"&&s===""||se(e,s):(typeof s=="number"||typeof s=="bigint")&&t!=="body"&&se(e,""+s);break;case"className":zi(e,"class",s);break;case"tabIndex":zi(e,"tabindex",s);break;case"dir":case"role":case"viewBox":case"width":case"height":zi(e,n,s);break;case"style":qr(e,s,c);break;case"data":if(t!=="object"){zi(e,"data",s);break}case"src":case"href":if(s===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(s==null||typeof s=="function"||typeof s=="symbol"||typeof s=="boolean"){e.removeAttribute(n);break}s=gs(""+s),e.setAttribute(n,s);break;case"action":case"formAction":if(typeof s=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof c=="function"&&(n==="formAction"?(t!=="input"&&Qe(e,t,"name",r.name,r,null),Qe(e,t,"formEncType",r.formEncType,r,null),Qe(e,t,"formMethod",r.formMethod,r,null),Qe(e,t,"formTarget",r.formTarget,r,null)):(Qe(e,t,"encType",r.encType,r,null),Qe(e,t,"method",r.method,r,null),Qe(e,t,"target",r.target,r,null)));if(s==null||typeof s=="symbol"||typeof s=="boolean"){e.removeAttribute(n);break}s=gs(""+s),e.setAttribute(n,s);break;case"onClick":s!=null&&(e.onclick=tc);break;case"onScroll":s!=null&&we("scroll",e);break;case"onScrollEnd":s!=null&&we("scrollend",e);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(S(61));if(n=s.__html,n!=null){if(r.children!=null)throw Error(S(60));e.innerHTML=n}}break;case"multiple":e.multiple=s&&typeof s!="function"&&typeof s!="symbol";break;case"muted":e.muted=s&&typeof s!="function"&&typeof s!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(s==null||typeof s=="function"||typeof s=="boolean"||typeof s=="symbol"){e.removeAttribute("xlink:href");break}n=gs(""+s),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":s!=null&&typeof s!="function"&&typeof s!="symbol"?e.setAttribute(n,""+s):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":s&&typeof s!="function"&&typeof s!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":s===!0?e.setAttribute(n,""):s!==!1&&s!=null&&typeof s!="function"&&typeof s!="symbol"?e.setAttribute(n,s):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":s!=null&&typeof s!="function"&&typeof s!="symbol"&&!isNaN(s)&&1<=s?e.setAttribute(n,s):e.removeAttribute(n);break;case"rowSpan":case"start":s==null||typeof s=="function"||typeof s=="symbol"||isNaN(s)?e.removeAttribute(n):e.setAttribute(n,s);break;case"popover":we("beforetoggle",e),we("toggle",e),oi(e,"popover",s);break;case"xlinkActuate":Tn(e,"http://www.w3.org/1999/xlink","xlink:actuate",s);break;case"xlinkArcrole":Tn(e,"http://www.w3.org/1999/xlink","xlink:arcrole",s);break;case"xlinkRole":Tn(e,"http://www.w3.org/1999/xlink","xlink:role",s);break;case"xlinkShow":Tn(e,"http://www.w3.org/1999/xlink","xlink:show",s);break;case"xlinkTitle":Tn(e,"http://www.w3.org/1999/xlink","xlink:title",s);break;case"xlinkType":Tn(e,"http://www.w3.org/1999/xlink","xlink:type",s);break;case"xmlBase":Tn(e,"http://www.w3.org/XML/1998/namespace","xml:base",s);break;case"xmlLang":Tn(e,"http://www.w3.org/XML/1998/namespace","xml:lang",s);break;case"xmlSpace":Tn(e,"http://www.w3.org/XML/1998/namespace","xml:space",s);break;case"is":oi(e,"is",s);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=Ac.get(n)||n,oi(e,n,s))}}function Du(e,t,n,s,r,c){switch(n){case"style":qr(e,s,c);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(S(61));if(n=s.__html,n!=null){if(r.children!=null)throw Error(S(60));e.innerHTML=n}}break;case"children":typeof s=="string"?se(e,s):(typeof s=="number"||typeof s=="bigint")&&se(e,""+s);break;case"onScroll":s!=null&&we("scroll",e);break;case"onScrollEnd":s!=null&&we("scrollend",e);break;case"onClick":s!=null&&(e.onclick=tc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!xr.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(r=n.endsWith("Capture"),t=n.slice(2,r?n.length-7:void 0),c=e[Ut]||null,c=c!=null?c[n]:null,typeof c=="function"&&e.removeEventListener(t,c,r),typeof s=="function")){typeof c!="function"&&c!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,s,r);break e}n in e?e[n]=s:s===!0?e.setAttribute(n,""):oi(e,n,s)}}}function Lt(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":we("error",e),we("load",e);var s=!1,r=!1,c;for(c in n)if(n.hasOwnProperty(c)){var d=n[c];if(d!=null)switch(c){case"src":s=!0;break;case"srcSet":r=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(S(137,t));default:Qe(e,t,c,d,n,null)}}r&&Qe(e,t,"srcSet",n.srcSet,n,null),s&&Qe(e,t,"src",n.src,n,null);return;case"input":we("invalid",e);var g=c=d=r=null,y=null,_=null;for(s in n)if(n.hasOwnProperty(s)){var k=n[s];if(k!=null)switch(s){case"name":r=k;break;case"type":d=k;break;case"checked":y=k;break;case"defaultChecked":_=k;break;case"value":c=k;break;case"defaultValue":g=k;break;case"children":case"dangerouslySetInnerHTML":if(k!=null)throw Error(S(137,t));break;default:Qe(e,t,s,k,n,null)}}hs(e,c,g,y,_,d,r,!1),fs(e);return;case"select":we("invalid",e),s=d=c=null;for(r in n)if(n.hasOwnProperty(r)&&(g=n[r],g!=null))switch(r){case"value":c=g;break;case"defaultValue":d=g;break;case"multiple":s=g;default:Qe(e,t,r,g,n,null)}t=c,n=d,e.multiple=!!s,t!=null?Hn(e,!!s,t,!1):n!=null&&Hn(e,!!s,n,!0);return;case"textarea":we("invalid",e),c=r=s=null;for(d in n)if(n.hasOwnProperty(d)&&(g=n[d],g!=null))switch(d){case"value":s=g;break;case"defaultValue":r=g;break;case"children":c=g;break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(S(91));break;default:Qe(e,t,d,g,n,null)}dt(e,s,r,c),fs(e);return;case"option":for(y in n)if(n.hasOwnProperty(y)&&(s=n[y],s!=null))switch(y){case"selected":e.selected=s&&typeof s!="function"&&typeof s!="symbol";break;default:Qe(e,t,y,s,n,null)}return;case"dialog":we("beforetoggle",e),we("toggle",e),we("cancel",e),we("close",e);break;case"iframe":case"object":we("load",e);break;case"video":case"audio":for(s=0;s<lr.length;s++)we(lr[s],e);break;case"image":we("error",e),we("load",e);break;case"details":we("toggle",e);break;case"embed":case"source":case"link":we("error",e),we("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(_ in n)if(n.hasOwnProperty(_)&&(s=n[_],s!=null))switch(_){case"children":case"dangerouslySetInnerHTML":throw Error(S(137,t));default:Qe(e,t,_,s,n,null)}return;default:if(ds(t)){for(k in n)n.hasOwnProperty(k)&&(s=n[k],s!==void 0&&Du(e,t,k,s,n,void 0));return}}for(g in n)n.hasOwnProperty(g)&&(s=n[g],s!=null&&Qe(e,t,g,s,n,null))}function Eg(e,t,n,s){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var r=null,c=null,d=null,g=null,y=null,_=null,k=null;for(M in n){var z=n[M];if(n.hasOwnProperty(M)&&z!=null)switch(M){case"checked":break;case"value":break;case"defaultValue":y=z;default:s.hasOwnProperty(M)||Qe(e,t,M,null,s,z)}}for(var C in s){var M=s[C];if(z=n[C],s.hasOwnProperty(C)&&(M!=null||z!=null))switch(C){case"type":c=M;break;case"name":r=M;break;case"checked":_=M;break;case"defaultChecked":k=M;break;case"value":d=M;break;case"defaultValue":g=M;break;case"children":case"dangerouslySetInnerHTML":if(M!=null)throw Error(S(137,t));break;default:M!==z&&Qe(e,t,C,M,s,z)}}dl(e,d,g,y,_,k,c,r);return;case"select":M=d=g=C=null;for(c in n)if(y=n[c],n.hasOwnProperty(c)&&y!=null)switch(c){case"value":break;case"multiple":M=y;default:s.hasOwnProperty(c)||Qe(e,t,c,null,s,y)}for(r in s)if(c=s[r],y=n[r],s.hasOwnProperty(r)&&(c!=null||y!=null))switch(r){case"value":C=c;break;case"defaultValue":g=c;break;case"multiple":d=c;default:c!==y&&Qe(e,t,r,c,s,y)}t=g,n=d,s=M,C!=null?Hn(e,!!n,C,!1):!!s!=!!n&&(t!=null?Hn(e,!!n,t,!0):Hn(e,!!n,n?[]:"",!1));return;case"textarea":M=C=null;for(g in n)if(r=n[g],n.hasOwnProperty(g)&&r!=null&&!s.hasOwnProperty(g))switch(g){case"value":break;case"children":break;default:Qe(e,t,g,null,s,r)}for(d in s)if(r=s[d],c=n[d],s.hasOwnProperty(d)&&(r!=null||c!=null))switch(d){case"value":C=r;break;case"defaultValue":M=r;break;case"children":break;case"dangerouslySetInnerHTML":if(r!=null)throw Error(S(91));break;default:r!==c&&Qe(e,t,d,r,s,c)}Lr(e,C,M);return;case"option":for(var ye in n)if(C=n[ye],n.hasOwnProperty(ye)&&C!=null&&!s.hasOwnProperty(ye))switch(ye){case"selected":e.selected=!1;break;default:Qe(e,t,ye,null,s,C)}for(y in s)if(C=s[y],M=n[y],s.hasOwnProperty(y)&&C!==M&&(C!=null||M!=null))switch(y){case"selected":e.selected=C&&typeof C!="function"&&typeof C!="symbol";break;default:Qe(e,t,y,C,s,M)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var he in n)C=n[he],n.hasOwnProperty(he)&&C!=null&&!s.hasOwnProperty(he)&&Qe(e,t,he,null,s,C);for(_ in s)if(C=s[_],M=n[_],s.hasOwnProperty(_)&&C!==M&&(C!=null||M!=null))switch(_){case"children":case"dangerouslySetInnerHTML":if(C!=null)throw Error(S(137,t));break;default:Qe(e,t,_,C,s,M)}return;default:if(ds(t)){for(var Pe in n)C=n[Pe],n.hasOwnProperty(Pe)&&C!==void 0&&!s.hasOwnProperty(Pe)&&Du(e,t,Pe,void 0,s,C);for(k in s)C=s[k],M=n[k],!s.hasOwnProperty(k)||C===M||C===void 0&&M===void 0||Du(e,t,k,C,s,M);return}}for(var O in n)C=n[O],n.hasOwnProperty(O)&&C!=null&&!s.hasOwnProperty(O)&&Qe(e,t,O,null,s,C);for(z in s)C=s[z],M=n[z],!s.hasOwnProperty(z)||C===M||C==null&&M==null||Qe(e,t,z,C,s,M)}var ku=null,Lu=null;function nc(e){return e.nodeType===9?e:e.ownerDocument}function sd(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ld(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Bu(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var qu=null;function Mg(){var e=window.event;return e&&e.type==="popstate"?e===qu?!1:(qu=e,!0):(qu=null,!1)}var rd=typeof setTimeout=="function"?setTimeout:void 0,wg=typeof clearTimeout=="function"?clearTimeout:void 0,od=typeof Promise=="function"?Promise:void 0,Ng=typeof queueMicrotask=="function"?queueMicrotask:typeof od<"u"?function(e){return od.resolve(null).then(e).catch(Ug)}:rd;function Ug(e){setTimeout(function(){throw e})}function ba(e){return e==="head"}function cd(e,t){var n=t,s=0,r=0;do{var c=n.nextSibling;if(e.removeChild(n),c&&c.nodeType===8)if(n=c.data,n==="/$"){if(0<s&&8>s){n=s;var d=e.ownerDocument;if(n&1&&or(d.documentElement),n&2&&or(d.body),n&4)for(n=d.head,or(n),d=n.firstChild;d;){var g=d.nextSibling,y=d.nodeName;d[Na]||y==="SCRIPT"||y==="STYLE"||y==="LINK"&&d.rel.toLowerCase()==="stylesheet"||n.removeChild(d),d=g}}if(r===0){e.removeChild(c),pr(t);return}r--}else n==="$"||n==="$?"||n==="$!"?r++:s=n.charCodeAt(0)-48;else s=0;n=c}while(n);pr(t)}function ju(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":ju(n),ol(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function xg(e,t,n,s){for(;e.nodeType===1;){var r=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!s&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(s){if(!e[Na])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(c=e.getAttribute("rel"),c==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(c!==r.rel||e.getAttribute("href")!==(r.href==null||r.href===""?null:r.href)||e.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin)||e.getAttribute("title")!==(r.title==null?null:r.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(c=e.getAttribute("src"),(c!==(r.src==null?null:r.src)||e.getAttribute("type")!==(r.type==null?null:r.type)||e.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin))&&c&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var c=r.name==null?null:""+r.name;if(r.type==="hidden"&&e.getAttribute("name")===c)return e}else return e;if(e=qn(e.nextSibling),e===null)break}return null}function Dg(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=qn(e.nextSibling),e===null))return null;return e}function Gu(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState==="complete"}function kg(e,t){var n=e.ownerDocument;if(e.data!=="$?"||n.readyState==="complete")t();else{var s=function(){t(),n.removeEventListener("DOMContentLoaded",s)};n.addEventListener("DOMContentLoaded",s),e._reactRetry=s}}function qn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="F!"||t==="F")break;if(t==="/$")return null}}return e}var zu=null;function ud(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}function fd(e,t,n){switch(t=nc(n),e){case"html":if(e=t.documentElement,!e)throw Error(S(452));return e;case"head":if(e=t.head,!e)throw Error(S(453));return e;case"body":if(e=t.body,!e)throw Error(S(454));return e;default:throw Error(S(451))}}function or(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);ol(e)}var bn=new Map,hd=new Set;function ic(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var xi=j.d;j.d={f:Lg,r:Bg,D:qg,C:jg,L:Gg,m:zg,X:Vg,S:Hg,M:Ig};function Lg(){var e=xi.f(),t=Ko();return e||t}function Bg(e){var t=li(e);t!==null&&t.tag===5&&t.type==="form"?xf(t):xi.r(e)}var Js=typeof document>"u"?null:document;function dd(e,t,n){var s=Js;if(s&&typeof t=="string"&&t){var r=Kt(t);r='link[rel="'+e+'"][href="'+r+'"]',typeof n=="string"&&(r+='[crossorigin="'+n+'"]'),hd.has(r)||(hd.add(r),e={rel:e,crossOrigin:n,href:t},s.querySelector(r)===null&&(t=s.createElement("link"),Lt(t,"link",e),yt(t),s.head.appendChild(t)))}}function qg(e){xi.D(e),dd("dns-prefetch",e,null)}function jg(e,t){xi.C(e,t),dd("preconnect",e,t)}function Gg(e,t,n){xi.L(e,t,n);var s=Js;if(s&&e&&t){var r='link[rel="preload"][as="'+Kt(t)+'"]';t==="image"&&n&&n.imageSrcSet?(r+='[imagesrcset="'+Kt(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(r+='[imagesizes="'+Kt(n.imageSizes)+'"]')):r+='[href="'+Kt(e)+'"]';var c=r;switch(t){case"style":c=Ws(e);break;case"script":c=$s(e)}bn.has(c)||(e=V({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),bn.set(c,e),s.querySelector(r)!==null||t==="style"&&s.querySelector(cr(c))||t==="script"&&s.querySelector(ur(c))||(t=s.createElement("link"),Lt(t,"link",e),yt(t),s.head.appendChild(t)))}}function zg(e,t){xi.m(e,t);var n=Js;if(n&&e){var s=t&&typeof t.as=="string"?t.as:"script",r='link[rel="modulepreload"][as="'+Kt(s)+'"][href="'+Kt(e)+'"]',c=r;switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":c=$s(e)}if(!bn.has(c)&&(e=V({rel:"modulepreload",href:e},t),bn.set(c,e),n.querySelector(r)===null)){switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(ur(c)))return}s=n.createElement("link"),Lt(s,"link",e),yt(s),n.head.appendChild(s)}}}function Hg(e,t,n){xi.S(e,t,n);var s=Js;if(s&&e){var r=Gi(s).hoistableStyles,c=Ws(e);t=t||"default";var d=r.get(c);if(!d){var g={loading:0,preload:null};if(d=s.querySelector(cr(c)))g.loading=5;else{e=V({rel:"stylesheet",href:e,"data-precedence":t},n),(n=bn.get(c))&&Hu(e,n);var y=d=s.createElement("link");yt(y),Lt(y,"link",e),y._p=new Promise(function(_,k){y.onload=_,y.onerror=k}),y.addEventListener("load",function(){g.loading|=1}),y.addEventListener("error",function(){g.loading|=2}),g.loading|=4,ac(d,t,s)}d={type:"stylesheet",instance:d,count:1,state:g},r.set(c,d)}}}function Vg(e,t){xi.X(e,t);var n=Js;if(n&&e){var s=Gi(n).hoistableScripts,r=$s(e),c=s.get(r);c||(c=n.querySelector(ur(r)),c||(e=V({src:e,async:!0},t),(t=bn.get(r))&&Vu(e,t),c=n.createElement("script"),yt(c),Lt(c,"link",e),n.head.appendChild(c)),c={type:"script",instance:c,count:1,state:null},s.set(r,c))}}function Ig(e,t){xi.M(e,t);var n=Js;if(n&&e){var s=Gi(n).hoistableScripts,r=$s(e),c=s.get(r);c||(c=n.querySelector(ur(r)),c||(e=V({src:e,async:!0,type:"module"},t),(t=bn.get(r))&&Vu(e,t),c=n.createElement("script"),yt(c),Lt(c,"link",e),n.head.appendChild(c)),c={type:"script",instance:c,count:1,state:null},s.set(r,c))}}function gd(e,t,n,s){var r=(r=me.current)?ic(r):null;if(!r)throw Error(S(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=Ws(n.href),n=Gi(r).hoistableStyles,s=n.get(t),s||(s={type:"style",instance:null,count:0,state:null},n.set(t,s)),s):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=Ws(n.href);var c=Gi(r).hoistableStyles,d=c.get(e);if(d||(r=r.ownerDocument||r,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},c.set(e,d),(c=r.querySelector(cr(e)))&&!c._p&&(d.instance=c,d.state.loading=5),bn.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},bn.set(e,n),c||Yg(r,e,n,d.state))),t&&s===null)throw Error(S(528,""));return d}if(t&&s!==null)throw Error(S(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=$s(n),n=Gi(r).hoistableScripts,s=n.get(t),s||(s={type:"script",instance:null,count:0,state:null},n.set(t,s)),s):{type:"void",instance:null,count:0,state:null};default:throw Error(S(444,e))}}function Ws(e){return'href="'+Kt(e)+'"'}function cr(e){return'link[rel="stylesheet"]['+e+"]"}function md(e){return V({},e,{"data-precedence":e.precedence,precedence:null})}function Yg(e,t,n,s){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?s.loading=1:(t=e.createElement("link"),s.preload=t,t.addEventListener("load",function(){return s.loading|=1}),t.addEventListener("error",function(){return s.loading|=2}),Lt(t,"link",n),yt(t),e.head.appendChild(t))}function $s(e){return'[src="'+Kt(e)+'"]'}function ur(e){return"script[async]"+e}function pd(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var s=e.querySelector('style[data-href~="'+Kt(n.href)+'"]');if(s)return t.instance=s,yt(s),s;var r=V({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return s=(e.ownerDocument||e).createElement("style"),yt(s),Lt(s,"style",r),ac(s,n.precedence,e),t.instance=s;case"stylesheet":r=Ws(n.href);var c=e.querySelector(cr(r));if(c)return t.state.loading|=4,t.instance=c,yt(c),c;s=md(n),(r=bn.get(r))&&Hu(s,r),c=(e.ownerDocument||e).createElement("link"),yt(c);var d=c;return d._p=new Promise(function(g,y){d.onload=g,d.onerror=y}),Lt(c,"link",s),t.state.loading|=4,ac(c,n.precedence,e),t.instance=c;case"script":return c=$s(n.src),(r=e.querySelector(ur(c)))?(t.instance=r,yt(r),r):(s=n,(r=bn.get(c))&&(s=V({},n),Vu(s,r)),e=e.ownerDocument||e,r=e.createElement("script"),yt(r),Lt(r,"link",s),e.head.appendChild(r),t.instance=r);case"void":return null;default:throw Error(S(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(s=t.instance,t.state.loading|=4,ac(s,n.precedence,e));return t.instance}function ac(e,t,n){for(var s=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),r=s.length?s[s.length-1]:null,c=r,d=0;d<s.length;d++){var g=s[d];if(g.dataset.precedence===t)c=g;else if(c!==r)break}c?c.parentNode.insertBefore(e,c.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function Hu(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Vu(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var sc=null;function yd(e,t,n){if(sc===null){var s=new Map,r=sc=new Map;r.set(n,s)}else r=sc,s=r.get(n),s||(s=new Map,r.set(n,s));if(s.has(e))return s;for(s.set(e,null),n=n.getElementsByTagName(e),r=0;r<n.length;r++){var c=n[r];if(!(c[Na]||c[At]||e==="link"&&c.getAttribute("rel")==="stylesheet")&&c.namespaceURI!=="http://www.w3.org/2000/svg"){var d=c.getAttribute(t)||"";d=e+d;var g=s.get(d);g?g.push(c):s.set(d,[c])}}return s}function vd(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function Qg(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function bd(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}var fr=null;function Pg(){}function Xg(e,t,n){if(fr===null)throw Error(S(475));var s=fr;if(t.type==="stylesheet"&&(typeof n.media!="string"||matchMedia(n.media).matches!==!1)&&(t.state.loading&4)===0){if(t.instance===null){var r=Ws(n.href),c=e.querySelector(cr(r));if(c){e=c._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(s.count++,s=lc.bind(s),e.then(s,s)),t.state.loading|=4,t.instance=c,yt(c);return}c=e.ownerDocument||e,n=md(n),(r=bn.get(r))&&Hu(n,r),c=c.createElement("link"),yt(c);var d=c;d._p=new Promise(function(g,y){d.onload=g,d.onerror=y}),Lt(c,"link",n),t.instance=c}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(t,e),(e=t.state.preload)&&(t.state.loading&3)===0&&(s.count++,t=lc.bind(s),e.addEventListener("load",t),e.addEventListener("error",t))}}function Kg(){if(fr===null)throw Error(S(475));var e=fr;return e.stylesheets&&e.count===0&&Iu(e,e.stylesheets),0<e.count?function(t){var n=setTimeout(function(){if(e.stylesheets&&Iu(e,e.stylesheets),e.unsuspend){var s=e.unsuspend;e.unsuspend=null,s()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}function lc(){if(this.count--,this.count===0){if(this.stylesheets)Iu(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var rc=null;function Iu(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,rc=new Map,t.forEach(Zg,e),rc=null,lc.call(e))}function Zg(e,t){if(!(t.state.loading&4)){var n=rc.get(e);if(n)var s=n.get(null);else{n=new Map,rc.set(e,n);for(var r=e.querySelectorAll("link[data-precedence],style[data-precedence]"),c=0;c<r.length;c++){var d=r[c];(d.nodeName==="LINK"||d.getAttribute("media")!=="not all")&&(n.set(d.dataset.precedence,d),s=d)}s&&n.set(null,s)}r=t.instance,d=r.getAttribute("data-precedence"),c=n.get(d)||s,c===s&&n.set(null,r),n.set(d,r),this.count++,s=lc.bind(this),r.addEventListener("load",s),r.addEventListener("error",s),c?c.parentNode.insertBefore(r,c.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(r,e.firstChild)),t.state.loading|=4}}var hr={$$typeof:$e,Provider:null,Consumer:null,_currentValue:le,_currentValue2:le,_threadCount:0};function Jg(e,t,n,s,r,c,d,g){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=pt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pt(0),this.hiddenUpdates=pt(null),this.identifierPrefix=s,this.onUncaughtError=r,this.onCaughtError=c,this.onRecoverableError=d,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=g,this.incompleteTransitions=new Map}function Sd(e,t,n,s,r,c,d,g,y,_,k,z){return e=new Jg(e,t,n,d,g,y,_,z),t=1,c===!0&&(t|=24),c=Vt(3,null,null,t),e.current=c,c.stateNode=e,t=Zn(),t.refCount++,e.pooledCache=t,t.refCount++,c.memoizedState={element:s,isDehydrated:n,cache:t},xs(c),e}function Ad(e){return e?(e=vi,e):vi}function Od(e,t,n,s,r,c){r=Ad(r),s.context===null?s.context=r:s.pendingContext=r,s=Wn(t),s.payload={element:n},c=c===void 0?null:c,c!==null&&(s.callback=c),n=$n(e,s,t),n!==null&&(un(n,e,t),Za(n,e,t))}function Td(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Yu(e,t){Td(e,t),(e=e.alternate)&&Td(e,t)}function Rd(e){if(e.tag===13){var t=Ji(e,67108864);t!==null&&un(t,e,67108864),Yu(e,67108864)}}var oc=!0;function Wg(e,t,n,s){var r=D.T;D.T=null;var c=j.p;try{j.p=2,Qu(e,t,n,s)}finally{j.p=c,D.T=r}}function $g(e,t,n,s){var r=D.T;D.T=null;var c=j.p;try{j.p=8,Qu(e,t,n,s)}finally{j.p=c,D.T=r}}function Qu(e,t,n,s){if(oc){var r=Pu(s);if(r===null)xu(e,t,s,cc,n),Cd(e,s);else if(em(r,e,t,n,s))s.stopPropagation();else if(Cd(e,s),t&4&&-1<Fg.indexOf(e)){for(;r!==null;){var c=li(r);if(c!==null)switch(c.tag){case 3:if(c=c.stateNode,c.current.memoizedState.isDehydrated){var d=Sn(c.pendingLanes);if(d!==0){var g=c;for(g.pendingLanes|=2,g.entangledLanes|=2;d;){var y=1<<31-et(d);g.entanglements[1]|=y,d&=~y}si(c),(He&6)===0&&(Po=Qt()+500,sr(0))}}break;case 13:g=Ji(c,2),g!==null&&un(g,c,2),Ko(),Yu(c,2)}if(c=Pu(s),c===null&&xu(e,t,s,cc,n),c===r)break;r=c}r!==null&&s.stopPropagation()}else xu(e,t,s,null,n)}}function Pu(e){return e=Ua(e),Xu(e)}var cc=null;function Xu(e){if(cc=null,e=On(e),e!==null){var t=X(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=re(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return cc=e,null}function _d(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(_a()){case Ca:return 2;case ss:return 8;case Be:case Rr:return 32;case tl:return 268435456;default:return 32}default:return 32}}var Ku=!1,Sa=null,Aa=null,Oa=null,dr=new Map,gr=new Map,Ta=[],Fg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Cd(e,t){switch(e){case"focusin":case"focusout":Sa=null;break;case"dragenter":case"dragleave":Aa=null;break;case"mouseover":case"mouseout":Oa=null;break;case"pointerover":case"pointerout":dr.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":gr.delete(t.pointerId)}}function mr(e,t,n,s,r,c){return e===null||e.nativeEvent!==c?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:c,targetContainers:[r]},t!==null&&(t=li(t),t!==null&&Rd(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,r!==null&&t.indexOf(r)===-1&&t.push(r),e)}function em(e,t,n,s,r){switch(t){case"focusin":return Sa=mr(Sa,e,t,n,s,r),!0;case"dragenter":return Aa=mr(Aa,e,t,n,s,r),!0;case"mouseover":return Oa=mr(Oa,e,t,n,s,r),!0;case"pointerover":var c=r.pointerId;return dr.set(c,mr(dr.get(c)||null,e,t,n,s,r)),!0;case"gotpointercapture":return c=r.pointerId,gr.set(c,mr(gr.get(c)||null,e,t,n,s,r)),!0}return!1}function Ed(e){var t=On(e.target);if(t!==null){var n=X(t);if(n!==null){if(t=n.tag,t===13){if(t=re(n),t!==null){e.blockedOn=t,Nr(e.priority,function(){if(n.tag===13){var s=cn();s=al(s);var r=Ji(n,s);r!==null&&un(r,n,s),Yu(n,s)}});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function uc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Pu(e.nativeEvent);if(n===null){n=e.nativeEvent;var s=new n.constructor(n.type,n);ms=s,n.target.dispatchEvent(s),ms=null}else return t=li(n),t!==null&&Rd(t),e.blockedOn=n,!1;t.shift()}return!0}function Md(e,t,n){uc(e)&&n.delete(t)}function tm(){Ku=!1,Sa!==null&&uc(Sa)&&(Sa=null),Aa!==null&&uc(Aa)&&(Aa=null),Oa!==null&&uc(Oa)&&(Oa=null),dr.forEach(Md),gr.forEach(Md)}function fc(e,t){e.blockedOn===t&&(e.blockedOn=null,Ku||(Ku=!0,U.unstable_scheduleCallback(U.unstable_NormalPriority,tm)))}var hc=null;function wd(e){hc!==e&&(hc=e,U.unstable_scheduleCallback(U.unstable_NormalPriority,function(){hc===e&&(hc=null);for(var t=0;t<e.length;t+=3){var n=e[t],s=e[t+1],r=e[t+2];if(typeof s!="function"){if(Xu(s||n)===null)continue;break}var c=li(n);c!==null&&(e.splice(t,3),t-=3,Xc(c,{pending:!0,data:r,method:n.method,action:s},s,r))}}))}function pr(e){function t(y){return fc(y,e)}Sa!==null&&fc(Sa,e),Aa!==null&&fc(Aa,e),Oa!==null&&fc(Oa,e),dr.forEach(t),gr.forEach(t);for(var n=0;n<Ta.length;n++){var s=Ta[n];s.blockedOn===e&&(s.blockedOn=null)}for(;0<Ta.length&&(n=Ta[0],n.blockedOn===null);)Ed(n),n.blockedOn===null&&Ta.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(s=0;s<n.length;s+=3){var r=n[s],c=n[s+1],d=r[Ut]||null;if(typeof c=="function")d||wd(n);else if(d){var g=null;if(c&&c.hasAttribute("formAction")){if(r=c,d=c[Ut]||null)g=d.formAction;else if(Xu(r)!==null)continue}else g=d.action;typeof g=="function"?n[s+1]=g:(n.splice(s,3),s-=3),wd(n)}}}function Zu(e){this._internalRoot=e}dc.prototype.render=Zu.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(S(409));var n=t.current,s=cn();Od(n,s,e,t,null,null)},dc.prototype.unmount=Zu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Od(e.current,2,null,e,null,null),Ko(),t[ji]=null}};function dc(e){this._internalRoot=e}dc.prototype.unstable_scheduleHydration=function(e){if(e){var t=ll();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ta.length&&t!==0&&t<Ta[n].priority;n++);Ta.splice(n,0,e),n===0&&Ed(e)}};var Nd=F.version;if(Nd!=="19.1.0")throw Error(S(527,Nd,"19.1.0"));j.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(S(188)):(e=Object.keys(e).join(","),Error(S(268,e)));return e=K(t),e=e!==null?w(e):null,e=e===null?null:e.stateNode,e};var nm={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:D,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gc.isDisabled&&gc.supportsFiber)try{ki=gc.inject(nm),Ie=gc}catch{}}return vr.createRoot=function(e,t){if(!Z(e))throw Error(S(299));var n=!1,s="",r=Pf,c=Xf,d=Kf,g=null;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onUncaughtError!==void 0&&(r=t.onUncaughtError),t.onCaughtError!==void 0&&(c=t.onCaughtError),t.onRecoverableError!==void 0&&(d=t.onRecoverableError),t.unstable_transitionCallbacks!==void 0&&(g=t.unstable_transitionCallbacks)),t=Sd(e,1,!1,null,null,n,s,r,c,d,g,null),e[ji]=t.current,Uu(e),new Zu(t)},vr.hydrateRoot=function(e,t,n){if(!Z(e))throw Error(S(299));var s=!1,r="",c=Pf,d=Xf,g=Kf,y=null,_=null;return n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(r=n.identifierPrefix),n.onUncaughtError!==void 0&&(c=n.onUncaughtError),n.onCaughtError!==void 0&&(d=n.onCaughtError),n.onRecoverableError!==void 0&&(g=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(y=n.unstable_transitionCallbacks),n.formState!==void 0&&(_=n.formState)),t=Sd(e,1,!0,t,n??null,s,r,c,d,g,y,_),t.context=Ad(null),n=t.current,s=cn(),s=al(s),r=Wn(s),r.callback=null,$n(n,r,s),n=s,t.current.lanes=n,qi(t,n),si(t),e[ji]=t.current,Uu(e),new dc(t)},vr.version="19.1.0",vr}var zd;function hm(){if(zd)return $u.exports;zd=1;function U(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(U)}catch(F){console.error(F)}}return U(),$u.exports=fm(),$u.exports}var dm=hm();const br=(U,F)=>{const[P,S]=an.useState(()=>{const Z=localStorage.getItem(U);if(Z)try{return JSON.parse(Z)}catch(X){console.error(`Error loading ${U} from localStorage:`,X)}return F});return an.useEffect(()=>{localStorage.setItem(U,JSON.stringify(P))},[U,P]),[P,S]};var mc={exports:{}};/*@license Copyright 2015-2022 Ably Real-time Ltd (ably.com)

Ably JavaScript Library v2.10.0
https://github.com/ably/ably-js

Released under the Apache Licence v2.0*/var gm=mc.exports,Hd;function mm(){return Hd||(Hd=1,function(U,F){(function(P,S){U.exports=S()})(gm,()=>{var P={},S={exports:P},Z=Object.defineProperty,X=Object.defineProperties,re=Object.getOwnPropertyDescriptor,ue=Object.getOwnPropertyDescriptors,K=Object.getOwnPropertyNames,w=Object.getOwnPropertySymbols,V=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable,ae=(i,a,l)=>a in i?Z(i,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):i[a]=l,$=(i,a)=>{for(var l in a||(a={}))V.call(a,l)&&ae(i,l,a[l]);if(w)for(var l of w(a))I.call(a,l)&&ae(i,l,a[l]);return i},be=(i,a)=>X(i,ue(a)),rt=(i,a)=>{var l={};for(var o in i)V.call(i,o)&&a.indexOf(o)<0&&(l[o]=i[o]);if(i!=null&&w)for(var o of w(i))a.indexOf(o)<0&&I.call(i,o)&&(l[o]=i[o]);return l},Ke=(i,a)=>{for(var l in a)Z(i,l,{get:a[l],enumerable:!0})},De=(i,a,l,o)=>{if(a&&typeof a=="object"||typeof a=="function")for(let u of K(a))!V.call(i,u)&&u!==l&&Z(i,u,{get:()=>a[u],enumerable:!(o=re(a,u))||o.enumerable});return i},Ae=i=>De(Z({},"__esModule",{value:!0}),i),$e={};Ke($e,{ErrorInfo:()=>N,Realtime:()=>Nn,Rest:()=>_s,default:()=>Uo,makeProtocolMessageFromDeserialized:()=>_l,msgpack:()=>Ri}),S.exports=Ae($e);var x=class{},Re=typeof globalThis<"u"?globalThis:typeof window<"u"?window:self;function ht(i,a){return`${i}`.padStart(a?3:2,"0")}function Nt(i){return x.Config.logTimestamps?function(a){const l=new Date;i(ht(l.getHours())+":"+ht(l.getMinutes())+":"+ht(l.getSeconds())+"."+ht(l.getMilliseconds(),1)+" "+a)}:function(a){i(a)}}var mt=()=>{var i;let a,l;return typeof((i=Re?.console)==null?void 0:i.log)=="function"?(a=function(...o){console.log.apply(console,o)},l=console.warn?function(...o){console.warn.apply(console,o)}:a):a=l=function(){},[a,l].map(Nt)},Ze=class Sr{constructor(){this.deprecated=(a,l)=>{this.deprecationWarning(`${a} is deprecated and will be removed in a future version. ${l}`)},this.shouldLog=a=>a<=this.logLevel,this.setLog=(a,l)=>{a!==void 0&&(this.logLevel=a),l!==void 0&&(this.logHandler=this.logErrorHandler=l)},this.logLevel=Sr.defaultLogLevel,this.logHandler=Sr.defaultLogHandler,this.logErrorHandler=Sr.defaultLogErrorHandler}static initLogHandlers(){const[a,l]=mt();this.defaultLogHandler=a,this.defaultLogErrorHandler=l,this.defaultLogger=new Sr}static logActionNoStrip(a,l,o,u){a.logAction(l,o,u)}logAction(a,l,o){this.shouldLog(a)&&(a===1?this.logErrorHandler:this.logHandler)("Ably: "+l+": "+o,a)}renamedClientOption(a,l){this.deprecationWarning(`The \`${a}\` client option has been renamed to \`${l}\`. Please update your code to use \`${l}\` instead. \`${a}\` will be removed in a future version.`)}renamedMethod(a,l,o){this.deprecationWarning(`\`${a}\`’s \`${l}\` method has been renamed to \`${o}\`. Please update your code to use \`${o}\` instead. \`${l}\` will be removed in a future version.`)}deprecationWarning(a){this.shouldLog(1)&&this.logErrorHandler(`Ably: Deprecation warning - ${a}`,1)}};Ze.defaultLogLevel=1,Ze.LOG_NONE=0,Ze.LOG_ERROR=1,Ze.LOG_MAJOR=2,Ze.LOG_MINOR=3,Ze.LOG_MICRO=4,Ze.logAction=(i,a,l,o)=>{Ze.logActionNoStrip(i,a,l,o)};var jn=Ze,h=jn,Fe={};Ke(Fe,{Format:()=>as,allSame:()=>is,allToLowerCase:()=>nl,allToUpperCase:()=>Cr,arrChooseN:()=>ki,arrDeleteValue:()=>Ce,arrEquals:()=>il,arrIntersect:()=>J,arrIntersectOb:()=>ve,arrPopRandomElement:()=>Qt,arrWithoutValue:()=>_e,cheapRandStr:()=>ls,containsValue:()=>me,copy:()=>le,createMissingPluginError:()=>wa,dataSizeBytes:()=>tl,decodeBody:()=>ct,encodeBody:()=>et,ensureArray:()=>Le,forInOwnNonNullProperties:()=>Di,getBackoffCoefficient:()=>Er,getGlobalObject:()=>Sn,getJitterCoefficient:()=>Ea,getRetryTime:()=>Li,inherits:()=>Ne,inspectBody:()=>Rr,inspectError:()=>Be,intersect:()=>ne,isEmpty:()=>H,isErrorInfoOrPartialErrorInfo:()=>ss,isNil:()=>Q,isObject:()=>v,keysArray:()=>ot,matchDerivedChannel:()=>Bi,mixin:()=>j,parseQueryString:()=>Ca,prototypicalClone:()=>ce,randomString:()=>_r,shallowClone:()=>W,shallowEquals:()=>Ma,throwMissingPluginError:()=>pt,toBase64:()=>rs,toQueryString:()=>_a,valuesArray:()=>Yt,whenPromiseSettles:()=>Ie,withTimeoutAsync:()=>qi});function fn(i){let a="["+i.constructor.name;return i.message&&(a+=": "+i.message),i.statusCode&&(a+="; statusCode="+i.statusCode),i.code&&(a+="; code="+i.code),i.cause&&(a+="; cause="+Be(i.cause)),i.href&&!(i.message&&i.message.indexOf("help.ably.io")>-1)&&(a+="; see "+i.href+" "),a+="]",a}var N=class af extends Error{constructor(a,l,o,u){super(a),typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(this,af.prototype),this.code=l,this.statusCode=o,this.cause=u}toString(){return fn(this)}static fromValues(a){const{message:l,code:o,statusCode:u}=a;if(typeof l!="string"||typeof o!="number"||typeof u!="number")throw new Error("ErrorInfo.fromValues(): invalid values: "+x.Config.inspect(a));const f=Object.assign(new af(l,o,u),a);return f.code&&!f.href&&(f.href="https://help.ably.io/error/"+f.code),f}},Ue=class sf extends Error{constructor(a,l,o,u){super(a),typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(this,sf.prototype),this.code=l,this.statusCode=o,this.cause=u}toString(){return fn(this)}static fromValues(a){const{message:l,code:o,statusCode:u}=a;if(typeof l!="string"||!Q(o)&&typeof o!="number"||!Q(u)&&typeof u!="number")throw new Error("PartialErrorInfo.fromValues(): invalid values: "+x.Config.inspect(a));const f=Object.assign(new sf(l,o,u),a);return f.code&&!f.href&&(f.href="https://help.ably.io/error/"+f.code),f}};function D(i){return Math.floor(Math.random()*i.length)}function j(i,...a){for(let l=0;l<a.length;l++){const o=a[l];if(!o)break;for(const u in o)Object.prototype.hasOwnProperty.call(o,u)&&(i[u]=o[u])}return i}function le(i){return j({},i)}function Le(i){return Q(i)?[]:Array.isArray(i)?i:[i]}function v(i){return Object.prototype.toString.call(i)=="[object Object]"}function H(i){for(const a in i)return!1;return!0}function Q(i){return i==null}function W(i){const a=new Object;for(const l in i)a[l]=i[l];return a}function ce(i,a){class l{}l.prototype=i;const o=new l;return a&&j(o,a),o}var Ne=function(i,a){if(x.Config.inherits){x.Config.inherits(i,a);return}i.super_=a,i.prototype=ce(a.prototype,{constructor:i})};function me(i,a){for(const l in i)if(i[l]==a)return!0;return!1}function ne(i,a){return Array.isArray(a)?J(i,a):ve(i,a)}function J(i,a){const l=[];for(let o=0;o<i.length;o++){const u=i[o];a.indexOf(u)!=-1&&l.push(u)}return l}function ve(i,a){const l=[];for(let o=0;o<i.length;o++){const u=i[o];u in a&&l.push(u)}return l}function Ce(i,a){const l=i.indexOf(a),o=l!=-1;return o&&i.splice(l,1),o}function _e(i,a){const l=i.slice();return Ce(l,a),l}function ot(i,a){const l=[];for(const o in i)a&&!Object.prototype.hasOwnProperty.call(i,o)||l.push(o);return l}function Yt(i,a){const l=[];for(const o in i)a&&!Object.prototype.hasOwnProperty.call(i,o)||l.push(i[o]);return l}function Di(i,a){for(const l in i)Object.prototype.hasOwnProperty.call(i,l)&&i[l]&&a(l)}function is(i,a){if(i.length===0)return!0;const l=i[0][a];return i.every(function(o){return o[a]===l})}var as=(i=>(i.msgpack="msgpack",i.json="json",i))(as||{});function Qt(i){return i.splice(D(i),1)[0]}function _a(i){const a=[];if(i)for(const l in i)a.push(encodeURIComponent(l)+"="+encodeURIComponent(i[l]));return a.length?"?"+a.join("&"):""}function Ca(i){let a;const l=/([^?&=]+)=?([^&]*)/g,o={};for(;a=l.exec(i);)o[decodeURIComponent(a[1])]=decodeURIComponent(a[2]);return o}function ss(i){return typeof i=="object"&&i!==null&&(i instanceof N||i instanceof Ue)}function Be(i){var a,l;return i instanceof Error||((a=i?.constructor)==null?void 0:a.name)==="ErrorInfo"||((l=i?.constructor)==null?void 0:l.name)==="PartialErrorInfo"?i.toString():x.Config.inspect(i)}function Rr(i){return x.BufferUtils.isBuffer(i)?i.toString():typeof i=="string"?i:x.Config.inspect(i)}function tl(i){if(x.BufferUtils.isBuffer(i))return x.BufferUtils.byteLength(i);if(typeof i=="string")return x.Config.stringByteSize(i);if(typeof i=="number")return 8;if(typeof i=="boolean")return 1;throw new Error(`Expected input of Utils.dataSizeBytes to be a string, a number, a boolean or a buffer, but was: ${typeof i}`)}function ls(){return String(Math.random()).substr(2)}var _r=async i=>{const a=await x.Config.getRandomArrayBuffer(i);return x.BufferUtils.base64Encode(a)};function ki(i,a){const l=Math.min(a,i.length),o=i.slice(),u=[];for(let f=0;f<l;f++)u.push(Qt(o));return u}function Ie(i,a){i.then(l=>{a?.(null,l)}).catch(l=>{a?.(l)})}function ct(i,a,l){return l=="msgpack"?(a||pt("MsgPack"),a.decode(i)):JSON.parse(String(i))}function et(i,a,l){return l=="msgpack"?(a||pt("MsgPack"),a.encode(i,!0)):JSON.stringify(i)}function nl(i){return i.map(function(a){return a&&a.toLowerCase()})}function Cr(i){return i.map(function(a){return a&&a.toUpperCase()})}function Er(i){return Math.min((i+2)/3,2)}function Ea(){return 1-Math.random()*.2}function Li(i,a){return i*Er(a)*Ea()}function Sn(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:self}function Ma(i,a){return Object.keys(i).every(l=>i[l]===a[l])&&Object.keys(a).every(l=>a[l]===i[l])}function Bi(i){const a=/^(\[([^?]*)(?:(.*))\])?(.+)$/,l=i.match(a);if(!l||!l.length||l.length<5)throw new N("regex match failed",400,40010);if(l[2])throw new N(`cannot use a derived option with a ${l[2]} channel`,400,40010);return{qualifierParam:l[3]||"",channelName:l[4]}}function rs(i){const a=x.BufferUtils,l=a.utf8Encode(i);return a.base64Encode(l)}function il(i,a){return i.length===a.length&&i.every(function(l,o){return l===a[o]})}function wa(i){return new N(`${i} plugin not provided`,40019,400)}function pt(i){throw wa(i)}async function qi(i,a=5e3,l="Timeout expired"){const o=new N(l,5e4,500);return Promise.race([i,new Promise((u,f)=>setTimeout(()=>f(o),a))])}var Mr="2.10.0",wr="ably-js/"+Mr,Pt={ENDPOINT:"main",ENVIRONMENT:"",REST_HOST:"rest.ably.io",REALTIME_HOST:"realtime.ably.io",FALLBACK_HOSTS:["main.a.fallback.ably-realtime.com","main.b.fallback.ably-realtime.com","main.c.fallback.ably-realtime.com","main.d.fallback.ably-realtime.com","main.e.fallback.ably-realtime.com"],PORT:80,TLS_PORT:443,TIMEOUTS:{disconnectedRetryTimeout:15e3,suspendedRetryTimeout:3e4,httpRequestTimeout:1e4,httpMaxRetryDuration:15e3,channelRetryTimeout:15e3,fallbackRetryTimeout:6e5,connectionStateTtl:12e4,realtimeRequestTimeout:1e4,recvTimeout:9e4,webSocketConnectTimeout:1e4,webSocketSlowTimeout:4e3},httpMaxRetryCount:3,maxMessageSize:65536,version:Mr,protocolVersion:3,agent:wr,getPort:al,getHttpScheme:sl,getPrimaryDomainFromEndpoint:Nr,getEndpointFallbackHosts:An,getFallbackHosts:Ut,getHosts:ji,checkHost:os,objectifyOptions:Ur,normaliseOptions:ol,defaultGetHeaders:Gi,defaultPostHeaders:yt};function al(i,a){return a||i.tls?i.tlsPort:i.port}function sl(i){return i.tls?"https://":"http://"}function ll(i){return i.includes(".")||i.includes("::")||i==="localhost"}function Nr(i){return ll(i)?i:i.startsWith("nonprod:")?`${i.replace("nonprod:","")}.realtime.ably-nonprod.net`:`${i}.realtime.ably.net`}function An(i){if(ll(i))return[];if(i.startsWith("nonprod:")){const a=i.replace("nonprod:","");return At(a,"ably-realtime-nonprod.com")}return At(i,"ably-realtime.com")}function At(i,a){return["a","b","c","d","e"].map(l=>`${i}.${l}.fallback.${a}`)}function Ut(i){const a=i.fallbackHosts,l=typeof i.httpMaxRetryCount<"u"?i.httpMaxRetryCount:Pt.httpMaxRetryCount;return a?ki(a,l):[]}function ji(i){return[i.primaryDomain].concat(Ut(i))}function os(i){if(typeof i!="string")throw new N("host must be a string; was a "+typeof i,4e4,400);if(!i.length)throw new N("host must not be zero-length",4e4,400)}function yc(i){const a={};for(const l in Pt.TIMEOUTS)a[l]=i[l]||Pt.TIMEOUTS[l];return a}function rl(i){let a=Pt.agent;if(i.agents)for(var l in i.agents)a+=" "+l+"/"+i.agents[l];return a}function Ur(i,a,l,o,u){if(i===void 0){const m=a?`${l} must be initialized with either a client options object, an Ably API key, or an Ably Token`:`${l} must be initialized with a client options object`;throw h.logAction(o,h.LOG_ERROR,`${l}()`,m),new Error(m)}let f;if(typeof i=="string")if(i.indexOf(":")==-1){if(!a){const m=`${l} cannot be initialized with just an Ably Token; you must provide a client options object with a \`plugins\` property. (Set this Ably Token as the object’s \`token\` property.)`;throw h.logAction(o,h.LOG_ERROR,`${l}()`,m),new Error(m)}f={token:i}}else{if(!a){const m=`${l} cannot be initialized with just an Ably API key; you must provide a client options object with a \`plugins\` property. (Set this Ably API key as the object’s \`key\` property.)`;throw h.logAction(o,h.LOG_ERROR,`${l}()`,m),new Error(m)}f={key:i}}else f=i;return u&&(f=be($({},f),{plugins:$($({},u),f.plugins)})),f}function Na(i){if(i.endpoint&&(i.environment||i.restHost||i.realtimeHost))throw new N("The `endpoint` option cannot be used in conjunction with the `environment`, `restHost`, or `realtimeHost` options.",40106,400);if(i.environment&&(i.restHost||i.realtimeHost))throw new N("The `environment` option cannot be used in conjunction with the `restHost`, or `realtimeHost` options.",40106,400)}function ol(i,a,l){const o=l??h.defaultLogger;i.environment&&o.deprecated("The `environment` client option","Use the `endpoint` client option instead."),i.restHost&&o.deprecated("The `restHost` client option","Use the `endpoint` client option instead."),i.realtimeHost&&o.deprecated("The `realtimeHost` client option","Use the `endpoint` client option instead."),Na(i),typeof i.recover=="function"&&i.closeOnUnload===!0&&(h.logAction(o,h.LOG_ERROR,"Defaults.normaliseOptions","closeOnUnload was true and a session recovery function was set - these are mutually exclusive, so unsetting the latter"),i.recover=void 0),"closeOnUnload"in i||(i.closeOnUnload=!i.recover),"queueMessages"in i||(i.queueMessages=!0);const u=i.endpoint||Pt.ENDPOINT;!i.fallbackHosts&&!i.restHost&&!i.realtimeHost&&!i.port&&!i.tlsPort&&(i.fallbackHosts=An(i.environment||u));const f=i.environment&&`${i.environment}.realtime.ably.net`,p=i.restHost||i.realtimeHost||f||Nr(u);(i.fallbackHosts||[]).concat(p).forEach(os),i.port=i.port||Pt.PORT,i.tlsPort=i.tlsPort||Pt.TLS_PORT,"tls"in i||(i.tls=!0);const R=yc(i);a?"useBinaryProtocol"in i?i.useBinaryProtocol=x.Config.supportsBinary&&i.useBinaryProtocol:i.useBinaryProtocol=x.Config.preferBinary:i.useBinaryProtocol=!1;const A={};i.clientId&&(A["X-Ably-ClientId"]=x.BufferUtils.base64Encode(x.BufferUtils.utf8Encode(i.clientId))),"idempotentRestPublishing"in i||(i.idempotentRestPublishing=!0);let L=null,B=i.connectivityCheckUrl;if(i.connectivityCheckUrl){let[q,ee]=i.connectivityCheckUrl.split("?");L=ee?Ca(ee):{},q.indexOf("://")===-1&&(q="https://"+q),B=q}let Y=i.wsConnectivityCheckUrl;return Y&&Y.indexOf("://")===-1&&(Y="wss://"+Y),be($({},i),{primaryDomain:p,maxMessageSize:i.maxMessageSize||Pt.maxMessageSize,timeouts:R,connectivityCheckParams:L,connectivityCheckUrl:B,wsConnectivityCheckUrl:Y,headers:A})}function On(i,a,l){const o=l||{};if(o.cipher){i||pt("Crypto");const u=i.getCipher(o.cipher,a);o.cipher=u.cipherParams,o.channelCipher=u.cipher}else"cipher"in o&&(o.cipher=void 0,o.channelCipher=null);return o}var li={json:"application/json",xml:"application/xml",html:"text/html",msgpack:"application/x-msgpack",text:"text/plain"},Gn={format:"json",protocolVersion:Pt.protocolVersion};function Gi(i,{format:a=Gn.format,protocolVersion:l=Gn.protocolVersion}={}){return{accept:li[a],"X-Ably-Version":l.toString(),"Ably-Agent":rl(i)}}function yt(i,{format:a=Gn.format,protocolVersion:l=Gn.protocolVersion}={}){let o;return{accept:o=li[a],"content-type":o,"X-Ably-Version":l.toString(),"Ably-Agent":rl(i)}}var ge=Pt;function xr(i){return Object.assign(Pt,i)}var ri=class Yd{constructor(a,l){this.logger=a,this.members=l||[]}call(a,l){for(const o of this.members)if(o)try{o(a,l)}catch(u){h.logAction(this.logger,h.LOG_ERROR,"Multicaster multiple callback handler","Unexpected exception: "+u+"; stack = "+u.stack)}}push(...a){this.members.push(...a)}createPromise(){return new Promise((a,l)=>{this.push((o,u)=>{o?l(o):a(u)})})}resolveAll(a){this.call(null,a)}rejectAll(a){this.call(a)}static create(a,l){const o=new Yd(a,l);return Object.assign((u,f)=>o.call(u,f),{push:u=>o.push(u),createPromise:()=>o.createPromise(),resolveAll:u=>o.resolveAll(u),rejectAll:u=>o.rejectAll(u)})}},zn=ri,Dr=(i=>(i.Get="get",i.Delete="delete",i.Post="post",i.Put="put",i.Patch="patch",i))(Dr||{}),nt=Dr,cl=(i=>(i[i.Success=200]="Success",i[i.NoContent=204]="NoContent",i[i.BadRequest=400]="BadRequest",i[i.Unauthorized=401]="Unauthorized",i[i.Forbidden=403]="Forbidden",i[i.RequestTimeout=408]="RequestTimeout",i[i.InternalServerError=500]="InternalServerError",i))(cl||{});function vc(i){return i>=200&&i<400}var oi=cl,zi=Math.pow(2,17);function Tn(){return("000000"+Math.floor(Math.random()*1e16)).slice(-16)}function ul(i){return!!i.connection}function fl(i){return ss(i)?(i.code||(i.statusCode===403?i.code=40300:(i.code=40170,i.statusCode=401)),i):new N(Be(i),i.code||40170,i.statusCode||401)}var Hi=(i,a)=>{const l=x.BufferUtils,o=l.utf8Encode(i),u=l.utf8Encode(a),f=l.hmacSha256(o,u);return l.base64Encode(f)};function cs(i){if(!i)return"";typeof i=="string"&&(i=JSON.parse(i));const a=Object.create(null),l=ot(i,!0);if(!l)return"";l.sort();for(let o=0;o<l.length;o++)a[l[o]]=i[l[o]].sort();return JSON.stringify(a)}function us(i,a){if(i.authCallback)h.logAction(a,h.LOG_MINOR,"Auth()","using token auth with authCallback");else if(i.authUrl)h.logAction(a,h.LOG_MINOR,"Auth()","using token auth with authUrl");else if(i.key)h.logAction(a,h.LOG_MINOR,"Auth()","using token auth with client-side signing");else if(i.tokenDetails)h.logAction(a,h.LOG_MINOR,"Auth()","using token auth with supplied token only");else{const l="authOptions must include valid authentication parameters";throw h.logAction(a,h.LOG_ERROR,"Auth()",l),new Error(l)}}function bc(i){return"useTokenAuth"in i&&!i.useTokenAuth}function hl(i){return i.useTokenAuth||!bc(i)&&(i.authCallback||i.authUrl||i.token||i.tokenDetails)}function Xt(i){return!i.key&&!i.authCallback&&!i.authUrl}var kr=0;function Sc(){return kr++}var fs=class{constructor(i,a){if(this.authOptions={},this.client=i,this.tokenParams=a.defaultTokenParams||{},this.currentTokenRequestId=null,this.waitingForTokenRequest=null,hl(a))Xt(a)&&h.logAction(this.logger,h.LOG_ERROR,"Auth()","Warning: library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),this._saveTokenOptions(a.defaultTokenParams,a),us(this.authOptions,this.logger);else{if(!a.key){const l="No authentication options provided; need one of: key, authUrl, or authCallback (or for testing only, token or tokenDetails)";throw h.logAction(this.logger,h.LOG_ERROR,"Auth()",l),new N(l,40160,401)}h.logAction(this.logger,h.LOG_MINOR,"Auth()","anonymous, using basic auth"),this._saveBasicOptions(a)}}get logger(){return this.client.logger}async authorize(i,a){if(a&&a.key&&this.authOptions.key!==a.key)throw new N("Unable to update auth options with incompatible key",40102,401);try{let l=await this._forceNewToken(i??null,a??null);return ul(this.client)?new Promise((o,u)=>{this.client.connection.connectionManager.onAuthUpdated(l,(f,m)=>f?u(f):o(m))}):l}catch(l){throw this.client.connection&&l.statusCode===oi.Forbidden&&this.client.connection.connectionManager.actOnErrorFromAuthorize(l),l}}async _forceNewToken(i,a){this.tokenDetails=null,this._saveTokenOptions(i,a),us(this.authOptions,this.logger);try{return this._ensureValidAuthCredentials(!0)}finally{delete this.tokenParams.timestamp,delete this.authOptions.queryTime}}async requestToken(i,a){const l=a||this.authOptions,o=i||le(this.tokenParams);let u,f=this.client;if(l.authCallback)h.logAction(this.logger,h.LOG_MINOR,"Auth.requestToken()","using token auth with authCallback"),u=l.authCallback;else if(l.authUrl)h.logAction(this.logger,h.LOG_MINOR,"Auth.requestToken()","using token auth with authUrl"),u=(p,R)=>{const A=j({accept:"application/json, text/plain"},l.authHeaders),L=l.authMethod&&l.authMethod.toLowerCase()==="post";let B;const Y=l.authUrl.indexOf("?");Y>-1&&(B=Ca(l.authUrl.slice(Y)),l.authUrl=l.authUrl.slice(0,Y),L||(l.authParams=j(B,l.authParams)));const q=j({},l.authParams||{},p),ee=te=>{var fe,xe;let je=(fe=te.body)!=null?fe:null,ze=null;if(te.error)h.logAction(this.logger,h.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received Error: "+Be(te.error));else{const Tt=(xe=te.headers["content-type"])!=null?xe:null;Array.isArray(Tt)?ze=Tt.join(", "):ze=Tt,h.logAction(this.logger,h.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received; content-type: "+ze+"; body: "+Rr(je))}if(te.error){R(te.error,null);return}if(te.unpacked){R(null,je);return}if(x.BufferUtils.isBuffer(je)&&(je=je.toString()),!ze){R(new N("authUrl response is missing a content-type header",40170,401),null);return}const pe=ze.indexOf("application/json")>-1,It=ze.indexOf("text/plain")>-1||ze.indexOf("application/jwt")>-1;if(!pe&&!It){R(new N("authUrl responded with unacceptable content-type "+ze+", should be either text/plain, application/jwt or application/json",40170,401),null);return}if(pe){if(je.length>zi){R(new N("authUrl response exceeded max permitted length",40170,401),null);return}try{je=JSON.parse(je)}catch(Tt){R(new N("Unexpected error processing authURL response; err = "+Tt.message,40170,401),null);return}}R(null,je,ze)};if(h.logAction(this.logger,h.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Requesting token from "+l.authUrl+"; Params: "+JSON.stringify(q)+"; method: "+(L?"POST":"GET")),L){const te=A||{};te["content-type"]="application/x-www-form-urlencoded";const fe=_a(q).slice(1);Ie(this.client.http.doUri(nt.Post,l.authUrl,te,fe,B),(xe,je)=>ee(xe||je))}else Ie(this.client.http.doUri(nt.Get,l.authUrl,A||{},null,q),(te,fe)=>ee(te||fe))};else if(l.key)h.logAction(this.logger,h.LOG_MINOR,"Auth.requestToken()","using token auth with client-side signing"),u=(p,R)=>{Ie(this.createTokenRequest(p,l),(A,L)=>R(A,L??null))};else{const p="Need a new token, but authOptions does not include any way to request one (no authUrl, authCallback, or key)";throw h.logAction(this.logger,h.LOG_ERROR,"Auth()","library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),new N(p,40171,403)}"capability"in o&&(o.capability=cs(o.capability));const m=(p,R)=>{const A=p.keyName,L="/keys/"+A+"/requestToken",B=function(q){return f.baseUri(q)+L},Y=ge.defaultPostHeaders(this.client.options);l.requestHeaders&&j(Y,l.requestHeaders),h.logAction(this.logger,h.LOG_MICRO,"Auth.requestToken().requestToken","Sending POST to "+L+"; Token params: "+JSON.stringify(p)),Ie(this.client.http.do(nt.Post,B,Y,JSON.stringify(p),null),(q,ee)=>q?R(q):R(ee.error,ee.body,ee.unpacked))};return new Promise((p,R)=>{let A=!1,L=this.client.options.timeouts.realtimeRequestTimeout,B=setTimeout(()=>{A=!0;const Y="Token request callback timed out after "+L/1e3+" seconds";h.logAction(this.logger,h.LOG_ERROR,"Auth.requestToken()",Y),R(new N(Y,40170,401))},L);u(o,(Y,q,ee)=>{if(A)return;if(clearTimeout(B),Y){h.logAction(this.logger,h.LOG_ERROR,"Auth.requestToken()","token request signing call returned error; err = "+Be(Y)),R(fl(Y));return}if(typeof q=="string"){q.length===0?R(new N("Token string is empty",40170,401)):q.length>zi?R(new N("Token string exceeded max permitted length (was "+q.length+" bytes)",40170,401)):q==="undefined"||q==="null"?R(new N("Token string was literal null/undefined",40170,401)):q[0]==="{"&&!(ee&&ee.indexOf("application/jwt")>-1)?R(new N("Token was double-encoded; make sure you're not JSON-encoding an already encoded token request or details",40170,401)):p({token:q});return}if(typeof q!="object"||q===null){const fe="Expected token request callback to call back with a token string or token request/details object, but got a "+typeof q;h.logAction(this.logger,h.LOG_ERROR,"Auth.requestToken()",fe),R(new N(fe,40170,401));return}const te=JSON.stringify(q).length;if(te>zi&&!l.suppressMaxLengthCheck){R(new N("Token request/details object exceeded max permitted stringified size (was "+te+" bytes)",40170,401));return}if("issued"in q){p(q);return}if(!("keyName"in q)){const fe="Expected token request callback to call back with a token string, token request object, or token details object";h.logAction(this.logger,h.LOG_ERROR,"Auth.requestToken()",fe),R(new N(fe,40170,401));return}m(q,(fe,xe,je)=>{if(fe){h.logAction(this.logger,h.LOG_ERROR,"Auth.requestToken()","token request API call returned error; err = "+Be(fe)),R(fl(fe));return}je||(xe=JSON.parse(xe)),h.logAction(this.logger,h.LOG_MINOR,"Auth.getToken()","token received"),p(xe)})})})}async createTokenRequest(i,a){a=a||this.authOptions,i=i||le(this.tokenParams);const l=a.key;if(!l)throw new N("No key specified",40101,403);const o=l.split(":"),u=o[0],f=o[1];if(!f)throw new N("Invalid key specified",40101,403);if(i.clientId==="")throw new N("clientId can’t be an empty string",40012,400);"capability"in i&&(i.capability=cs(i.capability));const m=j({keyName:u},i),p=i.clientId||"",R=i.ttl||"",A=i.capability||"";m.timestamp||(m.timestamp=await this._getTimestamp(a&&a.queryTime));const L=m.nonce||(m.nonce=Tn()),B=m.timestamp,Y=m.keyName+`
`+R+`
`+A+`
`+p+`
`+B+`
`+L+`
`;return m.mac=m.mac||Hi(Y,f),h.logAction(this.logger,h.LOG_MINOR,"Auth.getTokenRequest()","generated signed request"),m}async getAuthParams(){if(this.method=="basic")return{key:this.key};{let i=await this._ensureValidAuthCredentials(!1);if(!i)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");return{access_token:i.token}}}async getAuthHeaders(){if(this.method=="basic")return{authorization:"Basic "+this.basicKey};{const i=await this._ensureValidAuthCredentials(!1);if(!i)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");return{authorization:"Bearer "+rs(i.token)}}}_saveBasicOptions(i){this.method="basic",this.key=i.key,this.basicKey=rs(i.key),this.authOptions=i||{},"clientId"in i&&this._userSetClientId(i.clientId)}_saveTokenOptions(i,a){this.method="token",i&&(this.tokenParams=i),a&&(a.token&&(a.tokenDetails=typeof a.token=="string"?{token:a.token}:a.token),a.tokenDetails&&(this.tokenDetails=a.tokenDetails),"clientId"in a&&this._userSetClientId(a.clientId),this.authOptions=a)}async _ensureValidAuthCredentials(i){const a=this.tokenDetails;if(a){if(this._tokenClientIdMismatch(a.clientId))throw new N("Mismatch between clientId in token ("+a.clientId+") and current clientId ("+this.clientId+")",40102,403);if(!this.client.isTimeOffsetSet()||!a.expires||a.expires>=this.client.getTimestampUsingOffset())return h.logAction(this.logger,h.LOG_MINOR,"Auth.getToken()","using cached token; expires = "+a.expires),a;h.logAction(this.logger,h.LOG_MINOR,"Auth.getToken()","deleting expired token"),this.tokenDetails=null}const l=(this.waitingForTokenRequest||(this.waitingForTokenRequest=zn.create(this.logger))).createPromise();if(this.currentTokenRequestId!==null&&!i)return l;const o=this.currentTokenRequestId=Sc();let u,f=null;try{u=await this.requestToken(this.tokenParams,this.authOptions)}catch(p){f=p}if(this.currentTokenRequestId>o)return h.logAction(this.logger,h.LOG_MINOR,"Auth._ensureValidAuthCredentials()","Discarding token request response; overtaken by newer one"),l;this.currentTokenRequestId=null;const m=this.waitingForTokenRequest;return this.waitingForTokenRequest=null,f?(m?.rejectAll(f),l):(m?.resolveAll(this.tokenDetails=u),l)}_userSetClientId(i){if(typeof i=="string"||i===null){if(i==="*")throw new N('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, instantiate the library with {defaultTokenParams: {clientId: "*"}}), or if calling authorize(), pass it in as a tokenParam: authorize({clientId: "*"}, authOptions)',40012,400);{const a=this._uncheckedSetClientId(i);if(a)throw a}}else throw new N("clientId must be either a string or null",40012,400)}_uncheckedSetClientId(i){if(this._tokenClientIdMismatch(i)){const a="Unexpected clientId mismatch: client has "+this.clientId+", requested "+i,l=new N(a,40102,401);return h.logAction(this.logger,h.LOG_ERROR,"Auth._uncheckedSetClientId()",a),l}else return this.clientId=this.tokenParams.clientId=i,null}_tokenClientIdMismatch(i){return!!(this.clientId&&this.clientId!=="*"&&i&&i!=="*"&&this.clientId!==i)}static isTokenErr(i){return i.code&&i.code>=40140&&i.code<40150}revokeTokens(i,a){return this.client.rest.revokeTokens(i,a)}async _getTimestamp(i){return this.client.getTimestamp(i||!!this.authOptions.queryTime)}},hn=fs;function Vi(i){const a=[];if(i)for(const l in i)a.push(l+"="+i[l]);return a.join("&")}function Ii(i,a){return i+(a?"?":"")+Vi(a)}function Kt(i,a,l,o,u){i.error?h.logActionNoStrip(u,h.LOG_MICRO,"Http."+a+"()","Received Error; "+Ii(l,o)+"; Error: "+Be(i.error)):h.logActionNoStrip(u,h.LOG_MICRO,"Http."+a+"()","Received; "+Ii(l,o)+"; Headers: "+Vi(i.headers)+"; StatusCode: "+i.statusCode+"; Body"+(x.BufferUtils.isBuffer(i.body)?" (Base64): "+x.BufferUtils.base64Encode(i.body):": "+i.body))}function dl(i,a,l,o,u){u.shouldLog(h.LOG_MICRO)&&h.logActionNoStrip(u,h.LOG_MICRO,"Http."+i+"()","Sending; "+Ii(a,o)+"; Body"+(x.BufferUtils.isBuffer(l)?" (Base64): "+x.BufferUtils.base64Encode(l):": "+l))}var hs=class{constructor(i){this.client=i,this.platformHttp=new x.Http(i),this.checkConnectivity=this.platformHttp.checkConnectivity?()=>this.platformHttp.checkConnectivity():void 0}get logger(){var i,a;return(a=(i=this.client)==null?void 0:i.logger)!=null?a:h.defaultLogger}get supportsAuthHeaders(){return this.platformHttp.supportsAuthHeaders}get supportsLinkHeaders(){return this.platformHttp.supportsLinkHeaders}_getHosts(i){const a=i.connection,l=a&&a.connectionManager.host;return l?[l].concat(ge.getFallbackHosts(i.options)):ge.getHosts(i.options)}async do(i,a,l,o,u){try{const f=this.client;if(!f)return{error:new N("http.do called without client",5e4,500)};const m=typeof a=="function"?a:function(B){return f.baseUri(B)+a},p=f._currentFallback;if(p)if(p.validUntil>Date.now()){const B=await this.doUri(i,m(p.host),l,o,u);return B.error&&this.platformHttp.shouldFallback(B.error)?(f._currentFallback=null,this.do(i,a,l,o,u)):B}else f._currentFallback=null;const R=this._getHosts(f);if(R.length===1)return this.doUri(i,m(R[0]),l,o,u);let A=null;const L=async(B,Y)=>{const q=B.shift();A=A??new Date;const ee=await this.doUri(i,m(q),l,o,u);return ee.error&&this.platformHttp.shouldFallback(ee.error)&&B.length?Date.now()-A.getTime()>f.options.timeouts.httpMaxRetryDuration?{error:new N(`Timeout for trying fallback hosts retries. Total elapsed time exceeded the ${f.options.timeouts.httpMaxRetryDuration}ms limit`,50003,500)}:L(B,!0):(Y&&(f._currentFallback={host:q,validUntil:Date.now()+f.options.timeouts.fallbackRetryTimeout}),ee)};return L(R)}catch(f){return{error:new N(`Unexpected error in Http.do: ${Be(f)}`,500,5e4)}}}async doUri(i,a,l,o,u){try{dl(i,a,o,u,this.logger);const f=await this.platformHttp.doUri(i,a,l,o,u);return this.logger.shouldLog(h.LOG_MICRO)&&Kt(f,i,a,u,this.logger),f}catch(f){return{error:new N(`Unexpected error in Http.doUri: ${Be(f)}`,500,5e4)}}}};function gl(i,a,l,o){try{l.apply(a,o)}catch(u){h.logAction(i,h.LOG_ERROR,"EventEmitter.emit()","Unexpected listener exception: "+u+"; stack = "+(u&&u.stack))}}function Hn(i,a,l){let o,u,f;for(let m=0;m<i.length;m++)if(o=i[m],l&&(o=o[l]),Array.isArray(o)){for(;(u=o.indexOf(a))!==-1;)o.splice(u,1);l&&o.length===0&&delete i[m][l]}else if(v(o))for(f in o)Object.prototype.hasOwnProperty.call(o,f)&&Array.isArray(o[f])&&Hn([o],a,f)}var Lr=class{constructor(i){this.logger=i,this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null)}on(...i){if(i.length===1){const a=i[0];if(typeof a=="function")this.any.push(a);else throw new Error("EventListener.on(): Invalid arguments: "+x.Config.inspect(i))}if(i.length===2){const[a,l]=i;if(typeof l!="function")throw new Error("EventListener.on(): Invalid arguments: "+x.Config.inspect(i));if(Q(a))this.any.push(l);else if(Array.isArray(a))a.forEach(o=>{this.on(o,l)});else{if(typeof a!="string")throw new Error("EventListener.on(): Invalid arguments: "+x.Config.inspect(i));(this.events[a]||(this.events[a]=[])).push(l)}}}off(...i){if(i.length==0||Q(i[0])&&Q(i[1])){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null);return}const[a,l]=i;let o=null,u=null;if(i.length===1||!l)typeof a=="function"?o=a:u=a;else{if(typeof l!="function")throw new Error("EventEmitter.off(): invalid arguments:"+x.Config.inspect(i));[u,o]=[a,l]}if(o&&Q(u)){Hn([this.any,this.events,this.anyOnce,this.eventsOnce],o);return}if(Array.isArray(u)){u.forEach(f=>{this.off(f,o)});return}if(typeof u!="string")throw new Error("EventEmitter.off(): invalid arguments:"+x.Config.inspect(i));o?Hn([this.events,this.eventsOnce],o,u):(delete this.events[u],delete this.eventsOnce[u])}listeners(i){if(i){const a=this.events[i]||[];return this.eventsOnce[i]&&Array.prototype.push.apply(a,this.eventsOnce[i]),a.length?a:null}return this.any.length?this.any:null}emit(i,...a){const l={event:i},o=[];this.anyOnce.length&&(Array.prototype.push.apply(o,this.anyOnce),this.anyOnce=[]),this.any.length&&Array.prototype.push.apply(o,this.any);const u=this.eventsOnce[i];u&&(Array.prototype.push.apply(o,u),delete this.eventsOnce[i]);const f=this.events[i];f&&Array.prototype.push.apply(o,f),o.forEach(m=>{gl(this.logger,l,m,a)})}once(...i){const a=i.length;if(a===0||a===1&&typeof i[0]!="function"){const u=i[0];return new Promise(f=>{this.once(u,f)})}const[l,o]=i;if(i.length===1&&typeof l=="function")this.anyOnce.push(l);else if(Q(l)){if(typeof o!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+x.Config.inspect(i));this.anyOnce.push(o)}else if(Array.isArray(l)){const u=this,f=function(){const m=Array.prototype.slice.call(arguments);if(l.forEach(function(p){u.off(p,f)}),typeof o!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+x.Config.inspect(i));o.apply(this,m)};l.forEach(function(m){u.on(m,f)})}else{if(typeof l!="string")throw new Error("EventEmitter.once(): Invalid arguments:"+x.Config.inspect(i));const u=this.eventsOnce[l]||(this.eventsOnce[l]=[]);if(o){if(typeof o!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+x.Config.inspect(i));u.push(o)}}}async whenState(i,a){if(typeof i!="string"||typeof a!="string")throw new Error("whenState requires a valid state String argument");return i===a?null:this.once(i)}},dt=Lr,se={HEARTBEAT:0,ACK:1,NACK:2,CONNECT:3,CONNECTED:4,DISCONNECT:5,DISCONNECTED:6,CLOSE:7,CLOSED:8,ERROR:9,ATTACH:10,ATTACHED:11,DETACH:12,DETACHED:13,PRESENCE:14,MESSAGE:15,SYNC:16,AUTH:17,ACTIVATE:18,OBJECT:19,OBJECT_SYNC:20,ANNOTATION:21},Br=[];Object.keys(se).forEach(function(i){Br[se[i]]=i});var xt={HAS_PRESENCE:1,HAS_BACKLOG:2,RESUMED:4,TRANSIENT:16,ATTACH_RESUME:32,HAS_OBJECTS:128,PRESENCE:65536,PUBLISH:1<<17,SUBSCRIBE:1<<18,PRESENCE_SUBSCRIBE:1<<19,ANNOTATION_PUBLISH:1<<21,ANNOTATION_SUBSCRIBE:1<<22,OBJECT_SUBSCRIBE:1<<24,OBJECT_PUBLISH:1<<25},qr=Object.keys(xt);xt.MODE_ALL=xt.PRESENCE|xt.PUBLISH|xt.SUBSCRIBE|xt.PRESENCE_SUBSCRIBE|xt.ANNOTATION_PUBLISH|xt.ANNOTATION_SUBSCRIBE|xt.OBJECT_SUBSCRIBE|xt.OBJECT_PUBLISH;var ds=["PRESENCE","PUBLISH","SUBSCRIBE","PRESENCE_SUBSCRIBE","ANNOTATION_PUBLISH","ANNOTATION_SUBSCRIBE","OBJECT_SUBSCRIBE","OBJECT_PUBLISH"];function Ac(i){return!i||!i.channelOptions?{channelOptions:i,plugins:{},baseEncodedPreviousPayload:void 0}:i}function jr(i,a,l){if(l&&l.cipher){i||pt("Crypto");const o=i.getCipher(l.cipher,a);return{cipher:o.cipherParams,channelCipher:o.cipher}}return l??{}}async function gs(i,a){const{data:l,encoding:o}=await ms(i.data,i.encoding,a);return i.data=l,i.encoding=o,i}async function ms(i,a,l){let o=l.channelCipher,u=i,f=a?a+"/":"";x.BufferUtils.isBuffer(u)||(u=x.BufferUtils.utf8Encode(String(u)),f=f+"utf-8/");const m=await o.encrypt(u);return f=f+"cipher+"+o.algorithm,{data:m,encoding:f}}async function Ua(i,a){const l=typeof i.data=="string"||x.BufferUtils.isBuffer(i.data)||i.data===null||i.data===void 0,{data:o,encoding:u}=ci(i.data,i.encoding,l);return i.data=o,i.encoding=u,a!=null&&a.cipher?gs(i,a):i}function ci(i,a,l){if(l)return{data:i,encoding:a};if(v(i)||Array.isArray(i))return{data:JSON.stringify(i),encoding:a?a+"/json":"json"};throw new N("Data type is unsupported",40013,400)}async function Vn(i,a){const{data:l,encoding:o,error:u}=await ml(i.data,i.encoding,a);if(i.data=l,i.encoding=o,u)throw u}async function ml(i,a,l){const o=Ac(l);let u=i,f=i,m=a,p;if(a){const R=a.split("/");let A,L=R.length,B="";try{for(;(A=L)>0;){const Y=R[--L].match(/([-\w]+)(\+([\w-]+))?/);if(!Y)break;switch(B=Y[1],B){case"base64":f=x.BufferUtils.base64Decode(String(f)),A==R.length&&(u=f);continue;case"utf-8":f=x.BufferUtils.utf8Decode(f);continue;case"json":f=JSON.parse(f);continue;case"cipher":if(o.channelOptions!=null&&o.channelOptions.cipher&&o.channelOptions.channelCipher){const q=Y[3],ee=o.channelOptions.channelCipher;if(q!=ee.algorithm)throw new Error("Unable to decrypt message with given cipher; incompatible cipher params");f=await ee.decrypt(f);continue}else throw new Error("Unable to decrypt message; not an encrypted channel");case"vcdiff":if(!o.plugins||!o.plugins.vcdiff)throw new N("Missing Vcdiff decoder (https://github.com/ably-forks/vcdiff-decoder)",40019,400);if(typeof Uint8Array>"u")throw new N("Delta decoding not supported on this browser (need ArrayBuffer & Uint8Array)",40020,400);try{let q=o.baseEncodedPreviousPayload;typeof q=="string"&&(q=x.BufferUtils.utf8Encode(q));const ee=x.BufferUtils.toBuffer(q);f=x.BufferUtils.toBuffer(f),f=x.BufferUtils.arrayBufferViewToBuffer(o.plugins.vcdiff.decode(f,ee)),u=f}catch(q){throw new N("Vcdiff delta decode failed with "+q,40018,400)}continue;default:throw new Error("Unknown encoding")}}}catch(Y){const q=Y;p=new N(`Error processing the ${B} encoding, decoder returned ‘${q.message}’`,q.code||40013,400)}finally{m=A<=0?null:R.slice(0,A).join("/")}}return p?{error:p,data:f,encoding:m}:(o.baseEncodedPreviousPayload=u,{data:f,encoding:m})}function xa(...i){const a=i.length>0?"json":"msgpack",{data:l,encoding:o}=pl(this.data,this.encoding,a);return Object.assign({},this,{encoding:o,data:l})}function pl(i,a,l){return!i||!x.BufferUtils.isBuffer(i)?{data:i,encoding:a}:l==="msgpack"?{data:x.BufferUtils.toBuffer(i),encoding:a}:{data:x.BufferUtils.base64Encode(i),encoding:a?a+"/base64":"base64"}}var In={encryptData:ms,encodeData:ci,encodeDataForWire:pl,decodeData:ml};function Zt(i){const{id:a,connectionId:l,timestamp:o}=i;let u;switch(i.action){case se.MESSAGE:{u=i.messages;break}case se.PRESENCE:case se.SYNC:u=i.presence;break;case se.ANNOTATION:u=i.annotations;break;case se.OBJECT:case se.OBJECT_SYNC:u=i.state;break;default:throw new N("Unexpected action "+i.action,4e4,400)}for(let f=0;f<u.length;f++){const m=u[f];m.connectionId||(m.connectionId=l),m.timestamp||(m.timestamp=o),a&&!m.id&&(m.id=a+":"+f)}}function Yn(i,a){let l="["+a;for(const o in i)o==="data"?typeof i.data=="string"?l+="; data="+i.data:x.BufferUtils.isBuffer(i.data)?l+="; data (buffer)="+x.BufferUtils.base64Encode(i.data):typeof i.data<"u"&&(l+="; data (json)="+JSON.stringify(i.data)):o&&(o==="extras"||o==="operation")?l+="; "+o+"="+JSON.stringify(i[o]):i[o]!==void 0&&(l+="; "+o+"="+i[o]);return l+="]",l}var dn=class{},Rn=class{constructor(i){this.Platform=x,this.ErrorInfo=N,this.Logger=h,this.Defaults=ge,this.Utils=Fe,this.EventEmitter=dt,this.MessageEncoding=In;var a,l,o,u,f,m,p,R,A,L;this._additionalHTTPRequestImplementations=(a=i.plugins)!=null?a:null,this.logger=new h,this.logger.setLog(i.logLevel,i.logHandler),h.logAction(this.logger,h.LOG_MICRO,"BaseClient()","initialized with clientOptions "+x.Config.inspect(i)),this._MsgPack=(o=(l=i.plugins)==null?void 0:l.MsgPack)!=null?o:null;const B=this.options=ge.normaliseOptions(i,this._MsgPack,this.logger);if(B.key){const Y=B.key.match(/^([^:\s]+):([^:.\s]+)$/);if(!Y){const q="invalid key parameter";throw h.logAction(this.logger,h.LOG_ERROR,"BaseClient()",q),new N(q,40400,404)}B.keyName=Y[1],B.keySecret=Y[2]}if("clientId"in B)if(typeof B.clientId=="string"||B.clientId===null){if(B.clientId==="*")throw new N('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, use {defaultTokenParams: {clientId: "*"}})',40012,400)}else throw new N("clientId must be either a string or null",40012,400);h.logAction(this.logger,h.LOG_MINOR,"BaseClient()","started; version = "+ge.version),this._currentFallback=null,this.serverTimeOffset=null,this.http=new hs(this),this.auth=new hn(this,B),this._rest=(u=i.plugins)!=null&&u.Rest?new i.plugins.Rest(this):null,this._Crypto=(m=(f=i.plugins)==null?void 0:f.Crypto)!=null?m:null,this.__FilteredSubscriptions=(R=(p=i.plugins)==null?void 0:p.MessageInteractions)!=null?R:null,this._Annotations=(L=(A=i.plugins)==null?void 0:A.Annotations)!=null?L:null}get rest(){return this._rest||pt("Rest"),this._rest}get _FilteredSubscriptions(){return this.__FilteredSubscriptions||pt("MessageInteractions"),this.__FilteredSubscriptions}get channels(){return this.rest.channels}get push(){return this.rest.push}device(){var i;return(!((i=this.options.plugins)!=null&&i.Push)||!this.push.LocalDevice)&&pt("Push"),this._device||(this._device=this.push.LocalDevice.load(this)),this._device}baseUri(i){return ge.getHttpScheme(this.options)+i+":"+ge.getPort(this.options,!1)}async stats(i){return this.rest.stats(i)}async time(i){return this.rest.time(i)}async request(i,a,l,o,u,f){return this.rest.request(i,a,l,o,u,f)}batchPublish(i){return this.rest.batchPublish(i)}batchPresence(i){return this.rest.batchPresence(i)}setLog(i){this.logger.setLog(i.level,i.handler)}async getTimestamp(i){return!this.isTimeOffsetSet()&&i?this.time():this.getTimestampUsingOffset()}getTimestampUsingOffset(){return Date.now()+(this.serverTimeOffset||0)}isTimeOffsetSet(){return this.serverTimeOffset!==null}};Rn.Platform=x;var ps=Rn,ys=class Fs{toJSON(){var a,l,o;return{id:this.id,deviceSecret:this.deviceSecret,platform:this.platform,formFactor:this.formFactor,clientId:this.clientId,metadata:this.metadata,deviceIdentityToken:this.deviceIdentityToken,push:{recipient:(a=this.push)==null?void 0:a.recipient,state:(l=this.push)==null?void 0:l.state,error:(o=this.push)==null?void 0:o.error}}}toString(){var a,l,o,u;let f="[DeviceDetails";return this.id&&(f+="; id="+this.id),this.platform&&(f+="; platform="+this.platform),this.formFactor&&(f+="; formFactor="+this.formFactor),this.clientId&&(f+="; clientId="+this.clientId),this.metadata&&(f+="; metadata="+this.metadata),this.deviceIdentityToken&&(f+="; deviceIdentityToken="+JSON.stringify(this.deviceIdentityToken)),(a=this.push)!=null&&a.recipient&&(f+="; push.recipient="+JSON.stringify(this.push.recipient)),(l=this.push)!=null&&l.state&&(f+="; push.state="+this.push.state),(o=this.push)!=null&&o.error&&(f+="; push.error="+JSON.stringify(this.push.error)),(u=this.push)!=null&&u.metadata&&(f+="; push.metadata="+this.push.metadata),f+="]",f}static toRequestBody(a,l,o){return et(a,l,o)}static fromResponseBody(a,l,o){return o&&(a=ct(a,l,o)),Array.isArray(a)?Fs.fromValuesArray(a):Fs.fromValues(a)}static fromValues(a){return a.error=a.error&&N.fromValues(a.error),Object.assign(new Fs,a)}static fromLocalDevice(a){return Object.assign(new Fs,a)}static fromValuesArray(a){const l=a.length,o=new Array(l);for(let u=0;u<l;u++)o[u]=Fs.fromValues(a[u]);return o}},ui=ys;async function Da(i,a,l,o){if(i.http.supportsAuthHeaders){const u=await i.auth.getAuthHeaders();return o(j(u,a),l)}else{const u=await i.auth.getAuthParams();return o(a,j(u,l))}}function vs(i,a,l){if(i.err&&!i.body)return{err:i.err};if(i.statusCode===oi.NoContent)return be($({},i),{body:[],unpacked:!0});let o=i.body;if(!i.unpacked)try{o=ct(o,a,l)}catch(p){return ss(p)?{err:p}:{err:new Ue(Be(p),null)}}if(!o)return{err:new Ue("unenvelope(): Response body is missing",null)};const{statusCode:u,response:f,headers:m}=o;if(u===void 0)return be($({},i),{body:o,unpacked:!0});if(u<200||u>=300){let p=f&&f.error||i.err;return p||(p=new Error("Error in unenveloping "+o),p.statusCode=u),{err:p,body:f,headers:m,unpacked:!0,statusCode:u}}return{err:i.err,body:f,headers:m,unpacked:!0,statusCode:u}}function Gr(i,a,l,o,u){i.err?h.logAction(u,h.LOG_MICRO,"Resource."+a+"()","Received Error; "+Ii(l,o)+"; Error: "+Be(i.err)):h.logAction(u,h.LOG_MICRO,"Resource."+a+"()","Received; "+Ii(l,o)+"; Headers: "+Vi(i.headers)+"; StatusCode: "+i.statusCode+"; Body: "+(x.BufferUtils.isBuffer(i.body)?" (Base64): "+x.BufferUtils.base64Encode(i.body):": "+x.Config.inspect(i.body)))}var Bt=class el{static async get(a,l,o,u,f,m){return el.do(nt.Get,a,l,null,o,u,f,m??!1)}static async delete(a,l,o,u,f,m){return el.do(nt.Delete,a,l,null,o,u,f,m)}static async post(a,l,o,u,f,m,p){return el.do(nt.Post,a,l,o,u,f,m,p)}static async patch(a,l,o,u,f,m,p){return el.do(nt.Patch,a,l,o,u,f,m,p)}static async put(a,l,o,u,f,m,p){return el.do(nt.Put,a,l,o,u,f,m,p)}static async do(a,l,o,u,f,m,p,R){p&&((m=m||{}).envelope=p);const A=l.logger;async function L(Y,q){var ee;if(A.shouldLog(h.LOG_MICRO)){let fe=u;if(((ee=Y["content-type"])==null?void 0:ee.indexOf("msgpack"))>0)try{l._MsgPack||pt("MsgPack"),fe=l._MsgPack.decode(u)}catch(xe){h.logAction(A,h.LOG_MICRO,"Resource."+a+"()","Sending MsgPack Decoding Error: "+Be(xe))}h.logAction(A,h.LOG_MICRO,"Resource."+a+"()","Sending; "+Ii(o,q)+"; Body: "+fe)}const te=await l.http.do(a,o,Y,u,q);return te.error&&hn.isTokenErr(te.error)?(await l.auth.authorize(null,null),Da(l,Y,q,L)):{err:te.error,body:te.body,headers:te.headers,unpacked:te.unpacked,statusCode:te.statusCode}}let B=await Da(l,f,m,L);if(p&&(B=vs(B,l._MsgPack,p)),A.shouldLog(h.LOG_MICRO)&&Gr(B,a,o,m,A),R){if(B.err)throw B.err;{const Y=$({},B);return delete Y.err,Y}}return B}},Ye=Bt;function bs(i){const a=i.match(/^\.\/(\w+)\?(.*)$/);return a&&a[2]&&Ca(a[2])}function ka(i){typeof i=="string"&&(i=i.split(","));const a={};for(let l=0;l<i.length;l++){const o=i[l].match(/^\s*<(.+)>;\s*rel="(\w+)"$/);if(o){const u=bs(o[1]);u&&(a[o[2]]=u)}}return a}function Oc(i,a,l){return!(l&&(a||typeof i.code=="number"))}var yl=class{constructor(i,a,l,o,u,f){this.client=i,this.path=a,this.headers=l,this.envelope=o??null,this.bodyHandler=u,this.useHttpPaginatedResponse=f||!1}get logger(){return this.client.logger}async get(i){const a=await Ye.get(this.client,this.path,this.headers,i,this.envelope,!1);return this.handlePage(a)}async delete(i){const a=await Ye.delete(this.client,this.path,this.headers,i,this.envelope,!1);return this.handlePage(a)}async post(i,a){const l=await Ye.post(this.client,this.path,a,this.headers,i,this.envelope,!1);return this.handlePage(l)}async put(i,a){const l=await Ye.put(this.client,this.path,a,this.headers,i,this.envelope,!1);return this.handlePage(l)}async patch(i,a){const l=await Ye.patch(this.client,this.path,a,this.headers,i,this.envelope,!1);return this.handlePage(l)}async handlePage(i){if(i.err&&Oc(i.err,i.body,this.useHttpPaginatedResponse))throw h.logAction(this.logger,h.LOG_ERROR,"PaginatedResource.handlePage()","Unexpected error getting resource: err = "+Be(i.err)),i.err;let a,l,o;try{a=i.statusCode==oi.NoContent?[]:await this.bodyHandler(i.body,i.headers||{},i.unpacked)}catch(u){throw i.err||u}return i.headers&&(l=i.headers.Link||i.headers.link)&&(o=ka(l)),this.useHttpPaginatedResponse?new La(this,a,i.headers||{},i.statusCode,o,i.err):new Ss(this,a,o)}},Ss=class{constructor(i,a,l){this.resource=i,this.items=a,this._relParams=l}async first(){if(this.hasFirst())return this.get(this._relParams.first);throw new N("No link to the first page of results",40400,404)}async current(){if(this.hasCurrent())return this.get(this._relParams.current);throw new N("No link to the current page of results",40400,404)}async next(){return this.hasNext()?this.get(this._relParams.next):null}hasFirst(){return this._relParams!=null&&"first"in this._relParams}hasCurrent(){return this._relParams!=null&&"current"in this._relParams}hasNext(){return this._relParams!=null&&"next"in this._relParams}isLast(){return!this.hasNext()}async get(i){const a=this.resource,l=await Ye.get(a.client,a.path,a.headers,i,a.envelope,!1);return a.handlePage(l)}},La=class extends Ss{constructor(i,a,l,o,u,f){super(i,a,u),this.statusCode=o,this.success=o<300&&o>=200,this.headers=l,this.errorCode=f&&f.code,this.errorMessage=f&&f.message}toJSON(){return{items:this.items,statusCode:this.statusCode,success:this.success,headers:this.headers,errorCode:this.errorCode,errorMessage:this.errorMessage}}},zt=yl,vl=class Ar{toJSON(){return{channel:this.channel,deviceId:this.deviceId,clientId:this.clientId}}toString(){let a="[PushChannelSubscription";return this.channel&&(a+="; channel="+this.channel),this.deviceId&&(a+="; deviceId="+this.deviceId),this.clientId&&(a+="; clientId="+this.clientId),a+="]",a}static fromResponseBody(a,l,o){return o&&(a=ct(a,l,o)),Array.isArray(a)?Ar.fromValuesArray(a):Ar.fromValues(a)}static fromValues(a){return Object.assign(new Ar,a)}static fromValuesArray(a){const l=a.length,o=new Array(l);for(let u=0;u<l;u++)o[u]=Ar.fromValues(a[u]);return o}};vl.toRequestBody=et;var Tc=vl,As=Tc,Rc=class{constructor(i){var a;this.client=i,this.admin=new bl(i),x.Config.push&&((a=i.options.plugins)!=null&&a.Push)&&(this.stateMachine=new i.options.plugins.Push.ActivationStateMachine(i),this.LocalDevice=i.options.plugins.Push.localDeviceFactory(ui))}async activate(i,a){await new Promise((l,o)=>{var u;if(!((u=this.client.options.plugins)!=null&&u.Push)){o(wa("Push"));return}if(!this.stateMachine){o(new N("This platform is not supported as a target of push notifications",4e4,400));return}if(this.stateMachine.activatedCallback){o(new N("Activation already in progress",4e4,400));return}this.stateMachine.activatedCallback=f=>{if(f){o(f);return}l()},this.stateMachine.updateFailedCallback=a,this.stateMachine.handleEvent(new this.client.options.plugins.Push.CalledActivate(this.stateMachine,i))})}async deactivate(i){await new Promise((a,l)=>{var o;if(!((o=this.client.options.plugins)!=null&&o.Push)){l(wa("Push"));return}if(!this.stateMachine){l(new N("This platform is not supported as a target of push notifications",4e4,400));return}if(this.stateMachine.deactivatedCallback){l(new N("Deactivation already in progress",4e4,400));return}this.stateMachine.deactivatedCallback=u=>{if(u){l(u);return}a()},this.stateMachine.handleEvent(new this.client.options.plugins.Push.CalledDeactivate(this.stateMachine,i))})}},bl=class{constructor(i){this.client=i,this.deviceRegistrations=new _c(i),this.channelSubscriptions=new Cc(i)}async publish(i,a){const l=this.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=ge.defaultPostHeaders(l.options,{format:o}),f={},m=j({recipient:i},a);j(u,l.options.headers),l.options.pushFullWait&&j(f,{fullWait:"true"});const p=et(m,l._MsgPack,o);await Ye.post(l,"/push/publish",p,u,f,null,!0)}},_c=class{constructor(i){this.client=i}async save(i){const a=this.client,l=ui.fromValues(i),o=a.options.useBinaryProtocol?"msgpack":"json",u=ge.defaultPostHeaders(a.options,{format:o}),f={};j(u,a.options.headers),a.options.pushFullWait&&j(f,{fullWait:"true"});const m=et(l,a._MsgPack,o),p=await Ye.put(a,"/push/deviceRegistrations/"+encodeURIComponent(i.id),m,u,f,null,!0);return ui.fromResponseBody(p.body,a._MsgPack,p.unpacked?void 0:o)}async get(i){const a=this.client,l=a.options.useBinaryProtocol?"msgpack":"json",o=ge.defaultGetHeaders(a.options,{format:l}),u=i.id||i;if(typeof u!="string"||!u.length)throw new N("First argument to DeviceRegistrations#get must be a deviceId string or DeviceDetails",4e4,400);j(o,a.options.headers);const f=await Ye.get(a,"/push/deviceRegistrations/"+encodeURIComponent(u),o,{},null,!0);return ui.fromResponseBody(f.body,a._MsgPack,f.unpacked?void 0:l)}async list(i){const a=this.client,l=a.options.useBinaryProtocol?"msgpack":"json",o=this.client.http.supportsLinkHeaders?void 0:l,u=ge.defaultGetHeaders(a.options,{format:l});return j(u,a.options.headers),new zt(a,"/push/deviceRegistrations",u,o,async function(f,m,p){return ui.fromResponseBody(f,a._MsgPack,p?void 0:l)}).get(i)}async remove(i){const a=this.client,l=a.options.useBinaryProtocol?"msgpack":"json",o=ge.defaultGetHeaders(a.options,{format:l}),u={},f=i.id||i;if(typeof f!="string"||!f.length)throw new N("First argument to DeviceRegistrations#remove must be a deviceId string or DeviceDetails",4e4,400);j(o,a.options.headers),a.options.pushFullWait&&j(u,{fullWait:"true"}),await Ye.delete(a,"/push/deviceRegistrations/"+encodeURIComponent(f),o,u,null,!0)}async removeWhere(i){const a=this.client,l=a.options.useBinaryProtocol?"msgpack":"json",o=ge.defaultGetHeaders(a.options,{format:l});j(o,a.options.headers),a.options.pushFullWait&&j(i,{fullWait:"true"}),await Ye.delete(a,"/push/deviceRegistrations",o,i,null,!0)}},Cc=class Qd{constructor(a){this.remove=Qd.prototype.removeWhere,this.client=a}async save(a){const l=this.client,o=As.fromValues(a),u=l.options.useBinaryProtocol?"msgpack":"json",f=ge.defaultPostHeaders(l.options,{format:u}),m={};j(f,l.options.headers),l.options.pushFullWait&&j(m,{fullWait:"true"});const p=et(o,l._MsgPack,u),R=await Ye.post(l,"/push/channelSubscriptions",p,f,m,null,!0);return As.fromResponseBody(R.body,l._MsgPack,R.unpacked?void 0:u)}async list(a){const l=this.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=this.client.http.supportsLinkHeaders?void 0:o,f=ge.defaultGetHeaders(l.options,{format:o});return j(f,l.options.headers),new zt(l,"/push/channelSubscriptions",f,u,async function(m,p,R){return As.fromResponseBody(m,l._MsgPack,R?void 0:o)}).get(a)}async removeWhere(a){const l=this.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=ge.defaultGetHeaders(l.options,{format:o});j(u,l.options.headers),l.options.pushFullWait&&j(a,{fullWait:"true"}),await Ye.delete(l,"/push/channelSubscriptions",u,a,null,!0)}async listChannels(a){const l=this.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=this.client.http.supportsLinkHeaders?void 0:o,f=ge.defaultGetHeaders(l.options,{format:o});return j(f,l.options.headers),l.options.pushFullWait&&j(a,{fullWait:"true"}),new zt(l,"/push/channels",f,u,async function(m,p,R){const A=!R&&o?ct(m,l._MsgPack,o):m;for(let L=0;L<A.length;L++)A[L]=String(A[L]);return A}).get(a)}},Ec=Rc,zr=["absent","present","enter","leave","update"];async function Hr(i,a,l,o){const u=jr(a,i,o??null);return Ba.fromValues(l).decode(u,i)}async function Vr(i,a,l,o){return Promise.all(l.map(function(u){return Hr(i,a,u,o)}))}async function Mc(i,a){return Ba.fromValues(i).decode(a.channelOptions,a.logger)}async function Ir(i,a){return Promise.all(i.map(function(l){return Mc(l,a)}))}var Yr=class Or extends dn{isSynthesized(){return!this.id||!this.connectionId?!0:this.id.substring(this.connectionId.length,0)!==this.connectionId}parseId(){if(!this.id)throw new Error("parseId(): Presence message does not contain an id");const a=this.id.split(":");return{connectionId:a[0],msgSerial:parseInt(a[1],10),index:parseInt(a[2],10)}}async encode(a){const l=Object.assign(new Ba,this,{action:zr.indexOf(this.action||"present")});return Ua(l,a)}static fromValues(a){return Object.assign(new Or,a)}static fromValuesArray(a){return a.map(l=>Or.fromValues(l))}static fromData(a){return a instanceof Or?a:Or.fromValues({data:a})}toString(){return Yn(this,"PresenceMessage")}},Ba=class lf extends dn{toJSON(...a){return xa.call(this,...a)}static fromValues(a){return Object.assign(new lf,a)}static fromValuesArray(a){return a.map(l=>lf.fromValues(l))}async decode(a,l){const o=Object.assign(new Yr,be($({},this),{action:zr[this.action]}));try{await Vn(o,a)}catch(u){h.logAction(l,h.LOG_ERROR,"WirePresenceMessage.decode()",Be(u))}return o}toString(){return Yn(this,"WirePresenceMessage")}},gn=Yr,wc=class{constructor(i){this.channel=i}get logger(){return this.channel.logger}async get(i){h.logAction(this.logger,h.LOG_MICRO,"RestPresence.get()","channel = "+this.channel.name);const a=this.channel.client,l=a.options.useBinaryProtocol?"msgpack":"json",o=this.channel.client.http.supportsLinkHeaders?void 0:l,u=ge.defaultGetHeaders(a.options,{format:l});return j(u,a.options.headers),new zt(a,this.channel.client.rest.presenceMixin.basePath(this),u,o,async(f,m,p)=>{const R=p?f:ct(f,a._MsgPack,l);return Ir(R,this.channel)}).get(i)}async history(i){return h.logAction(this.logger,h.LOG_MICRO,"RestPresence.history()","channel = "+this.channel.name),this.channel.client.rest.presenceMixin.history(this,i)}},Nc=wc,Qr=["message.create","message.update","message.delete","meta","message.summary"];function Pr(i){return Qr[i||0]||"unknown"}function Uc(i){let a=0;return i.name&&(a+=i.name.length),i.clientId&&(a+=i.clientId.length),i.extras&&(a+=JSON.stringify(i.extras).length),i.data&&(a+=tl(i.data)),a}async function Xr(i,a,l,o){const u=jr(a,i,o??null);return fi.fromValues(l).decode(u,i)}async function xc(i,a,l,o){return Promise.all(l.map(function(u){return Xr(i,a,u,o)}))}async function Dc(i,a){return fi.fromValues(i).decode(a.channelOptions,a.logger)}async function kc(i,a){return Promise.all(i.map(function(l){return Dc(l,a)}))}async function Kr(i,a){return Promise.all(i.map(l=>l.encode(a)))}var Lc=et;function Sl(i){let a,l=0;for(let o=0;o<i.length;o++)a=i[o],l+=a.size||(a.size=Uc(a));return l}var Zr=class rf extends dn{expandFields(){this.action==="message.create"&&(this.version&&!this.serial&&(this.serial=this.version),this.timestamp&&!this.createdAt&&(this.createdAt=this.timestamp))}async encode(a){const l=Object.assign(new fi,this,{action:Qr.indexOf(this.action||"message.create")});return Ua(l,a)}static fromValues(a){return Object.assign(new rf,a)}static fromValuesArray(a){return a.map(l=>rf.fromValues(l))}toString(){return Yn(this,"Message")}},fi=class of extends dn{toJSON(...a){return xa.call(this,...a)}static fromValues(a){return Object.assign(new of,a)}static fromValuesArray(a){return a.map(l=>of.fromValues(l))}async decodeWithErr(a,l){const o=Object.assign(new Zr,be($({},this),{action:Pr(this.action)}));let u;try{await Vn(o,a)}catch(f){h.logAction(l,h.LOG_ERROR,"WireMessage.decode()",Be(f)),u=f}return o.expandFields(),{decoded:o,err:u}}async decode(a,l){const{decoded:o}=await this.decodeWithErr(a,l);return o}toString(){return Yn(this,"WireMessage")}},Jt=Zr,Bc=9;function Jr(i){return i.every(function(a){return!a.id})}var Wr=class{constructor(i,a,l){this._annotations=null;var o,u;h.logAction(i.logger,h.LOG_MINOR,"RestChannel()","started; name = "+a),this.name=a,this.client=i,this.presence=new Nc(this),this.channelOptions=On((o=i._Crypto)!=null?o:null,this.logger,l),(u=i.options.plugins)!=null&&u.Push&&(this._push=new i.options.plugins.Push.PushChannel(this)),i._Annotations&&(this._annotations=new i._Annotations.RestAnnotations(this))}get annotations(){return this._annotations||pt("Annotations"),this._annotations}get push(){return this._push||pt("Push"),this._push}get logger(){return this.client.logger}setOptions(i){var a;this.channelOptions=On((a=this.client._Crypto)!=null?a:null,this.logger,i)}async history(i){return h.logAction(this.logger,h.LOG_MICRO,"RestChannel.history()","channel = "+this.name),this.client.rest.channelMixin.history(this,i)}async publish(...i){const a=i[0],l=i[1];let o,u;if(typeof a=="string"||a===null)o=[Jt.fromValues({name:a,data:l})],u=i[2];else if(v(a))o=[Jt.fromValues(a)],u=i[1];else if(Array.isArray(a))o=Jt.fromValuesArray(a),u=i[1];else throw new N("The single-argument form of publish() expects a message object or an array of message objects",40013,400);u||(u={});const f=this.client,m=f.options,p=m.useBinaryProtocol?"msgpack":"json",R=f.options.idempotentRestPublishing,A=ge.defaultPostHeaders(f.options,{format:p});if(j(A,m.headers),R&&Jr(o)){const q=await _r(Bc);o.forEach(function(ee,te){ee.id=q+":"+te.toString()})}const L=await Kr(o,this.channelOptions),B=Sl(L),Y=m.maxMessageSize;if(B>Y)throw new N(`Maximum size of messages that can be published at once exceeded (was ${B} bytes; limit is ${Y} bytes)`,40009,400);await this._publish(Lc(L,f._MsgPack,p),A,u)}async _publish(i,a,l){await Ye.post(this.client,this.client.rest.channelMixin.basePath(this)+"/messages",i,a,l,null,!0)}async status(){return this.client.rest.channelMixin.status(this)}},$r=Wr,Fr=class Pd{constructor(a){this.entries=a&&a.entries||void 0,this.schema=a&&a.schema||void 0,this.appId=a&&a.appId||void 0,this.inProgress=a&&a.inProgress||void 0,this.unit=a&&a.unit||void 0,this.intervalId=a&&a.intervalId||void 0}static fromValues(a){return new Pd(a)}},eo=Fr,hi=class{static basePath(i){return"/channels/"+encodeURIComponent(i.name)}static history(i,a){const l=i.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=i.client.http.supportsLinkHeaders?void 0:o,f=ge.defaultGetHeaders(l.options,{format:o});return j(f,l.options.headers),new zt(l,this.basePath(i)+"/messages",f,u,async function(m,p,R){const A=R?m:ct(m,l._MsgPack,o);return kc(A,i)}).get(a)}static async status(i){const a=i.client.options.useBinaryProtocol?"msgpack":"json",l=ge.defaultPostHeaders(i.client.options,{format:a});return(await Ye.get(i.client,this.basePath(i),l,{},a,!0)).body}},qc=class{static basePath(i){return hi.basePath(i.channel)+"/presence"}static async history(i,a){const l=i.channel.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=i.channel.client.http.supportsLinkHeaders?void 0:o,f=ge.defaultGetHeaders(l.options,{format:o});return j(f,l.options.headers),new zt(l,this.basePath(i)+"/history",f,u,async(m,p,R)=>{const A=R?m:ct(m,l._MsgPack,o);return Ir(A,i.channel)}).get(a)}},to=class{constructor(i){this.channelMixin=hi,this.presenceMixin=qc,this.Resource=Ye,this.PaginatedResource=zt,this.DeviceDetails=ui,this.PushChannelSubscription=As,this.client=i,this.channels=new jc(this.client),this.push=new Ec(this.client)}async stats(i){const a=ge.defaultGetHeaders(this.client.options),l=this.client.options.useBinaryProtocol?"msgpack":"json",o=this.client.http.supportsLinkHeaders?void 0:l;return j(a,this.client.options.headers),new zt(this.client,"/stats",a,o,function(u,f,m){const p=m?u:JSON.parse(u);for(let R=0;R<p.length;R++)p[R]=eo.fromValues(p[R]);return p}).get(i)}async time(i){const a=ge.defaultGetHeaders(this.client.options);this.client.options.headers&&j(a,this.client.options.headers);const l=p=>this.client.baseUri(p)+"/time";let{error:o,body:u,unpacked:f}=await this.client.http.do(nt.Get,l,a,null,i);if(o)throw o;f||(u=JSON.parse(u));const m=u[0];if(!m)throw new N("Internal error (unexpected result type from GET /time)",5e4,500);return this.client.serverTimeOffset=m-Date.now(),m}async request(i,a,l,o,u,f){var m;const[p,R,A]=this.client.options.useBinaryProtocol?(this.client._MsgPack||pt("MsgPack"),[this.client._MsgPack.encode,this.client._MsgPack.decode,"msgpack"]):[JSON.stringify,JSON.parse,"json"],L=this.client.http.supportsLinkHeaders?void 0:A;o=o||{};const B=i.toLowerCase(),Y=B=="get"?ge.defaultGetHeaders(this.client.options,{format:A,protocolVersion:l}):ge.defaultPostHeaders(this.client.options,{format:A,protocolVersion:l});typeof u!="string"&&(u=(m=p(u))!=null?m:null),j(Y,this.client.options.headers),f&&j(Y,f);const q=new zt(this.client,a,Y,L,async function(ee,te,fe){return Le(fe?ee:R(ee))},!0);if(!x.Http.methods.includes(B))throw new N("Unsupported method "+B,40500,405);return x.Http.methodsWithBody.includes(B)?q[B](o,u):q[B](o)}async batchPublish(i){let a,l;Array.isArray(i)?(a=i,l=!1):(a=[i],l=!0);const o=this.client.options.useBinaryProtocol?"msgpack":"json",u=ge.defaultPostHeaders(this.client.options,{format:o});this.client.options.headers&&j(u,this.client.options.headers);const f=et(a,this.client._MsgPack,o),m=await Ye.post(this.client,"/messages",f,u,{},null,!0),p=m.unpacked?m.body:ct(m.body,this.client._MsgPack,o);return l?p[0]:p}async batchPresence(i){const a=this.client.options.useBinaryProtocol?"msgpack":"json",l=ge.defaultPostHeaders(this.client.options,{format:a});this.client.options.headers&&j(l,this.client.options.headers);const o=i.join(","),u=await Ye.get(this.client,"/presence",l,{channels:o},null,!0);return u.unpacked?u.body:ct(u.body,this.client._MsgPack,a)}async revokeTokens(i,a){if(hl(this.client.options))throw new N("Cannot revoke tokens when using token auth",40162,401);const l=this.client.options.keyName;let o=a??{};const u=$({targets:i.map(A=>`${A.type}:${A.value}`)},o),f=this.client.options.useBinaryProtocol?"msgpack":"json",m=ge.defaultPostHeaders(this.client.options,{format:f});this.client.options.headers&&j(m,this.client.options.headers);const p=et(u,this.client._MsgPack,f),R=await Ye.post(this.client,`/keys/${l}/revokeTokens`,p,m,{},null,!0);return R.unpacked?R.body:ct(R.body,this.client._MsgPack,f)}},jc=class{constructor(i){this.client=i,this.all=Object.create(null)}get(i,a){i=String(i);let l=this.all[i];return l?a&&l.setOptions(a):this.all[i]=l=new $r(this.client,i,a),l}release(i){delete this.all[String(i)]}},no=class extends ps{constructor(i){super(ge.objectifyOptions(i,!1,"BaseRest",h.defaultLogger,{Rest:to}))}},Al={Rest:to},Yi=class extends Jt{static async fromEncoded(i,a){return Xr(h.defaultLogger,x.Crypto,i,a)}static async fromEncodedArray(i,a){return xc(h.defaultLogger,x.Crypto,i,a)}static fromValues(i){return Jt.fromValues(i)}},Qi=class extends gn{static async fromEncoded(i,a){return Hr(h.defaultLogger,x.Crypto,i,a)}static async fromEncodedArray(i,a){return Vr(h.defaultLogger,x.Crypto,i,a)}static fromValues(i){return gn.fromValues(i)}},io=["annotation.create","annotation.delete"];async function qa(i,a,l){return di.fromValues(a).decode(l||{},i)}async function ao(i,a,l){return Promise.all(a.map(function(o){return qa(i,o,l)}))}async function so(i,a){return di.fromValues(i).decode(a.channelOptions,a.logger)}async function Ol(i,a){return Promise.all(i.map(function(l){return so(l,a)}))}var Os=class cf extends dn{async encode(){const a=Object.assign(new di,this,{action:io.indexOf(this.action||"annotation.create")});return Ua(a,{})}static fromValues(a){return Object.assign(new cf,a)}static fromValuesArray(a){return a.map(l=>cf.fromValues(l))}toString(){return Yn(this,"Annotation")}},di=class uf extends dn{toJSON(...a){return xa.call(this,...a)}static fromValues(a){return Object.assign(new uf,a)}static fromValuesArray(a){return a.map(l=>uf.fromValues(l))}async decode(a,l){const o=Object.assign(new Os,be($({},this),{action:io[this.action]}));try{await Vn(o,a)}catch(u){h.logAction(l,h.LOG_ERROR,"WireAnnotation.decode()",Be(u))}return o}toString(){return Yn(this,"WireAnnotation")}},Pi=Os,Tl=class extends Pi{static async fromEncoded(i,a){return qa(h.defaultLogger,i,a)}static async fromEncodedArray(i,a){return ao(h.defaultLogger,i,a)}static fromValues(i){return Pi.fromValues(i)}};function lo(i){let a;switch(typeof i){case"string":a=i;break;case"object":a=i.serial;break}if(!a||typeof a!="string")throw new N("First argument of annotations.publish() must be either a Message (or at least an object with a string `serial` property) or a message serial (string)",40003,400);return a}function ro(i,a){const l=lo(i);if(!a||typeof a!="object")throw new N("Second argument of annotations.publish() must be an object (the intended annotation to publish)",40003,400);const o=Pi.fromValues(a);return o.messageSerial=l,o.action||(o.action="annotation.create"),o}function oo(i,a){return i.client.rest.channelMixin.basePath(i)+"/messages/"+encodeURIComponent(a)+"/annotations"}var Gc=class{constructor(i){this.channel=i}async publish(i,a){const l=ro(i,a),o=await l.encode(),u=this.channel.client,f=u.options,m=f.useBinaryProtocol?"msgpack":"json",p=ge.defaultPostHeaders(u.options,{format:m}),R={};j(p,u.options.headers);const A=et([o],u._MsgPack,m);await Ye.post(u,oo(this.channel,l.messageSerial),A,p,R,null,!0)}async delete(i,a){return a.action="annotation.delete",this.publish(i,a)}async get(i,a){const l=this.channel.client,o=lo(i),u=l.options.useBinaryProtocol?"msgpack":"json",f=l.http.supportsLinkHeaders?void 0:u,m=ge.defaultGetHeaders(l.options,{format:u});return j(m,l.options.headers),new zt(l,oo(this.channel,o),m,f,async(p,R,A)=>{const L=A?p:ct(p,l._MsgPack,u);return Ol(L,this.channel)}).get(a)}},Rl=Gc,Ht=et;function Qn(i){const a=[];if(i)for(let l=0;l<i.length;l++)a.push(i[l].toString());return"[ "+a.join(", ")+" ]"}function co(i,a,l,o,u,f){const m=ct(i,a,f);return Ts(m,l,o,u)}function Ts(i,a,l,o){let u;i.error&&(u=N.fromValues(i.error));let f;i.messages&&(f=fi.fromValuesArray(i.messages));let m;a&&i.presence&&(m=a.WirePresenceMessage.fromValuesArray(i.presence));let p;l&&i.annotations&&(p=l.WireAnnotation.fromValuesArray(i.annotations));let R;return o&&i.state&&(R=o.ObjectMessage.fromValuesArray(i.state,Fe,In)),Object.assign(new Cl,be($({},i),{presence:m,messages:f,annotations:p,state:R,error:u}))}function _l(i){return a=>{var l;return Ts(a,{WirePresenceMessage:Ba},{WireAnnotation:di},(l=i?.ObjectsPlugin)!=null?l:null)}}function qt(i){return Object.assign(new Cl,i)}function ja(i,a,l,o){let u="[ProtocolMessage";i.action!==void 0&&(u+="; action="+Br[i.action]||i.action);const f=["id","channel","channelSerial","connectionId","count","msgSerial","timestamp"];let m;for(let p=0;p<f.length;p++)m=f[p],i[m]!==void 0&&(u+="; "+m+"="+i[m]);if(i.messages&&(u+="; messages="+Qn(fi.fromValuesArray(i.messages))),i.presence&&a&&(u+="; presence="+Qn(a.WirePresenceMessage.fromValuesArray(i.presence))),i.annotations&&l&&(u+="; annotations="+Qn(l.WireAnnotation.fromValuesArray(i.annotations))),i.state&&o&&(u+="; state="+Qn(o.ObjectMessage.fromValuesArray(i.state,Fe,In))),i.error&&(u+="; error="+N.fromValues(i.error).toString()),i.auth&&i.auth.accessToken&&(u+="; token="+i.auth.accessToken),i.flags&&(u+="; flags="+qr.filter(i.hasFlag).join(",")),i.params){let p="";Di(i.params,function(R){p.length>0&&(p+="; "),p+=R+"="+i.params[R]}),p.length>0&&(u+="; params=["+p+"]")}return u+="]",u}var Cl=class{constructor(){this.hasFlag=i=>(this.flags&xt[i])>0}setFlag(i){return this.flags=this.flags|xt[i]}getMode(){return(this.flags||0)&xt.MODE_ALL}encodeModesToFlags(i){i.forEach(a=>this.setFlag(a))}decodeModesFromFlags(){const i=[];return ds.forEach(a=>{this.hasFlag(a)&&i.push(a)}),i.length>0?i:void 0}},Xi=Cl,El=class{constructor(i,a,l,o,u){this.previous=i,this.current=a,a==="attached"&&(this.resumed=l,this.hasBacklog=o),u&&(this.reason=u)}},gi=El,Rs=function(){};function uo(i){if(i&&"params"in i&&!v(i.params))return new N("options.params must be an object",4e4,400);if(i&&"modes"in i){if(!Array.isArray(i.modes))return new N("options.modes must be an array",4e4,400);for(let a=0;a<i.modes.length;a++){const l=i.modes[a];if(!l||typeof l!="string"||!ds.includes(String.prototype.toUpperCase.call(l)))return new N("Invalid channel mode: "+l,4e4,400)}}}var mi=class ff extends dt{constructor(a,l,o){var u,f,m;super(a.logger),this._annotations=null,this._mode=0,this.retryCount=0,this.history=async function(p){h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.history()","channel = "+this.name);const R=this.client.rest.channelMixin;if(p&&p.untilAttach){if(this.state!=="attached")throw new N("option untilAttach requires the channel to be attached",4e4,400);if(!this.properties.attachSerial)throw new N("untilAttach was specified and channel is attached, but attachSerial is not defined",4e4,400);delete p.untilAttach,p.from_serial=this.properties.attachSerial}return R.history(this,p)},this.whenState=p=>dt.prototype.whenState.call(this,p,this.state),h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel()","started; name = "+l),this.name=l,this.channelOptions=On((u=a._Crypto)!=null?u:null,this.logger,o),this.client=a,this._presence=a._RealtimePresence?new a._RealtimePresence.RealtimePresence(this):null,a._Annotations&&(this._annotations=new a._Annotations.RealtimeAnnotations(this)),this.connectionManager=a.connection.connectionManager,this.state="initialized",this.subscriptions=new dt(this.logger),this.syncChannelSerial=void 0,this.properties={attachSerial:void 0,channelSerial:void 0},this.setOptions(o),this.errorReason=null,this._attachResume=!1,this._decodingContext={channelOptions:this.channelOptions,plugins:a.options.plugins||{},baseEncodedPreviousPayload:void 0},this._lastPayload={messageId:null,protocolMessageChannelSerial:null,decodeFailureRecoveryInProgress:null},this._allChannelChanges=new dt(this.logger),(f=a.options.plugins)!=null&&f.Push&&(this._push=new a.options.plugins.Push.PushChannel(this)),(m=a.options.plugins)!=null&&m.Objects&&(this._objects=new a.options.plugins.Objects.Objects(this))}get presence(){return this._presence||pt("RealtimePresence"),this._presence}get annotations(){return this._annotations||pt("Annotations"),this._annotations}get push(){return this._push||pt("Push"),this._push}get objects(){return this._objects||pt("Objects"),this._objects}invalidStateError(){return new N("Channel operation failed as channel state is "+this.state,90001,400,this.errorReason||void 0)}static processListenerArgs(a){return a=Array.prototype.slice.call(a),typeof a[0]=="function"&&a.unshift(null),a}async setOptions(a){var l;const o=this.channelOptions,u=uo(a);if(u)throw u;if(this.channelOptions=On((l=this.client._Crypto)!=null?l:null,this.logger,a),this._decodingContext&&(this._decodingContext.channelOptions=this.channelOptions),this._shouldReattachToSetOptions(a,o))return this.attachImpl(),new Promise((f,m)=>{this._allChannelChanges.once(["attached","update","detached","failed"],function(p){switch(this.event){case"update":case"attached":f();break;default:m(p.reason)}})})}_shouldReattachToSetOptions(a,l){if(!(this.state==="attached"||this.state==="attaching"))return!1;if(a?.params){const o=pi(a.params),u=pi(l.params);if(Object.keys(o).length!==Object.keys(u).length||!Ma(u,o))return!0}return!!(a?.modes&&(!l.modes||!il(a.modes,l.modes)))}async publish(...a){let l;if(a.length==1)if(v(a[0]))l=[Jt.fromValues(a[0])];else if(Array.isArray(a[0]))l=Jt.fromValuesArray(a[0]);else throw new N("The single-argument form of publish() expects a message object or an array of message objects",40013,400);else l=[Jt.fromValues({name:a[0],data:a[1]})];const u=this.client.options.maxMessageSize,f=await Kr(l,this.channelOptions),m=Sl(f);if(m>u)throw new N(`Maximum size of messages that can be published at once exceeded (was ${m} bytes; limit is ${u} bytes)`,40009,400);this.throwIfUnpublishableState(),h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.publish()","sending message; channel state is "+this.state+", message count = "+f.length);const p=qt({action:se.MESSAGE,channel:this.name,messages:f});return this.sendMessage(p)}throwIfUnpublishableState(){if(!this.connectionManager.activeState())throw this.connectionManager.getError();if(this.state==="failed"||this.state==="suspended")throw this.invalidStateError()}onEvent(a){h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.onEvent()","received message");const l=this.subscriptions;for(let o=0;o<a.length;o++){const u=a[o];l.emit(u.name,u)}}async attach(){return this.state==="attached"?null:new Promise((a,l)=>{this._attach(!1,null,(o,u)=>o?l(o):a(u))})}_attach(a,l,o){o||(o=f=>{f&&h.logAction(this.logger,h.LOG_ERROR,"RealtimeChannel._attach()","Channel attach failed: "+f.toString())});const u=this.connectionManager;if(!u.activeState()){o(u.getError());return}(this.state!=="attaching"||a)&&this.requestState("attaching",l),this.once(function(f){switch(this.event){case"attached":o?.(null,f);break;case"detached":case"suspended":case"failed":o?.(f.reason||u.getError()||new N("Unable to attach; reason unknown; state = "+this.event,9e4,500));break;case"detaching":o?.(new N("Attach request superseded by a subsequent detach request",9e4,409));break}})}attachImpl(){h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.attachImpl()","sending ATTACH message");const a=qt({action:se.ATTACH,channel:this.name,params:this.channelOptions.params,channelSerial:this.properties.channelSerial});this.channelOptions.modes&&a.encodeModesToFlags(Cr(this.channelOptions.modes)),this._attachResume&&a.setFlag("ATTACH_RESUME"),this._lastPayload.decodeFailureRecoveryInProgress&&(a.channelSerial=this._lastPayload.protocolMessageChannelSerial),this.sendMessage(a).catch(Rs)}async detach(){const a=this.connectionManager;if(!a.activeState())throw a.getError();switch(this.state){case"suspended":this.notifyState("detached");return;case"detached":return;case"failed":throw new N("Unable to detach; channel state = failed",90001,400);default:this.requestState("detaching");case"detaching":return new Promise((l,o)=>{this.once(function(u){switch(this.event){case"detached":l();break;case"attached":case"suspended":case"failed":o(u.reason||a.getError()||new N("Unable to detach; reason unknown; state = "+this.event,9e4,500));break;case"attaching":o(new N("Detach request superseded by a subsequent attach request",9e4,409));break}})})}}detachImpl(){h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.detach()","sending DETACH message");const a=qt({action:se.DETACH,channel:this.name});this.sendMessage(a).catch(Rs)}async subscribe(...a){const[l,o]=ff.processListenerArgs(a);if(this.state==="failed")throw N.fromValues(this.invalidStateError());return l&&typeof l=="object"&&!Array.isArray(l)?this.client._FilteredSubscriptions.subscribeFilter(this,l,o):this.subscriptions.on(l,o),this.channelOptions.attachOnSubscribe!==!1?this.attach():null}unsubscribe(...a){var l;const[o,u]=ff.processListenerArgs(a);if(typeof o=="object"&&!u||(l=this.filteredSubscriptions)!=null&&l.has(u)){this.client._FilteredSubscriptions.getAndDeleteFilteredSubscriptions(this,o,u).forEach(f=>this.subscriptions.off(f));return}this.subscriptions.off(o,u)}sync(){switch(this.state){case"initialized":case"detaching":case"detached":throw new Ue("Unable to sync to channel; not attached",4e4)}const a=this.connectionManager;if(!a.activeState())throw a.getError();const l=qt({action:se.SYNC,channel:this.name});this.syncChannelSerial&&(l.channelSerial=this.syncChannelSerial),a.send(l)}async sendMessage(a){return new Promise((l,o)=>{this.connectionManager.send(a,this.client.options.queueMessages,u=>{u?o(u):l()})})}async sendPresence(a){const l=qt({action:se.PRESENCE,channel:this.name,presence:a});return this.sendMessage(l)}sendState(a){const l=qt({action:se.OBJECT,channel:this.name,state:a});return this.sendMessage(l)}async processMessage(a){(a.action===se.ATTACHED||a.action===se.MESSAGE||a.action===se.PRESENCE||a.action===se.OBJECT||a.action===se.ANNOTATION)&&this.setChannelSerial(a.channelSerial);let l,o=!1;switch(a.action){case se.ATTACHED:{this.properties.attachSerial=a.channelSerial,this._mode=a.getMode(),this.params=a.params||{};const u=a.decodeModesFromFlags();this.modes=u&&nl(u)||void 0;const f=a.hasFlag("RESUMED"),m=a.hasFlag("HAS_PRESENCE"),p=a.hasFlag("HAS_BACKLOG"),R=a.hasFlag("HAS_OBJECTS");if(this.state==="attached"){f||(this._presence&&this._presence.onAttached(m),this._objects&&this._objects.onAttached(R));const A=new gi(this.state,this.state,f,p,a.error);this._allChannelChanges.emit("update",A),(!f||this.channelOptions.updateOnAttached)&&this.emit("update",A)}else this.state==="detaching"?this.checkPendingState():this.notifyState("attached",a.error,f,m,p,R);break}case se.DETACHED:{const u=a.error?N.fromValues(a.error):new N("Channel detached",90001,404);this.state==="detaching"?this.notifyState("detached",u):this.state==="attaching"?this.notifyState("suspended",u):(this.state==="attached"||this.state==="suspended")&&this.requestState("attaching",u);break}case se.SYNC:if(o=!0,l=this.syncChannelSerial=a.channelSerial,!a.presence)break;case se.PRESENCE:{if(!a.presence)break;Zt(a);const u=this.channelOptions;if(this._presence){const f=await Promise.all(a.presence.map(m=>m.decode(u,this.logger)));this._presence.setPresence(f,o,l)}break}case se.OBJECT:case se.OBJECT_SYNC:{if(!this._objects||!a.state)return;Zt(a);const u=a.state,f=this.client.connection.connectionManager.getActiveTransportFormat();await Promise.all(u.map(m=>this.client._objectsPlugin.ObjectMessage.decode(m,this.client,this.logger,h,Fe,f))),a.action===se.OBJECT?this._objects.handleObjectMessages(u):this._objects.handleObjectSyncMessages(u,a.channelSerial);break}case se.MESSAGE:{if(this.state!=="attached"){h.logAction(this.logger,h.LOG_MAJOR,"RealtimeChannel.processMessage()",'Message "'+a.id+'" skipped as this channel "'+this.name+'" state is not "attached" (state is "'+this.state+'").');return}Zt(a);const u=a.messages,f=u[0],m=u[u.length-1];if(f.extras&&f.extras.delta&&f.extras.delta.from!==this._lastPayload.messageId){const R='Delta message decode failure - previous message not available for message "'+a.id+'" on this channel "'+this.name+'".';h.logAction(this.logger,h.LOG_ERROR,"RealtimeChannel.processMessage()",R),this._startDecodeFailureRecovery(new N(R,40018,400));break}let p=[];for(let R=0;R<u.length;R++){const{decoded:A,err:L}=await u[R].decodeWithErr(this._decodingContext,this.logger);if(p[R]=A,L)switch(L.code){case 40018:this._startDecodeFailureRecovery(L);return;case 40019:case 40021:this.notifyState("failed",L);return}}this._lastPayload.messageId=m.id,this._lastPayload.protocolMessageChannelSerial=a.channelSerial,this.onEvent(p);break}case se.ANNOTATION:{Zt(a);const u=this.channelOptions;if(this._annotations){const f=await Promise.all((a.annotations||[]).map(m=>m.decode(u,this.logger)));this._annotations._processIncoming(f)}break}case se.ERROR:{const u=a.error;u&&u.code==80016?this.checkPendingState():this.notifyState("failed",N.fromValues(u));break}default:h.logAction(this.logger,h.LOG_MAJOR,"RealtimeChannel.processMessage()","Protocol error: unrecognised message action ("+a.action+")")}}_startDecodeFailureRecovery(a){this._lastPayload.decodeFailureRecoveryInProgress||(h.logAction(this.logger,h.LOG_MAJOR,"RealtimeChannel.processMessage()","Starting decode failure recovery process."),this._lastPayload.decodeFailureRecoveryInProgress=!0,this._attach(!0,a,()=>{this._lastPayload.decodeFailureRecoveryInProgress=!1}))}onAttached(){h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.onAttached","activating channel; name = "+this.name)}notifyState(a,l,o,u,f,m){if(h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.notifyState","name = "+this.name+", current state = "+this.state+", notifying state "+a),this.clearStateTimer(),["detached","suspended","failed"].includes(a)&&(this.properties.channelSerial=null),a===this.state)return;this._presence&&this._presence.actOnChannelState(a,u,l),this._objects&&this._objects.actOnChannelState(a,m),a==="suspended"&&this.connectionManager.state.sendEvents?this.startRetryTimer():this.cancelRetryTimer(),l&&(this.errorReason=l);const p=new gi(this.state,a,o,f,l),R='Channel state for channel "'+this.name+'"',A=a+(l?"; reason: "+l:"");a==="failed"?h.logAction(this.logger,h.LOG_ERROR,R,A):h.logAction(this.logger,h.LOG_MAJOR,R,A),a!=="attaching"&&a!=="suspended"&&(this.retryCount=0),a==="attached"&&this.onAttached(),a==="attached"?this._attachResume=!0:(a==="detaching"||a==="failed")&&(this._attachResume=!1),this.state=a,this._allChannelChanges.emit(a,p),this.emit(a,p)}requestState(a,l){h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.requestState","name = "+this.name+", state = "+a),this.notifyState(a,l),this.checkPendingState()}checkPendingState(){if(!this.connectionManager.state.sendEvents){h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.checkPendingState","sendEvents is false; state is "+this.connectionManager.state.state);return}switch(h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.checkPendingState","name = "+this.name+", state = "+this.state),this.state){case"attaching":this.startStateTimerIfNotRunning(),this.attachImpl();break;case"detaching":this.startStateTimerIfNotRunning(),this.detachImpl();break;case"attached":this.sync();break}}timeoutPendingState(){switch(this.state){case"attaching":{const a=new N("Channel attach timed out",90007,408);this.notifyState("suspended",a);break}case"detaching":{const a=new N("Channel detach timed out",90007,408);this.notifyState("attached",a);break}default:this.checkPendingState();break}}startStateTimerIfNotRunning(){this.stateTimer||(this.stateTimer=setTimeout(()=>{h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.startStateTimerIfNotRunning","timer expired"),this.stateTimer=null,this.timeoutPendingState()},this.client.options.timeouts.realtimeRequestTimeout))}clearStateTimer(){const a=this.stateTimer;a&&(clearTimeout(a),this.stateTimer=null)}startRetryTimer(){if(this.retryTimer)return;this.retryCount++;const a=Li(this.client.options.timeouts.channelRetryTimeout,this.retryCount);this.retryTimer=setTimeout(()=>{this.state==="suspended"&&this.connectionManager.state.sendEvents&&(this.retryTimer=null,h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel retry timer expired","attempting a new attach"),this.requestState("attaching"))},a)}cancelRetryTimer(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)}getReleaseErr(){const a=this.state;return a==="initialized"||a==="detached"||a==="failed"?null:new N("Can only release a channel in a state where there is no possibility of further updates from the server being received (initialized, detached, or failed); was "+a,90001,400)}setChannelSerial(a){h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.setChannelSerial()","Updating channel serial; serial = "+a+"; previous = "+this.properties.channelSerial),a&&(this.properties.channelSerial=a)}async status(){return this.client.rest.channelMixin.status(this)}};function pi(i){const a=i||{},{agent:l}=a;return rt(a,["agent"])}var yi=mi,fo=class{constructor(i){this.channel=i,this.logger=i.logger,this.subscriptions=new dt(this.logger)}async publish(i,a){const l=this.channel.name,o=ro(i,a),u=await o.encode();this.channel.throwIfUnpublishableState(),h.logAction(this.logger,h.LOG_MICRO,"RealtimeAnnotations.publish()","channelName = "+l+", sending annotation with messageSerial = "+o.messageSerial+", type = "+o.type);const f=qt({action:se.ANNOTATION,channel:l,annotations:[u]});return this.channel.sendMessage(f)}async delete(i,a){return a.action="annotation.delete",this.publish(i,a)}async subscribe(...i){const a=yi.processListenerArgs(i),l=a[0],o=a[1],u=this.channel;if(u.state==="failed")throw N.fromValues(u.invalidStateError());if(this.subscriptions.on(l,o),this.channel.channelOptions.attachOnSubscribe!==!1&&await u.attach(),(this.channel.state==="attached"&&this.channel._mode&xt.ANNOTATION_SUBSCRIBE)===0)throw new N("You are trying to add an annotation listener, but you haven't requested the annotation_subscribe channel mode in ChannelOptions, so this won't do anything (we only deliver annotations to clients who have explicitly requested them)",93001,400)}unsubscribe(...i){const a=yi.processListenerArgs(i),l=a[0],o=a[1];this.subscriptions.off(l,o)}_processIncoming(i){for(const a of i)this.subscriptions.emit(a.type||"",a)}async get(i,a){return Rl.prototype.get.call(this,i,a)}},Pn=fo,Xn=class pc extends no{constructor(a){var l,o;if(!pc._MsgPack)throw new Error("Expected DefaultRest._MsgPack to have been set");super(ge.objectifyOptions(a,!0,"Rest",h.defaultLogger,be($({},Al),{Crypto:(l=pc.Crypto)!=null?l:void 0,MsgPack:(o=pc._MsgPack)!=null?o:void 0,Annotations:{Annotation:Pi,WireAnnotation:di,RealtimeAnnotations:Pn,RestAnnotations:Rl}})))}static get Crypto(){if(this._Crypto===null)throw new Error("Encryption not enabled; use ably.encryption.js instead");return this._Crypto}static set Crypto(a){this._Crypto=a}};Xn._Crypto=null,Xn.Message=Yi,Xn.PresenceMessage=Qi,Xn.Annotation=Tl,Xn._MsgPack=null,Xn._Http=hs;var _s=Xn,ho=class extends dt{constructor(i){super(i),this.messages=[]}count(){return this.messages.length}push(i){this.messages.push(i)}shift(){return this.messages.shift()}last(){return this.messages[this.messages.length-1]}copyAll(){return this.messages.slice()}append(i){this.messages.push.apply(this.messages,i)}prepend(i){this.messages.unshift.apply(this.messages,i)}completeMessages(i,a,l){h.logAction(this.logger,h.LOG_MICRO,"MessageQueue.completeMessages()","serial = "+i+"; count = "+a),l=l||null;const o=this.messages;if(o.length===0)throw new Error("MessageQueue.completeMessages(): completeMessages called on any empty MessageQueue");const u=o[0];if(u){const f=u.message.msgSerial,m=i+a;if(m>f){const p=o.splice(0,m-f);for(const R of p)R.callback(l)}o.length==0&&this.emit("idle")}}completeAllMessages(i){this.completeMessages(0,Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,i)}resetSendAttempted(){for(let i of this.messages)i.sendAttempted=!1}clear(){h.logAction(this.logger,h.LOG_MICRO,"MessageQueue.clear()","clearing "+this.messages.length+" messages"),this.messages=[],this.emit("idle")}},go=ho,mo=class{constructor(i,a){this.message=i,this.callback=a,this.merged=!1;const l=i.action;this.sendAttempted=!1,this.ackRequired=typeof l=="number"&&[se.MESSAGE,se.PRESENCE,se.ANNOTATION,se.OBJECT].includes(l)}},zc=class extends dt{constructor(i){super(i.logger),this.transport=i,this.messageQueue=new go(this.logger),i.on("ack",(a,l)=>{this.onAck(a,l)}),i.on("nack",(a,l,o)=>{this.onNack(a,l,o)})}onAck(i,a){h.logAction(this.logger,h.LOG_MICRO,"Protocol.onAck()","serial = "+i+"; count = "+a),this.messageQueue.completeMessages(i,a)}onNack(i,a,l){h.logAction(this.logger,h.LOG_ERROR,"Protocol.onNack()","serial = "+i+"; count = "+a+"; err = "+Be(l)),l||(l=new N("Unable to send message; channel not responding",50001,500)),this.messageQueue.completeMessages(i,a,l)}onceIdle(i){const a=this.messageQueue;if(a.count()===0){i();return}a.once("idle",i)}send(i){i.ackRequired&&this.messageQueue.push(i),this.logger.shouldLog(h.LOG_MICRO)&&h.logActionNoStrip(this.logger,h.LOG_MICRO,"Protocol.send()","sending msg; "+ja(i.message,this.transport.connectionManager.realtime._RealtimePresence,this.transport.connectionManager.realtime._Annotations,this.transport.connectionManager.realtime._objectsPlugin)),i.sendAttempted=!0,this.transport.send(i.message)}getTransport(){return this.transport}getPendingMessages(){return this.messageQueue.copyAll()}clearPendingMessages(){return this.messageQueue.clear()}finish(){const i=this.transport;this.onceIdle(function(){i.disconnect()})}},po=zc,yo=class{constructor(i,a,l,o){this.previous=i,this.current=a,l&&(this.retryIn=l),o&&(this.reason=o)}},Ki=yo,vt={DISCONNECTED:80003,SUSPENDED:80002,FAILED:8e4,CLOSING:80017,CLOSED:80017,UNKNOWN_CONNECTION_ERR:50002,UNKNOWN_CHANNEL_ERR:50001},vo={disconnected:()=>N.fromValues({statusCode:400,code:vt.DISCONNECTED,message:"Connection to server temporarily unavailable"}),suspended:()=>N.fromValues({statusCode:400,code:vt.SUSPENDED,message:"Connection to server unavailable"}),failed:()=>N.fromValues({statusCode:400,code:vt.FAILED,message:"Connection failed or disconnected by server"}),closing:()=>N.fromValues({statusCode:400,code:vt.CLOSING,message:"Connection closing"}),closed:()=>N.fromValues({statusCode:400,code:vt.CLOSED,message:"Connection closed"}),unknownConnectionErr:()=>N.fromValues({statusCode:500,code:vt.UNKNOWN_CONNECTION_ERR,message:"Internal connection error"}),unknownChannelErr:()=>N.fromValues({statusCode:500,code:vt.UNKNOWN_CONNECTION_ERR,message:"Internal channel error"})};function Wt(i){return!i.statusCode||!i.code||i.statusCode>=500?!0:Object.values(vt).includes(i.code)}var bt=vo,Zi=qt({action:se.CLOSE}),Ml=qt({action:se.DISCONNECT}),Cs=class extends dt{constructor(i,a,l,o){super(i.logger),o&&(l.format=void 0,l.heartbeats=!0),this.connectionManager=i,this.auth=a,this.params=l,this.timeouts=l.options.timeouts,this.format=l.format,this.isConnected=!1,this.isFinished=!1,this.isDisposed=!1,this.maxIdleInterval=null,this.idleTimer=null,this.lastActivity=null}connect(){}close(){this.isConnected&&this.requestClose(),this.finish("closed",bt.closed())}disconnect(i){this.isConnected&&this.requestDisconnect(),this.finish("disconnected",i||bt.disconnected())}fail(i){this.isConnected&&this.requestDisconnect(),this.finish("failed",i||bt.failed())}finish(i,a){var l;this.isFinished||(this.isFinished=!0,this.isConnected=!1,this.maxIdleInterval=null,clearTimeout((l=this.idleTimer)!=null?l:void 0),this.idleTimer=null,this.emit(i,a),this.dispose())}onProtocolMessage(i){switch(this.logger.shouldLog(h.LOG_MICRO)&&h.logActionNoStrip(this.logger,h.LOG_MICRO,"Transport.onProtocolMessage()","received on "+this.shortName+": "+ja(i,this.connectionManager.realtime._RealtimePresence,this.connectionManager.realtime._Annotations,this.connectionManager.realtime._objectsPlugin)+"; connectionId = "+this.connectionManager.connectionId),this.onActivity(),i.action){case se.HEARTBEAT:h.logActionNoStrip(this.logger,h.LOG_MICRO,"Transport.onProtocolMessage()",this.shortName+" heartbeat; connectionId = "+this.connectionManager.connectionId),this.emit("heartbeat",i.id);break;case se.CONNECTED:this.onConnect(i),this.emit("connected",i.error,i.connectionId,i.connectionDetails,i);break;case se.CLOSED:this.onClose(i);break;case se.DISCONNECTED:this.onDisconnect(i);break;case se.ACK:this.emit("ack",i.msgSerial,i.count);break;case se.NACK:this.emit("nack",i.msgSerial,i.count,i.error);break;case se.SYNC:this.connectionManager.onChannelMessage(i,this);break;case se.ACTIVATE:break;case se.AUTH:Ie(this.auth.authorize(),a=>{a&&h.logAction(this.logger,h.LOG_ERROR,"Transport.onProtocolMessage()","Ably requested re-authentication, but unable to obtain a new token: "+Be(a))});break;case se.ERROR:if(h.logAction(this.logger,h.LOG_MINOR,"Transport.onProtocolMessage()","received error action; connectionId = "+this.connectionManager.connectionId+"; err = "+x.Config.inspect(i.error)+(i.channel?", channel: "+i.channel:"")),i.channel===void 0){this.onFatalError(i);break}this.connectionManager.onChannelMessage(i,this);break;default:this.connectionManager.onChannelMessage(i,this)}}onConnect(i){if(this.isConnected=!0,!i.connectionDetails)throw new Error("Transport.onConnect(): Connect message recieved without connectionDetails");const a=i.connectionDetails.maxIdleInterval;a&&(this.maxIdleInterval=a+this.timeouts.realtimeRequestTimeout,this.onActivity())}onDisconnect(i){const a=i&&i.error;h.logAction(this.logger,h.LOG_MINOR,"Transport.onDisconnect()","err = "+Be(a)),this.finish("disconnected",a)}onFatalError(i){const a=i&&i.error;h.logAction(this.logger,h.LOG_MINOR,"Transport.onFatalError()","err = "+Be(a)),this.finish("failed",a)}onClose(i){const a=i&&i.error;h.logAction(this.logger,h.LOG_MINOR,"Transport.onClose()","err = "+Be(a)),this.finish("closed",a)}requestClose(){h.logAction(this.logger,h.LOG_MINOR,"Transport.requestClose()",""),this.send(Zi)}requestDisconnect(){h.logAction(this.logger,h.LOG_MINOR,"Transport.requestDisconnect()",""),this.send(Ml)}ping(i){const a={action:se.HEARTBEAT};i&&(a.id=i),this.send(qt(a))}dispose(){h.logAction(this.logger,h.LOG_MINOR,"Transport.dispose()",""),this.isDisposed=!0,this.off()}onActivity(){this.maxIdleInterval&&(this.lastActivity=this.connectionManager.lastActivity=Date.now(),this.setIdleTimer(this.maxIdleInterval+100))}setIdleTimer(i){this.idleTimer||(this.idleTimer=setTimeout(()=>{this.onIdleTimerExpire()},i))}onIdleTimerExpire(){if(!this.lastActivity||!this.maxIdleInterval)throw new Error("Transport.onIdleTimerExpire(): lastActivity/maxIdleInterval not set");this.idleTimer=null;const i=Date.now()-this.lastActivity,a=this.maxIdleInterval-i;if(a<=0){const l="No activity seen from realtime in "+i+"ms; assuming connection has dropped";h.logAction(this.logger,h.LOG_ERROR,"Transport.onIdleTimerExpire()",l),this.disconnect(new N(l,80003,408))}else this.setIdleTimer(a+100)}static tryConnect(i,a,l,o,u){const f=new i(a,l,o);let m;const p=function(A){clearTimeout(m),u({event:this.event,error:A})},R=a.options.timeouts.realtimeRequestTimeout;return m=setTimeout(()=>{f.off(["preconnect","disconnected","failed"]),f.dispose(),p.call({event:"disconnected"},new N("Timeout waiting for transport to indicate itself viable",5e4,500))},R),f.on(["failed","disconnected"],p),f.on("preconnect",function(){h.logAction(a.logger,h.LOG_MINOR,"Transport.tryConnect()","viable transport "+f),clearTimeout(m),f.off(["failed","disconnected"],p),u(null,f)}),f.connect(),f}static isAvailable(){throw new N("isAvailable not implemented for transport",5e4,500)}},_n=Cs,_t;(i=>{i.WebSocket="web_socket",i.Comet="comet",i.XhrPolling="xhr_polling"})(_t||(_t={}));var Ji=typeof globalThis<"u"?globalThis:typeof window<"u"?window:self,Es=()=>{var i;return typeof x.WebStorage<"u"&&((i=x.WebStorage)==null?void 0:i.localSupported)},Kn=()=>{var i;return typeof x.WebStorage<"u"&&((i=x.WebStorage)==null?void 0:i.sessionSupported)},vi=function(){},wl="ably-transport-preference";function Vt(i,a,l){let o;if(i.channel!==a.channel||(o=i.action)!==se.PRESENCE&&o!==se.MESSAGE||o!==a.action)return!1;const u=o===se.PRESENCE?"presence":"messages",f=i[u].concat(a[u]);return Sl(f)>l||!is(f,"clientId")||!f.every(function(p){return!p.id})?!1:(i[u]=f,!0)}function Ga(i){try{return JSON.parse(i)}catch{return null}}var Cn=class{constructor(i,a,l,o){this.options=i,this.host=a,this.mode=l,this.connectionKey=o,this.format=i.useBinaryProtocol?"msgpack":"json"}getConnectParams(i){const a=i?le(i):{},l=this.options;switch(this.mode){case"resume":a.resume=this.connectionKey;break;case"recover":{const o=Ga(l.recover);o&&(a.recover=o.connectionKey);break}}return l.clientId!==void 0&&(a.clientId=l.clientId),l.echoMessages===!1&&(a.echo="false"),this.format!==void 0&&(a.format=this.format),this.stream!==void 0&&(a.stream=this.stream),this.heartbeats!==void 0&&(a.heartbeats=this.heartbeats),a.v=ge.protocolVersion,a.agent=rl(this.options),l.transportParams!==void 0&&j(a,l.transportParams),a}toString(){let i="[mode="+this.mode;return this.host&&(i+=",host="+this.host),this.connectionKey&&(i+=",connectionKey="+this.connectionKey),this.format&&(i+=",format="+this.format),i+="]",i}},bo=class Xd extends dt{constructor(a,l){super(a.logger),this.supportedTransports={},this.disconnectedRetryCount=0,this.pendingChannelMessagesState={isProcessing:!1,queue:[]},this.realtime=a,this.initTransports(),this.options=l;const o=l.timeouts,u=o.webSocketConnectTimeout+o.realtimeRequestTimeout;if(this.states={initialized:{state:"initialized",terminal:!1,queueEvents:!0,sendEvents:!1,failState:"disconnected"},connecting:{state:"connecting",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:u,failState:"disconnected"},connected:{state:"connected",terminal:!1,queueEvents:!1,sendEvents:!0,failState:"disconnected"},disconnected:{state:"disconnected",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:o.disconnectedRetryTimeout,failState:"disconnected"},suspended:{state:"suspended",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:o.suspendedRetryTimeout,failState:"suspended"},closing:{state:"closing",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:o.realtimeRequestTimeout,failState:"closed"},closed:{state:"closed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"closed"},failed:{state:"failed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"failed"}},this.state=this.states.initialized,this.errorReason=null,this.queuedMessages=new go(this.logger),this.msgSerial=0,this.connectionDetails=void 0,this.connectionId=void 0,this.connectionKey=void 0,this.connectionStateTtl=o.connectionStateTtl,this.maxIdleInterval=null,this.transports=ne(l.transports||ge.defaultTransports,this.supportedTransports),this.transportPreference=null,this.transports.includes(_t.WebSocket)&&(this.webSocketTransportAvailable=!0),this.transports.includes(_t.XhrPolling)?this.baseTransport=_t.XhrPolling:this.transports.includes(_t.Comet)&&(this.baseTransport=_t.Comet),this.domains=ge.getHosts(l),this.activeProtocol=null,this.host=null,this.lastAutoReconnectAttempt=null,this.lastActivity=null,this.forceFallbackHost=!1,this.connectCounter=0,this.wsCheckResult=null,this.webSocketSlowTimer=null,this.webSocketGiveUpTimer=null,this.abandonedWebSocket=!1,h.logAction(this.logger,h.LOG_MINOR,"Realtime.ConnectionManager()","started"),h.logAction(this.logger,h.LOG_MICRO,"Realtime.ConnectionManager()","requested transports = ["+(l.transports||ge.defaultTransports)+"]"),h.logAction(this.logger,h.LOG_MICRO,"Realtime.ConnectionManager()","available transports = ["+this.transports+"]"),h.logAction(this.logger,h.LOG_MICRO,"Realtime.ConnectionManager()","http domains = ["+this.domains+"]"),!this.transports.length){const m="no requested transports available";throw h.logAction(this.logger,h.LOG_ERROR,"realtime.ConnectionManager()",m),new Error(m)}const f=x.Config.addEventListener;f&&(Kn()&&typeof l.recover=="function"&&f("beforeunload",this.persistConnection.bind(this)),l.closeOnUnload===!0&&f("beforeunload",()=>{h.logAction(this.logger,h.LOG_MAJOR,"Realtime.ConnectionManager()","beforeunload event has triggered the connection to close as closeOnUnload is true"),this.requestState({state:"closing"})}),f("online",()=>{var m;this.state==this.states.disconnected||this.state==this.states.suspended?(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager caught browser ‘online’ event","reattempting connection"),this.requestState({state:"connecting"})):this.state==this.states.connecting&&((m=this.pendingTransport)==null||m.off(),this.disconnectAllTransports(),this.startConnect())}),f("offline",()=>{this.state==this.states.connected&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager caught browser ‘offline’ event","disconnecting active transport"),this.disconnectAllTransports())}))}static supportedTransports(a){const l={supportedTransports:{}};return this.initTransports(a,l),l.supportedTransports}static initTransports(a,l){const o=$($({},x.Transports.bundledImplementations),a);[_t.WebSocket,...x.Transports.order].forEach(u=>{const f=o[u];f&&f.isAvailable()&&(l.supportedTransports[u]=f)})}initTransports(){Xd.initTransports(this.realtime._additionalTransportImplementations,this)}createTransportParams(a,l){return new Cn(this.options,a,l,this.connectionKey)}getTransportParams(a){(o=>{if(this.connectionKey){o("resume");return}if(typeof this.options.recover=="string"){o("recover");return}const u=this.options.recover,f=this.getSessionRecoverData(),m=this.sessionRecoveryName();if(f&&typeof u=="function"){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.getTransportParams()","Calling clientOptions-provided recover function with last session data (recovery scope: "+m+")"),u(f,p=>{p?(this.options.recover=f.recoveryKey,o("recover")):o("clean")});return}o("clean")})(o=>{const u=this.createTransportParams(null,o);if(o==="recover"){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport recovery mode = recover; recoveryKey = "+this.options.recover);const f=Ga(this.options.recover);f&&(this.msgSerial=f.msgSerial)}else h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport params = "+u.toString());a(u)})}tryATransport(a,l,o){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.tryATransport()","trying "+l),this.proposedTransport=_n.tryConnect(this.supportedTransports[l],this,this.realtime.auth,a,(u,f)=>{const m=this.state;if(m==this.states.closing||m==this.states.closed||m==this.states.failed){f&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.tryATransport()","connection "+m.state+" while we were attempting the transport; closing "+f),f.close()),o(!0);return}if(u){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.tryATransport()","transport "+l+" "+u.event+", err: "+u.error.toString()),hn.isTokenErr(u.error)&&!(this.errorReason&&hn.isTokenErr(this.errorReason))?(this.errorReason=u.error,Ie(this.realtime.auth._forceNewToken(null,null),p=>{if(p){this.actOnErrorFromAuthorize(p);return}this.tryATransport(a,l,o)})):u.event==="failed"?(this.notifyState({state:"failed",error:u.error}),o(!0)):u.event==="disconnected"&&(Wt(u.error)?o(!1):(this.notifyState({state:this.states.connecting.failState,error:u.error}),o(!0)));return}h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.tryATransport()","viable transport "+l+"; setting pending"),this.setTransportPending(f,a),o(null,f)})}setTransportPending(a,l){const o=l.mode;h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.setTransportPending()","transport = "+a+"; mode = "+o),this.pendingTransport=a,this.cancelWebSocketSlowTimer(),this.cancelWebSocketGiveUpTimer(),a.once("connected",(f,m,p)=>{this.activateTransport(f,a,m,p),o==="recover"&&this.options.recover&&(delete this.options.recover,this.unpersistConnection())});const u=this;a.on(["disconnected","closed","failed"],function(f){u.deactivateTransport(a,this.event,f)}),this.emit("transport.pending",a)}activateTransport(a,l,o,u){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.activateTransport()","transport = "+l),a&&h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.activateTransport()","error = "+a),o&&h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.activateTransport()","connectionId =  "+o),u&&h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.activateTransport()","connectionDetails =  "+JSON.stringify(u)),this.persistTransportPreference(l);const f=this.state,m=this.states.connected.state;if(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.activateTransport()","current state = "+f.state),f.state==this.states.closing.state||f.state==this.states.closed.state||f.state==this.states.failed.state)return h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.activateTransport()","Disconnecting transport and abandoning"),l.disconnect(),!1;if(delete this.pendingTransport,!l.isConnected)return h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.activateTransport()","Declining to activate transport "+l+" since it appears to no longer be connected"),!1;const p=this.activeProtocol;this.activeProtocol=new po(l),this.host=l.params.host;const R=u.connectionKey;if(R&&this.connectionKey!=R&&this.setConnection(o,u,!!a),this.onConnectionDetailsUpdate(u,l),x.Config.nextTick(()=>{l.on("connected",(A,L,B)=>{this.onConnectionDetailsUpdate(B,l),this.emit("update",new Ki(m,m,null,A))})}),f.state===this.states.connected.state?a&&(this.errorReason=this.realtime.connection.errorReason=a,this.emit("update",new Ki(m,m,null,a))):(this.notifyState({state:"connected",error:a}),this.errorReason=this.realtime.connection.errorReason=a||null),this.emit("transport.active",l),p)if(p.messageQueue.count()>0&&h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.activateTransport()","Previous active protocol (for transport "+p.transport.shortName+", new one is "+l.shortName+") finishing with "+p.messageQueue.count()+" messages still pending"),p.transport===l){const A="Assumption violated: activating a transport that was also the transport for the previous active protocol; transport = "+l.shortName+"; stack = "+new Error().stack;h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.activateTransport()",A)}else p.finish();return!0}deactivateTransport(a,l,o){const u=this.activeProtocol,f=u&&u.getTransport()===a,m=a===this.pendingTransport,p=this.noTransportsScheduledForActivation();if(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.deactivateTransport()","transport = "+a),h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.deactivateTransport()","state = "+l+(f?"; was active":m?"; was pending":"")+(p?"":"; another transport is scheduled for activation")),o&&o.message&&h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.deactivateTransport()","reason =  "+o.message),f&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.deactivateTransport()","Getting, clearing, and requeuing "+this.activeProtocol.messageQueue.count()+" pending messages"),this.queuePendingMessages(u.getPendingMessages()),u.clearPendingMessages(),this.activeProtocol=this.host=null),this.emit("transport.inactive",a),f&&p||f&&l==="failed"||l==="closed"||u===null&&m){if(l==="disconnected"&&o&&o.statusCode>500&&this.domains.length>1){this.unpersistTransportPreference(),this.forceFallbackHost=!0,this.notifyState({state:l,error:o,retryImmediately:!0});return}const R=l==="failed"&&hn.isTokenErr(o)?"disconnected":l;this.notifyState({state:R,error:o});return}}noTransportsScheduledForActivation(){return!this.pendingTransport||!this.pendingTransport.isConnected}setConnection(a,l,o){const u=this.connectionId;(u&&u!==a||!u&&o)&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.setConnection()","Resetting msgSerial"),this.msgSerial=0,this.queuedMessages.resetSendAttempted()),this.connectionId!==a&&h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.setConnection()","New connectionId; reattaching any attached channels"),this.realtime.connection.id=this.connectionId=a,this.realtime.connection.key=this.connectionKey=l.connectionKey}clearConnection(){this.realtime.connection.id=this.connectionId=void 0,this.realtime.connection.key=this.connectionKey=void 0,this.msgSerial=0,this.unpersistConnection()}createRecoveryKey(){return this.connectionKey?JSON.stringify({connectionKey:this.connectionKey,msgSerial:this.msgSerial,channelSerials:this.realtime.channels.channelSerials()}):null}checkConnectionStateFreshness(){if(!this.lastActivity||!this.connectionId)return;const a=Date.now()-this.lastActivity;a>this.connectionStateTtl+this.maxIdleInterval&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.checkConnectionStateFreshness()","Last known activity from realtime was "+a+"ms ago; discarding connection state"),this.clearConnection(),this.states.connecting.failState="suspended")}persistConnection(){if(Kn()){const a=this.createRecoveryKey();a&&this.setSessionRecoverData({recoveryKey:a,disconnectedAt:Date.now(),location:Ji.location,clientId:this.realtime.auth.clientId})}}unpersistConnection(){this.clearSessionRecoverData()}getActiveTransportFormat(){var a;return(a=this.activeProtocol)==null?void 0:a.getTransport().format}getError(){if(this.errorReason){const a=Ue.fromValues(this.errorReason);return a.cause=this.errorReason,a}return this.getStateError()}getStateError(){var a,l;return(l=(a=bt)[this.state.state])==null?void 0:l.call(a)}activeState(){return this.state.queueEvents||this.state.sendEvents}enactStateChange(a){const l="Connection state",o=a.current+(a.reason?"; reason: "+a.reason:"");a.current==="failed"?h.logAction(this.logger,h.LOG_ERROR,l,o):h.logAction(this.logger,h.LOG_MAJOR,l,o),h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.enactStateChange","setting new state: "+a.current+"; reason = "+(a.reason&&a.reason.message));const u=this.state=this.states[a.current];a.reason&&(this.errorReason=a.reason,this.realtime.connection.errorReason=a.reason),(u.terminal||u.state==="suspended")&&this.clearConnection(),this.emit("connectionstate",a)}startTransitionTimer(a){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.startTransitionTimer()","transitionState: "+a.state),this.transitionTimer&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.startTransitionTimer()","clearing already-running timer"),clearTimeout(this.transitionTimer)),this.transitionTimer=setTimeout(()=>{this.transitionTimer&&(this.transitionTimer=null,h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager "+a.state+" timer expired","requesting new state: "+a.failState),this.notifyState({state:a.failState}))},a.retryDelay)}cancelTransitionTimer(){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.cancelTransitionTimer()",""),this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null)}startSuspendTimer(){this.suspendTimer||(this.suspendTimer=setTimeout(()=>{this.suspendTimer&&(this.suspendTimer=null,h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager suspend timer expired","requesting new state: suspended"),this.states.connecting.failState="suspended",this.notifyState({state:"suspended"}))},this.connectionStateTtl))}checkSuspendTimer(a){a!=="disconnected"&&a!=="suspended"&&a!=="connecting"&&this.cancelSuspendTimer()}cancelSuspendTimer(){this.states.connecting.failState="disconnected",this.suspendTimer&&(clearTimeout(this.suspendTimer),this.suspendTimer=null)}startRetryTimer(a){this.retryTimer=setTimeout(()=>{h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager retry timer expired","retrying"),this.retryTimer=null,this.requestState({state:"connecting"})},a)}cancelRetryTimer(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)}startWebSocketSlowTimer(){this.webSocketSlowTimer=setTimeout(()=>{h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager WebSocket slow timer","checking connectivity"),this.checkWsConnectivity().then(()=>{h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager WebSocket slow timer","ws connectivity check succeeded"),this.wsCheckResult=!0}).catch(()=>{h.logAction(this.logger,h.LOG_MAJOR,"ConnectionManager WebSocket slow timer","ws connectivity check failed"),this.wsCheckResult=!1}),this.realtime.http.checkConnectivity&&Ie(this.realtime.http.checkConnectivity(),(a,l)=>{a||!l?(h.logAction(this.logger,h.LOG_MAJOR,"ConnectionManager WebSocket slow timer","http connectivity check failed"),this.cancelWebSocketGiveUpTimer(),this.notifyState({state:"disconnected",error:new N("Unable to connect (network unreachable)",80003,404)})):h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager WebSocket slow timer","http connectivity check succeeded")})},this.options.timeouts.webSocketSlowTimeout)}cancelWebSocketSlowTimer(){this.webSocketSlowTimer&&(clearTimeout(this.webSocketSlowTimer),this.webSocketSlowTimer=null)}startWebSocketGiveUpTimer(a){this.webSocketGiveUpTimer=setTimeout(()=>{var l,o;this.wsCheckResult||(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager WebSocket give up timer","websocket connection took more than 10s; "+(this.baseTransport?"trying base transport":"")),this.baseTransport?(this.abandonedWebSocket=!0,(l=this.proposedTransport)==null||l.dispose(),(o=this.pendingTransport)==null||o.dispose(),this.connectBase(a,++this.connectCounter)):h.logAction(this.logger,h.LOG_MAJOR,"ConnectionManager WebSocket give up timer","websocket connectivity appears to be unavailable but no other transports to try"))},this.options.timeouts.webSocketConnectTimeout)}cancelWebSocketGiveUpTimer(){this.webSocketGiveUpTimer&&(clearTimeout(this.webSocketGiveUpTimer),this.webSocketGiveUpTimer=null)}notifyState(a){var l,o;const u=a.state,f=u==="disconnected"&&(this.state===this.states.connected||a.retryImmediately||this.state===this.states.connecting&&a.error&&hn.isTokenErr(a.error)&&!(this.errorReason&&hn.isTokenErr(this.errorReason)));if(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.notifyState()","new state: "+u+(f?"; will retry connection immediately":"")),u==this.state.state||(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.cancelWebSocketSlowTimer(),this.cancelWebSocketGiveUpTimer(),this.checkSuspendTimer(a.state),(u==="suspended"||u==="connected")&&(this.disconnectedRetryCount=0),this.state.terminal))return;const m=this.states[a.state];let p=m.retryDelay;m.state==="disconnected"&&(this.disconnectedRetryCount++,p=Li(m.retryDelay,this.disconnectedRetryCount));const R=new Ki(this.state.state,m.state,p,a.error||((o=(l=bt)[m.state])==null?void 0:o.call(l)));if(f){const A=()=>{this.state===this.states.disconnected&&(this.lastAutoReconnectAttempt=Date.now(),this.requestState({state:"connecting"}))},L=this.lastAutoReconnectAttempt&&Date.now()-this.lastAutoReconnectAttempt+1;L&&L<1e3?(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.notifyState()","Last reconnect attempt was only "+L+"ms ago, waiting another "+(1e3-L)+"ms before trying again"),setTimeout(A,1e3-L)):x.Config.nextTick(A)}else(u==="disconnected"||u==="suspended")&&this.startRetryTimer(p);(u==="disconnected"&&!f||u==="suspended"||m.terminal)&&x.Config.nextTick(()=>{this.disconnectAllTransports()}),u=="connected"&&!this.activeProtocol&&h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.notifyState()","Broken invariant: attempted to go into connected state, but there is no active protocol"),this.enactStateChange(R),this.state.sendEvents?this.sendQueuedMessages():this.state.queueEvents||(this.realtime.channels.propogateConnectionInterruption(u,R.reason),this.failQueuedMessages(R.reason))}requestState(a){var l,o;const u=a.state;if(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.requestState()","requested state: "+u+"; current state: "+this.state.state),u==this.state.state||(this.cancelWebSocketSlowTimer(),this.cancelWebSocketGiveUpTimer(),this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(u),u=="connecting"&&this.state.state=="connected")||u=="closing"&&this.state.state=="closed")return;const f=this.states[u],m=new Ki(this.state.state,f.state,null,a.error||((o=(l=bt)[f.state])==null?void 0:o.call(l)));this.enactStateChange(m),u=="connecting"&&x.Config.nextTick(()=>{this.startConnect()}),u=="closing"&&this.closeImpl()}startConnect(){if(this.state!==this.states.connecting){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.startConnect()","Must be in connecting state to connect, but was "+this.state.state);return}const a=this.realtime.auth,l=++this.connectCounter,o=()=>{this.checkConnectionStateFreshness(),this.getTransportParams(u=>{if(u.mode==="recover"&&u.options.recover){const f=Ga(u.options.recover);f&&this.realtime.channels.recoverChannels(f.channelSerials)}l===this.connectCounter&&this.connectImpl(u,l)})};if(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.startConnect()","starting connection"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),a.method==="basic")o();else{const u=f=>{l===this.connectCounter&&(f?this.actOnErrorFromAuthorize(f):o())};this.errorReason&&hn.isTokenErr(this.errorReason)?Ie(a._forceNewToken(null,null),u):Ie(a._ensureValidAuthCredentials(!1),u)}}connectImpl(a,l){const o=this.state.state;if(o!==this.states.connecting.state){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.connectImpl()","Must be in connecting state to connect, but was "+o);return}const u=this.getTransportPreference();u&&u===this.baseTransport&&this.webSocketTransportAvailable&&this.checkWsConnectivity().then(()=>{this.unpersistTransportPreference(),this.state===this.states.connecting&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.connectImpl():","web socket connectivity available, cancelling connection attempt with "+this.baseTransport),this.disconnectAllTransports(),this.connectWs(a,++this.connectCounter))}).catch(vi),u&&u===this.baseTransport||this.baseTransport&&!this.webSocketTransportAvailable?this.connectBase(a,l):this.connectWs(a,l)}connectWs(a,l){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.connectWs()"),this.wsCheckResult=null,this.abandonedWebSocket=!1,this.startWebSocketSlowTimer(),this.startWebSocketGiveUpTimer(a),this.tryTransportWithFallbacks("web_socket",a,!0,l,()=>this.wsCheckResult!==!1&&!this.abandonedWebSocket)}connectBase(a,l){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.connectBase()"),this.baseTransport?this.tryTransportWithFallbacks(this.baseTransport,a,!1,l,()=>!0):this.notifyState({state:"disconnected",error:new N("No transports left to try",8e4,404)})}tryTransportWithFallbacks(a,l,o,u,f){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.tryTransportWithFallbacks()",a);const m=B=>{this.notifyState({state:this.states.connecting.failState,error:B})},p=this.domains.slice(),R=(B,Y)=>{if(u===this.connectCounter){if(!f()){Y&&Y.dispose();return}!Y&&!B&&L()}},A=p.shift();if(!A){m(new N("Unable to connect (no available host)",80003,404));return}l.host=A;const L=()=>{if(!p.length){m(new N("Unable to connect (and no more fallback hosts to try)",80003,404));return}if(!this.realtime.http.checkConnectivity){m(new Ue("Internal error: Http.checkConnectivity not set",null,500));return}Ie(this.realtime.http.checkConnectivity(),(B,Y)=>{if(u===this.connectCounter&&f()){if(B){m(B);return}if(!Y){m(new N("Unable to connect (network unreachable)",80003,404));return}l.host=Qt(p),this.tryATransport(l,a,R)}})};if(this.forceFallbackHost&&p.length){this.forceFallbackHost=!1,L();return}this.tryATransport(l,a,R)}closeImpl(){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.closeImpl()","closing connection"),this.cancelSuspendTimer(),this.startTransitionTimer(this.states.closing),this.pendingTransport&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.closeImpl()","Closing pending transport: "+this.pendingTransport),this.pendingTransport.close()),this.activeProtocol&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.closeImpl()","Closing active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().close()),this.notifyState({state:"closed"})}onAuthUpdated(a,l){var o;switch(this.state.state){case"connected":{h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Sending AUTH message on active transport");const u=(o=this.activeProtocol)==null?void 0:o.getTransport();u&&u.onAuthUpdated&&u.onAuthUpdated(a);const f=qt({action:se.AUTH,auth:{accessToken:a.token}});this.send(f);const m=()=>{this.off(p),l(null,a)},p=R=>{R.current==="failed"&&(this.off(m),this.off(p),l(R.reason||this.getStateError()))};this.once("connectiondetails",m),this.on("connectionstate",p);break}case"connecting":h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Aborting current connection attempts in order to start again with the new auth details"),this.disconnectAllTransports();default:{h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Connection state is "+this.state.state+"; waiting until either connected or failed");const u=f=>{switch(f.current){case"connected":this.off(u),l(null,a);break;case"failed":case"closed":case"suspended":this.off(u),l(f.reason||this.getStateError());break}};this.on("connectionstate",u),this.state.state==="connecting"?this.startConnect():this.requestState({state:"connecting"})}}}disconnectAllTransports(){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.disconnectAllTransports()","Disconnecting all transports"),this.connectCounter++,this.pendingTransport&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting pending transport: "+this.pendingTransport),this.pendingTransport.disconnect()),delete this.pendingTransport,this.proposedTransport&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting proposed transport: "+this.pendingTransport),this.proposedTransport.disconnect()),delete this.pendingTransport,this.activeProtocol&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().disconnect())}send(a,l,o){o=o||vi;const u=this.state;if(u.sendEvents){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.send()","sending event"),this.sendImpl(new mo(a,o));return}if(!(l&&u.queueEvents)){const m="rejecting event, queueEvent was "+l+", state was "+u.state;h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.send()",m),o(this.errorReason||new N(m,9e4,400));return}this.logger.shouldLog(h.LOG_MICRO)&&h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.send()","queueing msg; "+ja(a,this.realtime._RealtimePresence,this.realtime._Annotations,this.realtime._objectsPlugin)),this.queue(a,o)}sendImpl(a){const l=a.message;a.ackRequired&&!a.sendAttempted&&(l.msgSerial=this.msgSerial++);try{this.activeProtocol.send(a)}catch(o){h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.sendImpl()","Unexpected exception in transport.send(): "+o.stack)}}queue(a,l){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.queue()","queueing event");const o=this.queuedMessages.last(),u=this.options.maxMessageSize;o&&!o.sendAttempted&&Vt(o.message,a,u)?(o.merged||(o.callback=zn.create(this.logger,[o.callback]),o.merged=!0),o.callback.push(l)):this.queuedMessages.push(new mo(a,l))}sendQueuedMessages(){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.sendQueuedMessages()","sending "+this.queuedMessages.count()+" queued messages");let a;for(;a=this.queuedMessages.shift();)this.sendImpl(a)}queuePendingMessages(a){a&&a.length&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.queuePendingMessages()","queueing "+a.length+" pending messages"),this.queuedMessages.prepend(a))}failQueuedMessages(a){const l=this.queuedMessages.count();l>0&&(h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.failQueuedMessages()","failing "+l+" queued messages, err = "+Be(a)),this.queuedMessages.completeAllMessages(a))}onChannelMessage(a,l){this.pendingChannelMessagesState.queue.push({message:a,transport:l}),this.pendingChannelMessagesState.isProcessing||this.processNextPendingChannelMessage()}processNextPendingChannelMessage(){if(this.pendingChannelMessagesState.queue.length>0){this.pendingChannelMessagesState.isProcessing=!0;const a=this.pendingChannelMessagesState.queue.shift();this.processChannelMessage(a.message).catch(l=>{h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.processNextPendingChannelMessage() received error ",l)}).finally(()=>{this.pendingChannelMessagesState.isProcessing=!1,this.processNextPendingChannelMessage()})}}async processChannelMessage(a){await this.realtime.channels.processChannelMessage(a)}async ping(){var a;if(this.state.state!=="connected")throw new N("Unable to ping service; not connected",4e4,400);const l=(a=this.activeProtocol)==null?void 0:a.getTransport();if(!l)throw this.getStateError();h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.ping()","transport = "+l);const o=Date.now(),u=ls();return qi(new Promise(f=>{const m=p=>{p===u&&(l.off("heartbeat",m),f(Date.now()-o))};l.on("heartbeat",m),l.ping(u)}),this.options.timeouts.realtimeRequestTimeout,"Timeout waiting for heartbeat response")}abort(a){this.activeProtocol.getTransport().fail(a)}getTransportPreference(){var a,l;return this.transportPreference||Es()&&((l=(a=x.WebStorage)==null?void 0:a.get)==null?void 0:l.call(a,wl))}persistTransportPreference(a){var l,o;this.transportPreference=a.shortName,Es()&&((o=(l=x.WebStorage)==null?void 0:l.set)==null||o.call(l,wl,a.shortName))}unpersistTransportPreference(){var a,l;this.transportPreference=null,Es()&&((l=(a=x.WebStorage)==null?void 0:a.remove)==null||l.call(a,wl))}actOnErrorFromAuthorize(a){if(a.code===40171)this.notifyState({state:"failed",error:a});else if(a.code===40102)this.notifyState({state:"failed",error:a});else if(a.statusCode===oi.Forbidden){const l="Client configured authentication provider returned 403; failing the connection";h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.actOnErrorFromAuthorize()",l),this.notifyState({state:"failed",error:new N(l,80019,403,a)})}else{const l="Client configured authentication provider request failed";h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.actOnErrorFromAuthorize",l),this.notifyState({state:this.state.failState,error:new N(l,80019,401,a)})}}onConnectionDetailsUpdate(a,l){if(!a)return;this.connectionDetails=a,a.maxMessageSize&&(this.options.maxMessageSize=a.maxMessageSize);const o=a.clientId;if(o){const f=this.realtime.auth._uncheckedSetClientId(o);if(f){h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.onConnectionDetailsUpdate()",f.message),l.fail(f);return}}const u=a.connectionStateTtl;u&&(this.connectionStateTtl=u),this.maxIdleInterval=a.maxIdleInterval,this.emit("connectiondetails",a)}checkWsConnectivity(){const a=this.options.wsConnectivityCheckUrl||ge.wsConnectivityCheckUrl,l=new x.Config.WebSocket(a);return new Promise((o,u)=>{let f=!1;l.onopen=()=>{f||(f=!0,o(),l.close())},l.onclose=l.onerror=()=>{f||(f=!0,u())}})}sessionRecoveryName(){return this.options.recoveryKeyStorageName||"ably-connection-recovery"}getSessionRecoverData(){var a,l;return Kn()&&((l=(a=x.WebStorage)==null?void 0:a.getSession)==null?void 0:l.call(a,this.sessionRecoveryName()))}setSessionRecoverData(a){var l,o;return Kn()&&((o=(l=x.WebStorage)==null?void 0:l.setSession)==null?void 0:o.call(l,this.sessionRecoveryName(),a))}clearSessionRecoverData(){var a,l;return Kn()&&((l=(a=x.WebStorage)==null?void 0:a.removeSession)==null?void 0:l.call(a,this.sessionRecoveryName()))}},za=bo,bi=class extends dt{constructor(i,a){super(i.logger),this.whenState=l=>dt.prototype.whenState.call(this,l,this.state),this.ably=i,this.connectionManager=new za(i,a),this.state=this.connectionManager.state.state,this.key=void 0,this.id=void 0,this.errorReason=null,this.connectionManager.on("connectionstate",l=>{const o=this.state=l.current;x.Config.nextTick(()=>{this.emit(o,l)})}),this.connectionManager.on("update",l=>{x.Config.nextTick(()=>{this.emit("update",l)})})}connect(){h.logAction(this.logger,h.LOG_MINOR,"Connection.connect()",""),this.connectionManager.requestState({state:"connecting"})}async ping(){return h.logAction(this.logger,h.LOG_MINOR,"Connection.ping()",""),this.connectionManager.ping()}close(){h.logAction(this.logger,h.LOG_MINOR,"Connection.close()","connectionKey = "+this.key),this.connectionManager.requestState({state:"closing"})}get recoveryKey(){return this.logger.deprecationWarning("The `Connection.recoveryKey` attribute has been replaced by the `Connection.createRecoveryKey()` method. Replace your usage of `recoveryKey` with the return value of `createRecoveryKey()`. `recoveryKey` will be removed in a future version."),this.createRecoveryKey()}createRecoveryKey(){return this.connectionManager.createRecoveryKey()}},Nl=bi,Ms=class Kd extends ps{constructor(a){var l,o,u,f;if(super(ge.objectifyOptions(a,!1,"BaseRealtime",h.defaultLogger)),h.logAction(this.logger,h.LOG_MINOR,"Realtime()",""),typeof EdgeRuntime=="string")throw new N(`Ably.Realtime instance cannot be used in Vercel Edge runtime. If you are running Vercel Edge functions, please replace your "new Ably.Realtime()" with "new Ably.Rest()" and use Ably Rest API instead of the Realtime API. If you are server-rendering your application in the Vercel Edge runtime, please use the condition "if (typeof EdgeRuntime === 'string')" to prevent instantiating Ably.Realtime instance during SSR in the Vercel Edge runtime.`,4e4,400);this._additionalTransportImplementations=Kd.transportImplementationsFromPlugins(this.options.plugins),this._RealtimePresence=(o=(l=this.options.plugins)==null?void 0:l.RealtimePresence)!=null?o:null,this._objectsPlugin=(f=(u=this.options.plugins)==null?void 0:u.Objects)!=null?f:null,this.connection=new Nl(this,this.options),this._channels=new $i(this),this.options.autoConnect!==!1&&this.connect()}static transportImplementationsFromPlugins(a){const l={};return a?.WebSocketTransport&&(l[_t.WebSocket]=a.WebSocketTransport),a?.XHRPolling&&(l[_t.XhrPolling]=a.XHRPolling),l}get channels(){return this._channels}connect(){h.logAction(this.logger,h.LOG_MINOR,"Realtime.connect()",""),this.connection.connect()}close(){h.logAction(this.logger,h.LOG_MINOR,"Realtime.close()",""),this.connection.close()}};Ms.EventEmitter=dt;var Wi=Ms,$i=class extends dt{constructor(i){super(i.logger),this.realtime=i,this.all=Object.create(null),i.connection.connectionManager.on("transport.active",()=>{this.onTransportActive()})}channelSerials(){let i={};for(const a of ot(this.all,!0)){const l=this.all[a];l.properties.channelSerial&&(i[a]=l.properties.channelSerial)}return i}recoverChannels(i){for(const a of ot(i,!0)){const l=this.get(a);l.properties.channelSerial=i[a]}}async processChannelMessage(i){const a=i.channel;if(a===void 0){h.logAction(this.logger,h.LOG_ERROR,"Channels.processChannelMessage()","received event unspecified channel, action = "+i.action);return}const l=this.all[a];if(!l){h.logAction(this.logger,h.LOG_ERROR,"Channels.processChannelMessage()","received event for non-existent channel: "+a);return}await l.processMessage(i)}onTransportActive(){for(const i in this.all){const a=this.all[i];a.state==="attaching"||a.state==="detaching"?a.checkPendingState():a.state==="suspended"?a._attach(!1,null):a.state==="attached"&&a.requestState("attaching")}}propogateConnectionInterruption(i,a){const l={closing:"detached",closed:"detached",failed:"failed",suspended:"suspended"},o=["attaching","attached","detaching","suspended"],u=l[i];for(const f in this.all){const m=this.all[f];o.includes(m.state)&&m.notifyState(u,a)}}get(i,a){i=String(i);let l=this.all[i];if(!l)l=this.all[i]=new yi(this.realtime,i,a);else if(a){if(l._shouldReattachToSetOptions(a,l.channelOptions))throw new N("Channels.get() cannot be used to set channel options that would cause the channel to reattach. Please, use RealtimeChannel.setOptions() instead.",4e4,400);l.setOptions(a)}return l}getDerived(i,a,l){if(a.filter){const o=rs(a.filter),u=Bi(i);i=`[filter=${o}${u.qualifierParam}]${u.channelName}`}return this.get(i,l)}release(i){i=String(i);const a=this.all[i];if(!a)return;const l=a.getReleaseErr();if(l)throw l;delete this.all[i]}},ws=Wi;function Ns(i,a){if(i.isSynthesized()||a.isSynthesized())return i.timestamp>=a.timestamp;const l=i.parseId(),o=a.parseId();return l.msgSerial===o.msgSerial?l.index>o.index:l.msgSerial>o.msgSerial}var jt=class extends dt{constructor(i,a,l=Ns){super(i.logger),this.presence=i,this.map=Object.create(null),this.syncInProgress=!1,this.residualMembers=null,this.memberKey=a,this.newerThan=l}get(i){return this.map[i]}getClient(i){const a=this.map,l=[];for(const o in a){const u=a[o];u.clientId==i&&u.action!="absent"&&l.push(u)}return l}list(i){const a=this.map,l=i&&i.clientId,o=i&&i.connectionId,u=[];for(const f in a){const m=a[f];m.action!=="absent"&&(l&&l!=m.clientId||o&&o!=m.connectionId||u.push(m))}return u}put(i){(i.action==="enter"||i.action==="update")&&(i=gn.fromValues(i),i.action="present");const a=this.map,l=this.memberKey(i);this.residualMembers&&delete this.residualMembers[l];const o=a[l];return o&&!this.newerThan(i,o)?!1:(a[l]=i,!0)}values(){const i=this.map,a=[];for(const l in i){const o=i[l];o.action!="absent"&&a.push(o)}return a}remove(i){const a=this.map,l=this.memberKey(i),o=a[l];return o&&!this.newerThan(i,o)?!1:(this.syncInProgress?(i=gn.fromValues(i),i.action="absent",a[l]=i):delete a[l],!!o)}startSync(){const i=this.map,a=this.syncInProgress;h.logAction(this.logger,h.LOG_MINOR,"PresenceMap.startSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+a),this.syncInProgress||(this.residualMembers=le(i),this.setInProgress(!0))}endSync(){const i=this.map,a=this.syncInProgress;if(h.logAction(this.logger,h.LOG_MINOR,"PresenceMap.endSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+a),a){for(const l in i)i[l].action==="absent"&&delete i[l];this.presence._synthesizeLeaves(Yt(this.residualMembers));for(const l in this.residualMembers)delete i[l];this.residualMembers=null,this.setInProgress(!1)}this.emit("sync")}waitSync(i){const a=this.syncInProgress;if(h.logAction(this.logger,h.LOG_MINOR,"PresenceMap.waitSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+a),!a){i();return}this.once("sync",i)}clear(){this.map={},this.setInProgress(!1),this.residualMembers=null}setInProgress(i){h.logAction(this.logger,h.LOG_MICRO,"PresenceMap.setInProgress()","inProgress = "+i),this.syncInProgress=i,this.presence.syncComplete=!i}};function $t(i){return i.channel.client.auth.clientId}function En(i){const a=i.channel.client,l=a.auth.clientId;return(!l||l==="*")&&a.connection.state==="connected"}function Mn(i,a,l){switch(i.state){case"attached":case"suspended":l();break;case"initialized":case"detached":case"detaching":case"attaching":Ie(i.attach(),function(o){o?a(o):l()});break;default:a(N.fromValues(i.invalidStateError()))}}var wn=class extends dt{constructor(i){super(i.logger),this.channel=i,this.syncComplete=!1,this.members=new jt(this,a=>a.clientId+":"+a.connectionId),this._myMembers=new jt(this,a=>a.clientId),this.subscriptions=new dt(this.logger),this.pendingPresence=[]}async enter(i){if(En(this))throw new N("clientId must be specified to enter a presence channel",40012,400);return this._enterOrUpdateClient(void 0,void 0,i,"enter")}async update(i){if(En(this))throw new N("clientId must be specified to update presence data",40012,400);return this._enterOrUpdateClient(void 0,void 0,i,"update")}async enterClient(i,a){return this._enterOrUpdateClient(void 0,i,a,"enter")}async updateClient(i,a){return this._enterOrUpdateClient(void 0,i,a,"update")}async _enterOrUpdateClient(i,a,l,o){const u=this.channel;if(!u.connectionManager.activeState())throw u.connectionManager.getError();h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence."+o+"Client()","channel = "+u.name+", id = "+i+", client = "+(a||"(implicit) "+$t(this)));const f=gn.fromData(l);f.action=o,i&&(f.id=i),a&&(f.clientId=a);const m=await f.encode(u.channelOptions);switch(u.state){case"attached":return u.sendPresence([m]);case"initialized":case"detached":u.attach();case"attaching":return new Promise((p,R)=>{this.pendingPresence.push({presence:m,callback:A=>A?R(A):p()})});default:{const p=new Ue("Unable to "+o+" presence channel while in "+u.state+" state",90001);throw p.code=90001,p}}}async leave(i){if(En(this))throw new N("clientId must have been specified to enter or leave a presence channel",40012,400);return this.leaveClient(void 0,i)}async leaveClient(i,a){const l=this.channel;if(!l.connectionManager.activeState())throw l.connectionManager.getError();h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence.leaveClient()","leaving; channel = "+this.channel.name+", client = "+i);const o=gn.fromData(a);o.action="leave",i&&(o.clientId=i);const u=await o.encode(l.channelOptions);switch(l.state){case"attached":return l.sendPresence([u]);case"attaching":return new Promise((f,m)=>{this.pendingPresence.push({presence:u,callback:p=>p?m(p):f()})});case"initialized":case"failed":throw new Ue("Unable to leave presence channel (incompatible state)",90001);default:throw l.invalidStateError()}}async get(i){const a=!i||("waitForSync"in i?i.waitForSync:!0);return new Promise((l,o)=>{function u(f){l(i?f.list(i):f.values())}if(this.channel.state==="suspended"){a?o(N.fromValues({statusCode:400,code:91005,message:"Presence state is out of sync due to channel being in the SUSPENDED state"})):u(this.members);return}Mn(this.channel,f=>o(f),()=>{const f=this.members;a?f.waitSync(function(){u(f)}):u(f)})})}async history(i){h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence.history()","channel = "+this.name);const a=this.channel.client.rest.presenceMixin;if(i&&i.untilAttach)if(this.channel.state==="attached")delete i.untilAttach,i.from_serial=this.channel.properties.attachSerial;else throw new N("option untilAttach requires the channel to be attached, was: "+this.channel.state,4e4,400);return a.history(this,i)}setPresence(i,a,l){h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence.setPresence()","received presence for "+i.length+" participants; syncChannelSerial = "+l);let o,u;const f=this.members,m=this._myMembers,p=[],R=this.channel.connectionManager.connectionId;a&&(this.members.startSync(),l&&(u=l.match(/^[\w-]+:(.*)$/))&&(o=u[1]));for(let A of i)switch(A.action){case"leave":f.remove(A)&&p.push(A),A.connectionId===R&&!A.isSynthesized()&&m.remove(A);break;case"enter":case"present":case"update":f.put(A)&&p.push(A),A.connectionId===R&&m.put(A);break}a&&!o&&(f.endSync(),this.channel.syncChannelSerial=null);for(let A=0;A<p.length;A++){const L=p[A];this.subscriptions.emit(L.action,L)}}onAttached(i){h.logAction(this.logger,h.LOG_MINOR,"RealtimePresence.onAttached()","channel = "+this.channel.name+", hasPresence = "+i),i?this.members.startSync():(this._synthesizeLeaves(this.members.values()),this.members.clear()),this._ensureMyMembersPresent();const a=this.pendingPresence,l=a.length;if(l){this.pendingPresence=[];const o=[],u=zn.create(this.logger);h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence.onAttached","sending "+l+" queued presence messages");for(let f=0;f<l;f++){const m=a[f];o.push(m.presence),u.push(m.callback)}this.channel.sendPresence(o).then(()=>u()).catch(f=>u(f))}}actOnChannelState(i,a,l){switch(i){case"attached":this.onAttached(a);break;case"detached":case"failed":this._clearMyMembers(),this.members.clear();case"suspended":this.failPendingPresence(l);break}}failPendingPresence(i){if(this.pendingPresence.length){h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.failPendingPresence","channel; name = "+this.channel.name+", err = "+Be(i));for(let a=0;a<this.pendingPresence.length;a++)try{this.pendingPresence[a].callback(i)}catch{}this.pendingPresence=[]}}_clearMyMembers(){this._myMembers.clear()}_ensureMyMembersPresent(){const i=this._myMembers,a=this.channel.connectionManager.connectionId;for(const l in i.map){const o=i.map[l];h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence._ensureMyMembersPresent()",'Auto-reentering clientId "'+o.clientId+'" into the presence set');const u=o.connectionId===a?o.id:void 0;this._enterOrUpdateClient(u,o.clientId,o.data,"enter").catch(f=>{const m=new N("Presence auto re-enter failed",91004,400,f);h.logAction(this.logger,h.LOG_ERROR,"RealtimePresence._ensureMyMembersPresent()","Presence auto re-enter failed; reason = "+Be(f));const p=new gi(this.channel.state,this.channel.state,!0,!1,m);this.channel.emit("update",p)})}}_synthesizeLeaves(i){const a=this.subscriptions;i.forEach(function(l){const o=gn.fromValues({action:"leave",connectionId:l.connectionId,clientId:l.clientId,data:l.data,encoding:l.encoding,timestamp:Date.now()});a.emit("leave",o)})}async subscribe(...i){const a=yi.processListenerArgs(i),l=a[0],o=a[1],u=this.channel;if(u.state==="failed")throw N.fromValues(u.invalidStateError());this.subscriptions.on(l,o),u.channelOptions.attachOnSubscribe!==!1&&await u.attach()}unsubscribe(...i){const a=yi.processListenerArgs(i),l=a[0],o=a[1];this.subscriptions.off(l,o)}},Si=wn,So=_t.WebSocket;function Ul(i){return!!i.on}var xl=class extends _n{constructor(i,a,l){super(i,a,l),this.shortName=So,l.heartbeats=x.Config.useProtocolHeartbeats,this.wsHost=l.host}static isAvailable(){return!!x.Config.WebSocket}createWebSocket(i,a){return this.uri=i+_a(a),new x.Config.WebSocket(this.uri)}toString(){return"WebSocketTransport; uri="+this.uri}connect(){h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.connect()","starting"),_n.prototype.connect.call(this);const i=this,a=this.params,l=a.options,u=(l.tls?"wss://":"ws://")+this.wsHost+":"+ge.getPort(l)+"/";h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.connect()","uri: "+u),Ie(this.auth.getAuthParams(),function(f,m){if(i.isDisposed)return;let p="";for(const A in m)p+=" "+A+": "+m[A]+";";if(h.logAction(i.logger,h.LOG_MINOR,"WebSocketTransport.connect()","authParams:"+p+" err: "+f),f){i.disconnect(f);return}const R=a.getConnectParams(m);try{const A=i.wsConnection=i.createWebSocket(u,R);A.binaryType=x.Config.binaryType,A.onopen=function(){i.onWsOpen()},A.onclose=function(L){i.onWsClose(L)},A.onmessage=function(L){i.onWsData(L.data)},A.onerror=function(L){i.onWsError(L)},Ul(A)&&A.on("ping",function(){i.onActivity()})}catch(A){h.logAction(i.logger,h.LOG_ERROR,"WebSocketTransport.connect()","Unexpected exception creating websocket: err = "+(A.stack||A.message)),i.disconnect(A)}})}send(i){const a=this.wsConnection;if(!a){h.logAction(this.logger,h.LOG_ERROR,"WebSocketTransport.send()","No socket connection");return}try{a.send(Ht(i,this.connectionManager.realtime._MsgPack,this.params.format))}catch(l){const o="Exception from ws connection when trying to send: "+Be(l);h.logAction(this.logger,h.LOG_ERROR,"WebSocketTransport.send()",o),this.finish("disconnected",new N(o,5e4,500))}}onWsData(i){h.logAction(this.logger,h.LOG_MICRO,"WebSocketTransport.onWsData()","data received; length = "+i.length+"; type = "+typeof i);try{this.onProtocolMessage(co(i,this.connectionManager.realtime._MsgPack,this.connectionManager.realtime._RealtimePresence,this.connectionManager.realtime._Annotations,this.connectionManager.realtime._objectsPlugin,this.format))}catch(a){h.logAction(this.logger,h.LOG_ERROR,"WebSocketTransport.onWsData()","Unexpected exception handing channel message: "+a.stack)}}onWsOpen(){h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.onWsOpen()","opened WebSocket"),this.emit("preconnect")}onWsClose(i){let a,l;if(typeof i=="object"?(l=i.code,a=i.wasClean||l===1e3):(l=i,a=l==1e3),delete this.wsConnection,a){h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.onWsClose()","Cleanly closed WebSocket");const o=new N("Websocket closed",80003,400);this.finish("disconnected",o)}else{const o="Unclean disconnection of WebSocket ; code = "+l,u=new N(o,80003,400);h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.onWsClose()",o),this.finish("disconnected",u)}this.emit("disposed")}onWsError(i){h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.onError()","Error from WebSocket: "+i.message),x.Config.nextTick(()=>{this.disconnect(Error(i.message))})}dispose(){h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.dispose()",""),this.isDisposed=!0;const i=this.wsConnection;i&&(i.onmessage=function(){},delete this.wsConnection,x.Config.nextTick(()=>{if(h.logAction(this.logger,h.LOG_MICRO,"WebSocketTransport.dispose()","closing websocket"),!i)throw new Error("WebSocketTransport.dispose(): wsConnection is not defined");i.close()}))}},Ct=xl,it=class{static subscribeFilter(i,a,l){const o=u=>{var f,m,p,R,A,L;const B={name:u.name,refTimeserial:(m=(f=u.extras)==null?void 0:f.ref)==null?void 0:m.timeserial,refType:(R=(p=u.extras)==null?void 0:p.ref)==null?void 0:R.type,isRef:!!((L=(A=u.extras)==null?void 0:A.ref)!=null&&L.timeserial),clientId:u.clientId};Object.entries(a).find(([Y,q])=>q!==void 0?B[Y]!==q:!1)||l(u)};this.addFilteredSubscription(i,a,l,o),i.subscriptions.on(o)}static addFilteredSubscription(i,a,l,o){var u;if(i.filteredSubscriptions||(i.filteredSubscriptions=new Map),i.filteredSubscriptions.has(l)){const f=i.filteredSubscriptions.get(l);f.set(a,((u=f?.get(a))==null?void 0:u.concat(o))||[o])}else i.filteredSubscriptions.set(l,new Map([[a,[o]]]))}static getAndDeleteFilteredSubscriptions(i,a,l){if(!i.filteredSubscriptions)return[];if(!l&&a)return Array.from(i.filteredSubscriptions.entries()).map(([f,m])=>{var p;let R=m.get(a);return m.delete(a),m.size===0&&((p=i.filteredSubscriptions)==null||p.delete(f)),R}).reduce((f,m)=>m?f.concat(...m):f,[]);if(!l||!i.filteredSubscriptions.has(l))return[];const o=i.filteredSubscriptions.get(l);if(!a){const f=Array.from(o.values()).reduce((m,p)=>m.concat(...p),[]);return i.filteredSubscriptions.delete(l),f}let u=o.get(a);return o.delete(a),u||[]}},Se=class hf extends ws{constructor(a){var l;const o=hf._MsgPack;if(!o)throw new Error("Expected DefaultRealtime._MsgPack to have been set");super(ge.objectifyOptions(a,!0,"Realtime",h.defaultLogger,be($({},Al),{Crypto:(l=hf.Crypto)!=null?l:void 0,MsgPack:o,RealtimePresence:{RealtimePresence:Si,PresenceMessage:gn,WirePresenceMessage:Ba},Annotations:{Annotation:Pi,WireAnnotation:di,RealtimeAnnotations:Pn,RestAnnotations:Rl},WebSocketTransport:Ct,MessageInteractions:it})))}static get Crypto(){if(this._Crypto===null)throw new Error("Encryption not enabled; use ably.encryption.js instead");return this._Crypto}static set Crypto(a){this._Crypto=a}};Se.Utils=Fe,Se.ConnectionManager=za,Se.ProtocolMessage=Xi,Se._Crypto=null,Se.Message=Yi,Se.PresenceMessage=Qi,Se.Annotation=Tl,Se._MsgPack=null,Se._Http=hs,Se._PresenceMap=jt,Se._MessageEncoding=In;var Nn=Se,Ft=Uint8Array,Ai=Uint32Array,Un=Math.pow,Dl=new Ai(8),kl=[],xn=new Ai(64);function Fi(i){return(i-(i|0))*Un(2,32)|0}for(var ea=2,Dn=0;Dn<64;){for(Ha=!0,mn=2;mn<=ea/2;mn++)ea%mn===0&&(Ha=!1);Ha&&(Dn<8&&(Dl[Dn]=Fi(Un(ea,1/2))),kl[Dn]=Fi(Un(ea,1/3)),Dn++),ea++}var Ha,mn,kn=!!new Ft(new Ai([1]).buffer)[0];function pn(i){return kn?i>>>24|(i>>>16&255)<<8|(i&65280)<<8|i<<24:i}function St(i,a){return i>>>a|i<<32-a}function ta(i){var a=Dl.slice(),l=i.length,o=l*8,u=512-(o+64)%512-1+o+65,f=new Ft(u/8),m=new Ai(f.buffer);f.set(i,0),f[l]=128,m[m.length-1]=pn(o);for(var p,R=0;R<u/32;R+=16){var A=a.slice();for(p=0;p<64;p++){var L;if(p<16)L=pn(m[R+p]);else{var B=xn[p-15],Y=xn[p-2];L=xn[p-7]+xn[p-16]+(St(B,7)^St(B,18)^B>>>3)+(St(Y,17)^St(Y,19)^Y>>>10)}xn[p]=L|=0;for(var q=(St(A[4],6)^St(A[4],11)^St(A[4],25))+(A[4]&A[5]^~A[4]&A[6])+A[7]+L+kl[p],ee=(St(A[0],2)^St(A[0],13)^St(A[0],22))+(A[0]&A[1]^A[2]&(A[0]^A[1])),te=7;te>0;te--)A[te]=A[te-1];A[0]=q+ee|0,A[4]=A[4]+q|0}for(p=0;p<8;p++)a[p]=a[p]+A[p]|0}return new Ft(new Ai(a.map(function(fe){return pn(fe)})).buffer)}function Ll(i,a){if(i.length>64&&(i=ta(i)),i.length<64){const p=new Uint8Array(64);p.set(i,0),i=p}for(var l=new Uint8Array(64),o=new Uint8Array(64),u=0;u<64;u++)l[u]=54^i[u],o[u]=92^i[u];var f=new Uint8Array(a.length+64);f.set(l,0),f.set(a,64);var m=new Uint8Array(96);return m.set(o,0),m.set(ta(f),64),ta(m)}var Va=class{constructor(){this.base64CharSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",this.hexCharSet="0123456789abcdef"}uint8ViewToBase64(i){let a="";const l=this.base64CharSet,o=i.byteLength,u=o%3,f=o-u;let m,p,R,A,L;for(let B=0;B<f;B=B+3)L=i[B]<<16|i[B+1]<<8|i[B+2],m=(L&16515072)>>18,p=(L&258048)>>12,R=(L&4032)>>6,A=L&63,a+=l[m]+l[p]+l[R]+l[A];return u==1?(L=i[f],m=(L&252)>>2,p=(L&3)<<4,a+=l[m]+l[p]+"=="):u==2&&(L=i[f]<<8|i[f+1],m=(L&64512)>>10,p=(L&1008)>>4,R=(L&15)<<2,a+=l[m]+l[p]+l[R]+"="),a}base64ToArrayBuffer(i){const a=atob?.(i),l=a.length,o=new Uint8Array(l);for(let u=0;u<l;u++){const f=a.charCodeAt(u);o[u]=f}return this.toArrayBuffer(o)}isBuffer(i){return i instanceof ArrayBuffer||ArrayBuffer.isView(i)}toBuffer(i){if(!ArrayBuffer)throw new Error("Can't convert to Buffer: browser does not support the necessary types");if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(this.toArrayBuffer(i));throw new Error("BufferUtils.toBuffer expected an ArrayBuffer or a view onto one")}toArrayBuffer(i){if(!ArrayBuffer)throw new Error("Can't convert to ArrayBuffer: browser does not support the necessary types");if(i instanceof ArrayBuffer)return i;if(ArrayBuffer.isView(i))return i.buffer.slice(i.byteOffset,i.byteOffset+i.byteLength);throw new Error("BufferUtils.toArrayBuffer expected an ArrayBuffer or a view onto one")}base64Encode(i){return this.uint8ViewToBase64(this.toBuffer(i))}base64UrlEncode(i){return this.base64Encode(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}base64Decode(i){if(ArrayBuffer&&x.Config.atob)return this.base64ToArrayBuffer(i);throw new Error("Expected ArrayBuffer to exist and Platform.Config.atob to be configured")}hexEncode(i){return this.toBuffer(i).reduce((l,o)=>l+o.toString(16).padStart(2,"0"),"")}hexDecode(i){if(i.length%2!==0)throw new Error("Can't create a byte array from a hex string of odd length");const a=new Uint8Array(i.length/2);for(let l=0;l<a.length;l++)a[l]=parseInt(i.slice(2*l,2*(l+1)),16);return this.toArrayBuffer(a)}utf8Encode(i){if(x.Config.TextEncoder){const a=new x.Config.TextEncoder().encode(i);return this.toArrayBuffer(a)}else throw new Error("Expected TextEncoder to be configured")}utf8Decode(i){if(!this.isBuffer(i))throw new Error("Expected input of utf8decode to be an arraybuffer or typed array");if(TextDecoder)return new TextDecoder().decode(i);throw new Error("Expected TextDecoder to be configured")}areBuffersEqual(i,a){if(!i||!a)return!1;const l=this.toArrayBuffer(i),o=this.toArrayBuffer(a);if(l.byteLength!=o.byteLength)return!1;const u=new Uint8Array(l),f=new Uint8Array(o);for(var m=0;m<u.length;m++)if(u[m]!=f[m])return!1;return!0}byteLength(i){return i instanceof ArrayBuffer||ArrayBuffer.isView(i)?i.byteLength:-1}arrayBufferViewToBuffer(i){return this.toArrayBuffer(i)}concat(i){const a=i.reduce((u,f)=>u+f.byteLength,0),l=new Uint8Array(a);let o=0;for(const u of i){const f=this.toBuffer(u);l.set(f,o),o+=f.byteLength}return l.buffer}sha256(i){const a=ta(this.toBuffer(i));return this.toArrayBuffer(a)}hmacSha256(i,a){const l=Ll(this.toBuffer(a),this.toBuffer(i));return this.toArrayBuffer(l)}},Ia=new Va,Oi=function(i,a){var l="aes",o=256,u="cbc",f=16;function m(Y){if(Y.algorithm==="aes"&&Y.mode==="cbc"){if(Y.keyLength===128||Y.keyLength===256)return;throw new Error("Unsupported key length "+Y.keyLength+" for aes-cbc encryption. Encryption key must be 128 or 256 bits (16 or 32 ASCII characters)")}}function p(Y){return Y.replace("_","/").replace("-","+")}function R(Y){return Y instanceof A}class A{constructor(q,ee,te,fe){this.algorithm=q,this.keyLength=ee,this.mode=te,this.key=fe}}class L{static getDefaultParams(q){var ee;if(!q.key)throw new Error("Crypto.getDefaultParams: a key is required");typeof q.key=="string"?ee=a.toArrayBuffer(a.base64Decode(p(q.key))):q.key instanceof ArrayBuffer?ee=q.key:ee=a.toArrayBuffer(q.key);var te=q.algorithm||l,fe=ee.byteLength*8,xe=q.mode||u,je=new A(te,fe,xe,ee);if(q.keyLength&&q.keyLength!==je.keyLength)throw new Error("Crypto.getDefaultParams: a keyLength of "+q.keyLength+" was specified, but the key actually has length "+je.keyLength);return m(je),je}static async generateRandomKey(q){try{return i.getRandomArrayBuffer((q||o)/8)}catch(ee){throw new N("Failed to generate random key: "+ee.message,400,5e4,ee)}}static getCipher(q,ee){var te,fe=R(q)?q:this.getDefaultParams(q);return{cipherParams:fe,cipher:new B(fe,(te=q.iv)!=null?te:null,ee)}}}L.CipherParams=A;class B{constructor(q,ee,te){if(this.logger=te,!crypto.subtle)throw isSecureContext?new Error("Crypto operations are not possible since the browser’s SubtleCrypto class is unavailable (reason unknown)."):new Error("Crypto operations are is not possible since the current environment is a non-secure context and hence the browser’s SubtleCrypto class is not available.");this.algorithm=q.algorithm+"-"+String(q.keyLength)+"-"+q.mode,this.webCryptoAlgorithm=q.algorithm+"-"+q.mode,this.key=a.toArrayBuffer(q.key),this.iv=ee?a.toArrayBuffer(ee):null}concat(q,ee){const te=new ArrayBuffer(q.byteLength+ee.byteLength),fe=new DataView(te),xe=new DataView(a.toArrayBuffer(q));for(let ze=0;ze<xe.byteLength;ze++)fe.setInt8(ze,xe.getInt8(ze));const je=new DataView(a.toArrayBuffer(ee));for(let ze=0;ze<je.byteLength;ze++)fe.setInt8(xe.byteLength+ze,je.getInt8(ze));return te}async encrypt(q){h.logAction(this.logger,h.LOG_MICRO,"CBCCipher.encrypt()","");const ee=await this.getIv(),te=await crypto.subtle.importKey("raw",this.key,this.webCryptoAlgorithm,!1,["encrypt"]),fe=await crypto.subtle.encrypt({name:this.webCryptoAlgorithm,iv:ee},te,q);return this.concat(ee,fe)}async decrypt(q){h.logAction(this.logger,h.LOG_MICRO,"CBCCipher.decrypt()","");const ee=a.toArrayBuffer(q),te=ee.slice(0,f),fe=ee.slice(f),xe=await crypto.subtle.importKey("raw",this.key,this.webCryptoAlgorithm,!1,["decrypt"]);return crypto.subtle.decrypt({name:this.webCryptoAlgorithm,iv:te},xe,fe)}async getIv(){if(this.iv){var q=this.iv;return this.iv=null,q}const ee=await i.getRandomArrayBuffer(f);return a.toArrayBuffer(ee)}}return L},Ot=(i=>(i[i.REQ_SEND=0]="REQ_SEND",i[i.REQ_RECV=1]="REQ_RECV",i[i.REQ_RECV_POLL=2]="REQ_RECV_POLL",i[i.REQ_RECV_STREAM=3]="REQ_RECV_STREAM",i))(Ot||{}),en=Ot;function Bl(){return new N("No HTTP request plugin provided. Provide at least one of the FetchRequest or XHRRequest plugins.",400,4e4)}var Ya,Ao=(Ya=class{constructor(i){this.checksInProgress=null,this.checkConnectivity=void 0,this.supportsAuthHeaders=!1,this.supportsLinkHeaders=!1;var a;this.client=i??null;const l=i?.options.connectivityCheckUrl||ge.connectivityCheckUrl,o=(a=i?.options.connectivityCheckParams)!=null?a:null,u=!i?.options.connectivityCheckUrl,f=$($({},Ao.bundledRequestImplementations),i?._additionalHTTPRequestImplementations),m=f.XHRRequest,p=f.FetchRequest,R=!!(m||p);if(!R)throw Bl();x.Config.xhrSupported&&m?(this.supportsAuthHeaders=!0,this.Request=async function(A,L,B,Y,q){return new Promise(ee=>{var te;const fe=m.createRequest(L,B,Y,q,en.REQ_SEND,(te=i&&i.options.timeouts)!=null?te:null,this.logger,A);fe.once("complete",(xe,je,ze,pe,It)=>ee({error:xe,body:je,headers:ze,unpacked:pe,statusCode:It})),fe.exec()})},i?.options.disableConnectivityCheck?this.checkConnectivity=async function(){return!0}:this.checkConnectivity=async function(){var A;h.logAction(this.logger,h.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Sending; "+l);const L=await this.doUri(nt.Get,l,null,null,o);let B=!1;return u?B=!L.error&&((A=L.body)==null?void 0:A.replace(/\n/,""))=="yes":B=!L.error&&vc(L.statusCode),h.logAction(this.logger,h.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Result: "+B),B}):x.Config.fetchSupported&&p?(this.supportsAuthHeaders=!0,this.Request=async(A,L,B,Y,q)=>p(A,i??null,L,B,Y,q),i?.options.disableConnectivityCheck?this.checkConnectivity=async function(){return!0}:this.checkConnectivity=async function(){var A;h.logAction(this.logger,h.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Sending; "+l);const L=await this.doUri(nt.Get,l,null,null,null),B=!L.error&&((A=L.body)==null?void 0:A.replace(/\n/,""))=="yes";return h.logAction(this.logger,h.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Result: "+B),B}):this.Request=async()=>({error:R?new Ue("no supported HTTP transports available",null,400):Bl()})}get logger(){var i,a;return(a=(i=this.client)==null?void 0:i.logger)!=null?a:h.defaultLogger}async doUri(i,a,l,o,u){return this.Request?this.Request(i,a,l,u,o):{error:new Ue("Request invoked before assigned to",null,500)}}shouldFallback(i){const a=i.statusCode;return a===408&&!i.code||a===400&&!i.code||a>=500&&a<=504}},Ya.methods=[nt.Get,nt.Delete,nt.Post,nt.Put,nt.Patch],Ya.methodsWithoutBody=[nt.Get,nt.Delete],Ya.methodsWithBody=[nt.Post,nt.Put,nt.Patch],Ya),Oo=Ao,Je="ablyjs-storage-test",Zn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:self,Qa=class{constructor(){try{Zn.sessionStorage.setItem(Je,Je),Zn.sessionStorage.removeItem(Je),this.sessionSupported=!0}catch{this.sessionSupported=!1}try{Zn.localStorage.setItem(Je,Je),Zn.localStorage.removeItem(Je),this.localSupported=!0}catch{this.localSupported=!1}}get(i){return this._get(i,!1)}getSession(i){return this._get(i,!0)}remove(i){return this._remove(i,!1)}removeSession(i){return this._remove(i,!0)}set(i,a,l){return this._set(i,a,l,!1)}setSession(i,a,l){return this._set(i,a,l,!0)}_set(i,a,l,o){const u={value:a};return l&&(u.expires=Date.now()+l),this.storageInterface(o).setItem(i,JSON.stringify(u))}_get(i,a){if(a&&!this.sessionSupported)throw new Error("Session Storage not supported");if(!a&&!this.localSupported)throw new Error("Local Storage not supported");const l=this.storageInterface(a).getItem(i);if(!l)return null;const o=JSON.parse(l);return o.expires&&o.expires<Date.now()?(this.storageInterface(a).removeItem(i),null):o.value}_remove(i,a){return this.storageInterface(a).removeItem(i)}storageInterface(i){return i?Zn.sessionStorage:Zn.localStorage}},na=new Qa,tt=Sn(),ia=typeof EdgeRuntime=="string";typeof Window>"u"&&typeof WorkerGlobalScope>"u"&&!ia&&console.log("Warning: this distribution of Ably is intended for browsers. On nodejs, please use the 'ably' package on npm");function aa(){const i=tt.location;return!tt.WebSocket||!i||!i.origin||i.origin.indexOf("http")>-1}function Hc(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope}var To=tt.navigator&&tt.navigator.userAgent.toString(),Vc=tt.location&&tt.location.href,Ro={agent:"browser",logTimestamps:!0,userAgent:To,currentUrl:Vc,binaryType:"arraybuffer",WebSocket:tt.WebSocket,fetchSupported:!!tt.fetch,xhrSupported:tt.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,allowComet:aa(),useProtocolHeartbeats:!0,supportsBinary:!!tt.TextDecoder,preferBinary:!1,ArrayBuffer:tt.ArrayBuffer,atob:tt.atob,nextTick:typeof tt.setImmediate<"u"?tt.setImmediate.bind(tt):function(i){setTimeout(i,0)},addEventListener:tt.addEventListener,inspect:JSON.stringify,stringByteSize:function(i){return tt.TextDecoder&&new tt.TextEncoder().encode(i).length||i.length},TextEncoder:tt.TextEncoder,TextDecoder:tt.TextDecoder,getRandomArrayBuffer:async function(i){const a=new Uint8Array(i);return tt.crypto.getRandomValues(a),a.buffer},isWebworker:Hc(),push:{platform:"browser",formFactor:"desktop",storage:na}},Jn=Ro;function ql(i){const a=[80015,80017,80030];return i.code?hn.isTokenErr(i)?!1:a.includes(i.code)?!0:i.code>=4e4&&i.code<5e4:!1}function sa(i){return ql(i)?[qt({action:se.ERROR,error:i})]:[qt({action:se.DISCONNECTED,error:i})]}var _o=class extends _n{constructor(i,a,l){super(i,a,l,!0),this.onAuthUpdated=o=>{this.authParams={access_token:o.token}},this.stream="stream"in l?l.stream:!0,this.sendRequest=null,this.recvRequest=null,this.pendingCallback=null,this.pendingItems=null}connect(){h.logAction(this.logger,h.LOG_MINOR,"CometTransport.connect()","starting"),_n.prototype.connect.call(this);const i=this.params,a=i.options,l=i.host||a.primaryDomain,o=ge.getPort(a),u=a.tls?"https://":"http://";this.baseUri=u+l+":"+o+"/comet/";const f=this.baseUri+"connect";h.logAction(this.logger,h.LOG_MINOR,"CometTransport.connect()","uri: "+f),Ie(this.auth.getAuthParams(),(m,p)=>{if(m){this.disconnect(m);return}if(this.isDisposed)return;this.authParams=p;const R=this.params.getConnectParams(p);"stream"in R&&(this.stream=R.stream),h.logAction(this.logger,h.LOG_MINOR,"CometTransport.connect()","connectParams:"+_a(R));let A=!1;const L=this.recvRequest=this.createRequest(f,null,R,null,this.stream?en.REQ_RECV_STREAM:en.REQ_RECV);L.on("data",B=>{this.recvRequest&&(A||(A=!0,this.emit("preconnect")),this.onData(B))}),L.on("complete",B=>{if(this.recvRequest||(B=B||new N("Request cancelled",80003,400)),this.recvRequest=null,!A&&!B&&(A=!0,this.emit("preconnect")),this.onActivity(),B){B.code?this.onData(sa(B)):this.disconnect(B);return}x.Config.nextTick(()=>{this.recv()})}),L.exec()})}requestClose(){h.logAction(this.logger,h.LOG_MINOR,"CometTransport.requestClose()"),this._requestCloseOrDisconnect(!0)}requestDisconnect(){h.logAction(this.logger,h.LOG_MINOR,"CometTransport.requestDisconnect()"),this._requestCloseOrDisconnect(!1)}_requestCloseOrDisconnect(i){const a=i?this.closeUri:this.disconnectUri;if(a){const l=this.createRequest(a,null,this.authParams,null,en.REQ_SEND);l.on("complete",o=>{o&&(h.logAction(this.logger,h.LOG_ERROR,"CometTransport.request"+(i?"Close()":"Disconnect()"),"request returned err = "+Be(o)),this.finish("disconnected",o))}),l.exec()}}dispose(){h.logAction(this.logger,h.LOG_MINOR,"CometTransport.dispose()",""),this.isDisposed||(this.isDisposed=!0,this.recvRequest&&(h.logAction(this.logger,h.LOG_MINOR,"CometTransport.dispose()","aborting recv request"),this.recvRequest.abort(),this.recvRequest=null),this.finish("disconnected",bt.disconnected()),x.Config.nextTick(()=>{this.emit("disposed")}))}onConnect(i){var a;if(this.isDisposed)return;const l=(a=i.connectionDetails)==null?void 0:a.connectionKey;_n.prototype.onConnect.call(this,i);const o=this.baseUri+l;h.logAction(this.logger,h.LOG_MICRO,"CometTransport.onConnect()","baseUri = "+o),this.sendUri=o+"/send",this.recvUri=o+"/recv",this.closeUri=o+"/close",this.disconnectUri=o+"/disconnect"}send(i){if(this.sendRequest){this.pendingItems=this.pendingItems||[],this.pendingItems.push(i);return}const a=this.pendingItems||[];a.push(i),this.pendingItems=null,this.sendItems(a)}sendAnyPending(){const i=this.pendingItems;i&&(this.pendingItems=null,this.sendItems(i))}sendItems(i){const a=this.sendRequest=this.createRequest(this.sendUri,null,this.authParams,this.encodeRequest(i),en.REQ_SEND);a.on("complete",(l,o)=>{if(l&&h.logAction(this.logger,h.LOG_ERROR,"CometTransport.sendItems()","on complete: err = "+Be(l)),this.sendRequest=null,l){l.code?this.onData(sa(l)):this.disconnect(l);return}o&&this.onData(o),this.pendingItems&&x.Config.nextTick(()=>{this.sendRequest||this.sendAnyPending()})}),a.exec()}recv(){if(this.recvRequest||!this.isConnected)return;const i=this.recvRequest=this.createRequest(this.recvUri,null,this.authParams,null,this.stream?en.REQ_RECV_STREAM:en.REQ_RECV_POLL);i.on("data",a=>{this.onData(a)}),i.on("complete",a=>{if(this.recvRequest=null,this.onActivity(),a){a.code?this.onData(sa(a)):this.disconnect(a);return}x.Config.nextTick(()=>{this.recv()})}),i.exec()}onData(i){try{const a=this.decodeResponse(i);if(a&&a.length)for(let l=0;l<a.length;l++)this.onProtocolMessage(Ts(a[l],this.connectionManager.realtime._RealtimePresence,this.connectionManager.realtime._Annotations,this.connectionManager.realtime._objectsPlugin))}catch(a){h.logAction(this.logger,h.LOG_ERROR,"CometTransport.onData()","Unexpected exception handing channel event: "+a.stack)}}encodeRequest(i){return JSON.stringify(i)}decodeResponse(i){return typeof i=="string"?JSON.parse(i):i}},Pa=_o;function Co(i,a){return nl(ot(a)).includes("x-ably-errorcode")}function Us(i,a){if(Co(i,a))return i.error&&N.fromValues(i.error)}var jl=function(){},Eo=0,Xa={};function Mo(i,a){return i.getResponseHeader&&i.getResponseHeader(a)}function Ka(i){return i.getResponseHeader&&(i.getResponseHeader("transfer-encoding")||!i.getResponseHeader("content-length"))}function wo(i){const a=i.getAllResponseHeaders().trim().split(`\r
`),l={};for(let o=0;o<a.length;o++){const u=a[o].split(":").map(f=>f.trim());l[u[0].toLowerCase()]=u[1]}return l}var No=class Zd extends dt{constructor(a,l,o,u,f,m,p,R){super(p),o=o||{},o.rnd=ls(),this.uri=a+_a(o),this.headers=l||{},this.body=u,this.method=R?R.toUpperCase():Q(u)?"GET":"POST",this.requestMode=f,this.timeouts=m,this.timedOut=!1,this.requestComplete=!1,this.id=String(++Eo),Xa[this.id]=this}static createRequest(a,l,o,u,f,m,p,R){const A=m||ge.TIMEOUTS;return new Zd(a,l,le(o),u,f,A,p,R)}complete(a,l,o,u,f){this.requestComplete||(this.requestComplete=!0,!a&&l&&this.emit("data",l),this.emit("complete",a,l,o,u,f),this.dispose())}abort(){this.dispose()}exec(){let a=this.headers;const l=this.requestMode==en.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout,o=this.timer=setTimeout(()=>{this.timedOut=!0,f.abort()},l),u=this.method,f=this.xhr=new XMLHttpRequest,m=a.accept;let p=this.body,R="text";m?m.indexOf("application/x-msgpack")===0&&(R="arraybuffer"):a.accept="application/json",p&&(a["content-type"]||(a["content-type"]="application/json")).indexOf("application/json")>-1&&typeof p!="string"&&(p=JSON.stringify(p)),f.open(u,this.uri,!0),f.responseType=R,"authorization"in a&&(f.withCredentials=!0);for(const pe in a)f.setRequestHeader(pe,a[pe]);const A=(pe,It,Tt,oa)=>{var _i;let $a=It+" (event type: "+pe.type+")";(_i=this==null?void 0:this.xhr)!=null&&_i.statusText&&($a+=", current statusText is "+this.xhr.statusText),h.logAction(this.logger,h.LOG_ERROR,"Request.on"+pe.type+"()",$a),this.complete(new Ue($a,Tt,oa))};f.onerror=function(pe){A(pe,"XHR error occurred",null,400)},f.onabort=pe=>{this.timedOut?A(pe,"Request aborted due to request timeout expiring",null,408):A(pe,"Request cancelled",null,400)},f.ontimeout=function(pe){A(pe,"Request timed out",null,408)};let L,B,Y,q=0,ee=!1;const te=()=>{if(clearTimeout(o),Y=B<400,B==204){this.complete(null,null,null,null,B);return}L=this.requestMode==en.REQ_RECV_STREAM&&Y&&Ka(f)},fe=()=>{let pe;try{const Tt=Mo(f,"content-type");if(Tt?Tt.indexOf("application/json")>=0:f.responseType=="text"){const _i=f.responseType==="arraybuffer"?x.BufferUtils.utf8Decode(f.response):String(f.responseText);_i.length?pe=JSON.parse(_i):pe=_i,ee=!0}else pe=f.response;pe.response!==void 0?(B=pe.statusCode,Y=B<400,a=pe.headers,pe=pe.response):a=wo(f)}catch(Tt){this.complete(new Ue("Malformed response body from server: "+Tt.message,null,400));return}if(Y||Array.isArray(pe)){this.complete(null,pe,a,ee,B);return}let It=Us(pe,a);It||(It=new Ue("Error response received from server: "+B+" body was: "+x.Config.inspect(pe),null,B)),this.complete(It,pe,a,ee,B)};function xe(){const pe=f.responseText,It=pe.length-1;let Tt,oa;for(;q<It&&(Tt=pe.indexOf(`
`,q))>-1;)oa=pe.slice(q,Tt),q=Tt+1,je(oa)}const je=pe=>{try{pe=JSON.parse(pe)}catch(It){this.complete(new Ue("Malformed response body from server: "+It.message,null,400));return}this.emit("data",pe)},ze=()=>{xe(),this.streamComplete=!0,x.Config.nextTick(()=>{this.complete()})};f.onreadystatechange=function(){const pe=f.readyState;pe<3||f.status!==0&&(B===void 0&&(B=f.status,te()),pe==3&&L?xe():pe==4&&(L?ze():fe()))},f.send(p)}dispose(){const a=this.xhr;if(a){a.onreadystatechange=a.onerror=a.onabort=a.ontimeout=jl,this.xhr=null;const l=this.timer;l&&(clearTimeout(l),this.timer=null),this.requestComplete||a.abort()}delete Xa[this.id]}},Ln=No,xs=_t.XhrPolling,Gl=class extends Pa{constructor(i,a,l){super(i,a,l),this.shortName=xs,l.stream=!1,this.shortName=xs}static isAvailable(){return!!(x.Config.xhrSupported&&x.Config.allowComet)}toString(){return"XHRPollingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected}createRequest(i,a,l,o,u){return Ln.createRequest(i,a,l,o,u,this.timeouts,this.logger)}},Wn=Gl,$n=["xhr_polling"],Za={order:$n,bundledImplementations:{web_socket:Ct,xhr_polling:Wn}},zl=Za,Hl={connectivityCheckUrl:"https://internet-up.ably-realtime.com/is-the-internet-up.txt",wsConnectivityCheckUrl:"wss://ws-up.ably-realtime.com",defaultTransports:[_t.XhrPolling,_t.WebSocket]},Ja=Hl;function Wa(i){if(i===void 0)return"undefined";let a,l;if(i instanceof ArrayBuffer?(l="ArrayBuffer",a=new DataView(i)):i instanceof DataView&&(l="DataView",a=i),!a)return JSON.stringify(i);const o=[];for(let u=0;u<i.byteLength;u++){if(u>20){o.push("...");break}let f=a.getUint8(u).toString(16);f.length===1&&(f="0"+f),o.push(f)}return"<"+l+" "+o.join(" ")+">"}function la(i,a,l){for(let o=0,u=l.length;o<u;o++){const f=l.charCodeAt(o);if(f<128){i.setUint8(a++,f>>>0&127|0);continue}if(f<2048){i.setUint8(a++,f>>>6&31|192),i.setUint8(a++,f>>>0&63|128);continue}if(f<65536){i.setUint8(a++,f>>>12&15|224),i.setUint8(a++,f>>>6&63|128),i.setUint8(a++,f>>>0&63|128);continue}if(f<1114112){i.setUint8(a++,f>>>18&7|240),i.setUint8(a++,f>>>12&63|128),i.setUint8(a++,f>>>6&63|128),i.setUint8(a++,f>>>0&63|128);continue}throw new Error("bad codepoint "+f)}}function Vl(i,a,l){let o="";for(let u=a,f=a+l;u<f;u++){const m=i.getUint8(u);if((m&128)===0){o+=String.fromCharCode(m);continue}if((m&224)===192){o+=String.fromCharCode((m&15)<<6|i.getUint8(++u)&63);continue}if((m&240)===224){o+=String.fromCharCode((m&15)<<12|(i.getUint8(++u)&63)<<6|(i.getUint8(++u)&63)<<0);continue}if((m&248)===240){o+=String.fromCharCode((m&7)<<18|(i.getUint8(++u)&63)<<12|(i.getUint8(++u)&63)<<6|(i.getUint8(++u)&63)<<0);continue}throw new Error("Invalid byte "+m.toString(16))}return o}function Fn(i){let a=0;for(let l=0,o=i.length;l<o;l++){const u=i.charCodeAt(l);if(u<128){a+=1;continue}if(u<2048){a+=2;continue}if(u<65536){a+=3;continue}if(u<1114112){a+=4;continue}throw new Error("bad codepoint "+u)}return a}function Ds(i,a){const l=ti(i,a);if(l===0)return;const o=new ArrayBuffer(l),u=new DataView(o);return sn(i,u,0,a),o}var ks=65536*65536,Ls=1/ks;function Il(i,a){return a=a||0,i.getInt32(a)*ks+i.getUint32(a+4)}function ei(i,a){return a=a||0,i.getUint32(a)*ks+i.getUint32(a+4)}function Oe(i,a,l){l<9223372036854776e3?(i.setInt32(a,Math.floor(l*Ls)),i.setInt32(a+4,l&-1)):(i.setUint32(a,2147483647),i.setUint32(a+4,2147483647))}function Ge(i,a,l){l<18446744073709552e3?(i.setUint32(a,Math.floor(l*Ls)),i.setInt32(a+4,l&-1)):(i.setUint32(a,4294967295),i.setUint32(a+4,4294967295))}var ut=class{constructor(i,a){this.map=l=>{const o={};for(let u=0;u<l;u++){const f=this.parse();o[f]=this.parse()}return o},this.bin=l=>{const o=new ArrayBuffer(l);return new Uint8Array(o).set(new Uint8Array(this.view.buffer,this.offset,l),0),this.offset+=l,o},this.buf=this.bin,this.str=l=>{const o=Vl(this.view,this.offset,l);return this.offset+=l,o},this.array=l=>{const o=new Array(l);for(let u=0;u<l;u++)o[u]=this.parse();return o},this.ext=l=>(this.offset+=l,{type:this.view.getInt8(this.offset),data:this.buf(l)}),this.parse=()=>{const l=this.view.getUint8(this.offset);let o,u;if((l&128)===0)return this.offset++,l;if((l&240)===128)return u=l&15,this.offset++,this.map(u);if((l&240)===144)return u=l&15,this.offset++,this.array(u);if((l&224)===160)return u=l&31,this.offset++,this.str(u);if((l&224)===224)return o=this.view.getInt8(this.offset),this.offset++,o;switch(l){case 192:return this.offset++,null;case 193:this.offset++;return;case 194:return this.offset++,!1;case 195:return this.offset++,!0;case 196:return u=this.view.getUint8(this.offset+1),this.offset+=2,this.bin(u);case 197:return u=this.view.getUint16(this.offset+1),this.offset+=3,this.bin(u);case 198:return u=this.view.getUint32(this.offset+1),this.offset+=5,this.bin(u);case 199:return u=this.view.getUint8(this.offset+1),this.offset+=2,this.ext(u);case 200:return u=this.view.getUint16(this.offset+1),this.offset+=3,this.ext(u);case 201:return u=this.view.getUint32(this.offset+1),this.offset+=5,this.ext(u);case 202:return o=this.view.getFloat32(this.offset+1),this.offset+=5,o;case 203:return o=this.view.getFloat64(this.offset+1),this.offset+=9,o;case 204:return o=this.view.getUint8(this.offset+1),this.offset+=2,o;case 205:return o=this.view.getUint16(this.offset+1),this.offset+=3,o;case 206:return o=this.view.getUint32(this.offset+1),this.offset+=5,o;case 207:return o=ei(this.view,this.offset+1),this.offset+=9,o;case 208:return o=this.view.getInt8(this.offset+1),this.offset+=2,o;case 209:return o=this.view.getInt16(this.offset+1),this.offset+=3,o;case 210:return o=this.view.getInt32(this.offset+1),this.offset+=5,o;case 211:return o=Il(this.view,this.offset+1),this.offset+=9,o;case 212:return u=1,this.offset++,this.ext(u);case 213:return u=2,this.offset++,this.ext(u);case 214:return u=4,this.offset++,this.ext(u);case 215:return u=8,this.offset++,this.ext(u);case 216:return u=16,this.offset++,this.ext(u);case 217:return u=this.view.getUint8(this.offset+1),this.offset+=2,this.str(u);case 218:return u=this.view.getUint16(this.offset+1),this.offset+=3,this.str(u);case 219:return u=this.view.getUint32(this.offset+1),this.offset+=5,this.str(u);case 220:return u=this.view.getUint16(this.offset+1),this.offset+=3,this.array(u);case 221:return u=this.view.getUint32(this.offset+1),this.offset+=5,this.array(u);case 222:return u=this.view.getUint16(this.offset+1),this.offset+=3,this.map(u);case 223:return u=this.view.getUint32(this.offset+1),this.offset+=5,this.map(u)}throw new Error("Unknown type 0x"+l.toString(16))},this.offset=a||0,this.view=i}};function Bs(i){const a=new DataView(i),l=new ut(a),o=l.parse();if(l.offset!==i.byteLength)throw new Error(i.byteLength-l.offset+" trailing bytes");return o}function Ti(i,a){return Object.keys(i).filter(function(l){const o=i[l],u=typeof o;return(!a||o!=null)&&(u!=="function"||!!o.toJSON)})}function sn(i,a,l,o){const u=typeof i;if(typeof i=="string"){const f=Fn(i);if(f<32)return a.setUint8(l,f|160),la(a,l+1,i),1+f;if(f<256)return a.setUint8(l,217),a.setUint8(l+1,f),la(a,l+2,i),2+f;if(f<65536)return a.setUint8(l,218),a.setUint16(l+1,f),la(a,l+3,i),3+f;if(f<4294967296)return a.setUint8(l,219),a.setUint32(l+1,f),la(a,l+5,i),5+f}if(ArrayBuffer.isView&&ArrayBuffer.isView(i)&&(i=i.buffer),i instanceof ArrayBuffer){const f=i.byteLength;if(f<256)return a.setUint8(l,196),a.setUint8(l+1,f),new Uint8Array(a.buffer).set(new Uint8Array(i),l+2),2+f;if(f<65536)return a.setUint8(l,197),a.setUint16(l+1,f),new Uint8Array(a.buffer).set(new Uint8Array(i),l+3),3+f;if(f<4294967296)return a.setUint8(l,198),a.setUint32(l+1,f),new Uint8Array(a.buffer).set(new Uint8Array(i),l+5),5+f}if(typeof i=="number"){if(Math.floor(i)!==i)return a.setUint8(l,203),a.setFloat64(l+1,i),9;if(i>=0){if(i<128)return a.setUint8(l,i),1;if(i<256)return a.setUint8(l,204),a.setUint8(l+1,i),2;if(i<65536)return a.setUint8(l,205),a.setUint16(l+1,i),3;if(i<4294967296)return a.setUint8(l,206),a.setUint32(l+1,i),5;if(i<18446744073709552e3)return a.setUint8(l,207),Ge(a,l+1,i),9;throw new Error("Number too big 0x"+i.toString(16))}if(i>=-32)return a.setInt8(l,i),1;if(i>=-128)return a.setUint8(l,208),a.setInt8(l+1,i),2;if(i>=-32768)return a.setUint8(l,209),a.setInt16(l+1,i),3;if(i>=-2147483648)return a.setUint8(l,210),a.setInt32(l+1,i),5;if(i>=-9223372036854776e3)return a.setUint8(l,211),Oe(a,l+1,i),9;throw new Error("Number too small -0x"+(-i).toString(16).substr(1))}if(u==="undefined")return o?0:(a.setUint8(l,212),a.setUint8(l+1,0),a.setUint8(l+2,0),3);if(i===null)return o?0:(a.setUint8(l,192),1);if(u==="boolean")return a.setUint8(l,i?195:194),1;if(typeof i.toJSON=="function")return sn(i.toJSON(),a,l,o);if(u==="object"){let f,m=0,p;const R=Array.isArray(i);if(R?f=i.length:(p=Ti(i,o),f=p.length),f<16?(a.setUint8(l,f|(R?144:128)),m=1):f<65536?(a.setUint8(l,R?220:222),a.setUint16(l+1,f),m=3):f<4294967296&&(a.setUint8(l,R?221:223),a.setUint32(l+1,f),m=5),R)for(let A=0;A<f;A++)m+=sn(i[A],a,l+m,o);else if(p)for(let A=0;A<f;A++){const L=p[A];m+=sn(L,a,l+m),m+=sn(i[L],a,l+m,o)}return m}if(u==="function")return 0;throw new Error("Unknown type "+u)}function ti(i,a){const l=typeof i;if(l==="string"){const o=Fn(i);if(o<32)return 1+o;if(o<256)return 2+o;if(o<65536)return 3+o;if(o<4294967296)return 5+o}if(ArrayBuffer.isView&&ArrayBuffer.isView(i)&&(i=i.buffer),i instanceof ArrayBuffer){const o=i.byteLength;if(o<256)return 2+o;if(o<65536)return 3+o;if(o<4294967296)return 5+o}if(typeof i=="number"){if(Math.floor(i)!==i)return 9;if(i>=0){if(i<128)return 1;if(i<256)return 2;if(i<65536)return 3;if(i<4294967296)return 5;if(i<18446744073709552e3)return 9;throw new Error("Number too big 0x"+i.toString(16))}if(i>=-32)return 1;if(i>=-128)return 2;if(i>=-32768)return 3;if(i>=-2147483648)return 5;if(i>=-9223372036854776e3)return 9;throw new Error("Number too small -0x"+i.toString(16).substr(1))}if(l==="boolean")return 1;if(i===null)return a?0:1;if(i===void 0)return a?0:3;if(typeof i.toJSON=="function")return ti(i.toJSON(),a);if(l==="object"){let o,u=0;if(Array.isArray(i)){o=i.length;for(let f=0;f<o;f++)u+=ti(i[f],a)}else{const f=Ti(i,a);o=f.length;for(let m=0;m<o;m++){const p=f[m];u+=ti(p)+ti(i[p],a)}}if(o<16)return 1+u;if(o<65536)return 3+u;if(o<4294967296)return 5+u;throw new Error("Array or object too long 0x"+o.toString(16))}if(l==="function")return 0;throw new Error("Unknown type "+l)}var Ri={encode:Ds,decode:Bs,inspect:Wa,utf8Write:la,utf8Read:Vl,utf8ByteCount:Fn};function ra(i,a){return!!a.get("x-ably-errorcode")}function Ic(i,a){if(ra(i,a))return i.error&&N.fromValues(i.error)}function st(i){const a={};return i.forEach((l,o)=>{a[o]=l}),a}async function Yl(i,a,l,o,u,f){const m=new Headers(o||{}),p=i?i.toUpperCase():Q(f)?"GET":"POST",R=new AbortController;let A;const L=new Promise(q=>{A=setTimeout(()=>{R.abort(),q({error:new Ue("Request timed out",null,408)})},a?a.options.timeouts.httpRequestTimeout:ge.TIMEOUTS.httpRequestTimeout)}),B={method:p,headers:m,body:f,signal:R.signal};x.Config.isWebworker||(B.credentials=m.has("authorization")?"include":"same-origin");const Y=(async()=>{try{const q=new URLSearchParams(u||{});q.set("rnd",ls());const ee=l+"?"+q,te=await Sn().fetch(ee,B);if(clearTimeout(A),te.status==204)return{error:null,statusCode:te.status};const fe=te.headers.get("Content-Type");let xe;fe&&fe.indexOf("application/x-msgpack")>-1?xe=await te.arrayBuffer():fe&&fe.indexOf("application/json")>-1?xe=await te.json():xe=await te.text();const je=!!fe&&fe.indexOf("application/x-msgpack")===-1,ze=st(te.headers);return te.ok?{error:null,body:xe,headers:ze,unpacked:je,statusCode:te.status}:{error:Ic(xe,te.headers)||new Ue("Error response received from server: "+te.status+" body was: "+x.Config.inspect(xe),null,te.status),body:xe,headers:ze,unpacked:je,statusCode:te.status}}catch(q){return clearTimeout(A),{error:q}}})();return Promise.race([L,Y])}var Ql={XHRRequest:Ln,FetchRequest:Yl},Pl=Oi(Jn,Ia);x.Crypto=Pl,x.BufferUtils=Ia,x.Http=Oo,x.Config=Jn,x.Transports=zl,x.WebStorage=na;for(const i of[_s,Nn])i.Crypto=Pl,i._MsgPack=Ri;Oo.bundledRequestImplementations=Ql,h.initLogHandlers(),x.Defaults=xr(Ja),x.Config.agent&&(x.Defaults.agent+=" "+x.Config.agent);var Uo={ErrorInfo:N,Rest:_s,Realtime:Nn,msgpack:Ri,makeProtocolMessageFromDeserialized:_l};if(typeof S.exports=="object"&&typeof P=="object"){var Yc=(i,a,l,o)=>{if(a&&typeof a=="object"||typeof a=="function")for(let u of Object.getOwnPropertyNames(a))!Object.prototype.hasOwnProperty.call(i,u)&&u!==l&&Object.defineProperty(i,u,{get:()=>a[u],enumerable:!(o=Object.getOwnPropertyDescriptor(a,u))||o.enumerable});return i};S.exports=Yc(S.exports,P)}return S.exports})}(mc)),mc.exports}var pm=mm();const ym=(U,F,P,S)=>{const Z=an.useRef(null),X=an.useRef(null),re=an.useRef(null),[ue,K]=an.useState("disconnected"),[w,V]=an.useState(new Set),I=(De,...Ae)=>{U.debug&&console.log(De,...Ae)},ae=async()=>{if(!U.websocket.enabled||!U.websocket.apiKey.trim()||!U.websocket.roomId.trim()){I("Недостаточно данных для подключения к Ably");return}try{K("connecting"),re.current=`user-${Math.random().toString(36).substr(2,9)}`,Z.current=new pm.Realtime({key:U.websocket.apiKey,clientId:re.current,recover:!0}),Z.current.connection.on("connected",()=>{K("connected"),I("Подключено к Ably. Client ID:",re.current),I("Room ID:",U.websocket.roomId)}),Z.current.connection.on("disconnected",()=>{K("disconnected"),I("Отключено от Ably")}),Z.current.connection.on("failed",Ae=>{K("failed"),console.error("Ошибка подключения к Ably:",Ae)});const De=U.websocket.roomId.trim();X.current=Z.current.channels.get(De),I("Подключаемся к каналу:",De),X.current.on("attached",()=>{I("✅ Канал подключен и готов к работе")}),X.current.on("failed",Ae=>{console.error("❌ Ошибка канала:",Ae)}),X.current.subscribe("schedule-update",Ae=>{I("📨 Получено обновление расписания:",Ae.data),I("👤 От пользователя:",Ae.data?.userId,"Мой ID:",re.current),Ae.data&&Ae.data.schedule&&Ae.data.userId!==re.current?(I("✅ Применяем изменения расписания от другого пользователя"),P(Ae.data.schedule)):I("⏭️ Игнорируем собственное сообщение")}),X.current.subscribe("settings-update",Ae=>{I("Получено обновление настроек:",Ae.data),Ae.data&&Ae.data.settings&&Ae.data.userId!==re.current&&(I("Применяем изменения настроек от другого пользователя"),S(Ae.data.settings))}),X.current.subscribe("test-message",Ae=>{I("🧪 Получено тестовое сообщение:",Ae.data),Ae.data.userId!==re.current&&I("✅ Тест синхронизации прошел успешно!")}),X.current.presence.enter({username:`Пользователь ${Math.floor(Math.random()*1e3)}`,joinedAt:new Date().toISOString()}),X.current.presence.subscribe(Ae=>{X.current.presence.get(($e,x)=>{!$e&&Array.isArray(x)&&V(new Set(x.map(Re=>Re.data.username)))})})}catch(De){console.error("Ошибка при подключении к Ably:",De),K("failed")}},$=()=>{if(X.current){try{X.current.presence.leave(),X.current.unsubscribe()}catch(De){I("Ошибка при отключении канала (норм):",De.message)}X.current=null}if(Z.current){try{Z.current.close()}catch(De){I("Ошибка при закрытии клиента (норм):",De.message)}Z.current=null}re.current=null,K("disconnected"),V(new Set)},be=De=>{if(I("🔄 Попытка отправки обновления расписания"),I("📊 State - channel:",!!X.current,"connected:",ue==="connected"),X.current&&ue==="connected"){const Ae={schedule:De,timestamp:new Date().toISOString(),userId:re.current};I("📤 Отправляем обновление расписания:",Ae),X.current.publish("schedule-update",Ae).then(()=>{I("✅ Сообщение успешно отправлено")}).catch($e=>{console.error("❌ Ошибка отправки сообщения:",$e)})}else I("❌ Не можем отправить: канал не готов или не подключен")},rt=De=>{if(X.current&&ue==="connected"){const Ae={settings:{employees:De.employees,shiftTypes:De.shiftTypes},timestamp:new Date().toISOString(),userId:re.current};I("Отправляем обновление настроек:",Ae),X.current.publish("settings-update",Ae)}},Ke=()=>{if(X.current&&ue==="connected"){const De={test:!0,timestamp:new Date().toISOString(),userId:re.current};I("🧪 Отправляем тестовое сообщение"),X.current.publish("test-message",De)}};return an.useEffect(()=>{if($(),U.websocket.enabled&&U.websocket.apiKey.trim()&&U.websocket.roomId.trim()){const De=setTimeout(()=>{ae()},100);return()=>{clearTimeout(De),$()}}return()=>{$()}},[U.websocket.enabled,U.websocket.apiKey,U.websocket.roomId]),{connectionState:ue,onlineUsers:w,publishScheduleUpdate:be,publishSettingsUpdate:rt,sendTestMessage:Ke}},vm=["Ильвина","Инесса","Альбина","Анастасия","Арина","Ксения","Света","Елена","Леся","Алия","Даша"],bm={morning:{label:"Утро",time:"8:00-16:00",shortLabel:"У",start:8,startMinutes:0,end:16,endMinutes:0},day:{label:"День",time:"10:00-18:00",shortLabel:"Д",start:10,startMinutes:0,end:18,endMinutes:0},evening:{label:"Вечер",time:"16:00-00:00",shortLabel:"В",start:16,startMinutes:0,end:24,endMinutes:0},night:{label:"Ночь",time:"00:00-08:00",shortLabel:"Н",start:0,startMinutes:0,end:8,endMinutes:0},off:{label:"Выходной",time:"",shortLabel:"В",start:null,end:null},vacation:{label:"Отпуск",time:"",shortLabel:"О",start:null,end:null},sick:{label:"Больничный",time:"",shortLabel:"Б",start:null,end:null}},nf={Альбина:["off","off","off","off","off","off","off","off","off","off","off","off","off","off"],Анастасия:[],Арина:["off","off","off","off","off","off","off","off","off","off","off","off","off","off"],Алия:["","","off","off","","","","off","","","","","",""]},Vd={morning:!0,day:!0,evening:!0,night:!0,off:!0,vacation:!0,sick:!0,empty:!0},Tr=["пн 23","вт 24","ср 25","чт 26","пт 27","сб 28","вс 29","пн 30","вт 1","ср 2","чт 3","пт 4","сб 5","вс 6"],Sm=({currentView:U,selectedDay:F,bulkEditMode:P,onViewSwitch:S,onBulkEditToggle:Z,onSettingsOpen:X,onExportData:re,onImportData:ue,onClearAllData:K,connectionState:w,onlineUsers:V,websocketEnabled:I})=>{const ae=$=>Tr[$]||"";return E.jsxs("div",{className:"header",children:[E.jsxs("div",{className:"header-left",children:[E.jsx("h1",{children:"Расписание смен"}),I&&E.jsxs("div",{className:`connection-status ${w}`,children:[w==="connected"&&"🟢 Подключено",w==="connecting"&&"🟡 Подключение...",w==="disconnected"&&"🔴 Отключено",w==="failed"&&"❌ Ошибка",V.size>1&&` (${V.size})`]})]}),E.jsxs("div",{className:"header-controls",children:[E.jsxs("div",{className:"view-toggle",children:[E.jsx("button",{className:`view-btn ${U==="grid"?"active":""}`,onClick:()=>S("grid"),children:"Календарь"}),F!==null&&E.jsxs("button",{className:`view-btn ${U==="gantt"?"active":""}`,onClick:()=>S("gantt"),children:["Ганта (",ae(F),")"]})]}),E.jsxs("div",{className:"data-controls",children:[E.jsx("button",{className:`bulk-edit-btn ${P?"active":""}`,onClick:Z,children:P?"Выйти из массового режима":"Массовое редактирование"}),E.jsxs("div",{className:"dropdown",children:[E.jsx("button",{className:"dropdown-btn",children:"⚙️"}),E.jsxs("div",{className:"dropdown-content",children:[E.jsx("button",{onClick:X,children:"⚙️ Настройки"}),E.jsx("button",{onClick:re,children:"📥 Экспорт данных"}),E.jsxs("label",{className:"import-btn",children:["📤 Импорт данных",E.jsx("input",{type:"file",accept:".json",onChange:ue,style:{display:"none"}})]}),E.jsx("button",{onClick:K,className:"danger-btn",children:"🗑️ Очистить все"})]})]})]})]})]})},Am=({shiftTypes:U,filters:F,onFilterToggle:P})=>E.jsxs("div",{className:"legend",children:[E.jsx("div",{className:"filter-header",children:"Фильтры:"}),E.jsxs("div",{className:"filter-items",children:[Object.entries(U).map(([S,Z])=>E.jsxs("div",{className:`legend-item filter ${F[S]?"active":"inactive"}`,onClick:()=>P(S),title:Z.label,children:[E.jsx("div",{className:`legend-color shift-${S}`}),E.jsx("span",{children:Z.shortLabel})]},S)),E.jsxs("div",{className:`legend-item filter ${F.empty?"active":"inactive"}`,onClick:()=>P("empty"),title:"Пустые ячейки",children:[E.jsx("div",{className:"legend-color empty-shift"}),E.jsx("span",{children:"—"})]})]})]}),Om=({employees:U,schedule:F,shiftTypes:P,selectedCells:S,bulkEditMode:Z,onCellClick:X,onCellRightClick:re,onDateClick:ue,shouldShowEmployee:K})=>{const w=V=>P[V]?.shortLabel||"";return E.jsx("div",{className:"grid-view",children:E.jsxs("div",{className:"schedule-grid",children:[E.jsxs("div",{className:"grid-header",children:[E.jsx("div",{children:"Имя"}),Tr.map((V,I)=>E.jsx("div",{className:`date-header ${I===5||I===6||I===12||I===13?"weekend":""} ${I===8?"today":""}`,onClick:()=>ue(I),children:V.split(" ").map((ae,$)=>E.jsx("div",{children:ae},$))},I))]}),U.map((V,I)=>K(I)?E.jsxs("div",{className:"grid-row",children:[E.jsx("div",{className:"employee-name",children:V}),Array.from({length:14},(ae,$)=>{const be=`${I}-${$}`,rt=S.has(be);return E.jsx("div",{className:`day-cell ${rt?"selected":""} ${Z?"bulk-mode":""}`,onClick:()=>X(I,$),onContextMenu:re,children:F[be]&&E.jsx("div",{className:`shift-indicator shift-${F[be]}`,children:w(F[be])})},$)})]},I):null)]})})},Tm=({employees:U,schedule:F,shiftTypes:P,selectedCells:S,bulkEditMode:Z,onCellClick:X,onCellRightClick:re,shouldShowEmployee:ue})=>{const K=w=>P[w]?.shortLabel||"";return E.jsx("div",{className:"timeline-view",children:E.jsxs("div",{className:"timeline-container",children:[E.jsxs("div",{className:"timeline-header",children:[E.jsx("div",{className:"timeline-employee-header",children:"Сотрудник"}),E.jsx("div",{className:"timeline-dates",children:Tr.map((w,V)=>E.jsx("div",{className:`timeline-date ${V===5||V===6||V===12||V===13?"weekend":""} ${V===8?"today":""}`,children:w},V))})]}),U.map((w,V)=>ue(V)?E.jsxs("div",{className:"timeline-row",children:[E.jsx("div",{className:"timeline-employee",children:w}),E.jsx("div",{className:"timeline-schedule",children:Array.from({length:14},(I,ae)=>{const $=`${V}-${ae}`,be=S.has($);return E.jsx("div",{className:`timeline-cell ${be?"selected":""} ${Z?"bulk-mode":""}`,onClick:()=>X(V,ae),onContextMenu:re,children:F[$]&&E.jsx("div",{className:`timeline-shift shift-${F[$]}`,children:K(F[$])})},ae)})})]},V):null)]})})},Rm=({selectedDay:U,onDaySelect:F})=>E.jsxs("div",{className:"date-selector",children:[E.jsx("div",{className:"date-selector-header",children:"Выберите дату:"}),E.jsx("div",{className:"date-options",children:Tr.map((P,S)=>E.jsx("button",{className:`date-option ${U===S?"active":""} ${S===5||S===6||S===12||S===13?"weekend":""} ${S===8?"today":""}`,onClick:()=>F(S),children:P},S))})]}),_m=({employees:U,schedule:F,shiftTypes:P,selectedDay:S,onBackToGrid:Z,onDaySelect:X,shouldShowEmployee:re})=>{const ue=w=>Tr[w]||"",K=w=>{const V=P[w];return!V||V.start===null?null:{start:V.start,end:V.end,label:V.label}};return E.jsxs("div",{className:"gantt-view",children:[E.jsxs("div",{className:"gantt-header",children:[E.jsxs("h2",{children:["Расписание на ",ue(S)]}),E.jsx("button",{className:"back-btn",onClick:Z,children:"← Вернуться к календарю"})]}),E.jsx(Rm,{selectedDay:S,onDaySelect:X}),E.jsxs("div",{className:"gantt-container",children:[E.jsxs("div",{className:"time-scale",children:[E.jsx("div",{className:"time-scale-header",children:"Время"}),E.jsx("div",{className:"time-hours",children:Array.from({length:24},(w,V)=>E.jsxs("div",{className:"time-hour",children:[V.toString().padStart(2,"0"),":00"]},V))})]}),E.jsxs("div",{className:"gantt-employees",children:[E.jsx("div",{className:"gantt-employees-header",children:"Сотрудник"}),E.jsx("div",{className:"gantt-rows",children:U.map((w,V)=>{const I=`${V}-${S}`,ae=F[I],$=ae?K(ae):null;return re(V)?E.jsxs("div",{className:"gantt-row",children:[E.jsx("div",{className:"gantt-employee-name",children:w}),E.jsxs("div",{className:"gantt-timeline",children:[Array.from({length:24},(be,rt)=>E.jsx("div",{className:"gantt-hour-cell"},rt)),$&&E.jsx("div",{className:`gantt-shift shift-${ae}`,style:{left:`${$.start/24*100}%`,width:`${($.end-$.start)/24*100}%`},children:E.jsxs("span",{className:"gantt-shift-label",children:[$.label," (",$.start,":00-",$.end,":00)"]})}),ae&&!$&&E.jsxs("div",{className:`gantt-status shift-${ae}`,children:[ae==="off"&&"Выходной",ae==="vacation"&&"Отпуск",ae==="sick"&&"Больничный"]})]})]},V):null})})]})]})]})},Cm=({isOpen:U,shiftTypes:F,selectedCells:P,bulkEditMode:S,onShiftChange:Z,onClose:X})=>U?E.jsx("div",{className:"popup-overlay",onClick:X,children:E.jsxs("div",{className:"popup",onClick:re=>re.stopPropagation(),children:[E.jsx("h3",{children:S&&P.size>0?`Выберите тип смены для ${P.size} ячеек`:"Выберите тип смены"}),E.jsxs("div",{className:"shift-options",children:[Object.entries(F).map(([re,ue])=>E.jsxs("div",{className:`shift-option shift-${re}`,onClick:()=>Z(re),children:[ue.label,ue.time&&E.jsx("br",{}),ue.time]},re)),E.jsx("div",{className:"shift-option",style:{background:"#fff",color:"#333",border:"2px solid #ddd"},onClick:()=>Z("clear"),children:"Очистить"})]}),E.jsx("div",{className:"popup-buttons",children:E.jsx("button",{className:"btn btn-cancel",onClick:X,children:"Отмена"})})]})}):null,Jd=(U,F=0)=>{const P=U.toString().padStart(2,"0"),S=F.toString().padStart(2,"0");return`${P}:${S}`},Wd=(U,F=0)=>U*60+F,Em=U=>{const F=Math.floor(U/60),P=U%60;return{hours:F,minutes:P}},Mm=(U=10)=>{const F=[];for(let P=0;P<24;P++)for(let S=0;S<60;S+=U)F.push({value:Wd(P,S),label:Jd(P,S),hours:P,minutes:S});return F},Id=({value:U,onChange:F,placeholder:P="Выберите время",stepMinutes:S=10})=>{const Z=Mm(S);let X="";typeof U=="number"?X=U*60:typeof U=="object"&&U.hours!==void 0&&(X=Wd(U.hours,U.minutes||0));const re=ue=>{const K=parseInt(ue.target.value),w=Em(K);F({hours:w.hours,minutes:w.minutes,totalMinutes:K,formatted:Jd(w.hours,w.minutes)})};return E.jsxs("select",{value:X,onChange:re,className:"time-select",children:[E.jsx("option",{value:"",children:P}),Z.map(ue=>E.jsx("option",{value:ue.value,children:ue.label},ue.value))]})},wm=({isOpen:U,settings:F,connectionState:P,onClose:S,onEmployeeChange:Z,onRemoveEmployee:X,onAddEmployee:re,onShiftTypeChange:ue,onRemoveShiftType:K,onSettingsChange:w,onSendTestMessage:V})=>U?E.jsx("div",{className:"settings-overlay",onClick:S,children:E.jsxs("div",{className:"settings-modal",onClick:I=>I.stopPropagation(),children:[E.jsxs("div",{className:"settings-header",children:[E.jsx("h2",{children:"Настройки"}),E.jsx("button",{className:"close-btn",onClick:S,children:"×"})]}),E.jsxs("div",{className:"settings-content",children:[E.jsxs("div",{className:"settings-section",children:[E.jsx("h3",{children:"Сотрудники"}),E.jsx("div",{className:"employees-list",children:F.employees.map((I,ae)=>E.jsxs("div",{className:"employee-item",children:[E.jsx("input",{type:"text",value:I,onChange:$=>Z(ae,$.target.value)}),E.jsx("button",{className:"remove-btn",onClick:()=>X(ae),children:"🗑️"})]},ae))}),E.jsx("button",{className:"add-btn",onClick:re,children:"+ Добавить сотрудника"})]}),E.jsxs("div",{className:"settings-section",children:[E.jsx("h3",{children:"Типы смен"}),E.jsx("div",{className:"shift-types-list",children:Object.entries(F.shiftTypes).map(([I,ae])=>E.jsxs("div",{className:"shift-type-item",children:[E.jsxs("div",{className:"shift-type-inputs",children:[E.jsx("input",{type:"text",placeholder:"Название",value:ae.label,onChange:$=>ue(I,"label",$.target.value)}),E.jsx("input",{type:"text",placeholder:"Краткое",value:ae.shortLabel,maxLength:2,onChange:$=>ue(I,"shortLabel",$.target.value)}),ae.start!==null&&E.jsxs(E.Fragment,{children:[E.jsx(Id,{value:{hours:ae.start,minutes:ae.startMinutes||0},placeholder:"Начало",onChange:$=>{ue(I,"start",$.hours),ue(I,"startMinutes",$.minutes)}}),E.jsx(Id,{value:{hours:ae.end,minutes:ae.endMinutes||0},placeholder:"Конец",onChange:$=>{ue(I,"end",$.hours),ue(I,"endMinutes",$.minutes)}})]})]}),E.jsx("button",{className:"remove-btn",onClick:()=>K(I),children:"🗑️"})]},I))})]}),E.jsxs("div",{className:"settings-section",children:[E.jsx("h3",{children:"Ably Real-time Sync"}),E.jsxs("div",{className:"websocket-settings",children:[E.jsxs("div",{className:"ably-info",children:[E.jsx("p",{children:E.jsx("strong",{children:"📋 Инструкция по настройке:"})}),E.jsxs("ol",{children:[E.jsxs("li",{children:["Зарегистрируйтесь на ",E.jsx("a",{href:"https://ably.com",target:"_blank",rel:"noopener noreferrer",children:"ably.com"})," (бесплатно)"]}),E.jsx("li",{children:"Создайте новое приложение"}),E.jsx("li",{children:'Скопируйте API ключ из раздела "API Keys"'}),E.jsx("li",{children:"Введите данные ниже и включите синхронизацию"})]})]}),E.jsxs("label",{children:[E.jsx("input",{type:"checkbox",checked:F.websocket.enabled,onChange:I=>w("websocket.enabled",I.target.checked)}),"Включить real-time синхронизацию"]}),E.jsx("input",{type:"password",placeholder:"Ably API Key (например: abc123.def456:xyz789)",value:F.websocket.apiKey,onChange:I=>w("websocket.apiKey",I.target.value),disabled:!F.websocket.enabled}),E.jsx("input",{type:"text",placeholder:"Room ID (например: simple-scheduler-mv)",value:F.websocket.roomId,onChange:I=>w("websocket.roomId",I.target.value),disabled:!F.websocket.enabled}),P==="connected"&&E.jsx("div",{className:"ably-status success",children:"✅ Подключено! Изменения синхронизируются в реальном времени"}),P==="failed"&&E.jsx("div",{className:"ably-status error",children:"❌ Ошибка подключения. Проверьте API ключ и интернет-соединение"}),P==="connected"&&E.jsx("button",{className:"btn btn-primary",onClick:V,style:{marginTop:"10px"},children:"🧪 Тест отправки сообщения"})]})]}),E.jsxs("div",{className:"settings-section",children:[E.jsx("h3",{children:"Отладка"}),E.jsxs("div",{className:"debug-settings",children:[E.jsxs("label",{children:[E.jsx("input",{type:"checkbox",checked:F.debug,onChange:I=>w("debug",I.target.checked)}),"Включить режим отладки (показывать логи в консоли)"]}),F.debug&&E.jsxs("div",{className:"debug-info",children:[E.jsxs("p",{children:["🐛 ",E.jsx("strong",{children:"Режим отладки включен"})]}),E.jsx("p",{children:"Все действия синхронизации будут отображаться в консоли браузера (F12 → Console)"})]})]})]})]}),E.jsxs("div",{className:"settings-footer",children:[E.jsx("button",{className:"btn btn-cancel",onClick:S,children:"Отмена"}),E.jsx("button",{className:"btn btn-primary",onClick:S,children:"Сохранить"})]})]})}):null;function Nm(){const[U,F]=br("schedule-planner-settings",{employees:vm,shiftTypes:bm,websocket:{url:"",apiKey:"",roomId:"",enabled:!1},debug:!1}),[P,S]=br("schedule-planner-data",()=>{const ne={};return U.employees.forEach((J,ve)=>{for(let Ce=0;Ce<14;Ce++){const _e=`${ve}-${Ce}`;nf[J]&&nf[J][Ce]&&(ne[_e]=nf[J][Ce])}}),ne}),[Z,X]=br("schedule-planner-view","grid"),[re,ue]=br("schedule-planner-selected-day",null),[K,w]=br("schedule-planner-filters",Vd),[V,I]=an.useState({open:!1,empIndex:null,dayIndex:null}),[ae,$]=an.useState(!1),[be,rt]=an.useState(!1),[Ke,De]=an.useState(new Set),[Ae,$e]=an.useState(!1),x=ne=>{S(ne)},Re=ne=>{F(J=>({...J,employees:ne.employees||J.employees,shiftTypes:ne.shiftTypes||J.shiftTypes}))},{connectionState:ht,onlineUsers:Nt,publishScheduleUpdate:mt,publishSettingsUpdate:Ze,sendTestMessage:jn}=ym(U,P,x,Re);an.useEffect(()=>{const ne=J=>{Ae&&!J.target.closest(".dropdown")&&$e(!1)};return document.addEventListener("mousedown",ne),()=>{document.removeEventListener("mousedown",ne)}},[Ae]);const h=(ne,J)=>{const ve=[...U.employees];ve[ne]=J;const Ce={...U,employees:ve};F(Ce),Ze(Ce)},Fe=ne=>{const J=U.employees.filter((Ce,_e)=>_e!==ne),ve={...U,employees:J};F(ve),Ze(ve)},fn=()=>{const ne={...U,employees:[...U.employees,"Новый сотрудник"]};F(ne),Ze(ne)},N=(ne,J,ve)=>{const Ce={...U.shiftTypes,[ne]:{...U.shiftTypes[ne],[J]:ve}};if(J==="start"||J==="end"||J==="startMinutes"||J==="endMinutes"){const ot=Ce[ne];if(ot.start!==null&&ot.end!==null){const Yt=ot.startMinutes||0,Di=ot.endMinutes||0,is=`${ot.start.toString().padStart(2,"0")}:${Yt.toString().padStart(2,"0")}`,as=`${ot.end.toString().padStart(2,"0")}:${Di.toString().padStart(2,"0")}`;Ce[ne].time=`${is}-${as}`}}const _e={...U,shiftTypes:Ce};F(_e),Ze(_e)},Ue=ne=>{const J={...U.shiftTypes};delete J[ne];const ve={...U,shiftTypes:J};F(ve),Ze(ve)},D=ne=>{let J;if(be&&Ke.size>0)S(ve=>(J={...ve},Ke.forEach(Ce=>{ne==="clear"?delete J[Ce]:J[Ce]=ne}),mt(J),J)),De(new Set);else{if(V.empIndex===null||V.dayIndex===null)return;const ve=`${V.empIndex}-${V.dayIndex}`;S(Ce=>(J={...Ce},ne==="clear"?delete J[ve]:J[ve]=ne,mt(J),J))}I({open:!1,empIndex:null,dayIndex:null})},j=(ne,J)=>{if(be){const ve=`${ne}-${J}`;De(Ce=>{const _e=new Set(Ce);return _e.has(ve)?_e.delete(ve):_e.add(ve),_e})}else I({open:!0,empIndex:ne,dayIndex:J})},le=ne=>{be&&Ke.size>0&&(ne.preventDefault(),I({open:!0,empIndex:null,dayIndex:null}))},Le=ne=>{ue(ne),X("gantt")},v=ne=>{w(J=>({...J,[ne]:!J[ne]}))},H=ne=>{for(let J=0;J<14;J++){const ve=`${ne}-${J}`,Ce=P[ve];if(!Ce&&K.empty||Ce&&K[Ce])return!0}return!1},Q=()=>{rt(!be),De(new Set)},W=()=>{const ne={schedule:P,filters:K,currentView:Z,selectedDay:re,exportDate:new Date().toISOString(),version:"1.0"},J=JSON.stringify(ne,null,2),ve=new Blob([J],{type:"application/json"}),Ce=URL.createObjectURL(ve),_e=document.createElement("a");_e.href=Ce,_e.download=`schedule-planner-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(_e),_e.click(),document.body.removeChild(_e),URL.revokeObjectURL(Ce)},ce=ne=>{const J=ne.target.files[0];if(!J)return;const ve=new FileReader;ve.onload=Ce=>{try{const _e=JSON.parse(Ce.target.result);_e.schedule&&(S(_e.schedule),mt(_e.schedule)),_e.filters&&w(_e.filters),_e.currentView&&X(_e.currentView),_e.selectedDay!==void 0&&ue(_e.selectedDay),alert("Данные успешно импортированы!")}catch(_e){alert("Ошибка при импорте данных. Проверьте формат файла."),console.error("Import error:",_e)}},ve.readAsText(J),ne.target.value=""},Ne=()=>{if(confirm("Вы уверены, что хотите очистить все данные? Это действие нельзя отменить.")){const ne={};S(ne),mt(ne),w(Vd),X("grid"),ue(null),rt(!1),De(new Set),alert("Все данные очищены!")}},me=(ne,J)=>{const ve=ne.split(".");F(Ce=>{const _e={...Ce};let ot=_e;for(let Yt=0;Yt<ve.length-1;Yt++)ot[ve[Yt]]={...ot[ve[Yt]]},ot=ot[ve[Yt]];return ot[ve[ve.length-1]]=J,_e})};return E.jsxs("div",{className:"container",children:[E.jsx(Sm,{currentView:Z,selectedDay:re,bulkEditMode:be,connectionState:ht,onlineUsers:Nt,websocketEnabled:U.websocket.enabled,onViewSwitch:X,onBulkEditToggle:Q,onSettingsOpen:()=>$(!0),onExportData:W,onImportData:ce,onClearAllData:Ne}),E.jsxs("div",{className:"content",children:[E.jsx(Am,{shiftTypes:U.shiftTypes,filters:K,onFilterToggle:v}),Z==="grid"&&E.jsx(Om,{employees:U.employees,schedule:P,shiftTypes:U.shiftTypes,selectedCells:Ke,bulkEditMode:be,onCellClick:j,onCellRightClick:le,onDateClick:Le,shouldShowEmployee:H}),Z==="timeline"&&E.jsx(Tm,{employees:U.employees,schedule:P,shiftTypes:U.shiftTypes,selectedCells:Ke,bulkEditMode:be,onCellClick:j,onCellRightClick:le,shouldShowEmployee:H}),Z==="gantt"&&re!==null&&E.jsx(_m,{employees:U.employees,schedule:P,shiftTypes:U.shiftTypes,selectedDay:re,onBackToGrid:()=>X("grid"),onDaySelect:ue,shouldShowEmployee:H}),E.jsx(Cm,{isOpen:V.open,shiftTypes:U.shiftTypes,selectedCells:Ke,bulkEditMode:be,onShiftChange:D,onClose:()=>I({open:!1,empIndex:null,dayIndex:null})}),E.jsx(wm,{isOpen:ae,settings:U,connectionState:ht,onClose:()=>$(!1),onEmployeeChange:h,onRemoveEmployee:Fe,onAddEmployee:fn,onShiftTypeChange:N,onRemoveShiftType:Ue,onSettingsChange:me,onSendTestMessage:jn})]})]})}dm.createRoot(document.getElementById("root")).render(E.jsx(Nm,{}));
//# sourceMappingURL=index.js.map
